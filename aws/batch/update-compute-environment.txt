UPDATE-COMPUTE-ENVIRONMENT()                      UPDATE-COMPUTE-ENVIRONMENT()



NAME
       update-compute-environment -

DESCRIPTION
       Updates an Batch compute environment.

       See also: AWS API Documentation

       See 'aws help' for descriptions of global parameters.

SYNOPSIS
            update-compute-environment
          --compute-environment <value>
          [--state <value>]
          [--unmanagedv-cpus <value>]
          [--compute-resources <value>]
          [--service-role <value>]
          [--update-policy <value>]
          [--cli-input-json <value>]
          [--generate-cli-skeleton <value>]

OPTIONS
       --compute-environment (string)
          The  name or full Amazon Resource Name (ARN) of the compute environ-
          ment to update.

       --state (string)
          The state of the compute environment. Compute  environments  in  the
          ENABLED state can accept jobs from a queue and scale in or out auto-
          matically based on the workload demand of its associated queues.

          If the state is ENABLED , then the Batch scheduler  can  attempt  to
          place  jobs  from  an  associated job queue on the compute resources
          within the environment. If the compute environment is managed,  then
          it can scale its instances out or in automatically, based on the job
          queue demand.

          If the state is DISABLED , then the Batch scheduler doesn't  attempt
          to  place jobs within the environment. Jobs in a STARTING or RUNNING
          state continue to progress normally. Managed compute environments in
          the DISABLED state don't scale out. However, they scale in to minvC-
          pus value after instances become idle.

          Possible values:

          o ENABLED

          o DISABLED

       --unmanagedv-cpus (integer)
          The maximum number of vCPUs expected to be  used  for  an  unmanaged
          compute  environment.  Do  not  specify this parameter for a managed
          compute environment. This parameter is  only  used  for  fair  share
          scheduling  to  reserve  vCPU capacity for new share identifiers. If
          this parameter is not provided for a fair share job queue,  no  vCPU
          capacity will be reserved.

       --compute-resources (structure)
          Details of the compute resources managed by the compute environment.
          Required for a managed compute environment.  For  more  information,
          see Compute Environments in the Batch User Guide .

          minvCpus -> (integer)
              The  minimum  number  of  Amazon  EC2  vCPUs that an environment
              should maintain (even if the compute environment is DISABLED ).

              NOTE:
                 This parameter isn't applicable to jobs that are  running  on
                 Fargate resources, and shouldn't be specified.

          maxvCpus -> (integer)
              The  maximum  number of Amazon EC2 vCPUs that an environment can
              reach.

              NOTE:
                 With both  BEST_FIT_PROGRESSIVE  and  SPOT_CAPACITY_OPTIMIZED
                 allocation strategies, Batch might need to exceed maxvCpus to
                 meet your capacity requirements. In this event,  Batch  never
                 exceeds  maxvCpus by more than a single instance. That is, no
                 more than a single instance from  among  those  specified  in
                 your compute environment.

          desiredvCpus -> (integer)
              The  desired  number of Amazon EC2 vCPUS in the compute environ-
              ment. Batch modifies this value between the minimum and  maximum
              values based on job queue demand.

              NOTE:
                 This  parameter  isn't applicable to jobs that are running on
                 Fargate resources, and shouldn't be specified.

          subnets -> (list)
              The VPC subnets where the compute resources are  launched.  Far-
              gate compute resources can contain up to 16 subnets. For Fargate
              compute resources, providing an empty list will be handled as if
              this  parameter  wasn't specified and no change is made. For EC2
              compute resources, providing an empty list removes the VPC  sub-
              nets  from  the compute resource. For more information, see VPCs
              and subnets in the Amazon VPC User Guide .

              When updating a compute environment, changing  the  VPC  subnets
              requires  an  infrastructure  update of the compute environment.
              For more information, see Updating compute environments  in  the
              Batch User Guide .

              (string)

          securityGroupIds -> (list)
              The   Amazon  EC2  security  groups  associated  with  instances
              launched in the compute environment. This parameter is  required
              for  Fargate compute resources, where it can contain up to 5 se-
              curity groups. For Fargate compute resources, providing an empty
              list  is  handled  as  if this parameter wasn't specified and no
              change is made. For EC2 compute resources,  providing  an  empty
              list removes the security groups from the compute resource.

              When  updating  a compute environment, changing the EC2 security
              groups requires an infrastructure update of the compute environ-
              ment. For more information, see Updating compute environments in
              the Batch User Guide .

              (string)

          allocationStrategy -> (string)
              The allocation strategy to use for the compute resource  if  not
              enough  instances of the best fitting instance type can be allo-
              cated. This might be because of  availability  of  the  instance
              type  in  the Region or Amazon EC2 service limits . For more in-
              formation, see Allocation strategies in the Batch User Guide .

              When updating a compute  environment,  changing  the  allocation
              strategy  requires an infrastructure update of the compute envi-
              ronment. For more information, see Updating compute environments
              in the Batch User Guide . BEST_FIT isn't supported when updating
              a compute environment.

              NOTE:
                 This parameter isn't applicable to jobs that are  running  on
                 Fargate resources, and shouldn't be specified.

                 BEST_FIT_PROGRESSIVE

              Batch  will  select  additional  instance  types  that are large
              enough to meet the requirements of the jobs in the queue, with a
              preference  for  instance types with a lower cost per unit vCPU.
              If additional instances  of  the  previously  selected  instance
              types aren't available, Batch will select new instance types.
                 SPOT_CAPACITY_OPTIMIZED

              Batch  will  select  one  or  more instance types that are large
              enough to meet the requirements of the jobs in the queue, with a
              preference  for instance types that are less likely to be inter-
              rupted. This allocation strategy is only available for Spot  In-
              stance compute resources.

              With   both   BEST_FIT_PROGRESSIVE  and  SPOT_CAPACITY_OPTIMIZED
              strategies, Batch might need to go above maxvCpus to  meet  your
              capacity requirements. In this event, Batch never exceeds maxvC-
              pus by more than a single instance.

          instanceTypes -> (list)
              The instances types that can be launched. You  can  specify  in-
              stance  families  to launch any instance type within those fami-
              lies (for example, c5 or p3 ), or you can specify specific sizes
              within a family (such as c5.8xlarge ). You can also choose opti-
              mal to select instance types (from the C4, M4, and  R4  instance
              families) that match the demand of your job queues.

              When  updating  a compute environment, changing this setting re-
              quires an infrastructure update of the compute environment.  For
              more information, see Updating compute environments in the Batch
              User Guide .

              NOTE:
                 This parameter isn't applicable to jobs that are  running  on
                 Fargate resources, and shouldn't be specified.

              NOTE:
                 When  you  create  a  compute environment, the instance types
                 that you select for the compute environment  must  share  the
                 same architecture. For example, you can't mix x86 and ARM in-
                 stances in the same compute environment.

              NOTE:
                 Currently, optimal uses instance types from the C4,  M4,  and
                 R4  instance  families.  In  Regions that don't have instance
                 types from those instance families, instance types  from  the
                 C5, M5. and R5 instance families are used.

              (string)

          ec2KeyPair -> (string)
              The  Amazon  EC2  key pair that's used for instances launched in
              the compute environment. You can use this key pair to log in  to
              your  instances with SSH. To remove the Amazon EC2 key pair, set
              this value to an empty string.

              When updating a compute environment, changing the EC2  key  pair
              requires  an  infrastructure  update of the compute environment.
              For more information, see Updating compute environments  in  the
              Batch User Guide .

              NOTE:
                 This  parameter  isn't applicable to jobs that are running on
                 Fargate resources, and shouldn't be specified.

          instanceRole -> (string)
              The Amazon ECS instance profile applied to Amazon EC2  instances
              in a compute environment. You can specify the short name or full
              Amazon Resource Name (ARN) of an instance profile. For  example,
              `` ecsInstanceRole `` or
              ``
              arn:aws:iam::<aws_account_id>  :instance-profile/ecsInstanceRole
              `` . For more information, see Amazon ECS instance role  in  the
              Batch User Guide .

              System Message: WARNING/2 (<string>:, line 310)
                     Inline literal start-string without end-string.

                     When  updating  a compute environment, changing this set-
                     ting requires an infrastructure update of the compute en-
                     vironment. For more information, see Updating compute en-
                     vironments in the Batch User Guide .

                     NOTE:
                 This parameter isn't applicable to jobs that are  running  on
                 Fargate resources, and shouldn't be specified.

          tags -> (map)
              Key-value  pair  tags  to  be  applied to EC2 resources that are
              launched in the compute environment. For Batch, these  take  the
              form  of  "String1": "String2", where String1 is the tag key and
              String2 is the tag valuefor example, { "Name": "Batch Instance -
              C4OnDemand"  }  . This is helpful for recognizing your Batch in-
              stances in the Amazon EC2 console. These tags aren't  seen  when
              using the Batch ListTagsForResource API operation.

              When  updating  a compute environment, changing this setting re-
              quires an infrastructure update of the compute environment.  For
              more information, see Updating compute environments in the Batch
              User Guide .

              NOTE:
                 This parameter isn't applicable to jobs that are  running  on
                 Fargate resources, and shouldn't be specified.

              key -> (string)

              value -> (string)

          placementGroup -> (string)
              The  Amazon  EC2  placement group to associate with your compute
              resources. If you intend to submit multi-node parallel  jobs  to
              your compute environment, you should consider creating a cluster
              placement group and associate it with  your  compute  resources.
              This keeps your multi-node parallel job on a logical grouping of
              instances within a single Availability Zone  with  high  network
              flow  potential.  For  more information, see Placement groups in
              the Amazon EC2 User Guide for Linux Instances .

              When updating a  compute  environment,  changing  the  placement
              group  requires an infrastructure update of the compute environ-
              ment. For more information, see Updating compute environments in
              the Batch User Guide .

              NOTE:
                 This  parameter  isn't applicable to jobs that are running on
                 Fargate resources, and shouldn't be specified.

          bidPercentage -> (integer)
              The maximum percentage that a Spot Instance price  can  be  when
              compared  with the On-Demand price for that instance type before
              instances are launched. For example, if your maximum  percentage
              is 20%, then the Spot price must be less than 20% of the current
              On-Demand price for that Amazon EC2 instance. You always pay the
              lowest  (market) price and never more than your maximum percent-
              age.

              When updating a compute environment, changing the bid percentage
              requires  an  infrastructure  update of the compute environment.
              For more information, see Updating compute environments  in  the
              Batch User Guide .

              NOTE:
                 This  parameter  isn't applicable to jobs that are running on
                 Fargate resources, and shouldn't be specified.

          launchTemplate -> (structure)
              The updated launch template to use for your  compute  resources.
              You  must  specify  either the launch template ID or launch tem-
              plate name in the request, but not both. For  more  information,
              see  Launch template support in the Batch User Guide . To remove
              the custom launch template and use the default launch  template,
              set  launchTemplateId or launchTemplateName member of the launch
              template specification to an empty string. Removing  the  launch
              template  from  a  compute  environment  will not remove the AMI
              specified in the launch template. In order  to  update  the  AMI
              specified  in  a launch template, the updateToLatestImageVersion
              parameter must be set to true .

              When updating a compute environment, changing  the  launch  tem-
              plate  requires an infrastructure update of the compute environ-
              ment. For more information, see Updating compute environments in
              the Batch User Guide .

              NOTE:
                 This  parameter  isn't applicable to jobs that are running on
                 Fargate resources, and shouldn't be specified.

              launchTemplateId -> (string)
                 The ID of the launch template.

              launchTemplateName -> (string)
                 The name of the launch template.

              version -> (string)
                 The version number of the launch template, $Latest , or  $De-
                 fault .

                 If  the  value  is $Latest , the latest version of the launch
                 template is used. If the value is $Default , the default ver-
                 sion of the launch template is used.

                 WARNING:
                     If  the  AMI  ID  that's used in a compute environment is
                     from the launch template, the AMI isn't changed when  the
                     compute  environment is updated. It's only changed if the
                     updateToLatestImageVersion parameter for the compute  en-
                     vironment  is  set to true . During an infrastructure up-
                     date, if either $Latest or $Default is  specified,  Batch
                     re-evaluates  the  launch  template version, and it might
                     use a different version of the launch template.  This  is
                     the  case  even if the launch template isn't specified in
                     the update. When updating a compute environment, changing
                     the  launch template requires an infrastructure update of
                     the  compute  environment.  For  more  information,   see
                     Updating compute environments in the Batch User Guide .

                 Default: $Default .

          ec2Configuration -> (list)
              Provides information used to select Amazon Machine Images (AMIs)
              for EC2 instances in the compute environment.  If  Ec2Configura-
              tion isn't specified, the default is ECS_AL2 .

              When  updating  a compute environment, changing this setting re-
              quires an infrastructure update of the compute environment.  For
              more information, see Updating compute environments in the Batch
              User Guide . To remove the EC2 configuration and any custom  AMI
              ID  specified  in  imageIdOverride  , set this value to an empty
              string.

              One or two values can be provided.

              NOTE:
                 This parameter isn't applicable to jobs that are  running  on
                 Fargate resources, and shouldn't be specified.

              (structure)
                 Provides  information  used  to  select Amazon Machine Images
                 (AMIs) for instances in the compute environment.  If  Ec2Con-
                 figuration  isn't  specified,  the default is ECS_AL2 (Amazon
                 Linux 2 ).

                 NOTE:
                     This object isn't applicable to jobs that are running  on
                     Fargate resources.

                 imageType -> (string)
                     The  image type to match with the instance type to select
                     an AMI. If the imageIdOverride parameter isn't specified,
                     then  a  recent  Amazon  ECS-optimized Amazon Linux 2 AMI
                     (ECS_AL2 ) is used. If a new image type is  specified  in
                     an  update,  but neither an imageId nor a imageIdOverride
                     parameter is specified, then the latest Amazon ECS  opti-
                     mized  AMI  for that image type that's supported by Batch
                     is used.
                            ECS_AL2

                        Amazon Linux 2  Default for all non-GPU instance fami-
                        lies.
                            ECS_AL2_NVIDIA

                        Amazon Linux 2 (GPU) Default for all GPU instance fam-
                        ilies (for example P4 and G4 ) and can be used for all
                        non Amazon Web Services Graviton-based instance types.
                            ECS_AL1

                        Amazon   Linux   .   Amazon   Linux  is  reaching  the
                        end-of-life of standard support. For more information,
                        see Amazon Linux AMI .

                 imageIdOverride -> (string)
                     The AMI ID used for instances launched in the compute en-
                     vironment that match the image type. This  setting  over-
                     rides the imageId set in the computeResource object.

                     NOTE:
                        The AMI that you choose for a compute environment must
                        match the architecture of the instance types that  you
                        intend  to use for that compute environment. For exam-
                        ple, if your  compute  environment  uses  A1  instance
                        types,  the  compute resource AMI that you choose must
                        support ARM instances. Amazon ECS vends both  x86  and
                        ARM  versions of the Amazon ECS-optimized Amazon Linux
                        2 AMI. For more information, see Amazon  ECS-optimized
                        Amazon  Linux  2  AMI  in the Amazon Elastic Container
                        Service Developer Guide .

          updateToLatestImageVersion -> (boolean)
              Specifies whether the AMI ID is updated to the latest one that's
              supported  by  Batch  when the compute environment has an infra-
              structure update. The default value is false .

              NOTE:
                 If an AMI ID is specified in the imageId  or  imageIdOverride
                 parameters  or  by  the  launch  template  specified  in  the
                 launchTemplate parameter, this parameter is ignored. For more
                 information  on updating AMI IDs during an infrastructure up-
                 date, see Updating the AMI ID in the Batch User Guide .

              When updating a compute environment, changing this  setting  re-
              quires  an infrastructure update of the compute environment. For
              more information, see Updating compute environments in the Batch
              User Guide .

          type -> (string)
              The  type of compute environment: EC2 , SPOT , FARGATE , or FAR-
              GATE_SPOT . For more information, see  Compute  environments  in
              the Batch User Guide .

              If  you  choose  SPOT , you must also specify an Amazon EC2 Spot
              Fleet role with the spotIamFleetRole parameter. For more  infor-
              mation, see Amazon EC2 spot fleet role in the Batch User Guide .

              When updating a compute environment, changing the type of a com-
              pute environment requires an infrastructure update of  the  com-
              pute environment. For more information, see Updating compute en-
              vironments in the Batch User Guide .

          imageId -> (string)
              The Amazon Machine Image (AMI) ID used for instances launched in
              the compute environment. This parameter is overridden by the im-
              ageIdOverride member of the Ec2Configuration structure.  To  re-
              move  the  custom  AMI  ID  and use the default AMI ID, set this
              value to an empty string.

              When updating a compute environment, changing  the  AMI  ID  re-
              quires  an infrastructure update of the compute environment. For
              more information, see Updating compute environments in the Batch
              User Guide .

              NOTE:
                 This  parameter  isn't applicable to jobs that are running on
                 Fargate resources, and shouldn't be specified.

              NOTE:
                 The AMI that you choose for a compute environment must  match
                 the architecture of the instance types that you intend to use
                 for that compute environment. For example,  if  your  compute
                 environment  uses A1 instance types, the compute resource AMI
                 that you choose must support ARM instances. Amazon ECS  vends
                 both  x86 and ARM versions of the Amazon ECS-optimized Amazon
                 Linux 2 AMI. For more information, see  Amazon  ECS-optimized
                 Amazon  Linux  2  AMI in the Amazon Elastic Container Service
                 Developer Guide .

       Shorthand Syntax:

          minvCpus=integer,maxvCpus=integer,desiredvCpus=integer,subnets=string,string,securityGroupIds=string,string,allocationStrategy=string,instanceTypes=string,string,ec2KeyPair=string,instanceRole=string,tags={KeyName1=string,KeyName2=string},placementGroup=string,bidPercentage=integer,launchTemplate={launchTemplateId=string,launchTemplateName=string,version=string},ec2Configuration=[{imageType=string,imageIdOverride=string},{imageType=string,imageIdOverride=string}],updateToLatestImageVersion=boolean,type=string,imageId=string

       JSON Syntax:

          {
            "minvCpus": integer,
            "maxvCpus": integer,
            "desiredvCpus": integer,
            "subnets": ["string", ...],
            "securityGroupIds": ["string", ...],
            "allocationStrategy": "BEST_FIT_PROGRESSIVE"|"SPOT_CAPACITY_OPTIMIZED",
            "instanceTypes": ["string", ...],
            "ec2KeyPair": "string",
            "instanceRole": "string",
            "tags": {"string": "string"
              ...},
            "placementGroup": "string",
            "bidPercentage": integer,
            "launchTemplate": {
              "launchTemplateId": "string",
              "launchTemplateName": "string",
              "version": "string"
            },
            "ec2Configuration": [
              {
                "imageType": "string",
                "imageIdOverride": "string"
              }
              ...
            ],
            "updateToLatestImageVersion": true|false,
            "type": "EC2"|"SPOT"|"FARGATE"|"FARGATE_SPOT",
            "imageId": "string"
          }

       --service-role (string)
          The full Amazon Resource Name (ARN) of  the  IAM  role  that  allows
          Batch  to  make  calls to other Amazon Web Services services on your
          behalf. For more information, see Batch  service  IAM  role  in  the
          Batch User Guide .

          WARNING:
              If  the  compute environment has a service-linked role, it can't
              be changed to use a regular IAM role. Likewise, if  the  compute
              environment has a regular IAM role, it can't be changed to use a
              service-linked role. To update the parameters  for  the  compute
              environment that require an infrastructure update to change, the
              AWSServiceRoleForBatch service-linked role  must  be  used.  For
              more information, see Updating compute environments in the Batch
              User Guide .

          If your specified role has a path other than / , then you  must  ei-
          ther specify the full role ARN (recommended) or prefix the role name
          with the path.

          NOTE:
              Depending on how you created your Batch service  role,  its  ARN
              might  contain the service-role path prefix. When you only spec-
              ify the name of the service role, Batch assumes  that  your  ARN
              doesn't  use  the  service-role path prefix. Because of this, we
              recommend that you specify the full ARN  of  your  service  role
              when you create compute environments.

       --update-policy (structure)
          Specifies  the  updated infrastructure update policy for the compute
          environment. For more information about infrastructure updates,  see
          Updating compute environments in the Batch User Guide .

          terminateJobsOnUpdate -> (boolean)
              Specifies  whether  jobs  are  automatically terminated when the
              computer environment  infrastructure  is  updated.  The  default
              value is false .

          jobExecutionTimeoutMinutes -> (long)
              Specifies the job timeout, in minutes, when the compute environ-
              ment infrastructure is updated. The default value is 30.

       Shorthand Syntax:

          terminateJobsOnUpdate=boolean,jobExecutionTimeoutMinutes=long

       JSON Syntax:

          {
            "terminateJobsOnUpdate": true|false,
            "jobExecutionTimeoutMinutes": long
          }

       --cli-input-json (string) Performs service operation based on the  JSON
       string  provided. The JSON string follows the format provided by --gen-
       erate-cli-skeleton. If other arguments  are  provided  on  the  command
       line,  the CLI values will override the JSON-provided values. It is not
       possible to pass arbitrary binary values using a JSON-provided value as
       the string will be taken literally.

       --generate-cli-skeleton  (string)  Prints  a  JSON skeleton to standard
       output without sending an API request. If provided with no value or the
       value input, prints a sample input JSON that can be used as an argument
       for --cli-input-json. If provided with the value output,  it  validates
       the command inputs and returns a sample output JSON for that command.

       See 'aws help' for descriptions of global parameters.

EXAMPLES
       NOTE:
          To  use  the following examples, you must have the AWS CLI installed
          and configured. See the Getting started guide in the  AWS  CLI  User
          Guide for more information.

          Unless  otherwise  stated,  all  examples  have  unix-like quotation
          rules. These examples will need to be  adapted  to  your  terminal's
          quoting rules. See Using quotation marks with strings in the AWS CLI
          User Guide .

       To update a compute environment

       This example disables the P2OnDemand compute environment so it  can  be
       deleted.

       Command:

          aws batch update-compute-environment --compute-environment P2OnDemand --state DISABLED

       Output:

          {
              "computeEnvironmentName": "P2OnDemand",
              "computeEnvironmentArn": "arn:aws:batch:us-east-1:012345678910:compute-environment/P2OnDemand"
          }

OUTPUT
       computeEnvironmentName -> (string)
          The  name  of  the  compute environment. It can be up to 128 letters
          long. It can contain uppercase and lowercase letters,  numbers,  hy-
          phens (-), and underscores (_).

       computeEnvironmentArn -> (string)
          The Amazon Resource Name (ARN) of the compute environment.



                                                  UPDATE-COMPUTE-ENVIRONMENT()
