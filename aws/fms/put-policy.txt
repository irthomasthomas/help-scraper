PUT-POLICY()                                                      PUT-POLICY()



NAME
       put-policy -

DESCRIPTION
       Creates an Firewall Manager policy.

       Firewall Manager provides the following types of policies:

       o An WAF policy (type WAFV2), which defines rule groups to run first in
         the corresponding WAF web ACL and rule groups to run last in the  web
         ACL.

       o An WAF Classic policy (type WAF), which defines a rule group.

       o A Shield Advanced policy, which applies Shield Advanced protection to
         specified accounts and resources.

       o A security group policy, which manages  VPC  security  groups  across
         your Amazon Web Services organization.

       o An  Network  Firewall policy, which provides firewall rules to filter
         network traffic in specified Amazon VPCs.

       o A DNS Firewall policy, which provides Route 53 Resolver DNS  Firewall
         rules to filter DNS queries for specified VPCs.

       Each  policy  is  specific  to one of the types. If you want to enforce
       more than one policy type across accounts,  create  multiple  policies.
       You can create multiple policies for each type.

       You  must  be subscribed to Shield Advanced to create a Shield Advanced
       policy. For more information about subscribing to Shield Advanced,  see
       CreateSubscription .

       See also: AWS API Documentation

SYNOPSIS
            put-policy
          --policy <value>
          [--tag-list <value>]
          [--cli-input-json <value>]
          [--generate-cli-skeleton <value>]
          [--debug]
          [--endpoint-url <value>]
          [--no-verify-ssl]
          [--no-paginate]
          [--output <value>]
          [--query <value>]
          [--profile <value>]
          [--region <value>]
          [--version <value>]
          [--color <value>]
          [--no-sign-request]
          [--ca-bundle <value>]
          [--cli-read-timeout <value>]
          [--cli-connect-timeout <value>]

OPTIONS
       --policy (structure)
          The details of the Firewall Manager policy to be created.

          PolicyId -> (string)
              The ID of the Firewall Manager policy.

          PolicyName -> (string)
              The name of the Firewall Manager policy.

          PolicyUpdateToken -> (string)
              A  unique identifier for each update to the policy. When issuing
              a PutPolicy request, the PolicyUpdateToken in the  request  must
              match  the  PolicyUpdateToken  of the current policy version. To
              get the PolicyUpdateToken of the current policy version,  use  a
              GetPolicy request.

          SecurityServicePolicyData -> (structure)
              Details about the security service that is being used to protect
              the resources.

              Type -> (string)
                 The service that the policy  is  using  to  protect  the  re-
                 sources.  This  specifies the type of policy that is created,
                 either an WAF policy, a Shield Advanced policy, or a security
                 group  policy.  For security group policies, Firewall Manager
                 supports one security group for each common  policy  and  for
                 each  content  audit policy. This is an adjustable limit that
                 you can increase by contacting Amazon Web Services Support.

              ManagedServiceData -> (string)
                 Details about the service that are specific  to  the  service
                 type, in JSON format.

                 o Example: DNS_FIREWALL    "{\"type\":\"DNS_FIREWALL\",\"pre-
                   ProcessRuleGroups\":[{\"rule-
                   GroupId\":\"rslvr-frg-1\",\"priority\":10}],\"postProcess-
                   RuleGroups\":[{\"ruleGroupId\":\"rslvr-frg-2\",\"prior-
                   ity\":9911}]}"

                 NOTE:
                     Valid  values  for preProcessRuleGroups are between 1 and
                     99. Valid values for  postProcessRuleGroups  are  between
                     9901 and 10000.

                 o Example:  NETWORK_FIREWALL  -  Centralized deployment model
                   "{\"type\":\"NETWORK_FIREWALL\",\"awsNetworkFirewallCon-
                   fig\":{\"networkFirewallStatelessRuleGroupRefer-
                   ences\":[{\"resourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateless-rule-
                   group/test\",\"priority\":1}],\"networkFirewallStatelessDe-
                   faultActions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessFragmentDefaultAc-
                   tions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessCustomActions\":[{\"ac-
                   tionName\":\"customActionName\",\"actionDefini-
                   tion\":{\"publishMetricAction\":{\"dimen-
                   sions\":[{\"value\":\"metricdimensionvalue\"}]}}}],\"net-
                   workFirewallStatefulRuleGroupReferences\":[{\"re-
                   sourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateful-rule-
                   group/test\"}],\"networkFirewallLoggingConfigura-
                   tion\":{\"logDestinationConfigs\":[{\"logDestination-
                   Type\":\"S3\",\"logType\":\"ALERT\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}},{\"logDestina-
                   tionType\":\"S3\",\"logType\":\"FLOW\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}}],\"overrideEx-
                   istingConfig\":true}},\"firewallDeploymentModel\":{\"cen-
                   tralizedFirewallDeploymentModel\":{\"centralizedFirewal-
                   lOrchestrationConfig\":{\"inspectionVpcIds\":[{\"resour-
                   ceId\":\"vpc-1234\",\"accoun-
                   tId\":\"123456789011\"}],\"firewallCreationConfig\":{\"end-
                   pointLocation\":{\"availabilityZoneConfigList\":[{\"avail-
                   abilityZoneId\":null,\"availabilityZone-
                   Name\":\"us-east-1a\",\"al-
                   lowedIPV4CidrList\":[\"10.0.0.0/28\"]}]}},\"al-
                   lowedIPV4CidrList\":[]}}}}"   To use  the  centralized  de-
                   ployment model, you must set PolicyOption to CENTRALIZED .

                 o Example:  NETWORK_FIREWALL  -  Distributed deployment model
                   with    automatic    Availability    Zone     configuration
                   "{\"type\":\"NETWORK_FIREWALL\",\"networkFirewallStateless-
                   RuleGroupReferences\":[{\"resourceARN\":\"arn:aws:net-
                   work-firewall:us-east-1:123456789011:stateless-rule-
                   group/test\",\"priority\":1}],\"networkFirewallStatelessDe-
                   faultActions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessFragmentDefaultAc-
                   tions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessCustomActions\":[{\"ac-
                   tionName\":\"customActionName\",\"actionDefini-
                   tion\":{\"publishMetricAction\":{\"dimen-
                   sions\":[{\"value\":\"metricdimensionvalue\"}]}}}],\"net-
                   workFirewallStatefulRuleGroupReferences\":[{\"re-
                   sourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateful-rule-
                   group/test\"}],\"networkFirewallOrchestrationCon-
                   fig\":{\"singleFirewallEndpointPerVPC\":false,\"al-
                   lowedIPV4CidrList\":[\"10.0.0.0/28\",\"192.168.0.0/28\"],\"route-
                   ManagementAction\":\"OFF\"},\"networkFirewallLoggingConfig-
                   uration\":{\"logDestinationConfigs\":[{\"logDestination-
                   Type\":\"S3\",\"logType\":\"ALERT\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}},{\"logDestina-
                   tionType\":\"S3\",\"logType\":\"FLOW\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}}],\"overrideEx-
                   istingConfig\":true}}"   With  automatic  Availbility  Zone
                   configuration,  Firewall Manager chooses which Availability
                   Zones to create the endpoints in. To  use  the  distributed
                   deployment model, you must set PolicyOption to NULL .

                 o Example:  NETWORK_FIREWALL  -  Distributed deployment model
                   with automatic Availability Zone  configuration  and  route
                   management   "{\"type\":\"NETWORK_FIREWALL\",\"networkFire-
                   wallStatelessRuleGroupReferences\":[{\"re-
                   sourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateless-rule-
                   group/test\",\"priority\":1}],\"networkFirewallStatelessDe-
                   faultActions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessFragmentDefaultAc-
                   tions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessCustomActions\":[{\"ac-
                   tionName\":\"customActionName\",\"actionDefini-
                   tion\":{\"publishMetricAction\":{\"dimen-
                   sions\":[{\"value\":\"metricdimensionvalue\"}]}}}],\"net-
                   workFirewallStatefulRuleGroupReferences\":[{\"re-
                   sourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateful-rule-
                   group/test\"}],\"networkFirewallOrchestrationCon-
                   fig\":{\"singleFirewallEndpointPerVPC\":false,\"al-
                   lowedIPV4CidrList\":[\"10.0.0.0/28\",\"192.168.0.0/28\"],\"route-
                   ManagementAction\":\"MONITOR\",\"routeManagementTarget-
                   Types\":[\"InternetGateway\"]},\"networkFirewallLoggingCon-
                   figuration\":{\"logDestinationConfigs\":[{\"logDestination-
                   Type\":\"S3\",\"logType\":\"ALERT\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}},{\"logDestina-
                   tionType\":\"S3\",\"logType\":       \"FLOW\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}}],\"overrideEx-
                   istingConfig\":true}}"   To use the distributed  deployment
                   model, you must set PolicyOption to NULL .

                 o Example:  NETWORK_FIREWALL  -  Distributed deployment model
                   with     custom     Availability     Zone     configuration
                   "{\"type\":\"NETWORK_FIREWALL\",\"networkFirewallStateless-
                   RuleGroupReferences\":[{\"resourceARN\":\"arn:aws:net-
                   work-firewall:us-east-1:123456789011:stateless-rule-
                   group/test\",\"priority\":1}],\"networkFirewallStatelessDe-
                   faultActions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessFragmentDefaultAc-
                   tions\":[\"aws:forward_to_sfe\",\"fragmentcustomaction-
                   name\"],\"networkFirewallStatelessCustomActions\":[{\"ac-
                   tionName\":\"customActionName\",            \"actionDefini-
                   tion\":{\"publishMetricAction\":{\"dimen-
                   sions\":[{\"value\":\"metricdimensionvalue\"}]}}},{\"ac-
                   tionName\":\"fragmentcustomactionname\",\"actionDefini-
                   tion\":{\"publishMetricAction\":{\"dimen-
                   sions\":[{\"value\":\"fragmentmetricdimensionva-
                   lue\"}]}}}],\"networkFirewallStatefulRuleGroupRefer-
                   ences\":[{\"resourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateful-rule-
                   group/test\"}],\"networkFirewallOrchestrationCon-
                   fig\":{\"firewallCreationConfig\":{         \"endpointLoca-
                   tion\":{\"availabilityZoneConfigList\":[{\"availabilityZo-
                   neName\":\"us-east-1a\",\"al-
                   lowedIPV4CidrList\":[\"10.0.0.0/28\"]},{\"availabilityZone-
                   Name\":\"us-east-1b\",\"allowedIPV4CidrList\":[
                   \"10.0.0.0/28\"]}]}          },\"singleFirewallEndpointPer-
                   VPC\":false,\"allowedIPV4CidrList\":null,\"routeManagemen-
                   tAction\":\"OFF\",\"networkFirewallLoggingConfigura-
                   tion\":{\"logDestinationConfigs\":[{\"logDestination-
                   Type\":\"S3\",\"logType\":\"ALERT\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}},{\"logDestina-
                   tionType\":\"S3\",\"logType\":\"FLOW\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}}],\"overrideEx-
                   istingConfig\":boolean}}"   With custom  Availability  Zone
                   configuration, you define which specific Availability Zones
                   to create endpoints in by configuring  firewallCreationCon-
                   fig  .  To configure the Availability Zones in firewallCre-
                   ationConfig , specify either  the  availabilityZoneName  or
                   availabilityZoneId  parameter, not both parameters.  To use
                   the distributed deployment model, you must set PolicyOption
                   to NULL .

                 o Example:  NETWORK_FIREWALL  -  Distributed deployment model
                   with custom Availability Zone configuration and route  man-
                   agement  "{\"type\":\"NETWORK_FIREWALL\",\"networkFirewall-
                   StatelessRuleGroupReferences\":[{\"re-
                   sourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateless-rule-
                   group/test\",\"priority\":1}],\"networkFirewallStatelessDe-
                   faultActions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessFragmentDefaultAc-
                   tions\":[\"aws:forward_to_sfe\",\"fragmentcustomaction-
                   name\"],\"networkFirewallStatelessCustomActions\":[{\"ac-
                   tionName\":\"customActionName\",\"actionDefini-
                   tion\":{\"publishMetricAction\":{\"dimen-
                   sions\":[{\"value\":\"metricdimensionvalue\"}]}}},{\"ac-
                   tionName\":\"fragmentcustomactionname\",\"actionDefini-
                   tion\":{\"publishMetricAction\":{\"dimen-
                   sions\":[{\"value\":\"fragmentmetricdimensionva-
                   lue\"}]}}}],\"networkFirewallStatefulRuleGroupRefer-
                   ences\":[{\"resourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateful-rule-
                   group/test\"}],\"networkFirewallOrchestrationCon-
                   fig\":{\"firewallCreationConfig\":{\"endpointLoca-
                   tion\":{\"availabilityZoneConfigList\":[{\"availabilityZo-
                   neName\":\"us-east-1a\",\"al-
                   lowedIPV4CidrList\":[\"10.0.0.0/28\"]},{\"availabilityZone-
                   Name\":\"us-east-1b\",\"al-
                   lowedIPV4CidrList\":[\"10.0.0.0/28\"]}]}},\"singleFirewal-
                   lEndpointPerVPC\":false,\"al-
                   lowedIPV4CidrList\":null,\"routeManagementAction\":\"MONI-
                   TOR\",\"routeManagementTargetTypes\":[\"InternetGate-
                   way\"],\"routeManagementConfig\":{\"allowCrossAZTrafficIf-
                   NoEndpoint\":true}},\"networkFirewallLoggingConfigura-
                   tion\":{\"logDestinationConfigs\":[{\"logDestination-
                   Type\":\"S3\",\"logType\":\"ALERT\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}},{\"logDestina-
                   tionType\":\"S3\",\"logType\":\"FLOW\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}}],\"overrideEx-
                   istingConfig\":boolean}}"   To use the distributed  deploy-
                   ment model, you must set PolicyOption to NULL .

                 o Example:             THIRD_PARTY_FIREWALL                "{
                   "type":"THIRD_PARTY_FIREWALL",             "thirdPartyFire-
                   wall":"PALO_ALTO_NETWORKS_CLOUD_NGFW", "thirdPartyFirewall-
                   Config":{  "thirdPartyFirewallPolicyList":["global-1"]   },
                   "firewallDeploymentModel":{ "distributedFirewallDeployment-
                   Model":{ "distributedFirewallOrchestrationConfig":{  "fire-
                   wallCreationConfig":{  "endpointLocation":{  "availability-
                   ZoneConfigList":[ { "availabilityZoneName":"${Availability-
                   Zone}" } ] } }, "allowedIPV4CidrList":[ ] } } } }"

                 o Example:    SECURITY_GROUPS_COMMON       "{\"type\":\"SECU-
                   RITY_GROUPS_COMMON\",\"revertManualSecurity-
                   GroupChanges\":false,\"exclusiveResourceSecurityGroupMan-
                   agement\":false,  \"applyToAllEC2InstanceENIs\":false,\"se-
                   curityGroups\":[{\"id\":\" sg-000e55995d61a06bd\"}]}"

                 o Example:  SECURITY_GROUPS_COMMON  - Security group tag dis-
                   tribution    ""{\"type\":\"SECURITY_GROUPS_COMMON\",\"secu-
                   rityGroups\":[{\"id\":\"sg-000e55995d61a06bd\"}],\"revert-
                   ManualSecurityGroupChanges\":true,\"exclusiveResourceSecu-
                   rityGroupManagement\":false,\"applyToAllEC2InstanceE-
                   NIs\":false,\"includeSharedVPC\":false,\"enableTagDistribu-
                   tion\":true}""   Firewall Manager automatically distributes
                   tags from the primary group to the security groups  created
                   by this policy. To use security group tag distribution, you
                   must also set revertManualSecurityGroupChanges  to  true  ,
                   otherwise Firewall Manager won't be able to create the pol-
                   icy. When  you  enable  revertManualSecurityGroupChanges  ,
                   Firewall  Manager  identifies and reports when the security
                   groups created by this policy become non-compliant.   Fire-
                   wall  Manager  won't distrubute system tags added by Amazon
                   Web Services services into  the  replica  security  groups.
                   System tags begin with the aws: prefix.

                 o Example:  Shared  VPCs.  Apply  the preceding policy to re-
                   sources in shared VPCs as well as to those in VPCs that the
                   account  owns   "{\"type\":\"SECURITY_GROUPS_COMMON\",\"re-
                   vertManualSecurityGroupChanges\":false,\"exclusiveRe-
                   sourceSecurityGroupManagement\":false,   \"applyToAllEC2In-
                   stanceENIs\":false,\"includeSharedVPC\":true,\"security-
                   Groups\":[{\"id\":\" sg-000e55995d61a06bd\"}]}"

                 o Example:  SECURITY_GROUPS_CONTENT_AUDIT    "{\"type\":\"SE-
                   CURITY_GROUPS_CONTENT_AUDIT\",\"security-
                   Groups\":[{\"id\":\"sg-000e55995d61a06bd\"}],\"security-
                   GroupAction\":{\"type\":\"ALLOW\"}}"   The  security  group
                   action for content audit can be ALLOW or DENY . For ALLOW ,
                   all in-scope security group rules must be  within  the  al-
                   lowed  range of the policy's security group rules. For DENY
                   , all in-scope security group  rules  must  not  contain  a
                   value  or a range that matches a rule value or range in the
                   policy security group.

                 o Example: SECURITY_GROUPS_USAGE_AUDIT     "{\"type\":\"SECU-
                   RITY_GROUPS_USAGE_AUDIT\",\"deleteUnusedSecurity-
                   Groups\":true,\"coalesceRedundantSecurityGroups\":true}"

                 o Specification for  SHIELD_ADVANCED  for  Amazon  CloudFront
                   distributions    "{\"type\":\"SHIELD_ADVANCED\",\"automati-
                   cResponseConfiguration\":          {\"automaticResponseSta-
                   tus\":\"ENABLED|IGNORED|DISABLED\",  \"automaticResponseAc-
                   tion\":\"BLOCK|COUNT\"},      \"overrideCustomerWebaclClas-
                   sic\":true|false}"    For  example: "{\"type\":\"SHIELD_AD-
                   VANCED\",\"automaticResponseConfiguration\":   {\"automati-
                   cResponseStatus\":\"ENABLED\",       \"automaticResponseAc-
                   tion\":\"COUNT\"}}"   The default  value  for  automaticRe-
                   sponseStatus  is  IGNORED  . The value for automaticRespon-
                   seAction is only required when  automaticResponseStatus  is
                   set  to ENABLED . The default value for overrideCustomerWe-
                   baclClassic is false . For other resource  types  that  you
                   can protect with a Shield Advanced policy, this ManagedSer-
                   viceData configuration is an empty string.

                 o Example:  WAFV2      "{\"type\":\"WAFV2\",\"preProcessRule-
                   Groups\":[{\"ruleGroupArn\":null,\"overrideAc-
                   tion\":{\"type\":\"NONE\"},\"managedRuleGroupIdenti-
                   fier\":{\"version\":null,\"vendorName\":\"AWS\",\"manage-
                   dRuleGroupName\":\"AWSManagedRulesAmazonIpReputation-
                   List\"},\"ruleGroupType\":\"ManagedRuleGroup\",\"ex-
                   cludeRules\":[{\"name\":\"NoUserAgent_HEADER\"}]}],\"post-
                   ProcessRuleGroups\":[],\"defaultAction\":{\"type\":\"AL-
                   LOW\"},\"overrideCustomerWebACLAssociation\":false,\"log-
                   gingConfiguration\":{\"logDestinationCon-
                   figs\":[\"arn:aws:firehose:us-west-2:12345678912:deliverys-
                   tream/aws-waf-logs-fms-admin-destination\"],\"redacted-
                   Fields\":[{\"redactedFieldType\":\"SingleHeader\",\"redact-
                   edFieldValue\":\"Cookies\"},{\"redactedField-
                   Type\":\"Method\"}]}}"   In the loggingConfiguration ,  you
                   can  specify one logDestinationConfigs , you can optionally
                   provide up to 20 redactedFields , and the RedactedFieldType
                   must be one of URI , QUERY_STRING , HEADER , or METHOD .

                 o Example:  WAFV2  - Firewall Manager support for WAF managed
                   rule group versioning    "{\"type\":\"WAFV2\",\"preProcess-
                   RuleGroups\":[{\"ruleGroupArn\":null,\"overrideAc-
                   tion\":{\"type\":\"NONE\"},\"managedRuleGroupIdenti-
                   fier\":{\"versionEnabled\":true,\"version\":\"Ver-
                   sion_2.0\",\"vendorName\":\"AWS\",\"managedRuleGroup-
                   Name\":\"AWSManagedRulesCommonRuleSet\"},\"ruleGroup-
                   Type\":\"ManagedRuleGroup\",\"ex-
                   cludeRules\":[{\"name\":\"NoUserAgent_HEADER\"}]}],\"post-
                   ProcessRuleGroups\":[],\"defaultAction\":{\"type\":\"AL-
                   LOW\"},\"overrideCustomerWebACLAssociation\":false,\"log-
                   gingConfiguration\":{\"logDestinationCon-
                   figs\":[\"arn:aws:firehose:us-west-2:12345678912:deliverys-
                   tream/aws-waf-logs-fms-admin-destination\"],\"redacted-
                   Fields\":[{\"redactedFieldType\":\"SingleHeader\",\"redact-
                   edFieldValue\":\"Cookies\"},{\"redactedField-
                   Type\":\"Method\"}]}}"   To use a specific version of a WAF
                   managed rule group in your  Firewall  Manager  policy,  you
                   must  set  versionEnabled  to true , and set version to the
                   version you'd like to use. If you don't set  versionEnabled
                   to  true  ,  or  if you omit versionEnabled , then Firewall
                   Manager uses the default version of the  WAF  managed  rule
                   group.

                 o Example:   WAF   Classic     "{\"type\":  \"WAF\",  \"rule-
                   Groups\":
                   [{\"id\":\"12345678-1bcd-9012-efga-0987654321ab\",  \"over-
                   rideAction\" : {\"type\": \"COUNT\"}}],  \"defaultAction\":
                   {\"type\": \"BLOCK\"}}"

              PolicyOption -> (structure)
                 Contains the Network Firewall firewall policy options to con-
                 figure a centralized deployment model.

                 NetworkFirewallPolicy -> (structure)
                     Defines the deployment model to use for the firewall pol-
                     icy.

                     FirewallDeploymentModel -> (string)
                        Defines  the  deployment model to use for the firewall
                        policy. To use a distributed model,  set  PolicyOption
                        to NULL .

                 ThirdPartyFirewallPolicy -> (structure)
                     Defines  the  policy  options  for a third-party firewall
                     policy.

                     FirewallDeploymentModel -> (string)
                        Defines  the  deployment  model   to   use   for   the
                        third-party firewall policy.

          ResourceType -> (string)
              The  type  of  resource  protected by or in scope of the policy.
              This is in the format shown in the Amazon Web Services  Resource
              Types  Reference  .  To  apply  this policy to multiple resource
              types, specify a resource  type  of  ResourceTypeList  and  then
              specify the resource types in a ResourceTypeList .

              For WAF and Shield Advanced, resource types include AWS::Elasti-
              cLoadBalancingV2::LoadBalancer     ,     AWS::ElasticLoadBalanc-
              ing::LoadBalancer , AWS::EC2::EIP , and AWS::CloudFront::Distri-
              bution . For a security group common policy,  valid  values  are
              AWS::EC2::NetworkInterface  and AWS::EC2::Instance . For a secu-
              rity group content audit policy, valid values are  AWS::EC2::Se-
              curityGroup  ,  AWS::EC2::NetworkInterface  ,  and AWS::EC2::In-
              stance . For a security group usage audit policy, the  value  is
              AWS::EC2::SecurityGroup  . For an Network Firewall policy or DNS
              Firewall policy, the value is AWS::EC2::VPC .

          ResourceTypeList -> (list)
              An array of ResourceType objects. Use this only to specify  mul-
              tiple resource types. To specify a single resource type, use Re-
              sourceType .

              (string)

          ResourceTags -> (list)
              An array of ResourceTag objects.

              (structure)
                 The resource tags that Firewall Manager uses to determine  if
                 a particular resource should be included or excluded from the
                 Firewall Manager policy. Tags enable you to  categorize  your
                 Amazon Web Services resources in different ways, for example,
                 by purpose, owner, or environment. Each tag consists of a key
                 and  an  optional  value.  Firewall Manager combines the tags
                 with "AND" so that, if you add more than one tag to a  policy
                 scope,  a resource must have all the specified tags to be in-
                 cluded or excluded. For more information,  see  Working  with
                 Tag Editor .

                 Key -> (string)
                     The resource tag key.

                 Value -> (string)
                     The resource tag value.

          ExcludeResourceTags -> (boolean)
              If  set  to True , resources with the tags that are specified in
              the ResourceTag array are not in scope of the policy. If set  to
              False  ,  and  the ResourceTag array is not null, only resources
              with the specified tags are in scope of the policy.

          RemediationEnabled -> (boolean)
              Indicates if the policy should be automatically applied  to  new
              resources.

          DeleteUnusedFMManagedResources -> (boolean)
              Indicates  whether  Firewall Manager should automatically remove
              protections from resources that leave the policy scope and clean
              up resources that Firewall Manager is managing for accounts when
              those accounts leave policy scope. For example, Firewall Manager
              will disassociate a Firewall Manager managed web ACL from a pro-
              tected customer resource when the customer resource leaves  pol-
              icy scope.

              By  default,  Firewall  Manager  doesn't  remove  protections or
              delete Firewall Manager managed resources.

              This option is not available for Shield Advanced or WAF  Classic
              policies.

          IncludeMap -> (map)
              Specifies  the Amazon Web Services account IDs and Organizations
              organizational units (OUs) to include in the policy.  Specifying
              an OU is the equivalent of specifying all accounts in the OU and
              in any of its child OUs, including any child  OUs  and  accounts
              that are added at a later time.

              You  can  specify inclusions or exclusions, but not both. If you
              specify an IncludeMap , Firewall Manager applies the  policy  to
              all accounts specified by the IncludeMap , and does not evaluate
              any ExcludeMap specifications. If you  do  not  specify  an  In-
              cludeMap  ,  then Firewall Manager applies the policy to all ac-
              counts except for those specified by the ExcludeMap .

              You can specify account IDs, OUs, or a combination:

              o Specify account IDs by setting the key to ACCOUNT . For  exam-
                ple, the following is a valid map: {ACCOUNT : [accountID1, ac-
                countID2]} .

              o Specify OUs by setting the key to ORG_UNIT . For example,  the
                following is a valid map: {ORG_UNIT : [ouid111, ouid112]} .

              o Specify  accounts  and OUs together in a single map, separated
                with a comma. For example, the following is a valid map:  {AC-
                COUNT   :   [accountID1,  accountID2],  ORG_UNIT  :  [ouid111,
                ouid112]} .

              key -> (string)

              value -> (list)
                 (string)

          ExcludeMap -> (map)
              Specifies the Amazon Web Services account IDs and  Organizations
              organizational  units (OUs) to exclude from the policy. Specify-
              ing an OU is the equivalent of specifying all accounts in the OU
              and  in  any  of  its child OUs, including any child OUs and ac-
              counts that are added at a later time.

              You can specify inclusions or exclusions, but not both.  If  you
              specify  an  IncludeMap , Firewall Manager applies the policy to
              all accounts specified by the IncludeMap , and does not evaluate
              any  ExcludeMap  specifications.  If  you  do not specify an In-
              cludeMap , then Firewall Manager applies the policy to  all  ac-
              counts except for those specified by the ExcludeMap .

              You can specify account IDs, OUs, or a combination:

              o Specify  account IDs by setting the key to ACCOUNT . For exam-
                ple, the following is a valid map: {ACCOUNT : [accountID1, ac-
                countID2]} .

              o Specify  OUs by setting the key to ORG_UNIT . For example, the
                following is a valid map: {ORG_UNIT : [ouid111, ouid112]} .

              o Specify accounts and OUs together in a single  map,  separated
                with  a comma. For example, the following is a valid map: {AC-
                COUNT  :  [accountID1,  accountID2],  ORG_UNIT   :   [ouid111,
                ouid112]} .

              key -> (string)

              value -> (list)
                 (string)

          ResourceSetIds -> (list)
              The unique identifiers of the resource sets used by the policy.

              (string)

          PolicyDescription -> (string)
              The definition of the Network Firewall firewall policy.

       JSON Syntax:

          {
            "PolicyId": "string",
            "PolicyName": "string",
            "PolicyUpdateToken": "string",
            "SecurityServicePolicyData": {
              "Type": "WAF"|"WAFV2"|"SHIELD_ADVANCED"|"SECURITY_GROUPS_COMMON"|"SECURITY_GROUPS_CONTENT_AUDIT"|"SECURITY_GROUPS_USAGE_AUDIT"|"NETWORK_FIREWALL"|"DNS_FIREWALL"|"THIRD_PARTY_FIREWALL"|"IMPORT_NETWORK_FIREWALL",
              "ManagedServiceData": "string",
              "PolicyOption": {
                "NetworkFirewallPolicy": {
                  "FirewallDeploymentModel": "CENTRALIZED"|"DISTRIBUTED"
                },
                "ThirdPartyFirewallPolicy": {
                  "FirewallDeploymentModel": "CENTRALIZED"|"DISTRIBUTED"
                }
              }
            },
            "ResourceType": "string",
            "ResourceTypeList": ["string", ...],
            "ResourceTags": [
              {
                "Key": "string",
                "Value": "string"
              }
              ...
            ],
            "ExcludeResourceTags": true|false,
            "RemediationEnabled": true|false,
            "DeleteUnusedFMManagedResources": true|false,
            "IncludeMap": {"ACCOUNT"|"ORG_UNIT": ["string", ...]
              ...},
            "ExcludeMap": {"ACCOUNT"|"ORG_UNIT": ["string", ...]
              ...},
            "ResourceSetIds": ["string", ...],
            "PolicyDescription": "string"
          }

       --tag-list (list)
          The tags to add to the Amazon Web Services resource.

          (structure)
              A  collection  of  key:value pairs associated with an Amazon Web
              Services resource. The key:value pair can be  anything  you  de-
              fine. Typically, the tag key represents a category (such as "en-
              vironment") and the tag value represents a specific value within
              that  category (such as "test," "development," or "production").
              You can add up to 50 tags to each Amazon Web Services resource.

              Key -> (string)
                 Part of the key:value pair that defines a tag. You can use  a
                 tag  key to describe a category of information, such as "cus-
                 tomer." Tag keys are case-sensitive.

              Value -> (string)
                 Part of the key:value pair that defines a tag. You can use  a
                 tag  value  to  describe  a specific value within a category,
                 such as "companyA" or "companyB." Tag values are  case-sensi-
                 tive.

       Shorthand Syntax:

          Key=string,Value=string ...

       JSON Syntax:

          [
            {
              "Key": "string",
              "Value": "string"
            }
            ...
          ]

       --cli-input-json  (string) Performs service operation based on the JSON
       string provided. The JSON string follows the format provided by  --gen-
       erate-cli-skeleton.  If  other  arguments  are  provided on the command
       line, the CLI values will override the JSON-provided values. It is  not
       possible to pass arbitrary binary values using a JSON-provided value as
       the string will be taken literally.

       --generate-cli-skeleton (string) Prints a  JSON  skeleton  to  standard
       output without sending an API request. If provided with no value or the
       value input, prints a sample input JSON that can be used as an argument
       for  --cli-input-json.  If provided with the value output, it validates
       the command inputs and returns a sample output JSON for that command.

GLOBAL OPTIONS
       --debug (boolean)

       Turn on debug logging.

       --endpoint-url (string)

       Override command's default URL with the given URL.

       --no-verify-ssl (boolean)

       By default, the AWS CLI uses SSL when communicating with AWS  services.
       For each SSL connection, the AWS CLI will verify SSL certificates. This
       option overrides the default behavior of verifying SSL certificates.

       --no-paginate (boolean)

       Disable automatic pagination.

       --output (string)

       The formatting style for command output.

       o json

       o text

       o table

       --query (string)

       A JMESPath query to use in filtering the response data.

       --profile (string)

       Use a specific profile from your credential file.

       --region (string)

       The region to use. Overrides config/env settings.

       --version (string)

       Display the version of this tool.

       --color (string)

       Turn on/off color output.

       o on

       o off

       o auto

       --no-sign-request (boolean)

       Do not sign requests. Credentials will not be loaded if  this  argument
       is provided.

       --ca-bundle (string)

       The CA certificate bundle to use when verifying SSL certificates. Over-
       rides config/env settings.

       --cli-read-timeout (int)

       The maximum socket read time in seconds. If the value is set to 0,  the
       socket  read  will be blocking and not timeout. The default value is 60
       seconds.

       --cli-connect-timeout (int)

       The maximum socket connect time in seconds. If the value is set  to  0,
       the  socket connect will be blocking and not timeout. The default value
       is 60 seconds.

EXAMPLES
       NOTE:
          To use the following examples, you must have the AWS  CLI  installed
          and  configured.  See  the Getting started guide in the AWS CLI User
          Guide for more information.

          Unless otherwise  stated,  all  examples  have  unix-like  quotation
          rules.  These  examples  will  need to be adapted to your terminal's
          quoting rules. See Using quotation marks with strings in the AWS CLI
          User Guide .

       To create a Firewall Manager policy

       The  following  put-policy  example creates a Firewall Manager security
       group policy.

          aws fms put-policy \
              --cli-input-json file://policy.json

       Contents of policy.json:

          {
              "Policy": {
                  "PolicyName": "test",
                  "SecurityServicePolicyData": {
                      "Type": "SECURITY_GROUPS_USAGE_AUDIT",
                      "ManagedServiceData": "{\"type\":\"SECURITY_GROUPS_USAGE_AUDIT\",\"deleteUnusedSecurityGroups\":false,\"coalesceRedundantSecurityGroups\":true}"
                  },
                  "ResourceType": "AWS::EC2::SecurityGroup",
                  "ResourceTags": [],
                  "ExcludeResourceTags": false,
                  "RemediationEnabled": false
              },
              "TagList": [
                  {
                      "Key": "foo",
                      "Value": "foo"
                  }
              ]
          }

       Output:

          {
              "Policy": {
                  "PolicyId": "a1b2c3d4-5678-90ab-cdef-EXAMPLE11111",
                  "PolicyName": "test",
                  "PolicyUpdateToken": "1:X9QGexP7HASDlsFp+G31Iw==",
                  "SecurityServicePolicyData": {
                      "Type": "SECURITY_GROUPS_USAGE_AUDIT",
                      "ManagedServiceData": "{\"type\":\"SECURITY_GROUPS_USAGE_AUDIT\",\"deleteUnusedSecurityGroups\":false,\"coalesceRedundantSecurityGroups\":true,\"optionalDelayForUnusedInMinutes\":null}"
                  },
                  "ResourceType": "AWS::EC2::SecurityGroup",
                  "ResourceTags": [],
                  "ExcludeResourceTags": false,
                  "RemediationEnabled": false
              },
              "PolicyArn": "arn:aws:fms:us-west-2:123456789012:policy/a1b2c3d4-5678-90ab-cdef-EXAMPLE11111"
          }

       For more information, see Working with AWS Firewall Manager Policies in
       the  AWS  WAF,  AWS Firewall Manager, and AWS Shield Advanced Developer
       Guide.

OUTPUT
       Policy -> (structure)
          The details of the Firewall Manager policy.

          PolicyId -> (string)
              The ID of the Firewall Manager policy.

          PolicyName -> (string)
              The name of the Firewall Manager policy.

          PolicyUpdateToken -> (string)
              A unique identifier for each update to the policy. When  issuing
              a  PutPolicy  request, the PolicyUpdateToken in the request must
              match the PolicyUpdateToken of the current  policy  version.  To
              get  the  PolicyUpdateToken of the current policy version, use a
              GetPolicy request.

          SecurityServicePolicyData -> (structure)
              Details about the security service that is being used to protect
              the resources.

              Type -> (string)
                 The  service  that  the  policy  is  using to protect the re-
                 sources. This specifies the type of policy that  is  created,
                 either an WAF policy, a Shield Advanced policy, or a security
                 group policy. For security group policies,  Firewall  Manager
                 supports  one  security  group for each common policy and for
                 each content audit policy. This is an adjustable  limit  that
                 you can increase by contacting Amazon Web Services Support.

              ManagedServiceData -> (string)
                 Details  about  the  service that are specific to the service
                 type, in JSON format.

                 o Example: DNS_FIREWALL    "{\"type\":\"DNS_FIREWALL\",\"pre-
                   ProcessRuleGroups\":[{\"rule-
                   GroupId\":\"rslvr-frg-1\",\"priority\":10}],\"postProcess-
                   RuleGroups\":[{\"ruleGroupId\":\"rslvr-frg-2\",\"prior-
                   ity\":9911}]}"

                 NOTE:
                     Valid values for preProcessRuleGroups are between  1  and
                     99.  Valid  values  for postProcessRuleGroups are between
                     9901 and 10000.

                 o Example: NETWORK_FIREWALL -  Centralized  deployment  model
                   "{\"type\":\"NETWORK_FIREWALL\",\"awsNetworkFirewallCon-
                   fig\":{\"networkFirewallStatelessRuleGroupRefer-
                   ences\":[{\"resourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateless-rule-
                   group/test\",\"priority\":1}],\"networkFirewallStatelessDe-
                   faultActions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessFragmentDefaultAc-
                   tions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessCustomActions\":[{\"ac-
                   tionName\":\"customActionName\",\"actionDefini-
                   tion\":{\"publishMetricAction\":{\"dimen-
                   sions\":[{\"value\":\"metricdimensionvalue\"}]}}}],\"net-
                   workFirewallStatefulRuleGroupReferences\":[{\"re-
                   sourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateful-rule-
                   group/test\"}],\"networkFirewallLoggingConfigura-
                   tion\":{\"logDestinationConfigs\":[{\"logDestination-
                   Type\":\"S3\",\"logType\":\"ALERT\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}},{\"logDestina-
                   tionType\":\"S3\",\"logType\":\"FLOW\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}}],\"overrideEx-
                   istingConfig\":true}},\"firewallDeploymentModel\":{\"cen-
                   tralizedFirewallDeploymentModel\":{\"centralizedFirewal-
                   lOrchestrationConfig\":{\"inspectionVpcIds\":[{\"resour-
                   ceId\":\"vpc-1234\",\"accoun-
                   tId\":\"123456789011\"}],\"firewallCreationConfig\":{\"end-
                   pointLocation\":{\"availabilityZoneConfigList\":[{\"avail-
                   abilityZoneId\":null,\"availabilityZone-
                   Name\":\"us-east-1a\",\"al-
                   lowedIPV4CidrList\":[\"10.0.0.0/28\"]}]}},\"al-
                   lowedIPV4CidrList\":[]}}}}"    To  use  the centralized de-
                   ployment model, you must set PolicyOption to CENTRALIZED .

                 o Example: NETWORK_FIREWALL -  Distributed  deployment  model
                   with     automatic    Availability    Zone    configuration
                   "{\"type\":\"NETWORK_FIREWALL\",\"networkFirewallStateless-
                   RuleGroupReferences\":[{\"resourceARN\":\"arn:aws:net-
                   work-firewall:us-east-1:123456789011:stateless-rule-
                   group/test\",\"priority\":1}],\"networkFirewallStatelessDe-
                   faultActions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessFragmentDefaultAc-
                   tions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessCustomActions\":[{\"ac-
                   tionName\":\"customActionName\",\"actionDefini-
                   tion\":{\"publishMetricAction\":{\"dimen-
                   sions\":[{\"value\":\"metricdimensionvalue\"}]}}}],\"net-
                   workFirewallStatefulRuleGroupReferences\":[{\"re-
                   sourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateful-rule-
                   group/test\"}],\"networkFirewallOrchestrationCon-
                   fig\":{\"singleFirewallEndpointPerVPC\":false,\"al-
                   lowedIPV4CidrList\":[\"10.0.0.0/28\",\"192.168.0.0/28\"],\"route-
                   ManagementAction\":\"OFF\"},\"networkFirewallLoggingConfig-
                   uration\":{\"logDestinationConfigs\":[{\"logDestination-
                   Type\":\"S3\",\"logType\":\"ALERT\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}},{\"logDestina-
                   tionType\":\"S3\",\"logType\":\"FLOW\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}}],\"overrideEx-
                   istingConfig\":true}}"    With  automatic  Availbility Zone
                   configuration, Firewall Manager chooses which  Availability
                   Zones  to  create  the endpoints in. To use the distributed
                   deployment model, you must set PolicyOption to NULL .

                 o Example: NETWORK_FIREWALL -  Distributed  deployment  model
                   with  automatic  Availability  Zone configuration and route
                   management   "{\"type\":\"NETWORK_FIREWALL\",\"networkFire-
                   wallStatelessRuleGroupReferences\":[{\"re-
                   sourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateless-rule-
                   group/test\",\"priority\":1}],\"networkFirewallStatelessDe-
                   faultActions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessFragmentDefaultAc-
                   tions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessCustomActions\":[{\"ac-
                   tionName\":\"customActionName\",\"actionDefini-
                   tion\":{\"publishMetricAction\":{\"dimen-
                   sions\":[{\"value\":\"metricdimensionvalue\"}]}}}],\"net-
                   workFirewallStatefulRuleGroupReferences\":[{\"re-
                   sourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateful-rule-
                   group/test\"}],\"networkFirewallOrchestrationCon-
                   fig\":{\"singleFirewallEndpointPerVPC\":false,\"al-
                   lowedIPV4CidrList\":[\"10.0.0.0/28\",\"192.168.0.0/28\"],\"route-
                   ManagementAction\":\"MONITOR\",\"routeManagementTarget-
                   Types\":[\"InternetGateway\"]},\"networkFirewallLoggingCon-
                   figuration\":{\"logDestinationConfigs\":[{\"logDestination-
                   Type\":\"S3\",\"logType\":\"ALERT\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}},{\"logDestina-
                   tionType\":\"S3\",\"logType\":       \"FLOW\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}}],\"overrideEx-
                   istingConfig\":true}}"    To use the distributed deployment
                   model, you must set PolicyOption to NULL .

                 o Example: NETWORK_FIREWALL -  Distributed  deployment  model
                   with     custom     Availability     Zone     configuration
                   "{\"type\":\"NETWORK_FIREWALL\",\"networkFirewallStateless-
                   RuleGroupReferences\":[{\"resourceARN\":\"arn:aws:net-
                   work-firewall:us-east-1:123456789011:stateless-rule-
                   group/test\",\"priority\":1}],\"networkFirewallStatelessDe-
                   faultActions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessFragmentDefaultAc-
                   tions\":[\"aws:forward_to_sfe\",\"fragmentcustomaction-
                   name\"],\"networkFirewallStatelessCustomActions\":[{\"ac-
                   tionName\":\"customActionName\",            \"actionDefini-
                   tion\":{\"publishMetricAction\":{\"dimen-
                   sions\":[{\"value\":\"metricdimensionvalue\"}]}}},{\"ac-
                   tionName\":\"fragmentcustomactionname\",\"actionDefini-
                   tion\":{\"publishMetricAction\":{\"dimen-
                   sions\":[{\"value\":\"fragmentmetricdimensionva-
                   lue\"}]}}}],\"networkFirewallStatefulRuleGroupRefer-
                   ences\":[{\"resourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateful-rule-
                   group/test\"}],\"networkFirewallOrchestrationCon-
                   fig\":{\"firewallCreationConfig\":{         \"endpointLoca-
                   tion\":{\"availabilityZoneConfigList\":[{\"availabilityZo-
                   neName\":\"us-east-1a\",\"al-
                   lowedIPV4CidrList\":[\"10.0.0.0/28\"]},{\"availabilityZone-
                   Name\":\"us-east-1b\",\"allowedIPV4CidrList\":[
                   \"10.0.0.0/28\"]}]}          },\"singleFirewallEndpointPer-
                   VPC\":false,\"allowedIPV4CidrList\":null,\"routeManagemen-
                   tAction\":\"OFF\",\"networkFirewallLoggingConfigura-
                   tion\":{\"logDestinationConfigs\":[{\"logDestination-
                   Type\":\"S3\",\"logType\":\"ALERT\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}},{\"logDestina-
                   tionType\":\"S3\",\"logType\":\"FLOW\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}}],\"overrideEx-
                   istingConfig\":boolean}}"    With  custom Availability Zone
                   configuration, you define which specific Availability Zones
                   to  create endpoints in by configuring firewallCreationCon-
                   fig . To configure the Availability Zones  in  firewallCre-
                   ationConfig  ,  specify  either the availabilityZoneName or
                   availabilityZoneId parameter, not both parameters.  To  use
                   the distributed deployment model, you must set PolicyOption
                   to NULL .

                 o Example: NETWORK_FIREWALL -  Distributed  deployment  model
                   with  custom Availability Zone configuration and route man-
                   agement  "{\"type\":\"NETWORK_FIREWALL\",\"networkFirewall-
                   StatelessRuleGroupReferences\":[{\"re-
                   sourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateless-rule-
                   group/test\",\"priority\":1}],\"networkFirewallStatelessDe-
                   faultActions\":[\"aws:forward_to_sfe\",\"customAction-
                   Name\"],\"networkFirewallStatelessFragmentDefaultAc-
                   tions\":[\"aws:forward_to_sfe\",\"fragmentcustomaction-
                   name\"],\"networkFirewallStatelessCustomActions\":[{\"ac-
                   tionName\":\"customActionName\",\"actionDefini-
                   tion\":{\"publishMetricAction\":{\"dimen-
                   sions\":[{\"value\":\"metricdimensionvalue\"}]}}},{\"ac-
                   tionName\":\"fragmentcustomactionname\",\"actionDefini-
                   tion\":{\"publishMetricAction\":{\"dimen-
                   sions\":[{\"value\":\"fragmentmetricdimensionva-
                   lue\"}]}}}],\"networkFirewallStatefulRuleGroupRefer-
                   ences\":[{\"resourceARN\":\"arn:aws:network-fire-
                   wall:us-east-1:123456789011:stateful-rule-
                   group/test\"}],\"networkFirewallOrchestrationCon-
                   fig\":{\"firewallCreationConfig\":{\"endpointLoca-
                   tion\":{\"availabilityZoneConfigList\":[{\"availabilityZo-
                   neName\":\"us-east-1a\",\"al-
                   lowedIPV4CidrList\":[\"10.0.0.0/28\"]},{\"availabilityZone-
                   Name\":\"us-east-1b\",\"al-
                   lowedIPV4CidrList\":[\"10.0.0.0/28\"]}]}},\"singleFirewal-
                   lEndpointPerVPC\":false,\"al-
                   lowedIPV4CidrList\":null,\"routeManagementAction\":\"MONI-
                   TOR\",\"routeManagementTargetTypes\":[\"InternetGate-
                   way\"],\"routeManagementConfig\":{\"allowCrossAZTrafficIf-
                   NoEndpoint\":true}},\"networkFirewallLoggingConfigura-
                   tion\":{\"logDestinationConfigs\":[{\"logDestination-
                   Type\":\"S3\",\"logType\":\"ALERT\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}},{\"logDestina-
                   tionType\":\"S3\",\"logType\":\"FLOW\",\"logDestina-
                   tion\":{\"bucketName\":\"s3-bucket-name\"}}],\"overrideEx-
                   istingConfig\":boolean}}"    To use the distributed deploy-
                   ment model, you must set PolicyOption to NULL .

                 o Example:             THIRD_PARTY_FIREWALL                "{
                   "type":"THIRD_PARTY_FIREWALL",             "thirdPartyFire-
                   wall":"PALO_ALTO_NETWORKS_CLOUD_NGFW", "thirdPartyFirewall-
                   Config":{   "thirdPartyFirewallPolicyList":["global-1"]  },
                   "firewallDeploymentModel":{ "distributedFirewallDeployment-
                   Model":{  "distributedFirewallOrchestrationConfig":{ "fire-
                   wallCreationConfig":{  "endpointLocation":{  "availability-
                   ZoneConfigList":[ { "availabilityZoneName":"${Availability-
                   Zone}" } ] } }, "allowedIPV4CidrList":[ ] } } } }"

                 o Example:    SECURITY_GROUPS_COMMON       "{\"type\":\"SECU-
                   RITY_GROUPS_COMMON\",\"revertManualSecurity-
                   GroupChanges\":false,\"exclusiveResourceSecurityGroupMan-
                   agement\":false,  \"applyToAllEC2InstanceENIs\":false,\"se-
                   curityGroups\":[{\"id\":\" sg-000e55995d61a06bd\"}]}"

                 o Example: SECURITY_GROUPS_COMMON - Security group  tag  dis-
                   tribution    ""{\"type\":\"SECURITY_GROUPS_COMMON\",\"secu-
                   rityGroups\":[{\"id\":\"sg-000e55995d61a06bd\"}],\"revert-
                   ManualSecurityGroupChanges\":true,\"exclusiveResourceSecu-
                   rityGroupManagement\":false,\"applyToAllEC2InstanceE-
                   NIs\":false,\"includeSharedVPC\":false,\"enableTagDistribu-
                   tion\":true}""   Firewall Manager automatically distributes
                   tags  from the primary group to the security groups created
                   by this policy. To use security group tag distribution, you
                   must  also  set  revertManualSecurityGroupChanges to true ,
                   otherwise Firewall Manager won't be able to create the pol-
                   icy.  When  you  enable  revertManualSecurityGroupChanges ,
                   Firewall Manager identifies and reports when  the  security
                   groups  created by this policy become non-compliant.  Fire-
                   wall Manager won't distrubute system tags added  by  Amazon
                   Web  Services  services  into  the replica security groups.
                   System tags begin with the aws: prefix.

                 o Example: Shared VPCs. Apply the  preceding  policy  to  re-
                   sources in shared VPCs as well as to those in VPCs that the
                   account owns    "{\"type\":\"SECURITY_GROUPS_COMMON\",\"re-
                   vertManualSecurityGroupChanges\":false,\"exclusiveRe-
                   sourceSecurityGroupManagement\":false,   \"applyToAllEC2In-
                   stanceENIs\":false,\"includeSharedVPC\":true,\"security-
                   Groups\":[{\"id\":\" sg-000e55995d61a06bd\"}]}"

                 o Example: SECURITY_GROUPS_CONTENT_AUDIT     "{\"type\":\"SE-
                   CURITY_GROUPS_CONTENT_AUDIT\",\"security-
                   Groups\":[{\"id\":\"sg-000e55995d61a06bd\"}],\"security-
                   GroupAction\":{\"type\":\"ALLOW\"}}"    The  security group
                   action for content audit can be ALLOW or DENY . For ALLOW ,
                   all  in-scope  security  group rules must be within the al-
                   lowed range of the policy's security group rules. For  DENY
                   ,  all  in-scope  security  group  rules must not contain a
                   value or a range that matches a rule value or range in  the
                   policy security group.

                 o Example:  SECURITY_GROUPS_USAGE_AUDIT    "{\"type\":\"SECU-
                   RITY_GROUPS_USAGE_AUDIT\",\"deleteUnusedSecurity-
                   Groups\":true,\"coalesceRedundantSecurityGroups\":true}"

                 o Specification  for  SHIELD_ADVANCED  for  Amazon CloudFront
                   distributions    "{\"type\":\"SHIELD_ADVANCED\",\"automati-
                   cResponseConfiguration\":          {\"automaticResponseSta-
                   tus\":\"ENABLED|IGNORED|DISABLED\",  \"automaticResponseAc-
                   tion\":\"BLOCK|COUNT\"},      \"overrideCustomerWebaclClas-
                   sic\":true|false}"   For  example:  "{\"type\":\"SHIELD_AD-
                   VANCED\",\"automaticResponseConfiguration\":   {\"automati-
                   cResponseStatus\":\"ENABLED\",       \"automaticResponseAc-
                   tion\":\"COUNT\"}}"    The  default  value for automaticRe-
                   sponseStatus is IGNORED . The  value  for  automaticRespon-
                   seAction  is  only required when automaticResponseStatus is
                   set to ENABLED . The default value for  overrideCustomerWe-
                   baclClassic  is  false  . For other resource types that you
                   can protect with a Shield Advanced policy, this ManagedSer-
                   viceData configuration is an empty string.

                 o Example:   WAFV2     "{\"type\":\"WAFV2\",\"preProcessRule-
                   Groups\":[{\"ruleGroupArn\":null,\"overrideAc-
                   tion\":{\"type\":\"NONE\"},\"managedRuleGroupIdenti-
                   fier\":{\"version\":null,\"vendorName\":\"AWS\",\"manage-
                   dRuleGroupName\":\"AWSManagedRulesAmazonIpReputation-
                   List\"},\"ruleGroupType\":\"ManagedRuleGroup\",\"ex-
                   cludeRules\":[{\"name\":\"NoUserAgent_HEADER\"}]}],\"post-
                   ProcessRuleGroups\":[],\"defaultAction\":{\"type\":\"AL-
                   LOW\"},\"overrideCustomerWebACLAssociation\":false,\"log-
                   gingConfiguration\":{\"logDestinationCon-
                   figs\":[\"arn:aws:firehose:us-west-2:12345678912:deliverys-
                   tream/aws-waf-logs-fms-admin-destination\"],\"redacted-
                   Fields\":[{\"redactedFieldType\":\"SingleHeader\",\"redact-
                   edFieldValue\":\"Cookies\"},{\"redactedField-
                   Type\":\"Method\"}]}}"    In the loggingConfiguration , you
                   can specify one logDestinationConfigs , you can  optionally
                   provide up to 20 redactedFields , and the RedactedFieldType
                   must be one of URI , QUERY_STRING , HEADER , or METHOD .

                 o Example: WAFV2 - Firewall Manager support for  WAF  managed
                   rule  group versioning   "{\"type\":\"WAFV2\",\"preProcess-
                   RuleGroups\":[{\"ruleGroupArn\":null,\"overrideAc-
                   tion\":{\"type\":\"NONE\"},\"managedRuleGroupIdenti-
                   fier\":{\"versionEnabled\":true,\"version\":\"Ver-
                   sion_2.0\",\"vendorName\":\"AWS\",\"managedRuleGroup-
                   Name\":\"AWSManagedRulesCommonRuleSet\"},\"ruleGroup-
                   Type\":\"ManagedRuleGroup\",\"ex-
                   cludeRules\":[{\"name\":\"NoUserAgent_HEADER\"}]}],\"post-
                   ProcessRuleGroups\":[],\"defaultAction\":{\"type\":\"AL-
                   LOW\"},\"overrideCustomerWebACLAssociation\":false,\"log-
                   gingConfiguration\":{\"logDestinationCon-
                   figs\":[\"arn:aws:firehose:us-west-2:12345678912:deliverys-
                   tream/aws-waf-logs-fms-admin-destination\"],\"redacted-
                   Fields\":[{\"redactedFieldType\":\"SingleHeader\",\"redact-
                   edFieldValue\":\"Cookies\"},{\"redactedField-
                   Type\":\"Method\"}]}}"   To use a specific version of a WAF
                   managed  rule  group  in  your Firewall Manager policy, you
                   must set versionEnabled to true , and set  version  to  the
                   version  you'd like to use. If you don't set versionEnabled
                   to true , or if you omit  versionEnabled  ,  then  Firewall
                   Manager  uses  the  default version of the WAF managed rule
                   group.

                 o Example:  WAF  Classic     "{\"type\":   \"WAF\",   \"rule-
                   Groups\":
                   [{\"id\":\"12345678-1bcd-9012-efga-0987654321ab\",  \"over-
                   rideAction\"  : {\"type\": \"COUNT\"}}], \"defaultAction\":
                   {\"type\": \"BLOCK\"}}"

              PolicyOption -> (structure)
                 Contains the Network Firewall firewall policy options to con-
                 figure a centralized deployment model.

                 NetworkFirewallPolicy -> (structure)
                     Defines the deployment model to use for the firewall pol-
                     icy.

                     FirewallDeploymentModel -> (string)
                        Defines the deployment model to use for  the  firewall
                        policy.  To  use a distributed model, set PolicyOption
                        to NULL .

                 ThirdPartyFirewallPolicy -> (structure)
                     Defines the policy options  for  a  third-party  firewall
                     policy.

                     FirewallDeploymentModel -> (string)
                        Defines   the   deployment   model   to  use  for  the
                        third-party firewall policy.

          ResourceType -> (string)
              The type of resource protected by or in  scope  of  the  policy.
              This  is in the format shown in the Amazon Web Services Resource
              Types Reference . To apply  this  policy  to  multiple  resource
              types,  specify  a  resource  type  of ResourceTypeList and then
              specify the resource types in a ResourceTypeList .

              For WAF and Shield Advanced, resource types include AWS::Elasti-
              cLoadBalancingV2::LoadBalancer     ,     AWS::ElasticLoadBalanc-
              ing::LoadBalancer , AWS::EC2::EIP , and AWS::CloudFront::Distri-
              bution  .  For  a security group common policy, valid values are
              AWS::EC2::NetworkInterface and AWS::EC2::Instance . For a  secu-
              rity  group content audit policy, valid values are AWS::EC2::Se-
              curityGroup ,  AWS::EC2::NetworkInterface  ,  and  AWS::EC2::In-
              stance  .  For a security group usage audit policy, the value is
              AWS::EC2::SecurityGroup . For an Network Firewall policy or  DNS
              Firewall policy, the value is AWS::EC2::VPC .

          ResourceTypeList -> (list)
              An  array of ResourceType objects. Use this only to specify mul-
              tiple resource types. To specify a single resource type, use Re-
              sourceType .

              (string)

          ResourceTags -> (list)
              An array of ResourceTag objects.

              (structure)
                 The  resource tags that Firewall Manager uses to determine if
                 a particular resource should be included or excluded from the
                 Firewall  Manager  policy. Tags enable you to categorize your
                 Amazon Web Services resources in different ways, for example,
                 by purpose, owner, or environment. Each tag consists of a key
                 and an optional value. Firewall  Manager  combines  the  tags
                 with  "AND" so that, if you add more than one tag to a policy
                 scope, a resource must have all the specified tags to be  in-
                 cluded  or  excluded.  For more information, see Working with
                 Tag Editor .

                 Key -> (string)
                     The resource tag key.

                 Value -> (string)
                     The resource tag value.

          ExcludeResourceTags -> (boolean)
              If set to True , resources with the tags that are  specified  in
              the  ResourceTag array are not in scope of the policy. If set to
              False , and the ResourceTag array is not  null,  only  resources
              with the specified tags are in scope of the policy.

          RemediationEnabled -> (boolean)
              Indicates  if  the policy should be automatically applied to new
              resources.

          DeleteUnusedFMManagedResources -> (boolean)
              Indicates whether Firewall Manager should  automatically  remove
              protections from resources that leave the policy scope and clean
              up resources that Firewall Manager is managing for accounts when
              those accounts leave policy scope. For example, Firewall Manager
              will disassociate a Firewall Manager managed web ACL from a pro-
              tected  customer resource when the customer resource leaves pol-
              icy scope.

              By default,  Firewall  Manager  doesn't  remove  protections  or
              delete Firewall Manager managed resources.

              This  option is not available for Shield Advanced or WAF Classic
              policies.

          IncludeMap -> (map)
              Specifies the Amazon Web Services account IDs and  Organizations
              organizational  units (OUs) to include in the policy. Specifying
              an OU is the equivalent of specifying all accounts in the OU and
              in  any  of  its child OUs, including any child OUs and accounts
              that are added at a later time.

              You can specify inclusions or exclusions, but not both.  If  you
              specify  an  IncludeMap , Firewall Manager applies the policy to
              all accounts specified by the IncludeMap , and does not evaluate
              any  ExcludeMap  specifications.  If  you  do not specify an In-
              cludeMap , then Firewall Manager applies the policy to  all  ac-
              counts except for those specified by the ExcludeMap .

              You can specify account IDs, OUs, or a combination:

              o Specify  account IDs by setting the key to ACCOUNT . For exam-
                ple, the following is a valid map: {ACCOUNT : [accountID1, ac-
                countID2]} .

              o Specify  OUs by setting the key to ORG_UNIT . For example, the
                following is a valid map: {ORG_UNIT : [ouid111, ouid112]} .

              o Specify accounts and OUs together in a single  map,  separated
                with  a comma. For example, the following is a valid map: {AC-
                COUNT  :  [accountID1,  accountID2],  ORG_UNIT   :   [ouid111,
                ouid112]} .

              key -> (string)

              value -> (list)
                 (string)

          ExcludeMap -> (map)
              Specifies  the Amazon Web Services account IDs and Organizations
              organizational units (OUs) to exclude from the policy.  Specify-
              ing an OU is the equivalent of specifying all accounts in the OU
              and in any of its child OUs, including any  child  OUs  and  ac-
              counts that are added at a later time.

              You  can  specify inclusions or exclusions, but not both. If you
              specify an IncludeMap , Firewall Manager applies the  policy  to
              all accounts specified by the IncludeMap , and does not evaluate
              any ExcludeMap specifications. If you  do  not  specify  an  In-
              cludeMap  ,  then Firewall Manager applies the policy to all ac-
              counts except for those specified by the ExcludeMap .

              You can specify account IDs, OUs, or a combination:

              o Specify account IDs by setting the key to ACCOUNT . For  exam-
                ple, the following is a valid map: {ACCOUNT : [accountID1, ac-
                countID2]} .

              o Specify OUs by setting the key to ORG_UNIT . For example,  the
                following is a valid map: {ORG_UNIT : [ouid111, ouid112]} .

              o Specify  accounts  and OUs together in a single map, separated
                with a comma. For example, the following is a valid map:  {AC-
                COUNT   :   [accountID1,  accountID2],  ORG_UNIT  :  [ouid111,
                ouid112]} .

              key -> (string)

              value -> (list)
                 (string)

          ResourceSetIds -> (list)
              The unique identifiers of the resource sets used by the policy.

              (string)

          PolicyDescription -> (string)
              The definition of the Network Firewall firewall policy.

       PolicyArn -> (string)
          The Amazon Resource Name (ARN) of the policy.



                                                                  PUT-POLICY()
