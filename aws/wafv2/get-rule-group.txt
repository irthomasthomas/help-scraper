GET-RULE-GROUP()                                              GET-RULE-GROUP()



NAME
       get-rule-group -

DESCRIPTION
       Retrieves the specified  RuleGroup .

       See also: AWS API Documentation

SYNOPSIS
            get-rule-group
          [--name <value>]
          [--scope <value>]
          [--id <value>]
          [--arn <value>]
          [--cli-input-json <value>]
          [--generate-cli-skeleton <value>]
          [--debug]
          [--endpoint-url <value>]
          [--no-verify-ssl]
          [--no-paginate]
          [--output <value>]
          [--query <value>]
          [--profile <value>]
          [--region <value>]
          [--version <value>]
          [--color <value>]
          [--no-sign-request]
          [--ca-bundle <value>]
          [--cli-read-timeout <value>]
          [--cli-connect-timeout <value>]

OPTIONS
       --name (string)
          The  name  of  the  rule group. You cannot change the name of a rule
          group after you create it.

       --scope (string)
          Specifies whether this is for an Amazon CloudFront  distribution  or
          for  a regional application. A regional application can be an Appli-
          cation Load Balancer (ALB), an Amazon API Gateway REST API, an  App-
          Sync  GraphQL  API,  an Amazon Cognito user pool, an App Runner ser-
          vice, or an Amazon Web Services Verified Access instance.

          To work with CloudFront, you must also specify the  Region  US  East
          (N. Virginia) as follows:

          o CLI  -  Specify  the  Region  when  you  use the CloudFront scope:
            --scope=CLOUDFRONT --region=us-east-1 .

          o API and SDKs - For all calls, use the Region endpoint us-east-1.

          Possible values:

          o CLOUDFRONT

          o REGIONAL

       --id (string)
          A unique identifier for the rule group. This ID is returned  in  the
          responses  to create and list commands. You provide it to operations
          like update and delete.

       --arn (string)
          The Amazon Resource Name (ARN) of the entity.

       --cli-input-json (string) Performs service operation based on the  JSON
       string  provided. The JSON string follows the format provided by --gen-
       erate-cli-skeleton. If other arguments  are  provided  on  the  command
       line,  the CLI values will override the JSON-provided values. It is not
       possible to pass arbitrary binary values using a JSON-provided value as
       the string will be taken literally.

       --generate-cli-skeleton  (string)  Prints  a  JSON skeleton to standard
       output without sending an API request. If provided with no value or the
       value input, prints a sample input JSON that can be used as an argument
       for --cli-input-json. If provided with the value output,  it  validates
       the command inputs and returns a sample output JSON for that command.

GLOBAL OPTIONS
       --debug (boolean)

       Turn on debug logging.

       --endpoint-url (string)

       Override command's default URL with the given URL.

       --no-verify-ssl (boolean)

       By  default, the AWS CLI uses SSL when communicating with AWS services.
       For each SSL connection, the AWS CLI will verify SSL certificates. This
       option overrides the default behavior of verifying SSL certificates.

       --no-paginate (boolean)

       Disable automatic pagination.

       --output (string)

       The formatting style for command output.

       o json

       o text

       o table

       --query (string)

       A JMESPath query to use in filtering the response data.

       --profile (string)

       Use a specific profile from your credential file.

       --region (string)

       The region to use. Overrides config/env settings.

       --version (string)

       Display the version of this tool.

       --color (string)

       Turn on/off color output.

       o on

       o off

       o auto

       --no-sign-request (boolean)

       Do  not  sign requests. Credentials will not be loaded if this argument
       is provided.

       --ca-bundle (string)

       The CA certificate bundle to use when verifying SSL certificates. Over-
       rides config/env settings.

       --cli-read-timeout (int)

       The  maximum socket read time in seconds. If the value is set to 0, the
       socket read will be blocking and not timeout. The default value  is  60
       seconds.

       --cli-connect-timeout (int)

       The  maximum  socket connect time in seconds. If the value is set to 0,
       the socket connect will be blocking and not timeout. The default  value
       is 60 seconds.

EXAMPLES
       NOTE:
          To  use  the following examples, you must have the AWS CLI installed
          and configured. See the Getting started guide in the  AWS  CLI  User
          Guide for more information.

          Unless  otherwise  stated,  all  examples  have  unix-like quotation
          rules. These examples will need to be  adapted  to  your  terminal's
          quoting rules. See Using quotation marks with strings in the AWS CLI
          User Guide .

       To retrieve a specific custom rule group

       The following get-rule-group retrieves the custom rule group  with  the
       specified name, scope, and ID. You can get the ID for a rule group from
       the commands create-rule-group and list-rule-groups.

          aws wafv2 get-rule-group \
              --name ff \
              --scope REGIONAL \
              --id a1b2c3d4-5678-90ab-cdef-EXAMPLE11111

       Output:

          {
              "RuleGroup":{
                  "Capacity":1,
                  "Description":"",
                  "Rules":[
                      {
                          "Priority":0,
                          "Action":{
                              "Block":{

                              }
                          },
                          "VisibilityConfig":{
                              "SampledRequestsEnabled":true,
                              "CloudWatchMetricsEnabled":true,
                              "MetricName":"jj"
                          },
                          "Name":"jj",
                          "Statement":{
                              "SizeConstraintStatement":{
                                  "ComparisonOperator":"LE",
                                  "TextTransformations":[
                                      {
                                          "Priority":0,
                                          "Type":"NONE"
                                      }
                                  ],
                                  "FieldToMatch":{
                                      "UriPath":{

                                      }
                                  },
                                  "Size":7
                              }
                          }
                      }
                  ],
                  "VisibilityConfig":{
                      "SampledRequestsEnabled":true,
                      "CloudWatchMetricsEnabled":true,
                      "MetricName":"ff"
                  },
                  "Id":"a1b2c3d4-5678-90ab-cdef-EXAMPLE11111",
                  "ARN":"arn:aws:wafv2:us-west-2:123456789012:regional/rulegroup/ff/a1b2c3d4-5678-90ab-cdef-EXAMPLE11111",
                  "Name":"ff"
              },
              "LockToken":"485458c9-1830-4234-af31-ec4d52ced1b3"
          }

       For more information, see Managing Your Own Rule Groups in the AWS WAF,
       AWS Firewall Manager, and AWS Shield Advanced Developer Guide.

OUTPUT
       RuleGroup -> (structure)
          Name -> (string)
              The name of the rule group. You cannot change the name of a rule
              group after you create it.

          Id -> (string)
              A unique identifier for the rule group. This ID is  returned  in
              the responses to create and list commands. You provide it to op-
              erations like update and delete.

          Capacity -> (long)
              The web ACL capacity units (WCUs) required for this rule group.

              When you create your own rule group, you define  this,  and  you
              cannot  change  it  after  creation.  When you add or modify the
              rules in a rule group, WAF enforces this limit.  You  can  check
              the capacity for a set of rules using  CheckCapacity .

              WAF  uses  WCUs to calculate and control the operating resources
              that are used to run your rules, rule groups, and web ACLs.  WAF
              calculates  capacity  differently for each rule type, to reflect
              the relative cost of each rule. Simple rules that cost little to
              run  use  fewer  WCUs than more complex rules that use more pro-
              cessing power. Rule group capacity is fixed at  creation,  which
              helps  users  plan  their web ACL WCU usage when they use a rule
              group. For more information, see  WAF  web  ACL  capacity  units
              (WCU) in the WAF Developer Guide .

          ARN -> (string)
              The Amazon Resource Name (ARN) of the entity.

          Description -> (string)
              A description of the rule group that helps with identification.

          Rules -> (list)
              The   Rule statements used to identify the web requests that you
              want to allow, block, or count. Each rule includes one top-level
              statement  that  WAF uses to identify matching web requests, and
              parameters that govern how WAF handles them.

              (structure)
                 A single rule, which you can use in a  WebACL  or   RuleGroup
                 to  identify  web  requests that you want to allow, block, or
                 count. Each rule includes one top-level  Statement  that  WAF
                 uses  to  identify matching web requests, and parameters that
                 govern how WAF handles them.

                 Name -> (string)
                     The name of the rule. You can't change the name of a Rule
                     after you create it.

                 Priority -> (integer)
                     If you define more than one Rule in a WebACL , WAF evalu-
                     ates each request against the Rules in order based on the
                     value of Priority . WAF processes rules with lower prior-
                     ity first. The priorities don't need to  be  consecutive,
                     but they must all be different.

                 Statement -> (structure)
                     The  WAF  processing  statement for the rule, for example
                     ByteMatchStatement or  SizeConstraintStatement .

                     ByteMatchStatement -> (structure)
                        A rule statement that defines a  string  match  search
                        for  WAF  to  apply  to  web  requests. The byte match
                        statement provides the bytes to search for, the  loca-
                        tion  in  requests  that  you  want WAF to search, and
                        other settings. The bytes to search for are  typically
                        a  string  that  corresponds with ASCII characters. In
                        the WAF console  and  the  developer  guide,  this  is
                        called a string match statement.

                        SearchString -> (blob)
                            A  string  value  that you want WAF to search for.
                            WAF searches only in the part of web requests that
                            you  designate  for  inspection in  FieldToMatch .
                            The maximum length of the value is 200 bytes.

                            Valid values depend  on  the  component  that  you
                            specify for inspection in FieldToMatch :

                            o Method  :  The  HTTP method that you want WAF to
                              search for. This indicates the type of operation
                              specified in the request.

                            o UriPath  : The value that you want WAF to search
                              for  in  the  URI  path,   for   example,   /im-
                              ages/daily-ad.jpg .

                            o HeaderOrder : The comma-separated list of header
                              names to match for. WAF creates  a  string  that
                              contains  the ordered list of header names, from
                              the headers in the web request, and then matches
                              against that string.

                            If SearchString includes alphabetic characters A-Z
                            and a-z, note that the value is case sensitive.
                               If you're using the WAF API

                            Specify a base64-encoded version of the value. The
                            maximum  length of the value before you base64-en-
                            code it is 200 bytes.

                            For example, suppose the value of Type  is  HEADER
                            and  the value of Data is User-Agent . If you want
                            to search the User-Agent header for the value Bad-
                            Bot   ,   you   base64-encode  BadBot  using  MIME
                            base64-encoding and include the  resulting  value,
                            QmFkQm90 , in the value of SearchString .
                               If  you're  using  the CLI or one of the Amazon
                               Web Services SDKs

                            The value that you want WAF to search for. The SDK
                            automatically base64 encodes the value.

                        FieldToMatch -> (structure)
                            The  part  of the web request that you want WAF to
                            inspect.

                            SingleHeader -> (structure)
                               Inspect a single header. Provide  the  name  of
                               the  header to inspect, for example, User-Agent
                               or Referer . This setting isn't case sensitive.

                               Example   JSON:   "SingleHeader":   {   "Name":
                               "haystack" }

                               Alternately,  you  can  filter  and inspect all
                               headers with the Headers  FieldToMatch setting.

                               Name -> (string)
                                   The name of the query header to inspect.

                            SingleQueryArgument -> (structure)
                               Inspect a single query  argument.  Provide  the
                               name  of the query argument to inspect, such as
                               UserName or SalesRegion . The name can be up to
                               30 characters long and isn't case sensitive.

                               Example  JSON: "SingleQueryArgument": { "Name":
                               "myArgument" }

                               Name -> (string)
                                   The name of the query argument to inspect.

                            AllQueryArguments -> (structure)
                               Inspect all query arguments.

                            UriPath -> (structure)
                               Inspect the request URI path. This is the  part
                               of  the web request that identifies a resource,
                               for example, /images/daily-ad.jpg .

                            QueryString -> (structure)
                               Inspect the query string. This is the part of a
                               URL that appears after a ? character, if any.

                            Body -> (structure)
                               Inspect the request body as plain text. The re-
                               quest  body  immediately  follows  the  request
                               headers.  This  is  the  part of a request that
                               contains any additional data that you  want  to
                               send  to  your  web  server as the HTTP request
                               body, such as data from a form.

                               A limited amount of the request  body  is  for-
                               warded  to WAF for inspection by the underlying
                               host service. For regional resources, the limit
                               is  8  KB  (8,192 kilobytes) and for CloudFront
                               distributions, the limit is 16 KB (16,384 kilo-
                               bytes).  For  CloudFront distributions, you can
                               increase the limit in the  web  ACL's  Associa-
                               tionConfig , for additional processing fees.

                               For  information  about how to handle oversized
                               request bodies, see the Body object  configura-
                               tion.

                               OversizeHandling -> (string)
                                   What  WAF  should  do if the body is larger
                                   than WAF can inspect. WAF does not  support
                                   inspecting  the  entire contents of the web
                                   request body if the body exceeds the  limit
                                   for  the  resource  type.  If  the  body is
                                   larger than the limit, the underlying  host
                                   service only forwards the contents that are
                                   below the limit to WAF for inspection.

                                   The default limit is 8 KB (8,192 kilobytes)
                                   for  regional  resources  and 16 KB (16,384
                                   kilobytes)  for  CloudFront  distributions.
                                   For  CloudFront  distributions, you can in-
                                   crease the limit in the  web  ACL  Associa-
                                   tionConfig   ,  for  additional  processing
                                   fees.

                                   The options for oversize handling  are  the
                                   following:

                                   o CONTINUE  -  Inspect  the  available body
                                     contents normally, according to the  rule
                                     inspection criteria.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                                   You can combine the MATCH or NO_MATCH  set-
                                   tings  for oversize handling with your rule
                                   and web ACL action settings,  so  that  you
                                   block  any  request  whose body is over the
                                   limit.

                                   Default: CONTINUE

                            Method -> (structure)
                               Inspect the HTTP method. The  method  indicates
                               the  type of operation that the request is ask-
                               ing the origin to perform.

                            JsonBody -> (structure)
                               Inspect the request body as JSON.  The  request
                               body  immediately  follows the request headers.
                               This is the part of a request that contains any
                               additional  data  that you want to send to your
                               web server as the HTTP request  body,  such  as
                               data from a form.

                               A  limited  amount  of the request body is for-
                               warded to WAF for inspection by the  underlying
                               host service. For regional resources, the limit
                               is 8 KB (8,192 kilobytes)  and  for  CloudFront
                               distributions, the limit is 16 KB (16,384 kilo-
                               bytes). For CloudFront distributions,  you  can
                               increase  the  limit  in the web ACL's Associa-
                               tionConfig , for additional processing fees.

                               For information about how to  handle  oversized
                               request bodies, see the JsonBody object config-
                               uration.

                               MatchPattern -> (structure)
                                   The patterns to look for in the JSON  body.
                                   WAF  inspects  the results of these pattern
                                   matches against the rule inspection  crite-
                                   ria.

                                   All -> (structure)
                                      Match  all  of  the  elements.  See also
                                      MatchScope in  JsonBody .

                                      You must specify either this setting  or
                                      the IncludedPaths setting, but not both.

                                   IncludedPaths -> (list)
                                      Match  only the specified include paths.
                                      See also MatchScope in  JsonBody .

                                      Provide the  include  paths  using  JSON
                                      Pointer  syntax. For example, "Included-
                                      Paths": ["/dogs/0/name", "/dogs/1/name"]
                                      . For information about this syntax, see
                                      the  Internet  Engineering  Task   Force
                                      (IETF)  documentation  JavaScript Object
                                      Notation (JSON) Pointer .

                                      You must specify either this setting  or
                                      the All setting, but not both.

                                      NOTE:
                                          Don't use this option to include all
                                          paths. Instead, use the All setting.

                                      (string)

                               MatchScope -> (string)
                                   The parts of the JSON to match against  us-
                                   ing the MatchPattern . If you specify All ,
                                   WAF matches against keys and values.

                               InvalidFallbackBehavior -> (string)
                                   What WAF should do  if  it  fails  to  com-
                                   pletely  parse  the  JSON body. The options
                                   are the following:

                                   o EVALUATE_AS_STRING - Inspect the body  as
                                     plain  text.  WAF applies the text trans-
                                     formations and inspection  criteria  that
                                     you  defined  for  the JSON inspection to
                                     the body text string.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                                   If  you  don't  provide  this  setting, WAF
                                   parses and evaluates the content only up to
                                   the  first  parsing failure that it encoun-
                                   ters.

                                   WAF does its best to parse the entire  JSON
                                   body,  but might be forced to stop for rea-
                                   sons such as invalid characters,  duplicate
                                   keys,  truncation,  and  any  content whose
                                   root node isn't an object or an array.

                                   WAF parses the JSON in the following  exam-
                                   ples as two valid key, value pairs:

                                   o Missing                            comma:
                                     {"key1":"value1""key2":"value2"}

                                   o Missing                            colon:
                                     {"key1":"value1","key2""value2"}

                                   o Extra                             colons:
                                     {"key1"::"value1","key2""value2"}

                               OversizeHandling -> (string)
                                   What WAF should do if the  body  is  larger
                                   than  WAF can inspect. WAF does not support
                                   inspecting the entire contents of  the  web
                                   request  body if the body exceeds the limit
                                   for the  resource  type.  If  the  body  is
                                   larger  than the limit, the underlying host
                                   service only forwards the contents that are
                                   below the limit to WAF for inspection.

                                   The default limit is 8 KB (8,192 kilobytes)
                                   for regional resources and  16  KB  (16,384
                                   kilobytes)  for  CloudFront  distributions.
                                   For CloudFront distributions, you  can  in-
                                   crease  the  limit  in the web ACL Associa-
                                   tionConfig  ,  for  additional   processing
                                   fees.

                                   The  options  for oversize handling are the
                                   following:

                                   o CONTINUE -  Inspect  the  available  body
                                     contents  normally, according to the rule
                                     inspection criteria.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                                   You  can combine the MATCH or NO_MATCH set-
                                   tings for oversize handling with your  rule
                                   and  web  ACL  action settings, so that you
                                   block any request whose body  is  over  the
                                   limit.

                                   Default: CONTINUE

                            Headers -> (structure)
                               Inspect the request headers. You must configure
                               scope and pattern matching filters in the Head-
                               ers object, to define the set of headers to and
                               the parts of the headers that WAF inspects.

                               Only the first 8 KB (8192 bytes) of a request's
                               headers and only the first 200 headers are for-
                               warded to WAF for inspection by the  underlying
                               host  service. You must configure how to handle
                               any oversize header content in the Headers  ob-
                               ject.  WAF applies the pattern matching filters
                               to the headers that it receives from the under-
                               lying host service.

                               MatchPattern -> (structure)
                                   The filter to use to identify the subset of
                                   headers to inspect in a web request.

                                   You must specify exactly one  setting:  ei-
                                   ther  All  , IncludedHeaders , or Excluded-
                                   Headers .

                                   Example JSON: "MatchPattern": {  "Excluded-
                                   Headers":    {"KeyToExclude1",    "KeyToEx-
                                   clude2"} }

                                   All -> (structure)
                                      Inspect all headers.

                                   IncludedHeaders -> (list)
                                      Inspect only the headers that have a key
                                      that  matches  one of the strings speci-
                                      fied here.

                                      (string)

                                   ExcludedHeaders -> (list)
                                      Inspect  only  the  headers  whose  keys
                                      don't match any of the strings specified
                                      here.

                                      (string)

                               MatchScope -> (string)
                                   The parts of the headers to match with  the
                                   rule  inspection  criteria.  If you specify
                                   All , WAF inspects both keys and values.

                               OversizeHandling -> (string)
                                   What WAF should do if the  headers  of  the
                                   request  are  more  numerous or larger than
                                   WAF can inspect. WAF does not  support  in-
                                   specting  the  entire  contents  of request
                                   headers when they exceed 8 KB (8192  bytes)
                                   or  200  total headers. The underlying host
                                   service forwards a maximum of  200  headers
                                   and at most 8 KB of header contents to WAF.

                                   The  options  for oversize handling are the
                                   following:

                                   o CONTINUE - Inspect the available  headers
                                     normally,  according  to the rule inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                            Cookies -> (structure)
                               Inspect the request cookies. You must configure
                               scope and pattern matching filters in the Cook-
                               ies  object,  to  define the set of cookies and
                               the parts of the cookies that WAF inspects.

                               Only the first 8 KB (8192 bytes) of a request's
                               cookies and only the first 200 cookies are for-
                               warded to WAF for inspection by the  underlying
                               host  service. You must configure how to handle
                               any oversize cookie content in the Cookies  ob-
                               ject.  WAF applies the pattern matching filters
                               to the cookies that it receives from the under-
                               lying host service.

                               MatchPattern -> (structure)
                                   The filter to use to identify the subset of
                                   cookies to inspect in a web request.

                                   You must specify exactly one  setting:  ei-
                                   ther  All  , IncludedCookies , or Excluded-
                                   Cookies .

                                   Example JSON: "MatchPattern": {  "Included-
                                   Cookies":    {"KeyToInclude1",    "KeyToIn-
                                   clude2", "KeyToInclude3"} }

                                   All -> (structure)
                                      Inspect all cookies.

                                   IncludedCookies -> (list)
                                      Inspect only the cookies that have a key
                                      that  matches  one of the strings speci-
                                      fied here.

                                      (string)

                                   ExcludedCookies -> (list)
                                      Inspect  only  the  cookies  whose  keys
                                      don't match any of the strings specified
                                      here.

                                      (string)

                               MatchScope -> (string)
                                   The parts of the cookies  to  inspect  with
                                   the  rule inspection criteria. If you spec-
                                   ify All , WAF inspects both keys  and  val-
                                   ues.

                               OversizeHandling -> (string)
                                   What  WAF  should  do if the cookies of the
                                   request are more numerous  or  larger  than
                                   WAF  can  inspect. WAF does not support in-
                                   specting the  entire  contents  of  request
                                   cookies  when they exceed 8 KB (8192 bytes)
                                   or 200 total cookies. The  underlying  host
                                   service  forwards  a maximum of 200 cookies
                                   and at most 8 KB of cookie contents to WAF.

                                   The options for oversize handling  are  the
                                   following:

                                   o CONTINUE  - Inspect the available cookies
                                     normally, according to the  rule  inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                            HeaderOrder -> (structure)
                               Inspect a string containing the list of the re-
                               quest's header names, ordered as they appear in
                               the web request that WAF receives  for  inspec-
                               tion.  WAF  generates  the string and then uses
                               that as the field to match component in its in-
                               spection. WAF separates the header names in the
                               string using commas and no added spaces.

                               Matches against the  header  order  string  are
                               case insensitive.

                               OversizeHandling -> (string)
                                   What  WAF  should  do if the headers of the
                                   request are more numerous  or  larger  than
                                   WAF  can  inspect. WAF does not support in-
                                   specting the  entire  contents  of  request
                                   headers  when they exceed 8 KB (8192 bytes)
                                   or 200 total headers. The  underlying  host
                                   service  forwards  a maximum of 200 headers
                                   and at most 8 KB of header contents to WAF.

                                   The options for oversize handling  are  the
                                   following:

                                   o CONTINUE  - Inspect the available headers
                                     normally, according to the  rule  inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                        TextTransformations -> (list)
                            Text transformations eliminate some of the unusual
                            formatting  that  attackers use in web requests in
                            an effort to bypass  detection.  Text  transforma-
                            tions are used in rule match statements, to trans-
                            form the FieldToMatch request component before in-
                            specting  it,  and they're used in rate-based rule
                            statements, to transform request components before
                            using  them  as  custom  aggregation  keys. If you
                            specify one or more transformations to apply,  WAF
                            performs all transformations on the specified con-
                            tent, starting from the lowest  priority  setting,
                            and then uses the component contents.

                            (structure)
                               Text  transformations eliminate some of the un-
                               usual formatting that attackers use in web  re-
                               quests in an effort to bypass detection.

                               Priority -> (integer)
                                   Sets the relative processing order for mul-
                                   tiple transformations.  WAF  processes  all
                                   transformations,  from  lowest  priority to
                                   highest, before inspecting the  transformed
                                   content.  The  priorities  don't need to be
                                   consecutive, but they must all  be  differ-
                                   ent.

                               Type -> (string)
                                   You  can  specify the following transforma-
                                   tion types:
                                      BASE64_DECODE - Decode a Base64 -encoded
                                      string.

                                      BASE64_DECODE_EXT - Decode a Base64 -en-
                                      coded string, but use a forgiving imple-
                                      mentation  that  ignores characters that
                                      aren't valid.

                                      CMD_LINE - Command-line transformations.
                                      These are helpful in reducing effective-
                                      ness of attackers who inject an  operat-
                                      ing  system command-line command and use
                                      unusual formatting to disguise  some  or
                                      all of the command.

                                   o Delete the following characters: \ " ' ^

                                   o Delete  spaces before the following char-
                                     acters: / (

                                   o Replace the following characters  with  a
                                     space: , ;

                                   o Replace multiple spaces with one space

                                   o Convert uppercase letters (A-Z) to lower-
                                     case (a-z)
                                      COMPRESS_WHITE_SPACE  -  Replace   these
                                      characters with a space character (deci-
                                      mal 32):

                                   o \f , formfeed, decimal 12

                                   o \t , tab, decimal 9

                                   o \n , newline, decimal 10

                                   o \r , carriage return, decimal 13

                                   o \v , vertical tab, decimal 11

                                   o Non-breaking space, decimal 160
                                      COMPRESS_WHITE_SPACE also replaces  mul-
                                      tiple spaces with one space.

                                      CSS_DECODE - Decode characters that were
                                      encoded using CSS 2.x escape rules  syn-
                                      data.html#characters   .  This  function
                                      uses up to two  bytes  in  the  decoding
                                      process, so it can help to uncover ASCII
                                      characters that were encoded  using  CSS
                                      encoding  that  wouldnt typically be en-
                                      coded. It's also  useful  in  countering
                                      evasion,  which  is  a  combination of a
                                      backslash  and  non-hexadecimal  charac-
                                      ters. For example, ja\vascript for java-
                                      script.

                                      ESCAPE_SEQ_DECODE - Decode the following
                                      ANSI  C escape sequences: \a , \b , \f ,
                                      \n , \r , \t , \v , \\ , \? , \' , \"  ,
                                      \xHH  (hexadecimal),  \0OOO (octal). En-
                                      codings that aren't valid remain in  the
                                      output.

                                      HEX_DECODE - Decode a string of hexadec-
                                      imal characters into a binary.

                                      HTML_ENTITY_DECODE  -  Replace  HTML-en-
                                      coded  characters with unencoded charac-
                                      ters. HTML_ENTITY_DECODE performs  these
                                      operations:

                                   o Replaces (ampersand)quot; with "

                                   o Replaces    (ampersand)nbsp;    with    a
                                     non-breaking space, decimal 160

                                   o Replaces  (ampersand)lt;  with  a   "less
                                     than" symbol

                                   o Replaces (ampersand)gt; with >

                                   o Replaces  characters that are represented
                                     in hexadecimal format, (ampersand)#xhhhh;
                                     , with the corresponding characters

                                   o Replaces  characters that are represented
                                     in decimal  format,  (ampersand)#nnnn;  ,
                                     with the corresponding characters
                                      JS_DECODE - Decode JavaScript escape se-
                                      quences. If a \  u  HHHH code is in  the
                                      full-width ASCII code range of FF01-FF5E
                                      , then the higher byte is used to detect
                                      and  adjust the lower byte. If not, only
                                      the lower byte is used  and  the  higher
                                      byte  is zeroed, causing a possible loss
                                      of information.

                                      LOWERCASE -  Convert  uppercase  letters
                                      (A-Z) to lowercase (a-z).

                                      MD5  -  Calculate  an  MD5 hash from the
                                      data in the input. The computed hash  is
                                      in a raw binary form.

                                      NONE  -  Specify  NONE if you don't want
                                      any text transformations.

                                      NORMALIZE_PATH   -    Remove    multiple
                                      slashes,  directory self-references, and
                                      directory back-references that  are  not
                                      at  the  beginning  of the input from an
                                      input string.

                                      NORMALIZE_PATH_WIN - This is the same as
                                      NORMALIZE_PATH   ,  but  first  converts
                                      backslash characters to forward slashes.

                                      REMOVE_NULLS -  Remove  all  NULL  bytes
                                      from the input.

                                      REPLACE_COMMENTS  -  Replace each occur-
                                      rence of a C-style comment (/* ... */  )
                                      with  a  single space. Multiple consecu-
                                      tive occurrences are not compressed. Un-
                                      terminated  comments  are  also replaced
                                      with a space (ASCII  0x20).  However,  a
                                      standalone  termination of a comment (*/
                                      ) is not acted upon.

                                      REPLACE_NULLS - Replace  NULL  bytes  in
                                      the  input  with space characters (ASCII
                                      0x20 ).

                                      SQL_HEX_DECODE - Decode  SQL  hex  data.
                                      Example  (0x414243  ) will be decoded to
                                      (ABC ).

                                      URL_DECODE - Decode a URL-encoded value.

                                      URL_DECODE_UNI - Like URL_DECODE  ,  but
                                      with  support  for Microsoft-specific %u
                                      encoding.  If  the  code   is   in   the
                                      full-width ASCII code range of FF01-FF5E
                                      , the higher byte is used to detect  and
                                      adjust  the  lower byte. Otherwise, only
                                      the lower byte is used  and  the  higher
                                      byte is zeroed.

                                      UTF8_TO_UNICODE   -  Convert  all  UTF-8
                                      character  sequences  to  Unicode.  This
                                      helps  input normalization, and minimiz-
                                      ing false-positives and  false-negatives
                                      for non-English languages.

                        PositionalConstraint -> (string)
                            The  area  within  the  portion of the web request
                            that you want WAF to  search  for  SearchString  .
                            Valid values include the following:
                               CONTAINS

                            The specified part of the web request must include
                            the value  of  SearchString  ,  but  the  location
                            doesn't matter.
                               CONTAINS_WORD

                            The specified part of the web request must include
                            the value of SearchString , and SearchString  must
                            contain only alphanumeric characters or underscore
                            (A-Z, a-z, 0-9, or _). In  addition,  SearchString
                            must  be a word, which means that both of the fol-
                            lowing are true:

                            o SearchString is at the beginning of  the  speci-
                              fied part of the web request or is preceded by a
                              character other than an  alphanumeric  character
                              or underscore (_). Examples include the value of
                              a header and ;BadBot .

                            o SearchString is at the end of the specified part
                              of the web request or is followed by a character
                              other than an alphanumeric character  or  under-
                              score (_), for example, BadBot; and -BadBot; .
                               EXACTLY

                            The value of the specified part of the web request
                            must exactly match the value of SearchString .
                               STARTS_WITH

                            The value of SearchString must appear at  the  be-
                            ginning of the specified part of the web request.
                               ENDS_WITH

                            The  value  of SearchString must appear at the end
                            of the specified part of the web request.

                     SqliMatchStatement -> (structure)
                        A rule statement that inspects for malicious SQL code.
                        Attackers  insert malicious SQL code into web requests
                        to do things like modify your database or extract data
                        from it.

                        FieldToMatch -> (structure)
                            The  part  of the web request that you want WAF to
                            inspect.

                            SingleHeader -> (structure)
                               Inspect a single header. Provide  the  name  of
                               the  header to inspect, for example, User-Agent
                               or Referer . This setting isn't case sensitive.

                               Example   JSON:   "SingleHeader":   {   "Name":
                               "haystack" }

                               Alternately,  you  can  filter  and inspect all
                               headers with the Headers  FieldToMatch setting.

                               Name -> (string)
                                   The name of the query header to inspect.

                            SingleQueryArgument -> (structure)
                               Inspect a single query  argument.  Provide  the
                               name  of the query argument to inspect, such as
                               UserName or SalesRegion . The name can be up to
                               30 characters long and isn't case sensitive.

                               Example  JSON: "SingleQueryArgument": { "Name":
                               "myArgument" }

                               Name -> (string)
                                   The name of the query argument to inspect.

                            AllQueryArguments -> (structure)
                               Inspect all query arguments.

                            UriPath -> (structure)
                               Inspect the request URI path. This is the  part
                               of  the web request that identifies a resource,
                               for example, /images/daily-ad.jpg .

                            QueryString -> (structure)
                               Inspect the query string. This is the part of a
                               URL that appears after a ? character, if any.

                            Body -> (structure)
                               Inspect the request body as plain text. The re-
                               quest  body  immediately  follows  the  request
                               headers.  This  is  the  part of a request that
                               contains any additional data that you  want  to
                               send  to  your  web  server as the HTTP request
                               body, such as data from a form.

                               A limited amount of the request  body  is  for-
                               warded  to WAF for inspection by the underlying
                               host service. For regional resources, the limit
                               is  8  KB  (8,192 kilobytes) and for CloudFront
                               distributions, the limit is 16 KB (16,384 kilo-
                               bytes).  For  CloudFront distributions, you can
                               increase the limit in the  web  ACL's  Associa-
                               tionConfig , for additional processing fees.

                               For  information  about how to handle oversized
                               request bodies, see the Body object  configura-
                               tion.

                               OversizeHandling -> (string)
                                   What  WAF  should  do if the body is larger
                                   than WAF can inspect. WAF does not  support
                                   inspecting  the  entire contents of the web
                                   request body if the body exceeds the  limit
                                   for  the  resource  type.  If  the  body is
                                   larger than the limit, the underlying  host
                                   service only forwards the contents that are
                                   below the limit to WAF for inspection.

                                   The default limit is 8 KB (8,192 kilobytes)
                                   for  regional  resources  and 16 KB (16,384
                                   kilobytes)  for  CloudFront  distributions.
                                   For  CloudFront  distributions, you can in-
                                   crease the limit in the  web  ACL  Associa-
                                   tionConfig   ,  for  additional  processing
                                   fees.

                                   The options for oversize handling  are  the
                                   following:

                                   o CONTINUE  -  Inspect  the  available body
                                     contents normally, according to the  rule
                                     inspection criteria.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                                   You can combine the MATCH or NO_MATCH  set-
                                   tings  for oversize handling with your rule
                                   and web ACL action settings,  so  that  you
                                   block  any  request  whose body is over the
                                   limit.

                                   Default: CONTINUE

                            Method -> (structure)
                               Inspect the HTTP method. The  method  indicates
                               the  type of operation that the request is ask-
                               ing the origin to perform.

                            JsonBody -> (structure)
                               Inspect the request body as JSON.  The  request
                               body  immediately  follows the request headers.
                               This is the part of a request that contains any
                               additional  data  that you want to send to your
                               web server as the HTTP request  body,  such  as
                               data from a form.

                               A  limited  amount  of the request body is for-
                               warded to WAF for inspection by the  underlying
                               host service. For regional resources, the limit
                               is 8 KB (8,192 kilobytes)  and  for  CloudFront
                               distributions, the limit is 16 KB (16,384 kilo-
                               bytes). For CloudFront distributions,  you  can
                               increase  the  limit  in the web ACL's Associa-
                               tionConfig , for additional processing fees.

                               For information about how to  handle  oversized
                               request bodies, see the JsonBody object config-
                               uration.

                               MatchPattern -> (structure)
                                   The patterns to look for in the JSON  body.
                                   WAF  inspects  the results of these pattern
                                   matches against the rule inspection  crite-
                                   ria.

                                   All -> (structure)
                                      Match  all  of  the  elements.  See also
                                      MatchScope in  JsonBody .

                                      You must specify either this setting  or
                                      the IncludedPaths setting, but not both.

                                   IncludedPaths -> (list)
                                      Match  only the specified include paths.
                                      See also MatchScope in  JsonBody .

                                      Provide the  include  paths  using  JSON
                                      Pointer  syntax. For example, "Included-
                                      Paths": ["/dogs/0/name", "/dogs/1/name"]
                                      . For information about this syntax, see
                                      the  Internet  Engineering  Task   Force
                                      (IETF)  documentation  JavaScript Object
                                      Notation (JSON) Pointer .

                                      You must specify either this setting  or
                                      the All setting, but not both.

                                      NOTE:
                                          Don't use this option to include all
                                          paths. Instead, use the All setting.

                                      (string)

                               MatchScope -> (string)
                                   The parts of the JSON to match against  us-
                                   ing the MatchPattern . If you specify All ,
                                   WAF matches against keys and values.

                               InvalidFallbackBehavior -> (string)
                                   What WAF should do  if  it  fails  to  com-
                                   pletely  parse  the  JSON body. The options
                                   are the following:

                                   o EVALUATE_AS_STRING - Inspect the body  as
                                     plain  text.  WAF applies the text trans-
                                     formations and inspection  criteria  that
                                     you  defined  for  the JSON inspection to
                                     the body text string.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                                   If  you  don't  provide  this  setting, WAF
                                   parses and evaluates the content only up to
                                   the  first  parsing failure that it encoun-
                                   ters.

                                   WAF does its best to parse the entire  JSON
                                   body,  but might be forced to stop for rea-
                                   sons such as invalid characters,  duplicate
                                   keys,  truncation,  and  any  content whose
                                   root node isn't an object or an array.

                                   WAF parses the JSON in the following  exam-
                                   ples as two valid key, value pairs:

                                   o Missing                            comma:
                                     {"key1":"value1""key2":"value2"}

                                   o Missing                            colon:
                                     {"key1":"value1","key2""value2"}

                                   o Extra                             colons:
                                     {"key1"::"value1","key2""value2"}

                               OversizeHandling -> (string)
                                   What WAF should do if the  body  is  larger
                                   than  WAF can inspect. WAF does not support
                                   inspecting the entire contents of  the  web
                                   request  body if the body exceeds the limit
                                   for the  resource  type.  If  the  body  is
                                   larger  than the limit, the underlying host
                                   service only forwards the contents that are
                                   below the limit to WAF for inspection.

                                   The default limit is 8 KB (8,192 kilobytes)
                                   for regional resources and  16  KB  (16,384
                                   kilobytes)  for  CloudFront  distributions.
                                   For CloudFront distributions, you  can  in-
                                   crease  the  limit  in the web ACL Associa-
                                   tionConfig  ,  for  additional   processing
                                   fees.

                                   The  options  for oversize handling are the
                                   following:

                                   o CONTINUE -  Inspect  the  available  body
                                     contents  normally, according to the rule
                                     inspection criteria.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                                   You  can combine the MATCH or NO_MATCH set-
                                   tings for oversize handling with your  rule
                                   and  web  ACL  action settings, so that you
                                   block any request whose body  is  over  the
                                   limit.

                                   Default: CONTINUE

                            Headers -> (structure)
                               Inspect the request headers. You must configure
                               scope and pattern matching filters in the Head-
                               ers object, to define the set of headers to and
                               the parts of the headers that WAF inspects.

                               Only the first 8 KB (8192 bytes) of a request's
                               headers and only the first 200 headers are for-
                               warded to WAF for inspection by the  underlying
                               host  service. You must configure how to handle
                               any oversize header content in the Headers  ob-
                               ject.  WAF applies the pattern matching filters
                               to the headers that it receives from the under-
                               lying host service.

                               MatchPattern -> (structure)
                                   The filter to use to identify the subset of
                                   headers to inspect in a web request.

                                   You must specify exactly one  setting:  ei-
                                   ther  All  , IncludedHeaders , or Excluded-
                                   Headers .

                                   Example JSON: "MatchPattern": {  "Excluded-
                                   Headers":    {"KeyToExclude1",    "KeyToEx-
                                   clude2"} }

                                   All -> (structure)
                                      Inspect all headers.

                                   IncludedHeaders -> (list)
                                      Inspect only the headers that have a key
                                      that  matches  one of the strings speci-
                                      fied here.

                                      (string)

                                   ExcludedHeaders -> (list)
                                      Inspect  only  the  headers  whose  keys
                                      don't match any of the strings specified
                                      here.

                                      (string)

                               MatchScope -> (string)
                                   The parts of the headers to match with  the
                                   rule  inspection  criteria.  If you specify
                                   All , WAF inspects both keys and values.

                               OversizeHandling -> (string)
                                   What WAF should do if the  headers  of  the
                                   request  are  more  numerous or larger than
                                   WAF can inspect. WAF does not  support  in-
                                   specting  the  entire  contents  of request
                                   headers when they exceed 8 KB (8192  bytes)
                                   or  200  total headers. The underlying host
                                   service forwards a maximum of  200  headers
                                   and at most 8 KB of header contents to WAF.

                                   The  options  for oversize handling are the
                                   following:

                                   o CONTINUE - Inspect the available  headers
                                     normally,  according  to the rule inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                            Cookies -> (structure)
                               Inspect the request cookies. You must configure
                               scope and pattern matching filters in the Cook-
                               ies  object,  to  define the set of cookies and
                               the parts of the cookies that WAF inspects.

                               Only the first 8 KB (8192 bytes) of a request's
                               cookies and only the first 200 cookies are for-
                               warded to WAF for inspection by the  underlying
                               host  service. You must configure how to handle
                               any oversize cookie content in the Cookies  ob-
                               ject.  WAF applies the pattern matching filters
                               to the cookies that it receives from the under-
                               lying host service.

                               MatchPattern -> (structure)
                                   The filter to use to identify the subset of
                                   cookies to inspect in a web request.

                                   You must specify exactly one  setting:  ei-
                                   ther  All  , IncludedCookies , or Excluded-
                                   Cookies .

                                   Example JSON: "MatchPattern": {  "Included-
                                   Cookies":    {"KeyToInclude1",    "KeyToIn-
                                   clude2", "KeyToInclude3"} }

                                   All -> (structure)
                                      Inspect all cookies.

                                   IncludedCookies -> (list)
                                      Inspect only the cookies that have a key
                                      that  matches  one of the strings speci-
                                      fied here.

                                      (string)

                                   ExcludedCookies -> (list)
                                      Inspect  only  the  cookies  whose  keys
                                      don't match any of the strings specified
                                      here.

                                      (string)

                               MatchScope -> (string)
                                   The parts of the cookies  to  inspect  with
                                   the  rule inspection criteria. If you spec-
                                   ify All , WAF inspects both keys  and  val-
                                   ues.

                               OversizeHandling -> (string)
                                   What  WAF  should  do if the cookies of the
                                   request are more numerous  or  larger  than
                                   WAF  can  inspect. WAF does not support in-
                                   specting the  entire  contents  of  request
                                   cookies  when they exceed 8 KB (8192 bytes)
                                   or 200 total cookies. The  underlying  host
                                   service  forwards  a maximum of 200 cookies
                                   and at most 8 KB of cookie contents to WAF.

                                   The options for oversize handling  are  the
                                   following:

                                   o CONTINUE  - Inspect the available cookies
                                     normally, according to the  rule  inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                            HeaderOrder -> (structure)
                               Inspect a string containing the list of the re-
                               quest's header names, ordered as they appear in
                               the web request that WAF receives  for  inspec-
                               tion.  WAF  generates  the string and then uses
                               that as the field to match component in its in-
                               spection. WAF separates the header names in the
                               string using commas and no added spaces.

                               Matches against the  header  order  string  are
                               case insensitive.

                               OversizeHandling -> (string)
                                   What  WAF  should  do if the headers of the
                                   request are more numerous  or  larger  than
                                   WAF  can  inspect. WAF does not support in-
                                   specting the  entire  contents  of  request
                                   headers  when they exceed 8 KB (8192 bytes)
                                   or 200 total headers. The  underlying  host
                                   service  forwards  a maximum of 200 headers
                                   and at most 8 KB of header contents to WAF.

                                   The options for oversize handling  are  the
                                   following:

                                   o CONTINUE  - Inspect the available headers
                                     normally, according to the  rule  inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                        TextTransformations -> (list)
                            Text transformations eliminate some of the unusual
                            formatting  that  attackers use in web requests in
                            an effort to bypass  detection.  Text  transforma-
                            tions are used in rule match statements, to trans-
                            form the FieldToMatch request component before in-
                            specting  it,  and they're used in rate-based rule
                            statements, to transform request components before
                            using  them  as  custom  aggregation  keys. If you
                            specify one or more transformations to apply,  WAF
                            performs all transformations on the specified con-
                            tent, starting from the lowest  priority  setting,
                            and then uses the component contents.

                            (structure)
                               Text  transformations eliminate some of the un-
                               usual formatting that attackers use in web  re-
                               quests in an effort to bypass detection.

                               Priority -> (integer)
                                   Sets the relative processing order for mul-
                                   tiple transformations.  WAF  processes  all
                                   transformations,  from  lowest  priority to
                                   highest, before inspecting the  transformed
                                   content.  The  priorities  don't need to be
                                   consecutive, but they must all  be  differ-
                                   ent.

                               Type -> (string)
                                   You  can  specify the following transforma-
                                   tion types:
                                      BASE64_DECODE - Decode a Base64 -encoded
                                      string.

                                      BASE64_DECODE_EXT - Decode a Base64 -en-
                                      coded string, but use a forgiving imple-
                                      mentation  that  ignores characters that
                                      aren't valid.

                                      CMD_LINE - Command-line transformations.
                                      These are helpful in reducing effective-
                                      ness of attackers who inject an  operat-
                                      ing  system command-line command and use
                                      unusual formatting to disguise  some  or
                                      all of the command.

                                   o Delete the following characters: \ " ' ^

                                   o Delete  spaces before the following char-
                                     acters: / (

                                   o Replace the following characters  with  a
                                     space: , ;

                                   o Replace multiple spaces with one space

                                   o Convert uppercase letters (A-Z) to lower-
                                     case (a-z)
                                      COMPRESS_WHITE_SPACE  -  Replace   these
                                      characters with a space character (deci-
                                      mal 32):

                                   o \f , formfeed, decimal 12

                                   o \t , tab, decimal 9

                                   o \n , newline, decimal 10

                                   o \r , carriage return, decimal 13

                                   o \v , vertical tab, decimal 11

                                   o Non-breaking space, decimal 160
                                      COMPRESS_WHITE_SPACE also replaces  mul-
                                      tiple spaces with one space.

                                      CSS_DECODE - Decode characters that were
                                      encoded using CSS 2.x escape rules  syn-
                                      data.html#characters   .  This  function
                                      uses up to two  bytes  in  the  decoding
                                      process, so it can help to uncover ASCII
                                      characters that were encoded  using  CSS
                                      encoding  that  wouldnt typically be en-
                                      coded. It's also  useful  in  countering
                                      evasion,  which  is  a  combination of a
                                      backslash  and  non-hexadecimal  charac-
                                      ters. For example, ja\vascript for java-
                                      script.

                                      ESCAPE_SEQ_DECODE - Decode the following
                                      ANSI  C escape sequences: \a , \b , \f ,
                                      \n , \r , \t , \v , \\ , \? , \' , \"  ,
                                      \xHH  (hexadecimal),  \0OOO (octal). En-
                                      codings that aren't valid remain in  the
                                      output.

                                      HEX_DECODE - Decode a string of hexadec-
                                      imal characters into a binary.

                                      HTML_ENTITY_DECODE  -  Replace  HTML-en-
                                      coded  characters with unencoded charac-
                                      ters. HTML_ENTITY_DECODE performs  these
                                      operations:

                                   o Replaces (ampersand)quot; with "

                                   o Replaces    (ampersand)nbsp;    with    a
                                     non-breaking space, decimal 160

                                   o Replaces  (ampersand)lt;  with  a   "less
                                     than" symbol

                                   o Replaces (ampersand)gt; with >

                                   o Replaces  characters that are represented
                                     in hexadecimal format, (ampersand)#xhhhh;
                                     , with the corresponding characters

                                   o Replaces  characters that are represented
                                     in decimal  format,  (ampersand)#nnnn;  ,
                                     with the corresponding characters
                                      JS_DECODE - Decode JavaScript escape se-
                                      quences. If a \  u  HHHH code is in  the
                                      full-width ASCII code range of FF01-FF5E
                                      , then the higher byte is used to detect
                                      and  adjust the lower byte. If not, only
                                      the lower byte is used  and  the  higher
                                      byte  is zeroed, causing a possible loss
                                      of information.

                                      LOWERCASE -  Convert  uppercase  letters
                                      (A-Z) to lowercase (a-z).

                                      MD5  -  Calculate  an  MD5 hash from the
                                      data in the input. The computed hash  is
                                      in a raw binary form.

                                      NONE  -  Specify  NONE if you don't want
                                      any text transformations.

                                      NORMALIZE_PATH   -    Remove    multiple
                                      slashes,  directory self-references, and
                                      directory back-references that  are  not
                                      at  the  beginning  of the input from an
                                      input string.

                                      NORMALIZE_PATH_WIN - This is the same as
                                      NORMALIZE_PATH   ,  but  first  converts
                                      backslash characters to forward slashes.

                                      REMOVE_NULLS -  Remove  all  NULL  bytes
                                      from the input.

                                      REPLACE_COMMENTS  -  Replace each occur-
                                      rence of a C-style comment (/* ... */  )
                                      with  a  single space. Multiple consecu-
                                      tive occurrences are not compressed. Un-
                                      terminated  comments  are  also replaced
                                      with a space (ASCII  0x20).  However,  a
                                      standalone  termination of a comment (*/
                                      ) is not acted upon.

                                      REPLACE_NULLS - Replace  NULL  bytes  in
                                      the  input  with space characters (ASCII
                                      0x20 ).

                                      SQL_HEX_DECODE - Decode  SQL  hex  data.
                                      Example  (0x414243  ) will be decoded to
                                      (ABC ).

                                      URL_DECODE - Decode a URL-encoded value.

                                      URL_DECODE_UNI - Like URL_DECODE  ,  but
                                      with  support  for Microsoft-specific %u
                                      encoding.  If  the  code   is   in   the
                                      full-width ASCII code range of FF01-FF5E
                                      , the higher byte is used to detect  and
                                      adjust  the  lower byte. Otherwise, only
                                      the lower byte is used  and  the  higher
                                      byte is zeroed.

                                      UTF8_TO_UNICODE   -  Convert  all  UTF-8
                                      character  sequences  to  Unicode.  This
                                      helps  input normalization, and minimiz-
                                      ing false-positives and  false-negatives
                                      for non-English languages.

                        SensitivityLevel -> (string)
                            The  sensitivity  that  you want WAF to use to in-
                            spect for SQL injection attacks.
                               HIGH detects more attacks, but  might  generate
                               more  false  positives,  especially if your web
                               requests frequently  contain  unusual  strings.
                               For  information about identifying and mitigat-
                               ing false positives, see Testing and tuning  in
                               the WAF Developer Guide .

                               LOW  is generally a better choice for resources
                               that already have other protections against SQL
                               injection  attacks or that have a low tolerance
                               for false positives.

                            Default: LOW

                     XssMatchStatement -> (structure)
                        A rule statement that inspects for cross-site  script-
                        ing  (XSS)  attacks. In XSS attacks, the attacker uses
                        vulnerabilities in a benign website as  a  vehicle  to
                        inject malicious client-site scripts into other legit-
                        imate web browsers.

                        FieldToMatch -> (structure)
                            The part of the web request that you want  WAF  to
                            inspect.

                            SingleHeader -> (structure)
                               Inspect  a  single  header. Provide the name of
                               the header to inspect, for example,  User-Agent
                               or Referer . This setting isn't case sensitive.

                               Example   JSON:   "SingleHeader":   {   "Name":
                               "haystack" }

                               Alternately, you can  filter  and  inspect  all
                               headers with the Headers  FieldToMatch setting.

                               Name -> (string)
                                   The name of the query header to inspect.

                            SingleQueryArgument -> (structure)
                               Inspect  a  single  query argument. Provide the
                               name of the query argument to inspect, such  as
                               UserName or SalesRegion . The name can be up to
                               30 characters long and isn't case sensitive.

                               Example JSON: "SingleQueryArgument": {  "Name":
                               "myArgument" }

                               Name -> (string)
                                   The name of the query argument to inspect.

                            AllQueryArguments -> (structure)
                               Inspect all query arguments.

                            UriPath -> (structure)
                               Inspect  the request URI path. This is the part
                               of the web request that identifies a  resource,
                               for example, /images/daily-ad.jpg .

                            QueryString -> (structure)
                               Inspect the query string. This is the part of a
                               URL that appears after a ? character, if any.

                            Body -> (structure)
                               Inspect the request body as plain text. The re-
                               quest  body  immediately  follows  the  request
                               headers. This is the part  of  a  request  that
                               contains  any  additional data that you want to
                               send to your web server  as  the  HTTP  request
                               body, such as data from a form.

                               A  limited  amount  of the request body is for-
                               warded to WAF for inspection by the  underlying
                               host service. For regional resources, the limit
                               is 8 KB (8,192 kilobytes)  and  for  CloudFront
                               distributions, the limit is 16 KB (16,384 kilo-
                               bytes). For CloudFront distributions,  you  can
                               increase  the  limit  in the web ACL's Associa-
                               tionConfig , for additional processing fees.

                               For information about how to  handle  oversized
                               request  bodies, see the Body object configura-
                               tion.

                               OversizeHandling -> (string)
                                   What WAF should do if the  body  is  larger
                                   than  WAF can inspect. WAF does not support
                                   inspecting the entire contents of  the  web
                                   request  body if the body exceeds the limit
                                   for the  resource  type.  If  the  body  is
                                   larger  than the limit, the underlying host
                                   service only forwards the contents that are
                                   below the limit to WAF for inspection.

                                   The default limit is 8 KB (8,192 kilobytes)
                                   for regional resources and  16  KB  (16,384
                                   kilobytes)  for  CloudFront  distributions.
                                   For CloudFront distributions, you  can  in-
                                   crease  the  limit  in the web ACL Associa-
                                   tionConfig  ,  for  additional   processing
                                   fees.

                                   The  options  for oversize handling are the
                                   following:

                                   o CONTINUE -  Inspect  the  available  body
                                     contents  normally, according to the rule
                                     inspection criteria.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                                   You  can combine the MATCH or NO_MATCH set-
                                   tings for oversize handling with your  rule
                                   and  web  ACL  action settings, so that you
                                   block any request whose body  is  over  the
                                   limit.

                                   Default: CONTINUE

                            Method -> (structure)
                               Inspect  the  HTTP method. The method indicates
                               the type of operation that the request is  ask-
                               ing the origin to perform.

                            JsonBody -> (structure)
                               Inspect  the  request body as JSON. The request
                               body immediately follows the  request  headers.
                               This is the part of a request that contains any
                               additional data that you want to send  to  your
                               web  server  as  the HTTP request body, such as
                               data from a form.

                               A limited amount of the request  body  is  for-
                               warded  to WAF for inspection by the underlying
                               host service. For regional resources, the limit
                               is  8  KB  (8,192 kilobytes) and for CloudFront
                               distributions, the limit is 16 KB (16,384 kilo-
                               bytes).  For  CloudFront distributions, you can
                               increase the limit in the  web  ACL's  Associa-
                               tionConfig , for additional processing fees.

                               For  information  about how to handle oversized
                               request bodies, see the JsonBody object config-
                               uration.

                               MatchPattern -> (structure)
                                   The  patterns to look for in the JSON body.
                                   WAF inspects the results of  these  pattern
                                   matches  against the rule inspection crite-
                                   ria.

                                   All -> (structure)
                                      Match all  of  the  elements.  See  also
                                      MatchScope in  JsonBody .

                                      You  must specify either this setting or
                                      the IncludedPaths setting, but not both.

                                   IncludedPaths -> (list)
                                      Match only the specified include  paths.
                                      See also MatchScope in  JsonBody .

                                      Provide  the  include  paths  using JSON
                                      Pointer syntax. For example,  "Included-
                                      Paths": ["/dogs/0/name", "/dogs/1/name"]
                                      . For information about this syntax, see
                                      the   Internet  Engineering  Task  Force
                                      (IETF) documentation  JavaScript  Object
                                      Notation (JSON) Pointer .

                                      You  must specify either this setting or
                                      the All setting, but not both.

                                      NOTE:
                                          Don't use this option to include all
                                          paths. Instead, use the All setting.

                                      (string)

                               MatchScope -> (string)
                                   The  parts of the JSON to match against us-
                                   ing the MatchPattern . If you specify All ,
                                   WAF matches against keys and values.

                               InvalidFallbackBehavior -> (string)
                                   What  WAF  should  do  if  it fails to com-
                                   pletely parse the JSON  body.  The  options
                                   are the following:

                                   o EVALUATE_AS_STRING  - Inspect the body as
                                     plain text. WAF applies the  text  trans-
                                     formations  and  inspection criteria that
                                     you defined for the  JSON  inspection  to
                                     the body text string.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                                   If you  don't  provide  this  setting,  WAF
                                   parses and evaluates the content only up to
                                   the first parsing failure that  it  encoun-
                                   ters.

                                   WAF  does its best to parse the entire JSON
                                   body, but might be forced to stop for  rea-
                                   sons  such as invalid characters, duplicate
                                   keys, truncation,  and  any  content  whose
                                   root node isn't an object or an array.

                                   WAF  parses the JSON in the following exam-
                                   ples as two valid key, value pairs:

                                   o Missing                            comma:
                                     {"key1":"value1""key2":"value2"}

                                   o Missing                            colon:
                                     {"key1":"value1","key2""value2"}

                                   o Extra                             colons:
                                     {"key1"::"value1","key2""value2"}

                               OversizeHandling -> (string)
                                   What  WAF  should  do if the body is larger
                                   than WAF can inspect. WAF does not  support
                                   inspecting  the  entire contents of the web
                                   request body if the body exceeds the  limit
                                   for  the  resource  type.  If  the  body is
                                   larger than the limit, the underlying  host
                                   service only forwards the contents that are
                                   below the limit to WAF for inspection.

                                   The default limit is 8 KB (8,192 kilobytes)
                                   for  regional  resources  and 16 KB (16,384
                                   kilobytes)  for  CloudFront  distributions.
                                   For  CloudFront  distributions, you can in-
                                   crease the limit in the  web  ACL  Associa-
                                   tionConfig   ,  for  additional  processing
                                   fees.

                                   The options for oversize handling  are  the
                                   following:

                                   o CONTINUE  -  Inspect  the  available body
                                     contents normally, according to the  rule
                                     inspection criteria.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                                   You can combine the MATCH or NO_MATCH  set-
                                   tings  for oversize handling with your rule
                                   and web ACL action settings,  so  that  you
                                   block  any  request  whose body is over the
                                   limit.

                                   Default: CONTINUE

                            Headers -> (structure)
                               Inspect the request headers. You must configure
                               scope and pattern matching filters in the Head-
                               ers object, to define the set of headers to and
                               the parts of the headers that WAF inspects.

                               Only the first 8 KB (8192 bytes) of a request's
                               headers and only the first 200 headers are for-
                               warded  to WAF for inspection by the underlying
                               host service. You must configure how to  handle
                               any  oversize header content in the Headers ob-
                               ject. WAF applies the pattern matching  filters
                               to the headers that it receives from the under-
                               lying host service.

                               MatchPattern -> (structure)
                                   The filter to use to identify the subset of
                                   headers to inspect in a web request.

                                   You  must  specify exactly one setting: ei-
                                   ther All , IncludedHeaders ,  or  Excluded-
                                   Headers .

                                   Example  JSON: "MatchPattern": { "Excluded-
                                   Headers":    {"KeyToExclude1",    "KeyToEx-
                                   clude2"} }

                                   All -> (structure)
                                      Inspect all headers.

                                   IncludedHeaders -> (list)
                                      Inspect only the headers that have a key
                                      that matches one of the  strings  speci-
                                      fied here.

                                      (string)

                                   ExcludedHeaders -> (list)
                                      Inspect  only  the  headers  whose  keys
                                      don't match any of the strings specified
                                      here.

                                      (string)

                               MatchScope -> (string)
                                   The  parts of the headers to match with the
                                   rule inspection criteria.  If  you  specify
                                   All , WAF inspects both keys and values.

                               OversizeHandling -> (string)
                                   What  WAF  should  do if the headers of the
                                   request are more numerous  or  larger  than
                                   WAF  can  inspect. WAF does not support in-
                                   specting the  entire  contents  of  request
                                   headers  when they exceed 8 KB (8192 bytes)
                                   or 200 total headers. The  underlying  host
                                   service  forwards  a maximum of 200 headers
                                   and at most 8 KB of header contents to WAF.

                                   The options for oversize handling  are  the
                                   following:

                                   o CONTINUE  - Inspect the available headers
                                     normally, according to the  rule  inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                            Cookies -> (structure)
                               Inspect the request cookies. You must configure
                               scope and pattern matching filters in the Cook-
                               ies object, to define the set  of  cookies  and
                               the parts of the cookies that WAF inspects.

                               Only the first 8 KB (8192 bytes) of a request's
                               cookies and only the first 200 cookies are for-
                               warded  to WAF for inspection by the underlying
                               host service. You must configure how to  handle
                               any  oversize cookie content in the Cookies ob-
                               ject. WAF applies the pattern matching  filters
                               to the cookies that it receives from the under-
                               lying host service.

                               MatchPattern -> (structure)
                                   The filter to use to identify the subset of
                                   cookies to inspect in a web request.

                                   You  must  specify exactly one setting: ei-
                                   ther All , IncludedCookies ,  or  Excluded-
                                   Cookies .

                                   Example  JSON: "MatchPattern": { "Included-
                                   Cookies":    {"KeyToInclude1",    "KeyToIn-
                                   clude2", "KeyToInclude3"} }

                                   All -> (structure)
                                      Inspect all cookies.

                                   IncludedCookies -> (list)
                                      Inspect only the cookies that have a key
                                      that matches one of the  strings  speci-
                                      fied here.

                                      (string)

                                   ExcludedCookies -> (list)
                                      Inspect  only  the  cookies  whose  keys
                                      don't match any of the strings specified
                                      here.

                                      (string)

                               MatchScope -> (string)
                                   The  parts  of  the cookies to inspect with
                                   the rule inspection criteria. If you  spec-
                                   ify  All  , WAF inspects both keys and val-
                                   ues.

                               OversizeHandling -> (string)
                                   What WAF should do if the  cookies  of  the
                                   request  are  more  numerous or larger than
                                   WAF can inspect. WAF does not  support  in-
                                   specting  the  entire  contents  of request
                                   cookies when they exceed 8 KB (8192  bytes)
                                   or  200  total cookies. The underlying host
                                   service forwards a maximum of  200  cookies
                                   and at most 8 KB of cookie contents to WAF.

                                   The  options  for oversize handling are the
                                   following:

                                   o CONTINUE - Inspect the available  cookies
                                     normally,  according  to the rule inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                            HeaderOrder -> (structure)
                               Inspect a string containing the list of the re-
                               quest's header names, ordered as they appear in
                               the  web  request that WAF receives for inspec-
                               tion. WAF generates the string  and  then  uses
                               that as the field to match component in its in-
                               spection. WAF separates the header names in the
                               string using commas and no added spaces.

                               Matches  against  the  header  order string are
                               case insensitive.

                               OversizeHandling -> (string)
                                   What WAF should do if the  headers  of  the
                                   request  are  more  numerous or larger than
                                   WAF can inspect. WAF does not  support  in-
                                   specting  the  entire  contents  of request
                                   headers when they exceed 8 KB (8192  bytes)
                                   or  200  total headers. The underlying host
                                   service forwards a maximum of  200  headers
                                   and at most 8 KB of header contents to WAF.

                                   The  options  for oversize handling are the
                                   following:

                                   o CONTINUE - Inspect the available  headers
                                     normally,  according  to the rule inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                        TextTransformations -> (list)
                            Text transformations eliminate some of the unusual
                            formatting that attackers use in web  requests  in
                            an  effort  to  bypass detection. Text transforma-
                            tions are used in rule match statements, to trans-
                            form the FieldToMatch request component before in-
                            specting it, and they're used in  rate-based  rule
                            statements, to transform request components before
                            using them as  custom  aggregation  keys.  If  you
                            specify  one or more transformations to apply, WAF
                            performs all transformations on the specified con-
                            tent,  starting  from the lowest priority setting,
                            and then uses the component contents.

                            (structure)
                               Text transformations eliminate some of the  un-
                               usual  formatting that attackers use in web re-
                               quests in an effort to bypass detection.

                               Priority -> (integer)
                                   Sets the relative processing order for mul-
                                   tiple  transformations.  WAF  processes all
                                   transformations, from  lowest  priority  to
                                   highest,  before inspecting the transformed
                                   content. The priorities don't  need  to  be
                                   consecutive,  but  they must all be differ-
                                   ent.

                               Type -> (string)
                                   You can specify the  following  transforma-
                                   tion types:
                                      BASE64_DECODE - Decode a Base64 -encoded
                                      string.

                                      BASE64_DECODE_EXT - Decode a Base64 -en-
                                      coded string, but use a forgiving imple-
                                      mentation that ignores  characters  that
                                      aren't valid.

                                      CMD_LINE - Command-line transformations.
                                      These are helpful in reducing effective-
                                      ness  of attackers who inject an operat-
                                      ing system command-line command and  use
                                      unusual  formatting  to disguise some or
                                      all of the command.

                                   o Delete the following characters: \ " ' ^

                                   o Delete spaces before the following  char-
                                     acters: / (

                                   o Replace  the  following characters with a
                                     space: , ;

                                   o Replace multiple spaces with one space

                                   o Convert uppercase letters (A-Z) to lower-
                                     case (a-z)
                                      COMPRESS_WHITE_SPACE   -  Replace  these
                                      characters with a space character (deci-
                                      mal 32):

                                   o \f , formfeed, decimal 12

                                   o \t , tab, decimal 9

                                   o \n , newline, decimal 10

                                   o \r , carriage return, decimal 13

                                   o \v , vertical tab, decimal 11

                                   o Non-breaking space, decimal 160
                                      COMPRESS_WHITE_SPACE  also replaces mul-
                                      tiple spaces with one space.

                                      CSS_DECODE - Decode characters that were
                                      encoded  using CSS 2.x escape rules syn-
                                      data.html#characters  .  This   function
                                      uses  up  to  two  bytes in the decoding
                                      process, so it can help to uncover ASCII
                                      characters  that  were encoded using CSS
                                      encoding that wouldnt typically  be  en-
                                      coded.  It's  also  useful in countering
                                      evasion, which is  a  combination  of  a
                                      backslash  and  non-hexadecimal  charac-
                                      ters. For example, ja\vascript for java-
                                      script.

                                      ESCAPE_SEQ_DECODE - Decode the following
                                      ANSI C escape sequences: \a , \b , \f  ,
                                      \n  , \r , \t , \v , \\ , \? , \' , \" ,
                                      \xHH (hexadecimal), \0OOO  (octal).  En-
                                      codings  that aren't valid remain in the
                                      output.

                                      HEX_DECODE - Decode a string of hexadec-
                                      imal characters into a binary.

                                      HTML_ENTITY_DECODE  -  Replace  HTML-en-
                                      coded characters with unencoded  charac-
                                      ters.  HTML_ENTITY_DECODE performs these
                                      operations:

                                   o Replaces (ampersand)quot; with "

                                   o Replaces    (ampersand)nbsp;    with    a
                                     non-breaking space, decimal 160

                                   o Replaces   (ampersand)lt;  with  a  "less
                                     than" symbol

                                   o Replaces (ampersand)gt; with >

                                   o Replaces characters that are  represented
                                     in hexadecimal format, (ampersand)#xhhhh;
                                     , with the corresponding characters

                                   o Replaces characters that are  represented
                                     in  decimal  format,  (ampersand)#nnnn; ,
                                     with the corresponding characters
                                      JS_DECODE - Decode JavaScript escape se-
                                      quences.  If a \  u  HHHH code is in the
                                      full-width ASCII code range of FF01-FF5E
                                      , then the higher byte is used to detect
                                      and adjust the lower byte. If not,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed, causing a possible  loss
                                      of information.

                                      LOWERCASE  -  Convert  uppercase letters
                                      (A-Z) to lowercase (a-z).

                                      MD5 - Calculate an  MD5  hash  from  the
                                      data  in the input. The computed hash is
                                      in a raw binary form.

                                      NONE - Specify NONE if  you  don't  want
                                      any text transformations.

                                      NORMALIZE_PATH    -    Remove   multiple
                                      slashes, directory self-references,  and
                                      directory  back-references  that are not
                                      at the beginning of the  input  from  an
                                      input string.

                                      NORMALIZE_PATH_WIN - This is the same as
                                      NORMALIZE_PATH  ,  but  first   converts
                                      backslash characters to forward slashes.

                                      REMOVE_NULLS  -  Remove  all  NULL bytes
                                      from the input.

                                      REPLACE_COMMENTS - Replace  each  occur-
                                      rence  of a C-style comment (/* ... */ )
                                      with a single space.  Multiple  consecu-
                                      tive occurrences are not compressed. Un-
                                      terminated comments  are  also  replaced
                                      with  a  space  (ASCII 0x20). However, a
                                      standalone termination of a comment  (*/
                                      ) is not acted upon.

                                      REPLACE_NULLS  -  Replace  NULL bytes in
                                      the input with space  characters  (ASCII
                                      0x20 ).

                                      SQL_HEX_DECODE  -  Decode  SQL hex data.
                                      Example (0x414243 ) will be  decoded  to
                                      (ABC ).

                                      URL_DECODE - Decode a URL-encoded value.

                                      URL_DECODE_UNI  -  Like URL_DECODE , but
                                      with support for  Microsoft-specific  %u
                                      encoding.   If   the   code  is  in  the
                                      full-width ASCII code range of FF01-FF5E
                                      ,  the higher byte is used to detect and
                                      adjust the lower byte.  Otherwise,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed.

                                      UTF8_TO_UNICODE  -  Convert  all   UTF-8
                                      character  sequences  to  Unicode.  This
                                      helps input normalization, and  minimiz-
                                      ing  false-positives and false-negatives
                                      for non-English languages.

                     SizeConstraintStatement -> (structure)
                        A rule statement  that  compares  a  number  of  bytes
                        against  the size of a request component, using a com-
                        parison operator, such as greater  than  (>)  or  less
                        than  (<).  For example, you can use a size constraint
                        statement to look for query strings  that  are  longer
                        than 100 bytes.

                        If  you configure WAF to inspect the request body, WAF
                        inspects only the number of bytes of the  body  up  to
                        the  limit  for  the web ACL. By default, for regional
                        web ACLs, this limit is 8 KB (8,192 kilobytes) and for
                        CloudFront web ACLs, this limit is 16 KB (16,384 kilo-
                        bytes). For CloudFront web ACLs, you can increase  the
                        limit  in  the  web  ACL AssociationConfig , for addi-
                        tional fees. If you know that  the  request  body  for
                        your  web  requests should never exceed the inspection
                        limit, you could use a size  constraint  statement  to
                        block requests that have a larger request body size.

                        If you choose URI for the value of Part of the request
                        to filter on, the slash (/) in the URI counts  as  one
                        character.  For  example,  the  URI  /logo.jpg is nine
                        characters long.

                        FieldToMatch -> (structure)
                            The part of the web request that you want  WAF  to
                            inspect.

                            SingleHeader -> (structure)
                               Inspect  a  single  header. Provide the name of
                               the header to inspect, for example,  User-Agent
                               or Referer . This setting isn't case sensitive.

                               Example   JSON:   "SingleHeader":   {   "Name":
                               "haystack" }

                               Alternately, you can  filter  and  inspect  all
                               headers with the Headers  FieldToMatch setting.

                               Name -> (string)
                                   The name of the query header to inspect.

                            SingleQueryArgument -> (structure)
                               Inspect  a  single  query argument. Provide the
                               name of the query argument to inspect, such  as
                               UserName or SalesRegion . The name can be up to
                               30 characters long and isn't case sensitive.

                               Example JSON: "SingleQueryArgument": {  "Name":
                               "myArgument" }

                               Name -> (string)
                                   The name of the query argument to inspect.

                            AllQueryArguments -> (structure)
                               Inspect all query arguments.

                            UriPath -> (structure)
                               Inspect  the request URI path. This is the part
                               of the web request that identifies a  resource,
                               for example, /images/daily-ad.jpg .

                            QueryString -> (structure)
                               Inspect the query string. This is the part of a
                               URL that appears after a ? character, if any.

                            Body -> (structure)
                               Inspect the request body as plain text. The re-
                               quest  body  immediately  follows  the  request
                               headers. This is the part  of  a  request  that
                               contains  any  additional data that you want to
                               send to your web server  as  the  HTTP  request
                               body, such as data from a form.

                               A  limited  amount  of the request body is for-
                               warded to WAF for inspection by the  underlying
                               host service. For regional resources, the limit
                               is 8 KB (8,192 kilobytes)  and  for  CloudFront
                               distributions, the limit is 16 KB (16,384 kilo-
                               bytes). For CloudFront distributions,  you  can
                               increase  the  limit  in the web ACL's Associa-
                               tionConfig , for additional processing fees.

                               For information about how to  handle  oversized
                               request  bodies, see the Body object configura-
                               tion.

                               OversizeHandling -> (string)
                                   What WAF should do if the  body  is  larger
                                   than  WAF can inspect. WAF does not support
                                   inspecting the entire contents of  the  web
                                   request  body if the body exceeds the limit
                                   for the  resource  type.  If  the  body  is
                                   larger  than the limit, the underlying host
                                   service only forwards the contents that are
                                   below the limit to WAF for inspection.

                                   The default limit is 8 KB (8,192 kilobytes)
                                   for regional resources and  16  KB  (16,384
                                   kilobytes)  for  CloudFront  distributions.
                                   For CloudFront distributions, you  can  in-
                                   crease  the  limit  in the web ACL Associa-
                                   tionConfig  ,  for  additional   processing
                                   fees.

                                   The  options  for oversize handling are the
                                   following:

                                   o CONTINUE -  Inspect  the  available  body
                                     contents  normally, according to the rule
                                     inspection criteria.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                                   You  can combine the MATCH or NO_MATCH set-
                                   tings for oversize handling with your  rule
                                   and  web  ACL  action settings, so that you
                                   block any request whose body  is  over  the
                                   limit.

                                   Default: CONTINUE

                            Method -> (structure)
                               Inspect  the  HTTP method. The method indicates
                               the type of operation that the request is  ask-
                               ing the origin to perform.

                            JsonBody -> (structure)
                               Inspect  the  request body as JSON. The request
                               body immediately follows the  request  headers.
                               This is the part of a request that contains any
                               additional data that you want to send  to  your
                               web  server  as  the HTTP request body, such as
                               data from a form.

                               A limited amount of the request  body  is  for-
                               warded  to WAF for inspection by the underlying
                               host service. For regional resources, the limit
                               is  8  KB  (8,192 kilobytes) and for CloudFront
                               distributions, the limit is 16 KB (16,384 kilo-
                               bytes).  For  CloudFront distributions, you can
                               increase the limit in the  web  ACL's  Associa-
                               tionConfig , for additional processing fees.

                               For  information  about how to handle oversized
                               request bodies, see the JsonBody object config-
                               uration.

                               MatchPattern -> (structure)
                                   The  patterns to look for in the JSON body.
                                   WAF inspects the results of  these  pattern
                                   matches  against the rule inspection crite-
                                   ria.

                                   All -> (structure)
                                      Match all  of  the  elements.  See  also
                                      MatchScope in  JsonBody .

                                      You  must specify either this setting or
                                      the IncludedPaths setting, but not both.

                                   IncludedPaths -> (list)
                                      Match only the specified include  paths.
                                      See also MatchScope in  JsonBody .

                                      Provide  the  include  paths  using JSON
                                      Pointer syntax. For example,  "Included-
                                      Paths": ["/dogs/0/name", "/dogs/1/name"]
                                      . For information about this syntax, see
                                      the   Internet  Engineering  Task  Force
                                      (IETF) documentation  JavaScript  Object
                                      Notation (JSON) Pointer .

                                      You  must specify either this setting or
                                      the All setting, but not both.

                                      NOTE:
                                          Don't use this option to include all
                                          paths. Instead, use the All setting.

                                      (string)

                               MatchScope -> (string)
                                   The  parts of the JSON to match against us-
                                   ing the MatchPattern . If you specify All ,
                                   WAF matches against keys and values.

                               InvalidFallbackBehavior -> (string)
                                   What  WAF  should  do  if  it fails to com-
                                   pletely parse the JSON  body.  The  options
                                   are the following:

                                   o EVALUATE_AS_STRING  - Inspect the body as
                                     plain text. WAF applies the  text  trans-
                                     formations  and  inspection criteria that
                                     you defined for the  JSON  inspection  to
                                     the body text string.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                                   If you  don't  provide  this  setting,  WAF
                                   parses and evaluates the content only up to
                                   the first parsing failure that  it  encoun-
                                   ters.

                                   WAF  does its best to parse the entire JSON
                                   body, but might be forced to stop for  rea-
                                   sons  such as invalid characters, duplicate
                                   keys, truncation,  and  any  content  whose
                                   root node isn't an object or an array.

                                   WAF  parses the JSON in the following exam-
                                   ples as two valid key, value pairs:

                                   o Missing                            comma:
                                     {"key1":"value1""key2":"value2"}

                                   o Missing                            colon:
                                     {"key1":"value1","key2""value2"}

                                   o Extra                             colons:
                                     {"key1"::"value1","key2""value2"}

                               OversizeHandling -> (string)
                                   What  WAF  should  do if the body is larger
                                   than WAF can inspect. WAF does not  support
                                   inspecting  the  entire contents of the web
                                   request body if the body exceeds the  limit
                                   for  the  resource  type.  If  the  body is
                                   larger than the limit, the underlying  host
                                   service only forwards the contents that are
                                   below the limit to WAF for inspection.

                                   The default limit is 8 KB (8,192 kilobytes)
                                   for  regional  resources  and 16 KB (16,384
                                   kilobytes)  for  CloudFront  distributions.
                                   For  CloudFront  distributions, you can in-
                                   crease the limit in the  web  ACL  Associa-
                                   tionConfig   ,  for  additional  processing
                                   fees.

                                   The options for oversize handling  are  the
                                   following:

                                   o CONTINUE  -  Inspect  the  available body
                                     contents normally, according to the  rule
                                     inspection criteria.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                                   You can combine the MATCH or NO_MATCH  set-
                                   tings  for oversize handling with your rule
                                   and web ACL action settings,  so  that  you
                                   block  any  request  whose body is over the
                                   limit.

                                   Default: CONTINUE

                            Headers -> (structure)
                               Inspect the request headers. You must configure
                               scope and pattern matching filters in the Head-
                               ers object, to define the set of headers to and
                               the parts of the headers that WAF inspects.

                               Only the first 8 KB (8192 bytes) of a request's
                               headers and only the first 200 headers are for-
                               warded  to WAF for inspection by the underlying
                               host service. You must configure how to  handle
                               any  oversize header content in the Headers ob-
                               ject. WAF applies the pattern matching  filters
                               to the headers that it receives from the under-
                               lying host service.

                               MatchPattern -> (structure)
                                   The filter to use to identify the subset of
                                   headers to inspect in a web request.

                                   You  must  specify exactly one setting: ei-
                                   ther All , IncludedHeaders ,  or  Excluded-
                                   Headers .

                                   Example  JSON: "MatchPattern": { "Excluded-
                                   Headers":    {"KeyToExclude1",    "KeyToEx-
                                   clude2"} }

                                   All -> (structure)
                                      Inspect all headers.

                                   IncludedHeaders -> (list)
                                      Inspect only the headers that have a key
                                      that matches one of the  strings  speci-
                                      fied here.

                                      (string)

                                   ExcludedHeaders -> (list)
                                      Inspect  only  the  headers  whose  keys
                                      don't match any of the strings specified
                                      here.

                                      (string)

                               MatchScope -> (string)
                                   The  parts of the headers to match with the
                                   rule inspection criteria.  If  you  specify
                                   All , WAF inspects both keys and values.

                               OversizeHandling -> (string)
                                   What  WAF  should  do if the headers of the
                                   request are more numerous  or  larger  than
                                   WAF  can  inspect. WAF does not support in-
                                   specting the  entire  contents  of  request
                                   headers  when they exceed 8 KB (8192 bytes)
                                   or 200 total headers. The  underlying  host
                                   service  forwards  a maximum of 200 headers
                                   and at most 8 KB of header contents to WAF.

                                   The options for oversize handling  are  the
                                   following:

                                   o CONTINUE  - Inspect the available headers
                                     normally, according to the  rule  inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                            Cookies -> (structure)
                               Inspect the request cookies. You must configure
                               scope and pattern matching filters in the Cook-
                               ies object, to define the set  of  cookies  and
                               the parts of the cookies that WAF inspects.

                               Only the first 8 KB (8192 bytes) of a request's
                               cookies and only the first 200 cookies are for-
                               warded  to WAF for inspection by the underlying
                               host service. You must configure how to  handle
                               any  oversize cookie content in the Cookies ob-
                               ject. WAF applies the pattern matching  filters
                               to the cookies that it receives from the under-
                               lying host service.

                               MatchPattern -> (structure)
                                   The filter to use to identify the subset of
                                   cookies to inspect in a web request.

                                   You  must  specify exactly one setting: ei-
                                   ther All , IncludedCookies ,  or  Excluded-
                                   Cookies .

                                   Example  JSON: "MatchPattern": { "Included-
                                   Cookies":    {"KeyToInclude1",    "KeyToIn-
                                   clude2", "KeyToInclude3"} }

                                   All -> (structure)
                                      Inspect all cookies.

                                   IncludedCookies -> (list)
                                      Inspect only the cookies that have a key
                                      that matches one of the  strings  speci-
                                      fied here.

                                      (string)

                                   ExcludedCookies -> (list)
                                      Inspect  only  the  cookies  whose  keys
                                      don't match any of the strings specified
                                      here.

                                      (string)

                               MatchScope -> (string)
                                   The  parts  of  the cookies to inspect with
                                   the rule inspection criteria. If you  spec-
                                   ify  All  , WAF inspects both keys and val-
                                   ues.

                               OversizeHandling -> (string)
                                   What WAF should do if the  cookies  of  the
                                   request  are  more  numerous or larger than
                                   WAF can inspect. WAF does not  support  in-
                                   specting  the  entire  contents  of request
                                   cookies when they exceed 8 KB (8192  bytes)
                                   or  200  total cookies. The underlying host
                                   service forwards a maximum of  200  cookies
                                   and at most 8 KB of cookie contents to WAF.

                                   The  options  for oversize handling are the
                                   following:

                                   o CONTINUE - Inspect the available  cookies
                                     normally,  according  to the rule inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                            HeaderOrder -> (structure)
                               Inspect a string containing the list of the re-
                               quest's header names, ordered as they appear in
                               the  web  request that WAF receives for inspec-
                               tion. WAF generates the string  and  then  uses
                               that as the field to match component in its in-
                               spection. WAF separates the header names in the
                               string using commas and no added spaces.

                               Matches  against  the  header  order string are
                               case insensitive.

                               OversizeHandling -> (string)
                                   What WAF should do if the  headers  of  the
                                   request  are  more  numerous or larger than
                                   WAF can inspect. WAF does not  support  in-
                                   specting  the  entire  contents  of request
                                   headers when they exceed 8 KB (8192  bytes)
                                   or  200  total headers. The underlying host
                                   service forwards a maximum of  200  headers
                                   and at most 8 KB of header contents to WAF.

                                   The  options  for oversize handling are the
                                   following:

                                   o CONTINUE - Inspect the available  headers
                                     normally,  according  to the rule inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                        ComparisonOperator -> (string)
                            The operator to use to compare the request part to
                            the size setting.

                        Size -> (long)
                            The size, in byte, to compare to the request part,
                            after any transformations.

                        TextTransformations -> (list)
                            Text transformations eliminate some of the unusual
                            formatting that attackers use in web  requests  in
                            an  effort  to  bypass detection. Text transforma-
                            tions are used in rule match statements, to trans-
                            form the FieldToMatch request component before in-
                            specting it, and they're used in  rate-based  rule
                            statements, to transform request components before
                            using them as  custom  aggregation  keys.  If  you
                            specify  one or more transformations to apply, WAF
                            performs all transformations on the specified con-
                            tent,  starting  from the lowest priority setting,
                            and then uses the component contents.

                            (structure)
                               Text transformations eliminate some of the  un-
                               usual  formatting that attackers use in web re-
                               quests in an effort to bypass detection.

                               Priority -> (integer)
                                   Sets the relative processing order for mul-
                                   tiple  transformations.  WAF  processes all
                                   transformations, from  lowest  priority  to
                                   highest,  before inspecting the transformed
                                   content. The priorities don't  need  to  be
                                   consecutive,  but  they must all be differ-
                                   ent.

                               Type -> (string)
                                   You can specify the  following  transforma-
                                   tion types:
                                      BASE64_DECODE - Decode a Base64 -encoded
                                      string.

                                      BASE64_DECODE_EXT - Decode a Base64 -en-
                                      coded string, but use a forgiving imple-
                                      mentation that ignores  characters  that
                                      aren't valid.

                                      CMD_LINE - Command-line transformations.
                                      These are helpful in reducing effective-
                                      ness  of attackers who inject an operat-
                                      ing system command-line command and  use
                                      unusual  formatting  to disguise some or
                                      all of the command.

                                   o Delete the following characters: \ " ' ^

                                   o Delete spaces before the following  char-
                                     acters: / (

                                   o Replace  the  following characters with a
                                     space: , ;

                                   o Replace multiple spaces with one space

                                   o Convert uppercase letters (A-Z) to lower-
                                     case (a-z)
                                      COMPRESS_WHITE_SPACE   -  Replace  these
                                      characters with a space character (deci-
                                      mal 32):

                                   o \f , formfeed, decimal 12

                                   o \t , tab, decimal 9

                                   o \n , newline, decimal 10

                                   o \r , carriage return, decimal 13

                                   o \v , vertical tab, decimal 11

                                   o Non-breaking space, decimal 160
                                      COMPRESS_WHITE_SPACE  also replaces mul-
                                      tiple spaces with one space.

                                      CSS_DECODE - Decode characters that were
                                      encoded  using CSS 2.x escape rules syn-
                                      data.html#characters  .  This   function
                                      uses  up  to  two  bytes in the decoding
                                      process, so it can help to uncover ASCII
                                      characters  that  were encoded using CSS
                                      encoding that wouldnt typically  be  en-
                                      coded.  It's  also  useful in countering
                                      evasion, which is  a  combination  of  a
                                      backslash  and  non-hexadecimal  charac-
                                      ters. For example, ja\vascript for java-
                                      script.

                                      ESCAPE_SEQ_DECODE - Decode the following
                                      ANSI C escape sequences: \a , \b , \f  ,
                                      \n  , \r , \t , \v , \\ , \? , \' , \" ,
                                      \xHH (hexadecimal), \0OOO  (octal).  En-
                                      codings  that aren't valid remain in the
                                      output.

                                      HEX_DECODE - Decode a string of hexadec-
                                      imal characters into a binary.

                                      HTML_ENTITY_DECODE  -  Replace  HTML-en-
                                      coded characters with unencoded  charac-
                                      ters.  HTML_ENTITY_DECODE performs these
                                      operations:

                                   o Replaces (ampersand)quot; with "

                                   o Replaces    (ampersand)nbsp;    with    a
                                     non-breaking space, decimal 160

                                   o Replaces   (ampersand)lt;  with  a  "less
                                     than" symbol

                                   o Replaces (ampersand)gt; with >

                                   o Replaces characters that are  represented
                                     in hexadecimal format, (ampersand)#xhhhh;
                                     , with the corresponding characters

                                   o Replaces characters that are  represented
                                     in  decimal  format,  (ampersand)#nnnn; ,
                                     with the corresponding characters
                                      JS_DECODE - Decode JavaScript escape se-
                                      quences.  If a \  u  HHHH code is in the
                                      full-width ASCII code range of FF01-FF5E
                                      , then the higher byte is used to detect
                                      and adjust the lower byte. If not,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed, causing a possible  loss
                                      of information.

                                      LOWERCASE  -  Convert  uppercase letters
                                      (A-Z) to lowercase (a-z).

                                      MD5 - Calculate an  MD5  hash  from  the
                                      data  in the input. The computed hash is
                                      in a raw binary form.

                                      NONE - Specify NONE if  you  don't  want
                                      any text transformations.

                                      NORMALIZE_PATH    -    Remove   multiple
                                      slashes, directory self-references,  and
                                      directory  back-references  that are not
                                      at the beginning of the  input  from  an
                                      input string.

                                      NORMALIZE_PATH_WIN - This is the same as
                                      NORMALIZE_PATH  ,  but  first   converts
                                      backslash characters to forward slashes.

                                      REMOVE_NULLS  -  Remove  all  NULL bytes
                                      from the input.

                                      REPLACE_COMMENTS - Replace  each  occur-
                                      rence  of a C-style comment (/* ... */ )
                                      with a single space.  Multiple  consecu-
                                      tive occurrences are not compressed. Un-
                                      terminated comments  are  also  replaced
                                      with  a  space  (ASCII 0x20). However, a
                                      standalone termination of a comment  (*/
                                      ) is not acted upon.

                                      REPLACE_NULLS  -  Replace  NULL bytes in
                                      the input with space  characters  (ASCII
                                      0x20 ).

                                      SQL_HEX_DECODE  -  Decode  SQL hex data.
                                      Example (0x414243 ) will be  decoded  to
                                      (ABC ).

                                      URL_DECODE - Decode a URL-encoded value.

                                      URL_DECODE_UNI  -  Like URL_DECODE , but
                                      with support for  Microsoft-specific  %u
                                      encoding.   If   the   code  is  in  the
                                      full-width ASCII code range of FF01-FF5E
                                      ,  the higher byte is used to detect and
                                      adjust the lower byte.  Otherwise,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed.

                                      UTF8_TO_UNICODE  -  Convert  all   UTF-8
                                      character  sequences  to  Unicode.  This
                                      helps input normalization, and  minimiz-
                                      ing  false-positives and false-negatives
                                      for non-English languages.

                     GeoMatchStatement -> (structure)
                        A rule statement that labels web requests  by  country
                        and region and that matches against web requests based
                        on country code. A geo match rule labels every request
                        that  it  inspects  regardless  of  whether it finds a
                        match.

                        o To manage requests only by country, you can use this
                          statement  by  itself and specify the countries that
                          you want to match against in the CountryCodes array.

                        o Otherwise, configure your geo match rule with  Count
                          action  so  that  it only labels requests. Then, add
                          one or more label match rules to run after  the  geo
                          match  rule  and configure them to match against the
                          geographic labels and handle the requests as needed.

                        WAF labels requests using the alpha-2 country and  re-
                        gion  codes  from  the  International Organization for
                        Standardization (ISO) 3166  standard.  WAF  determines
                        the  codes  using either the IP address in the web re-
                        quest origin or, if you specify it, the address in the
                        geo match ForwardedIPConfig .

                        If  you  use the web request origin, the label formats
                        are awswaf:clientip:geo:region:<ISO country code>-<ISO
                        region   code>   and  awswaf:clientip:geo:country:<ISO
                        country code> .

                        If you use a forwarded IP address, the  label  formats
                        are     awswaf:forwardedip:geo:region:<ISO     country
                        code>-<ISO    region     code>     and     awswaf:for-
                        wardedip:geo:country:<ISO country code> .

                        For  additional  details,  see  Geographic  match rule
                        statement in the WAF Developer Guide .

                        CountryCodes -> (list)
                            An array of two-character country codes  that  you
                            want to match against, for example, [ "US", "CN" ]
                            , from the alpha-2 country ISO codes  of  the  ISO
                            3166 international standard.

                            When  you  use  a geo match statement just for the
                            region and country labels  that  it  adds  to  re-
                            quests,  you  still  have to supply a country code
                            for the rule to evaluate. In this case,  you  con-
                            figure  the  rule to only count matching requests,
                            but it will still generate logging and count  met-
                            rics  for  any matches. You can reduce the logging
                            and metrics that the rule produces by specifying a
                            country  that's unlikely to be a source of traffic
                            to your site.

                            (string)

                        ForwardedIPConfig -> (structure)
                            The configuration for inspecting IP  addresses  in
                            an  HTTP header that you specify, instead of using
                            the IP address that's reported by the web  request
                            origin.  Commonly,  this  is  the  X-Forwarded-For
                            (XFF) header, but you can specify any header name.

                            NOTE:
                               If the specified header isn't  present  in  the
                               request,  WAF doesn't apply the rule to the web
                               request at all.

                            HeaderName -> (string)
                               The name of the HTTP header to use for  the  IP
                               address.   For   example,  to  use  the  X-For-
                               warded-For (XFF) header,  set  this  to  X-For-
                               warded-For .

                               NOTE:
                                   If  the  specified  header isn't present in
                                   the request, WAF doesn't apply the rule  to
                                   the web request at all.

                            FallbackBehavior -> (string)
                               The  match  status to assign to the web request
                               if the request doesn't have a valid IP  address
                               in the specified position.

                               NOTE:
                                   If  the  specified  header isn't present in
                                   the request, WAF doesn't apply the rule  to
                                   the web request at all.

                               You  can  specify the following fallback behav-
                               iors:

                               o MATCH - Treat the web request as matching the
                                 rule  statement.  WAF applies the rule action
                                 to the request.

                               o NO_MATCH -  Treat  the  web  request  as  not
                                 matching the rule statement.

                     RuleGroupReferenceStatement -> (structure)
                        A  rule  statement  used to run the rules that are de-
                        fined in a  RuleGroup . To use  this,  create  a  rule
                        group  with  your  rules,  then provide the ARN of the
                        rule group in this statement.

                        You cannot nest a  RuleGroupReferenceStatement  ,  for
                        example for use inside a NotStatement or OrStatement .
                        You can only use a rule group reference  statement  at
                        the top level inside a web ACL.

                        ARN -> (string)
                            The Amazon Resource Name (ARN) of the entity.

                        ExcludedRules -> (list)
                            Rules  in  the referenced rule group whose actions
                            are set to Count .

                            NOTE:
                               Instead of this option, use RuleActionOverrides
                               .  It accepts any valid action setting, includ-
                               ing Count .

                            (structure)
                               Specifies a single rule in a rule  group  whose
                               action you want to override to Count .

                               NOTE:
                                   Instead of this option, use RuleActionOver-
                                   rides . It accepts any  valid  action  set-
                                   ting, including Count .

                               Name -> (string)
                                   The  name of the rule whose action you want
                                   to override to Count .

                        RuleActionOverrides -> (list)
                            Action settings to use in the place  of  the  rule
                            actions that are configured inside the rule group.
                            You specify one override for each rule  whose  ac-
                            tion you want to change.

                            You can use overrides for testing, for example you
                            can override all of rule actions to Count and then
                            monitor  the resulting count metrics to understand
                            how the rule group would handle your web  traffic.
                            You  can also permanently override some or all ac-
                            tions, to modify how the rule group  manages  your
                            web traffic.

                            (structure)
                               Action  setting  to  use in the place of a rule
                               action  that  is  configured  inside  the  rule
                               group.  You  specify one override for each rule
                               whose action you want to change.

                               You can use overrides for testing, for  example
                               you  can  override all of rule actions to Count
                               and then monitor the resulting count metrics to
                               understand how the rule group would handle your
                               web traffic. You can also permanently  override
                               some  or  all  actions,  to modify how the rule
                               group manages your web traffic.

                               Name -> (string)
                                   The name of the rule to override.

                               ActionToUse -> (structure)
                                   The override action to use, in place of the
                                   configured  action  of the rule in the rule
                                   group.

                                   Block -> (structure)
                                      Instructs WAF to block the web request.

                                      CustomResponse -> (structure)
                                          Defines a custom  response  for  the
                                          web request.

                                          For  information  about  customizing
                                          web  requests  and  responses,   see
                                          Customizing  web  requests  and  re-
                                          sponses in WAF in the WAF  Developer
                                          Guide .

                                          ResponseCode -> (integer)
                                             The HTTP status code to return to
                                             the client.

                                             For a list of status  codes  that
                                             you  can  use  in your custom re-
                                             sponses,  see  Supported   status
                                             codes  for custom response in the
                                             WAF Developer Guide .

                                          CustomResponseBodyKey -> (string)
                                             References the response body that
                                             you want WAF to return to the web
                                             request client. You can define  a
                                             custom response for a rule action
                                             or a default web ACL action  that
                                             is  set to block. To do this, you
                                             first define  the  response  body
                                             key  and  value  in the CustomRe-
                                             sponseBodies setting for the  We-
                                             bACL or  RuleGroup where you want
                                             to use it. Then, in the rule  ac-
                                             tion  or  web  ACL default action
                                             BlockAction setting,  you  refer-
                                             ence the response body using this
                                             key.

                                          ResponseHeaders -> (list)
                                             The HTTP headers to  use  in  the
                                             response.  Duplicate header names
                                             are not allowed.

                                             For information about the  limits
                                             on  count and size for custom re-
                                             quest and response settings,  see
                                             WAF  quotas  in the WAF Developer
                                             Guide .

                                             (structure)
                                                 A custom  header  for  custom
                                                 request   and  response  han-
                                                 dling. This is used in   Cus-
                                                 tomResponse   and   CustomRe-
                                                 questHandling .

                                                 Name -> (string)
                                                    The  name  of  the  custom
                                                    header.

                                                    For  custom request header
                                                    insertion,  when  WAF  in-
                                                    serts  the header into the
                                                    request, it prefixes  this
                                                    name   x-amzn-waf-   ,  to
                                                    avoid confusion  with  the
                                                    headers  that  are already
                                                    in the request. For  exam-
                                                    ple,  for  the header name
                                                    sample , WAF  inserts  the
                                                    header x-amzn-waf-sample .

                                                 Value -> (string)
                                                    The  value  of  the custom
                                                    header.

                                   Allow -> (structure)
                                      Instructs WAF to allow the web request.

                                      CustomRequestHandling -> (structure)
                                          Defines custom handling for the  web
                                          request.

                                          For  information  about  customizing
                                          web  requests  and  responses,   see
                                          Customizing  web  requests  and  re-
                                          sponses in WAF in the WAF  Developer
                                          Guide .

                                          InsertHeaders -> (list)
                                             The  HTTP  headers to insert into
                                             the  request.  Duplicate   header
                                             names are not allowed.

                                             For  information about the limits
                                             on count and size for custom  re-
                                             quest  and response settings, see
                                             WAF quotas in the  WAF  Developer
                                             Guide .

                                             (structure)
                                                 A  custom  header  for custom
                                                 request  and  response   han-
                                                 dling.  This is used in  Cus-
                                                 tomResponse  and    CustomRe-
                                                 questHandling .

                                                 Name -> (string)
                                                    The  name  of  the  custom
                                                    header.

                                                    For custom request  header
                                                    insertion,  when  WAF  in-
                                                    serts the header into  the
                                                    request,  it prefixes this
                                                    name  x-amzn-waf-   ,   to
                                                    avoid  confusion  with the
                                                    headers that  are  already
                                                    in  the request. For exam-
                                                    ple, for the  header  name
                                                    sample  ,  WAF inserts the
                                                    header x-amzn-waf-sample .

                                                 Value -> (string)
                                                    The value  of  the  custom
                                                    header.

                                   Count -> (structure)
                                      Instructs  WAF  to count the web request
                                      and then continue evaluating the request
                                      using  the  remaining  rules  in the web
                                      ACL.

                                      CustomRequestHandling -> (structure)
                                          Defines custom handling for the  web
                                          request.

                                          For  information  about  customizing
                                          web  requests  and  responses,   see
                                          Customizing  web  requests  and  re-
                                          sponses in WAF in the WAF  Developer
                                          Guide .

                                          InsertHeaders -> (list)
                                             The  HTTP  headers to insert into
                                             the  request.  Duplicate   header
                                             names are not allowed.

                                             For  information about the limits
                                             on count and size for custom  re-
                                             quest  and response settings, see
                                             WAF quotas in the  WAF  Developer
                                             Guide .

                                             (structure)
                                                 A  custom  header  for custom
                                                 request  and  response   han-
                                                 dling.  This is used in  Cus-
                                                 tomResponse  and    CustomRe-
                                                 questHandling .

                                                 Name -> (string)
                                                    The  name  of  the  custom
                                                    header.

                                                    For custom request  header
                                                    insertion,  when  WAF  in-
                                                    serts the header into  the
                                                    request,  it prefixes this
                                                    name  x-amzn-waf-   ,   to
                                                    avoid  confusion  with the
                                                    headers that  are  already
                                                    in  the request. For exam-
                                                    ple, for the  header  name
                                                    sample  ,  WAF inserts the
                                                    header x-amzn-waf-sample .

                                                 Value -> (string)
                                                    The value  of  the  custom
                                                    header.

                                   Captcha -> (structure)
                                      Instructs  WAF  to  run  a CAPTCHA check
                                      against the web request.

                                      CustomRequestHandling -> (structure)
                                          Defines custom handling for the  web
                                          request,  used  when the CAPTCHA in-
                                          spection  determines  that  the  re-
                                          quest's  token  is  valid  and unex-
                                          pired.

                                          For  information  about  customizing
                                          web   requests  and  responses,  see
                                          Customizing  web  requests  and  re-
                                          sponses  in WAF in the WAF Developer
                                          Guide .

                                          InsertHeaders -> (list)
                                             The HTTP headers to  insert  into
                                             the   request.  Duplicate  header
                                             names are not allowed.

                                             For information about the  limits
                                             on  count and size for custom re-
                                             quest and response settings,  see
                                             WAF  quotas  in the WAF Developer
                                             Guide .

                                             (structure)
                                                 A custom  header  for  custom
                                                 request   and  response  han-
                                                 dling. This is used in   Cus-
                                                 tomResponse   and   CustomRe-
                                                 questHandling .

                                                 Name -> (string)
                                                    The  name  of  the  custom
                                                    header.

                                                    For  custom request header
                                                    insertion,  when  WAF  in-
                                                    serts  the header into the
                                                    request, it prefixes  this
                                                    name   x-amzn-waf-   ,  to
                                                    avoid confusion  with  the
                                                    headers  that  are already
                                                    in the request. For  exam-
                                                    ple,  for  the header name
                                                    sample , WAF  inserts  the
                                                    header x-amzn-waf-sample .

                                                 Value -> (string)
                                                    The  value  of  the custom
                                                    header.

                                   Challenge -> (structure)
                                      Instructs WAF to run a  Challenge  check
                                      against the web request.

                                      CustomRequestHandling -> (structure)
                                          Defines  custom handling for the web
                                          request, used when the challenge in-
                                          spection  determines  that  the  re-
                                          quest's token  is  valid  and  unex-
                                          pired.

                                          For  information  about  customizing
                                          web  requests  and  responses,   see
                                          Customizing  web  requests  and  re-
                                          sponses in WAF in the WAF  Developer
                                          Guide .

                                          InsertHeaders -> (list)
                                             The  HTTP  headers to insert into
                                             the  request.  Duplicate   header
                                             names are not allowed.

                                             For  information about the limits
                                             on count and size for custom  re-
                                             quest  and response settings, see
                                             WAF quotas in the  WAF  Developer
                                             Guide .

                                             (structure)
                                                 A  custom  header  for custom
                                                 request  and  response   han-
                                                 dling.  This is used in  Cus-
                                                 tomResponse  and    CustomRe-
                                                 questHandling .

                                                 Name -> (string)
                                                    The  name  of  the  custom
                                                    header.

                                                    For custom request  header
                                                    insertion,  when  WAF  in-
                                                    serts the header into  the
                                                    request,  it prefixes this
                                                    name  x-amzn-waf-   ,   to
                                                    avoid  confusion  with the
                                                    headers that  are  already
                                                    in  the request. For exam-
                                                    ple, for the  header  name
                                                    sample  ,  WAF inserts the
                                                    header x-amzn-waf-sample .

                                                 Value -> (string)
                                                    The value  of  the  custom
                                                    header.

                     IPSetReferenceStatement -> (structure)
                        A  rule  statement  used to detect web requests coming
                        from particular IP addresses or address ranges. To use
                        this,  create  an   IPSet that specifies the addresses
                        you want to detect, then use the ARN of  that  set  in
                        this  statement. To create an IP set, see  CreateIPSet
                        .

                        Each IP set rule statement references an IP  set.  You
                        create and maintain the set independent of your rules.
                        This allows you to use  the  single  set  in  multiple
                        rules.  When  you update the referenced set, WAF auto-
                        matically updates all rules that reference it.

                        ARN -> (string)
                            The Amazon Resource Name (ARN) of the  IPSet  that
                            this statement references.

                        IPSetForwardedIPConfig -> (structure)
                            The  configuration  for inspecting IP addresses in
                            an HTTP header that you specify, instead of  using
                            the  IP address that's reported by the web request
                            origin.  Commonly,  this  is  the  X-Forwarded-For
                            (XFF) header, but you can specify any header name.

                            NOTE:
                               If  the  specified  header isn't present in the
                               request, WAF doesn't apply the rule to the  web
                               request at all.

                            HeaderName -> (string)
                               The  name  of the HTTP header to use for the IP
                               address.  For  example,  to  use   the   X-For-
                               warded-For  (XFF)  header,  set  this to X-For-
                               warded-For .

                               NOTE:
                                   If the specified header  isn't  present  in
                                   the  request, WAF doesn't apply the rule to
                                   the web request at all.

                            FallbackBehavior -> (string)
                               The match status to assign to the  web  request
                               if  the request doesn't have a valid IP address
                               in the specified position.

                               NOTE:
                                   If the specified header  isn't  present  in
                                   the  request, WAF doesn't apply the rule to
                                   the web request at all.

                               You can specify the following  fallback  behav-
                               iors:

                               o MATCH - Treat the web request as matching the
                                 rule statement. WAF applies the  rule  action
                                 to the request.

                               o NO_MATCH  -  Treat  the  web  request  as not
                                 matching the rule statement.

                            Position -> (string)
                               The position in the header to search for the IP
                               address. The header can contain IP addresses of
                               the original client and also  of  proxies.  For
                               example,  the  header  value could be 10.1.1.1,
                               127.0.0.0, 10.10.10.10 where the first  IP  ad-
                               dress  identifies  the  original client and the
                               rest identify proxies  that  the  request  went
                               through.

                               The options for this setting are the following:

                               o FIRST  -  Inspect the first IP address in the
                                 list of IP addresses in the header.  This  is
                                 usually the client's original IP.

                               o LAST  -  Inspect  the  last IP address in the
                                 list of IP addresses in the header.

                               o ANY - Inspect all IP addresses in the  header
                                 for a match. If the header contains more than
                                 10 IP addresses, WAF inspects the last 10.

                     RegexPatternSetReferenceStatement -> (structure)
                        A rule statement used to search web request components
                        for  matches  with  regular  expressions. To use this,
                        create a  RegexPatternSet that specifies  the  expres-
                        sions  that  you  want  to detect, then use the ARN of
                        that set in this statement. A web request matches  the
                        pattern  set  rule  statement if the request component
                        matches any of the patterns in the set.  To  create  a
                        regex pattern set, see  CreateRegexPatternSet .

                        Each  regex  pattern  set  rule statement references a
                        regex pattern set. You create and maintain the set in-
                        dependent  of  your  rules. This allows you to use the
                        single set in multiple rules. When you update the ref-
                        erenced  set, WAF automatically updates all rules that
                        reference it.

                        ARN -> (string)
                            The Amazon Resource Name (ARN) of  the   RegexPat-
                            ternSet that this statement references.

                        FieldToMatch -> (structure)
                            The  part  of the web request that you want WAF to
                            inspect.

                            SingleHeader -> (structure)
                               Inspect a single header. Provide  the  name  of
                               the  header to inspect, for example, User-Agent
                               or Referer . This setting isn't case sensitive.

                               Example   JSON:   "SingleHeader":   {   "Name":
                               "haystack" }

                               Alternately,  you  can  filter  and inspect all
                               headers with the Headers  FieldToMatch setting.

                               Name -> (string)
                                   The name of the query header to inspect.

                            SingleQueryArgument -> (structure)
                               Inspect a single query  argument.  Provide  the
                               name  of the query argument to inspect, such as
                               UserName or SalesRegion . The name can be up to
                               30 characters long and isn't case sensitive.

                               Example  JSON: "SingleQueryArgument": { "Name":
                               "myArgument" }

                               Name -> (string)
                                   The name of the query argument to inspect.

                            AllQueryArguments -> (structure)
                               Inspect all query arguments.

                            UriPath -> (structure)
                               Inspect the request URI path. This is the  part
                               of  the web request that identifies a resource,
                               for example, /images/daily-ad.jpg .

                            QueryString -> (structure)
                               Inspect the query string. This is the part of a
                               URL that appears after a ? character, if any.

                            Body -> (structure)
                               Inspect the request body as plain text. The re-
                               quest  body  immediately  follows  the  request
                               headers.  This  is  the  part of a request that
                               contains any additional data that you  want  to
                               send  to  your  web  server as the HTTP request
                               body, such as data from a form.

                               A limited amount of the request  body  is  for-
                               warded  to WAF for inspection by the underlying
                               host service. For regional resources, the limit
                               is  8  KB  (8,192 kilobytes) and for CloudFront
                               distributions, the limit is 16 KB (16,384 kilo-
                               bytes).  For  CloudFront distributions, you can
                               increase the limit in the  web  ACL's  Associa-
                               tionConfig , for additional processing fees.

                               For  information  about how to handle oversized
                               request bodies, see the Body object  configura-
                               tion.

                               OversizeHandling -> (string)
                                   What  WAF  should  do if the body is larger
                                   than WAF can inspect. WAF does not  support
                                   inspecting  the  entire contents of the web
                                   request body if the body exceeds the  limit
                                   for  the  resource  type.  If  the  body is
                                   larger than the limit, the underlying  host
                                   service only forwards the contents that are
                                   below the limit to WAF for inspection.

                                   The default limit is 8 KB (8,192 kilobytes)
                                   for  regional  resources  and 16 KB (16,384
                                   kilobytes)  for  CloudFront  distributions.
                                   For  CloudFront  distributions, you can in-
                                   crease the limit in the  web  ACL  Associa-
                                   tionConfig   ,  for  additional  processing
                                   fees.

                                   The options for oversize handling  are  the
                                   following:

                                   o CONTINUE  -  Inspect  the  available body
                                     contents normally, according to the  rule
                                     inspection criteria.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                                   You can combine the MATCH or NO_MATCH  set-
                                   tings  for oversize handling with your rule
                                   and web ACL action settings,  so  that  you
                                   block  any  request  whose body is over the
                                   limit.

                                   Default: CONTINUE

                            Method -> (structure)
                               Inspect the HTTP method. The  method  indicates
                               the  type of operation that the request is ask-
                               ing the origin to perform.

                            JsonBody -> (structure)
                               Inspect the request body as JSON.  The  request
                               body  immediately  follows the request headers.
                               This is the part of a request that contains any
                               additional  data  that you want to send to your
                               web server as the HTTP request  body,  such  as
                               data from a form.

                               A  limited  amount  of the request body is for-
                               warded to WAF for inspection by the  underlying
                               host service. For regional resources, the limit
                               is 8 KB (8,192 kilobytes)  and  for  CloudFront
                               distributions, the limit is 16 KB (16,384 kilo-
                               bytes). For CloudFront distributions,  you  can
                               increase  the  limit  in the web ACL's Associa-
                               tionConfig , for additional processing fees.

                               For information about how to  handle  oversized
                               request bodies, see the JsonBody object config-
                               uration.

                               MatchPattern -> (structure)
                                   The patterns to look for in the JSON  body.
                                   WAF  inspects  the results of these pattern
                                   matches against the rule inspection  crite-
                                   ria.

                                   All -> (structure)
                                      Match  all  of  the  elements.  See also
                                      MatchScope in  JsonBody .

                                      You must specify either this setting  or
                                      the IncludedPaths setting, but not both.

                                   IncludedPaths -> (list)
                                      Match  only the specified include paths.
                                      See also MatchScope in  JsonBody .

                                      Provide the  include  paths  using  JSON
                                      Pointer  syntax. For example, "Included-
                                      Paths": ["/dogs/0/name", "/dogs/1/name"]
                                      . For information about this syntax, see
                                      the  Internet  Engineering  Task   Force
                                      (IETF)  documentation  JavaScript Object
                                      Notation (JSON) Pointer .

                                      You must specify either this setting  or
                                      the All setting, but not both.

                                      NOTE:
                                          Don't use this option to include all
                                          paths. Instead, use the All setting.

                                      (string)

                               MatchScope -> (string)
                                   The parts of the JSON to match against  us-
                                   ing the MatchPattern . If you specify All ,
                                   WAF matches against keys and values.

                               InvalidFallbackBehavior -> (string)
                                   What WAF should do  if  it  fails  to  com-
                                   pletely  parse  the  JSON body. The options
                                   are the following:

                                   o EVALUATE_AS_STRING - Inspect the body  as
                                     plain  text.  WAF applies the text trans-
                                     formations and inspection  criteria  that
                                     you  defined  for  the JSON inspection to
                                     the body text string.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                                   If  you  don't  provide  this  setting, WAF
                                   parses and evaluates the content only up to
                                   the  first  parsing failure that it encoun-
                                   ters.

                                   WAF does its best to parse the entire  JSON
                                   body,  but might be forced to stop for rea-
                                   sons such as invalid characters,  duplicate
                                   keys,  truncation,  and  any  content whose
                                   root node isn't an object or an array.

                                   WAF parses the JSON in the following  exam-
                                   ples as two valid key, value pairs:

                                   o Missing                            comma:
                                     {"key1":"value1""key2":"value2"}

                                   o Missing                            colon:
                                     {"key1":"value1","key2""value2"}

                                   o Extra                             colons:
                                     {"key1"::"value1","key2""value2"}

                               OversizeHandling -> (string)
                                   What WAF should do if the  body  is  larger
                                   than  WAF can inspect. WAF does not support
                                   inspecting the entire contents of  the  web
                                   request  body if the body exceeds the limit
                                   for the  resource  type.  If  the  body  is
                                   larger  than the limit, the underlying host
                                   service only forwards the contents that are
                                   below the limit to WAF for inspection.

                                   The default limit is 8 KB (8,192 kilobytes)
                                   for regional resources and  16  KB  (16,384
                                   kilobytes)  for  CloudFront  distributions.
                                   For CloudFront distributions, you  can  in-
                                   crease  the  limit  in the web ACL Associa-
                                   tionConfig  ,  for  additional   processing
                                   fees.

                                   The  options  for oversize handling are the
                                   following:

                                   o CONTINUE -  Inspect  the  available  body
                                     contents  normally, according to the rule
                                     inspection criteria.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                                   You  can combine the MATCH or NO_MATCH set-
                                   tings for oversize handling with your  rule
                                   and  web  ACL  action settings, so that you
                                   block any request whose body  is  over  the
                                   limit.

                                   Default: CONTINUE

                            Headers -> (structure)
                               Inspect the request headers. You must configure
                               scope and pattern matching filters in the Head-
                               ers object, to define the set of headers to and
                               the parts of the headers that WAF inspects.

                               Only the first 8 KB (8192 bytes) of a request's
                               headers and only the first 200 headers are for-
                               warded to WAF for inspection by the  underlying
                               host  service. You must configure how to handle
                               any oversize header content in the Headers  ob-
                               ject.  WAF applies the pattern matching filters
                               to the headers that it receives from the under-
                               lying host service.

                               MatchPattern -> (structure)
                                   The filter to use to identify the subset of
                                   headers to inspect in a web request.

                                   You must specify exactly one  setting:  ei-
                                   ther  All  , IncludedHeaders , or Excluded-
                                   Headers .

                                   Example JSON: "MatchPattern": {  "Excluded-
                                   Headers":    {"KeyToExclude1",    "KeyToEx-
                                   clude2"} }

                                   All -> (structure)
                                      Inspect all headers.

                                   IncludedHeaders -> (list)
                                      Inspect only the headers that have a key
                                      that  matches  one of the strings speci-
                                      fied here.

                                      (string)

                                   ExcludedHeaders -> (list)
                                      Inspect  only  the  headers  whose  keys
                                      don't match any of the strings specified
                                      here.

                                      (string)

                               MatchScope -> (string)
                                   The parts of the headers to match with  the
                                   rule  inspection  criteria.  If you specify
                                   All , WAF inspects both keys and values.

                               OversizeHandling -> (string)
                                   What WAF should do if the  headers  of  the
                                   request  are  more  numerous or larger than
                                   WAF can inspect. WAF does not  support  in-
                                   specting  the  entire  contents  of request
                                   headers when they exceed 8 KB (8192  bytes)
                                   or  200  total headers. The underlying host
                                   service forwards a maximum of  200  headers
                                   and at most 8 KB of header contents to WAF.

                                   The  options  for oversize handling are the
                                   following:

                                   o CONTINUE - Inspect the available  headers
                                     normally,  according  to the rule inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                            Cookies -> (structure)
                               Inspect the request cookies. You must configure
                               scope and pattern matching filters in the Cook-
                               ies  object,  to  define the set of cookies and
                               the parts of the cookies that WAF inspects.

                               Only the first 8 KB (8192 bytes) of a request's
                               cookies and only the first 200 cookies are for-
                               warded to WAF for inspection by the  underlying
                               host  service. You must configure how to handle
                               any oversize cookie content in the Cookies  ob-
                               ject.  WAF applies the pattern matching filters
                               to the cookies that it receives from the under-
                               lying host service.

                               MatchPattern -> (structure)
                                   The filter to use to identify the subset of
                                   cookies to inspect in a web request.

                                   You must specify exactly one  setting:  ei-
                                   ther  All  , IncludedCookies , or Excluded-
                                   Cookies .

                                   Example JSON: "MatchPattern": {  "Included-
                                   Cookies":    {"KeyToInclude1",    "KeyToIn-
                                   clude2", "KeyToInclude3"} }

                                   All -> (structure)
                                      Inspect all cookies.

                                   IncludedCookies -> (list)
                                      Inspect only the cookies that have a key
                                      that  matches  one of the strings speci-
                                      fied here.

                                      (string)

                                   ExcludedCookies -> (list)
                                      Inspect  only  the  cookies  whose  keys
                                      don't match any of the strings specified
                                      here.

                                      (string)

                               MatchScope -> (string)
                                   The parts of the cookies  to  inspect  with
                                   the  rule inspection criteria. If you spec-
                                   ify All , WAF inspects both keys  and  val-
                                   ues.

                               OversizeHandling -> (string)
                                   What  WAF  should  do if the cookies of the
                                   request are more numerous  or  larger  than
                                   WAF  can  inspect. WAF does not support in-
                                   specting the  entire  contents  of  request
                                   cookies  when they exceed 8 KB (8192 bytes)
                                   or 200 total cookies. The  underlying  host
                                   service  forwards  a maximum of 200 cookies
                                   and at most 8 KB of cookie contents to WAF.

                                   The options for oversize handling  are  the
                                   following:

                                   o CONTINUE  - Inspect the available cookies
                                     normally, according to the  rule  inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                            HeaderOrder -> (structure)
                               Inspect a string containing the list of the re-
                               quest's header names, ordered as they appear in
                               the web request that WAF receives  for  inspec-
                               tion.  WAF  generates  the string and then uses
                               that as the field to match component in its in-
                               spection. WAF separates the header names in the
                               string using commas and no added spaces.

                               Matches against the  header  order  string  are
                               case insensitive.

                               OversizeHandling -> (string)
                                   What  WAF  should  do if the headers of the
                                   request are more numerous  or  larger  than
                                   WAF  can  inspect. WAF does not support in-
                                   specting the  entire  contents  of  request
                                   headers  when they exceed 8 KB (8192 bytes)
                                   or 200 total headers. The  underlying  host
                                   service  forwards  a maximum of 200 headers
                                   and at most 8 KB of header contents to WAF.

                                   The options for oversize handling  are  the
                                   following:

                                   o CONTINUE  - Inspect the available headers
                                     normally, according to the  rule  inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                        TextTransformations -> (list)
                            Text transformations eliminate some of the unusual
                            formatting  that  attackers use in web requests in
                            an effort to bypass  detection.  Text  transforma-
                            tions are used in rule match statements, to trans-
                            form the FieldToMatch request component before in-
                            specting  it,  and they're used in rate-based rule
                            statements, to transform request components before
                            using  them  as  custom  aggregation  keys. If you
                            specify one or more transformations to apply,  WAF
                            performs all transformations on the specified con-
                            tent, starting from the lowest  priority  setting,
                            and then uses the component contents.

                            (structure)
                               Text  transformations eliminate some of the un-
                               usual formatting that attackers use in web  re-
                               quests in an effort to bypass detection.

                               Priority -> (integer)
                                   Sets the relative processing order for mul-
                                   tiple transformations.  WAF  processes  all
                                   transformations,  from  lowest  priority to
                                   highest, before inspecting the  transformed
                                   content.  The  priorities  don't need to be
                                   consecutive, but they must all  be  differ-
                                   ent.

                               Type -> (string)
                                   You  can  specify the following transforma-
                                   tion types:
                                      BASE64_DECODE - Decode a Base64 -encoded
                                      string.

                                      BASE64_DECODE_EXT - Decode a Base64 -en-
                                      coded string, but use a forgiving imple-
                                      mentation  that  ignores characters that
                                      aren't valid.

                                      CMD_LINE - Command-line transformations.
                                      These are helpful in reducing effective-
                                      ness of attackers who inject an  operat-
                                      ing  system command-line command and use
                                      unusual formatting to disguise  some  or
                                      all of the command.

                                   o Delete the following characters: \ " ' ^

                                   o Delete  spaces before the following char-
                                     acters: / (

                                   o Replace the following characters  with  a
                                     space: , ;

                                   o Replace multiple spaces with one space

                                   o Convert uppercase letters (A-Z) to lower-
                                     case (a-z)
                                      COMPRESS_WHITE_SPACE  -  Replace   these
                                      characters with a space character (deci-
                                      mal 32):

                                   o \f , formfeed, decimal 12

                                   o \t , tab, decimal 9

                                   o \n , newline, decimal 10

                                   o \r , carriage return, decimal 13

                                   o \v , vertical tab, decimal 11

                                   o Non-breaking space, decimal 160
                                      COMPRESS_WHITE_SPACE also replaces  mul-
                                      tiple spaces with one space.

                                      CSS_DECODE - Decode characters that were
                                      encoded using CSS 2.x escape rules  syn-
                                      data.html#characters   .  This  function
                                      uses up to two  bytes  in  the  decoding
                                      process, so it can help to uncover ASCII
                                      characters that were encoded  using  CSS
                                      encoding  that  wouldnt typically be en-
                                      coded. It's also  useful  in  countering
                                      evasion,  which  is  a  combination of a
                                      backslash  and  non-hexadecimal  charac-
                                      ters. For example, ja\vascript for java-
                                      script.

                                      ESCAPE_SEQ_DECODE - Decode the following
                                      ANSI  C escape sequences: \a , \b , \f ,
                                      \n , \r , \t , \v , \\ , \? , \' , \"  ,
                                      \xHH  (hexadecimal),  \0OOO (octal). En-
                                      codings that aren't valid remain in  the
                                      output.

                                      HEX_DECODE - Decode a string of hexadec-
                                      imal characters into a binary.

                                      HTML_ENTITY_DECODE  -  Replace  HTML-en-
                                      coded  characters with unencoded charac-
                                      ters. HTML_ENTITY_DECODE performs  these
                                      operations:

                                   o Replaces (ampersand)quot; with "

                                   o Replaces    (ampersand)nbsp;    with    a
                                     non-breaking space, decimal 160

                                   o Replaces  (ampersand)lt;  with  a   "less
                                     than" symbol

                                   o Replaces (ampersand)gt; with >

                                   o Replaces  characters that are represented
                                     in hexadecimal format, (ampersand)#xhhhh;
                                     , with the corresponding characters

                                   o Replaces  characters that are represented
                                     in decimal  format,  (ampersand)#nnnn;  ,
                                     with the corresponding characters
                                      JS_DECODE - Decode JavaScript escape se-
                                      quences. If a \  u  HHHH code is in  the
                                      full-width ASCII code range of FF01-FF5E
                                      , then the higher byte is used to detect
                                      and  adjust the lower byte. If not, only
                                      the lower byte is used  and  the  higher
                                      byte  is zeroed, causing a possible loss
                                      of information.

                                      LOWERCASE -  Convert  uppercase  letters
                                      (A-Z) to lowercase (a-z).

                                      MD5  -  Calculate  an  MD5 hash from the
                                      data in the input. The computed hash  is
                                      in a raw binary form.

                                      NONE  -  Specify  NONE if you don't want
                                      any text transformations.

                                      NORMALIZE_PATH   -    Remove    multiple
                                      slashes,  directory self-references, and
                                      directory back-references that  are  not
                                      at  the  beginning  of the input from an
                                      input string.

                                      NORMALIZE_PATH_WIN - This is the same as
                                      NORMALIZE_PATH   ,  but  first  converts
                                      backslash characters to forward slashes.

                                      REMOVE_NULLS -  Remove  all  NULL  bytes
                                      from the input.

                                      REPLACE_COMMENTS  -  Replace each occur-
                                      rence of a C-style comment (/* ... */  )
                                      with  a  single space. Multiple consecu-
                                      tive occurrences are not compressed. Un-
                                      terminated  comments  are  also replaced
                                      with a space (ASCII  0x20).  However,  a
                                      standalone  termination of a comment (*/
                                      ) is not acted upon.

                                      REPLACE_NULLS - Replace  NULL  bytes  in
                                      the  input  with space characters (ASCII
                                      0x20 ).

                                      SQL_HEX_DECODE - Decode  SQL  hex  data.
                                      Example  (0x414243  ) will be decoded to
                                      (ABC ).

                                      URL_DECODE - Decode a URL-encoded value.

                                      URL_DECODE_UNI - Like URL_DECODE  ,  but
                                      with  support  for Microsoft-specific %u
                                      encoding.  If  the  code   is   in   the
                                      full-width ASCII code range of FF01-FF5E
                                      , the higher byte is used to detect  and
                                      adjust  the  lower byte. Otherwise, only
                                      the lower byte is used  and  the  higher
                                      byte is zeroed.

                                      UTF8_TO_UNICODE   -  Convert  all  UTF-8
                                      character  sequences  to  Unicode.  This
                                      helps  input normalization, and minimiz-
                                      ing false-positives and  false-negatives
                                      for non-English languages.

                     RateBasedStatement -> (structure)
                        A  rate-based  rule  counts incoming requests and rate
                        limits requests when they are coming  at  too  fast  a
                        rate.  The rule categorizes requests according to your
                        aggregation criteria, collects them  into  aggregation
                        instances, and counts and rate limits the requests for
                        each instance.

                        You can specify individual aggregation keys,  like  IP
                        address  or HTTP method. You can also specify aggrega-
                        tion  key  combinations,  like  IP  address  and  HTTP
                        method, or HTTP method, query argument, and cookie.

                        Each  unique  set  of  values for the aggregation keys
                        that you specify is a separate  aggregation  instance,
                        with  the  value from each key contributing to the ag-
                        gregation instance definition.

                        For example, assume the rule  evaluates  web  requests
                        with the following IP address and HTTP method values:

                        o IP address 10.1.1.1, HTTP method POST

                        o IP address 10.1.1.1, HTTP method GET

                        o IP address 127.0.0.0, HTTP method POST

                        o IP address 10.1.1.1, HTTP method GET

                        The  rule would create different aggregation instances
                        according to your aggregation criteria, for example:

                        o If the aggregation criteria is just the IP  address,
                          then  each  individual address is an aggregation in-
                          stance, and WAF counts requests separately for each.
                          The aggregation instances and request counts for our
                          example would be the following:

                          o IP address 10.1.1.1: count 3

                          o IP address 127.0.0.0: count 1

                        o If the aggregation criteria  is  HTTP  method,  then
                          each  individual  HTTP  method is an aggregation in-
                          stance. The aggregation instances and request counts
                          for our example would be the following:

                          o HTTP method POST: count 2

                          o HTTP method GET: count 2

                        o If  the  aggregation criteria is IP address and HTTP
                          method, then each IP address and  each  HTTP  method
                          would  contribute  to  the  combined aggregation in-
                          stance. The aggregation instances and request counts
                          for our example would be the following:

                          o IP address 10.1.1.1, HTTP method POST: count 1

                          o IP address 10.1.1.1, HTTP method GET: count 2

                          o IP address 127.0.0.0, HTTP method POST: count 1

                        For  any n-tuple of aggregation keys, each unique com-
                        bination of values for the keys defines a separate ag-
                        gregation  instance,  which WAF counts and rate-limits
                        individually.

                        You can optionally nest another statement  inside  the
                        rate-based  statement, to narrow the scope of the rule
                        so that it only counts and rate limits  requests  that
                        match  the  nested  statement. You can use this nested
                        scope-down statement in conjunction with your aggrega-
                        tion key specifications or you can just count and rate
                        limit all requests that match  the  scope-down  state-
                        ment,  without additional aggregation. When you choose
                        to just manage all requests that  match  a  scope-down
                        statement,  the  aggregation  instance is singular for
                        the rule.

                        You cannot nest a  RateBasedStatement  inside  another
                        statement,   for  example  inside  a  NotStatement  or
                        OrStatement . You can define a RateBasedStatement  in-
                        side a web ACL and inside a rule group.

                        For additional information about the options, see Rate
                        limiting web requests using rate-based  rules  in  the
                        WAF Developer Guide .

                        If  you only aggregate on the individual IP address or
                        forwarded IP address, you can retrieve the list of  IP
                        addresses  that  WAF  is currently rate limiting for a
                        rule through the  API  call  GetRateBasedStatementMan-
                        agedKeys  . This option is not available for other ag-
                        gregation configurations.

                        WAF tracks and manages  web  requests  separately  for
                        each  instance  of a rate-based rule that you use. For
                        example, if you provide the same rate-based rule  set-
                        tings in two web ACLs, each of the two rule statements
                        represents a separate instance of the rate-based  rule
                        and  gets  its  own tracking and management by WAF. If
                        you define a rate-based rule inside a rule group,  and
                        then  use that rule group in multiple places, each use
                        creates a separate instance  of  the  rate-based  rule
                        that gets its own tracking and management by WAF.

                        Limit -> (long)
                            The  limit  on  requests per 5-minute period for a
                            single aggregation  instance  for  the  rate-based
                            rule.  If  the  rate-based  statement  includes  a
                            ScopeDownStatement , this limit is applied only to
                            the requests that match the statement.

                            Examples:

                            o If you aggregate on just the IP address, this is
                              the limit on requests from  any  single  IP  ad-
                              dress.

                            o If  you  aggregate  on  the  HTTP method and the
                              query argument name "city",  then  this  is  the
                              limit  on  requests  for any single method, city
                              pair.

                        AggregateKeyType -> (string)
                            Setting that indicates how to  aggregate  the  re-
                            quest counts.

                            NOTE:
                               Web requests that are missing any of the compo-
                               nents specified in  the  aggregation  keys  are
                               omitted from the rate-based rule evaluation and
                               handling.

                            o CONSTANT - Count and  limit  the  requests  that
                              match  the  rate-based  rule's scope-down state-
                              ment. With this  option,  the  counted  requests
                              aren't further aggregated. The scope-down state-
                              ment is the only specification  used.  When  the
                              count   of   all   requests   that  satisfy  the
                              scope-down statement goes over  the  limit,  WAF
                              applies  the  rule  action  to all requests that
                              satisfy the scope-down statement.  With this op-
                              tion,  you must configure the ScopeDownStatement
                              property.

                            o CUSTOM_KEYS - Aggregate the request counts using
                              one or more web request components as the aggre-
                              gate keys. With this option,  you  must  specify
                              the  aggregate  keys in the CustomKeys property.
                              To aggregate on only the IP address or only  the
                              forwarded IP address, don't use custom keys. In-
                              stead, set the aggregate key type to IP or  FOR-
                              WARDED_IP .

                            o FORWARDED_IP  -  Aggregate the request counts on
                              the first IP address in an  HTTP  header.   With
                              this  option, you must specify the header to use
                              in the ForwardedIPConfig property.  To aggregate
                              on  a  combination  of  the forwarded IP address
                              with other aggregate keys, use CUSTOM_KEYS .

                            o IP - Aggregate the request counts on the IP  ad-
                              dress  from the web request origin. To aggregate
                              on a combination of the IP  address  with  other
                              aggregate keys, use CUSTOM_KEYS .

                        ScopeDownStatement -> (structure)
                            An  optional  nested  statement  that  narrows the
                            scope of the web requests that are  evaluated  and
                            managed  by the rate-based statement. When you use
                            a scope-down statement, the rate-based  rule  only
                            tracks  and  rate  limits  requests that match the
                            scope-down statement. You  can  use  any  nestable
                            Statement in the scope-down statement, and you can
                            nest statements at any level, the same as you  can
                            for a rule statement.

                            ByteMatchStatement -> (structure)
                               A  rule  statement  that defines a string match
                               search for WAF to apply to  web  requests.  The
                               byte  match  statement  provides  the  bytes to
                               search for, the location in requests  that  you
                               want  WAF  to  search,  and other settings. The
                               bytes to search for are typically a string that
                               corresponds  with  ASCII characters. In the WAF
                               console and the developer guide, this is called
                               a string match statement.

                               SearchString -> (blob)
                                   A  string value that you want WAF to search
                                   for. WAF searches only in the part  of  web
                                   requests  that you designate for inspection
                                   in  FieldToMatch . The  maximum  length  of
                                   the value is 200 bytes.

                                   Valid  values  depend on the component that
                                   you specify for inspection in  FieldToMatch
                                   :

                                   o Method  :  The  HTTP method that you want
                                     WAF to search  for.  This  indicates  the
                                     type  of  operation  specified in the re-
                                     quest.

                                   o UriPath : The value that you want WAF  to
                                     search  for in the URI path, for example,
                                     /images/daily-ad.jpg .

                                   o HeaderOrder : The comma-separated list of
                                     header  names to match for. WAF creates a
                                     string that contains the ordered list  of
                                     header names, from the headers in the web
                                     request, and then  matches  against  that
                                     string.

                                   If SearchString includes alphabetic charac-
                                   ters A-Z and a-z, note that  the  value  is
                                   case sensitive.
                                      If you're using the WAF API

                                   Specify  a  base64-encoded  version  of the
                                   value. The maximum length of the value  be-
                                   fore you base64-encode it is 200 bytes.

                                   For  example,  suppose the value of Type is
                                   HEADER and the value of Data is  User-Agent
                                   .  If  you  want  to  search the User-Agent
                                   header  for  the   value   BadBot   ,   you
                                   base64-encode  BadBot using MIME base64-en-
                                   coding and include the resulting value, Qm-
                                   FkQm90 , in the value of SearchString .
                                      If  you're  using  the CLI or one of the
                                      Amazon Web Services SDKs

                                   The value that you want WAF to search  for.
                                   The  SDK  automatically  base64 encodes the
                                   value.

                               FieldToMatch -> (structure)
                                   The part of the web request that  you  want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Alternately,  you can filter and inspect
                                      all headers  with  the  Headers   Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the part of the web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A  limited amount of the request body is
                                      forwarded to WAF for inspection  by  the
                                      underlying  host  service.  For regional
                                      resources, the  limit  is  8  KB  (8,192
                                      kilobytes)  and for CloudFront distribu-
                                      tions, the limit is 16 KB (16,384  kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you can increase the limit  in  the  web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized  request  bodies, see the Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      A  limited amount of the request body is
                                      forwarded to WAF for inspection  by  the
                                      underlying  host  service.  For regional
                                      resources, the  limit  is  8  KB  (8,192
                                      kilobytes)  and for CloudFront distribu-
                                      tions, the limit is 16 KB (16,384  kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you can increase the limit  in  the  web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized  request bodies, see the Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect the request  headers.  You  must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the  set  of headers to and the parts of
                                      the headers that WAF inspects.

                                      Only the first 8 KB (8192  bytes)  of  a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must configure how to handle  any  over-
                                      size  header  content in the Headers ob-
                                      ject. WAF applies the  pattern  matching
                                      filters  to the headers that it receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The filter to use  to  identify  the
                                          subset  of  headers  to inspect in a
                                          web request.

                                          You must specify  exactly  one  set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have  a  key  that matches one of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect only  the  headers  whose
                                             keys   don't  match  any  of  the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The parts of the  headers  to  match
                                          with  the  rule inspection criteria.
                                          If you specify All  ,  WAF  inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  headers
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total headers. The underlying
                                          host service forwards a  maximum  of
                                          200  headers  and  at  most  8 KB of
                                          header contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect the request  cookies.  You  must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the  set of cookies and the parts of the
                                      cookies that WAF inspects.

                                      Only the first 8 KB (8192  bytes)  of  a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must configure how to handle  any  over-
                                      size  cookie  content in the Cookies ob-
                                      ject. WAF applies the  pattern  matching
                                      filters  to the cookies that it receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The filter to use  to  identify  the
                                          subset  of  cookies  to inspect in a
                                          web request.

                                          You must specify  exactly  one  set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have  a  key  that matches one of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect only  the  cookies  whose
                                             keys   don't  match  any  of  the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The parts of the cookies to  inspect
                                          with  the  rule inspection criteria.
                                          If you specify All  ,  WAF  inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  cookies
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total cookies. The underlying
                                          host service forwards a  maximum  of
                                          200  cookies  and  at  most  8 KB of
                                          cookie contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect a string containing the list  of
                                      the  request's  header names, ordered as
                                      they appear in the web request that  WAF
                                      receives  for  inspection. WAF generates
                                      the string and then  uses  that  as  the
                                      field  to match component in its inspec-
                                      tion. WAF separates the header names  in
                                      the  string  using  commas  and no added
                                      spaces.

                                      Matches against the header order  string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  headers
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total headers. The underlying
                                          host service forwards a  maximum  of
                                          200  headers  and  at  most  8 KB of
                                          header contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion. Text transformations are used in rule
                                   match statements, to transform  the  Field-
                                   ToMatch request component before inspecting
                                   it, and they're  used  in  rate-based  rule
                                   statements, to transform request components
                                   before using  them  as  custom  aggregation
                                   keys.  If you specify one or more transfor-
                                   mations to apply, WAF performs  all  trans-
                                   formations on the specified content, start-
                                   ing from the lowest priority  setting,  and
                                   then uses the component contents.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations.  WAF
                                          processes all transformations,  from
                                          lowest  priority  to highest, before
                                          inspecting the transformed  content.
                                          The priorities don't need to be con-
                                          secutive, but they must all be  dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                               PositionalConstraint -> (string)
                                   The area within the portion of the web  re-
                                   quest  that  you  want  WAF  to  search for
                                   SearchString .  Valid  values  include  the
                                   following:
                                      CONTAINS

                                   The  specified part of the web request must
                                   include the value of SearchString , but the
                                   location doesn't matter.
                                      CONTAINS_WORD

                                   The  specified part of the web request must
                                   include the value  of  SearchString  ,  and
                                   SearchString must contain only alphanumeric
                                   characters or underscore (A-Z, a-z, 0-9, or
                                   _).  In  addition,  SearchString  must be a
                                   word, which means that both of the  follow-
                                   ing are true:

                                   o SearchString  is  at the beginning of the
                                     specified part of the web request  or  is
                                     preceded by a character other than an al-
                                     phanumeric character or  underscore  (_).
                                     Examples  include  the  value of a header
                                     and ;BadBot .

                                   o SearchString is at the end of the  speci-
                                     fied  part  of the web request or is fol-
                                     lowed by a character other  than  an  al-
                                     phanumeric  character  or underscore (_),
                                     for example, BadBot; and -BadBot; .
                                      EXACTLY

                                   The value of the specified part of the  web
                                   request  must  exactly  match  the value of
                                   SearchString .
                                      STARTS_WITH

                                   The value of SearchString  must  appear  at
                                   the  beginning of the specified part of the
                                   web request.
                                      ENDS_WITH

                                   The value of SearchString  must  appear  at
                                   the  end  of  the specified part of the web
                                   request.

                            SqliMatchStatement -> (structure)
                               A rule statement that  inspects  for  malicious
                               SQL  code.  Attackers insert malicious SQL code
                               into web requests to do things like modify your
                               database or extract data from it.

                               FieldToMatch -> (structure)
                                   The  part  of the web request that you want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Alternately, you can filter and  inspect
                                      all  headers  with  the  Headers  Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of the web request that identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see  the  Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see the  Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect  the  request  headers. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the set of headers to and the  parts  of
                                      the headers that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size header content in the  Headers  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the headers that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of headers to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect  only  the  headers whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the headers to match
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect  the  request  cookies. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the set of cookies and the parts of  the
                                      cookies that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size cookie content in the  Cookies  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the cookies that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of cookies to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect  only  the  cookies whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts of the cookies to inspect
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  cookies
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total cookies. The underlying
                                          host  service  forwards a maximum of
                                          200 cookies and  at  most  8  KB  of
                                          cookie contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect  a string containing the list of
                                      the request's header names,  ordered  as
                                      they  appear in the web request that WAF
                                      receives for inspection.  WAF  generates
                                      the  string  and  then  uses that as the
                                      field to match component in its  inspec-
                                      tion.  WAF separates the header names in
                                      the string using  commas  and  no  added
                                      spaces.

                                      Matches  against the header order string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. Text transformations are used in rule
                                   match  statements,  to transform the Field-
                                   ToMatch request component before inspecting
                                   it,  and  they're  used  in rate-based rule
                                   statements, to transform request components
                                   before  using  them  as  custom aggregation
                                   keys. If you specify one or more  transfor-
                                   mations  to  apply, WAF performs all trans-
                                   formations on the specified content, start-
                                   ing  from  the lowest priority setting, and
                                   then uses the component contents.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations.  WAF
                                          processes  all transformations, from
                                          lowest priority to  highest,  before
                                          inspecting  the transformed content.
                                          The priorities don't need to be con-
                                          secutive,  but they must all be dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                               SensitivityLevel -> (string)
                                   The sensitivity that you want WAF to use to
                                   inspect for SQL injection attacks.
                                      HIGH detects  more  attacks,  but  might
                                      generate  more  false  positives,  espe-
                                      cially if your web  requests  frequently
                                      contain unusual strings. For information
                                      about identifying and  mitigating  false
                                      positives, see Testing and tuning in the
                                      WAF Developer Guide .

                                      LOW is generally a better choice for re-
                                      sources  that already have other protec-
                                      tions against SQL injection  attacks  or
                                      that have a low tolerance for false pos-
                                      itives.

                                   Default: LOW

                            XssMatchStatement -> (structure)
                               A rule statement that inspects  for  cross-site
                               scripting  (XSS)  attacks.  In XSS attacks, the
                               attacker uses vulnerabilities in a benign  web-
                               site   as   a   vehicle   to  inject  malicious
                               client-site scripts into other  legitimate  web
                               browsers.

                               FieldToMatch -> (structure)
                                   The  part  of the web request that you want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Alternately, you can filter and  inspect
                                      all  headers  with  the  Headers  Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of the web request that identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see  the  Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see the  Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect  the  request  headers. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the set of headers to and the  parts  of
                                      the headers that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size header content in the  Headers  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the headers that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of headers to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect  only  the  headers whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the headers to match
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect  the  request  cookies. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the set of cookies and the parts of  the
                                      cookies that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size cookie content in the  Cookies  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the cookies that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of cookies to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect  only  the  cookies whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts of the cookies to inspect
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  cookies
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total cookies. The underlying
                                          host  service  forwards a maximum of
                                          200 cookies and  at  most  8  KB  of
                                          cookie contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect  a string containing the list of
                                      the request's header names,  ordered  as
                                      they  appear in the web request that WAF
                                      receives for inspection.  WAF  generates
                                      the  string  and  then  uses that as the
                                      field to match component in its  inspec-
                                      tion.  WAF separates the header names in
                                      the string using  commas  and  no  added
                                      spaces.

                                      Matches  against the header order string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. Text transformations are used in rule
                                   match  statements,  to transform the Field-
                                   ToMatch request component before inspecting
                                   it,  and  they're  used  in rate-based rule
                                   statements, to transform request components
                                   before  using  them  as  custom aggregation
                                   keys. If you specify one or more  transfor-
                                   mations  to  apply, WAF performs all trans-
                                   formations on the specified content, start-
                                   ing  from  the lowest priority setting, and
                                   then uses the component contents.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations.  WAF
                                          processes  all transformations, from
                                          lowest priority to  highest,  before
                                          inspecting  the transformed content.
                                          The priorities don't need to be con-
                                          secutive,  but they must all be dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            SizeConstraintStatement -> (structure)
                               A  rule  statement  that  compares  a number of
                               bytes against the size of a request  component,
                               using  a  comparison  operator, such as greater
                               than (>) or less than (<). For example, you can
                               use  a  size  constraint  statement to look for
                               query strings that are longer than 100 bytes.

                               If you configure WAF  to  inspect  the  request
                               body,  WAF inspects only the number of bytes of
                               the body up to the limit for the  web  ACL.  By
                               default, for regional web ACLs, this limit is 8
                               KB (8,192 kilobytes)  and  for  CloudFront  web
                               ACLs,  this  limit is 16 KB (16,384 kilobytes).
                               For CloudFront web ACLs, you can  increase  the
                               limit  in  the  web ACL AssociationConfig , for
                               additional fees. If you know that  the  request
                               body  for your web requests should never exceed
                               the inspection limit, you could use a size con-
                               straint statement to block requests that have a
                               larger request body size.

                               If you choose URI for the value of Part of  the
                               request  to filter on, the slash (/) in the URI
                               counts as one character. For example,  the  URI
                               /logo.jpg is nine characters long.

                               FieldToMatch -> (structure)
                                   The  part  of the web request that you want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Alternately, you can filter and  inspect
                                      all  headers  with  the  Headers  Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of the web request that identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see  the  Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see the  Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect  the  request  headers. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the set of headers to and the  parts  of
                                      the headers that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size header content in the  Headers  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the headers that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of headers to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect  only  the  headers whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the headers to match
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect  the  request  cookies. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the set of cookies and the parts of  the
                                      cookies that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size cookie content in the  Cookies  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the cookies that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of cookies to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect  only  the  cookies whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts of the cookies to inspect
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  cookies
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total cookies. The underlying
                                          host  service  forwards a maximum of
                                          200 cookies and  at  most  8  KB  of
                                          cookie contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect  a string containing the list of
                                      the request's header names,  ordered  as
                                      they  appear in the web request that WAF
                                      receives for inspection.  WAF  generates
                                      the  string  and  then  uses that as the
                                      field to match component in its  inspec-
                                      tion.  WAF separates the header names in
                                      the string using  commas  and  no  added
                                      spaces.

                                      Matches  against the header order string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               ComparisonOperator -> (string)
                                   The  operator to use to compare the request
                                   part to the size setting.

                               Size -> (long)
                                   The size, in byte, to compare  to  the  re-
                                   quest part, after any transformations.

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. Text transformations are used in rule
                                   match  statements,  to transform the Field-
                                   ToMatch request component before inspecting
                                   it,  and  they're  used  in rate-based rule
                                   statements, to transform request components
                                   before  using  them  as  custom aggregation
                                   keys. If you specify one or more  transfor-
                                   mations  to  apply, WAF performs all trans-
                                   formations on the specified content, start-
                                   ing  from  the lowest priority setting, and
                                   then uses the component contents.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations.  WAF
                                          processes  all transformations, from
                                          lowest priority to  highest,  before
                                          inspecting  the transformed content.
                                          The priorities don't need to be con-
                                          secutive,  but they must all be dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            GeoMatchStatement -> (structure)
                               A  rule  statement  that labels web requests by
                               country and region and that matches against web
                               requests  based  on  country  code. A geo match
                               rule labels every request that it inspects  re-
                               gardless of whether it finds a match.

                               o To  manage  requests only by country, you can
                                 use this statement by itself and specify  the
                                 countries  that  you want to match against in
                                 the CountryCodes array.

                               o Otherwise, configure your geo match rule with
                                 Count action so that it only labels requests.
                                 Then, add one or more label  match  rules  to
                                 run  after  the  geo match rule and configure
                                 them to match against the  geographic  labels
                                 and handle the requests as needed.

                               WAF  labels  requests using the alpha-2 country
                               and region codes from the International Organi-
                               zation for Standardization (ISO) 3166 standard.
                               WAF determines the codes using  either  the  IP
                               address  in  the  web request origin or, if you
                               specify it, the address in the geo  match  For-
                               wardedIPConfig .

                               If  you  use  the web request origin, the label
                               formats   are   awswaf:clientip:geo:region:<ISO
                               country code>-<ISO region code> and awswaf:cli-
                               entip:geo:country:<ISO country code> .

                               If you use a forwarded IP  address,  the  label
                               formats  are awswaf:forwardedip:geo:region:<ISO
                               country code>-<ISO region code> and awswaf:for-
                               wardedip:geo:country:<ISO country code> .

                               For  additional  details,  see Geographic match
                               rule statement in the WAF Developer Guide .

                               CountryCodes -> (list)
                                   An array  of  two-character  country  codes
                                   that  you  want to match against, for exam-
                                   ple, [ "US", "CN"  ]  ,  from  the  alpha-2
                                   country  ISO codes of the ISO 3166 interna-
                                   tional standard.

                                   When you use a geo match statement just for
                                   the  region and country labels that it adds
                                   to requests, you still  have  to  supply  a
                                   country  code  for the rule to evaluate. In
                                   this case, you configure the rule  to  only
                                   count  matching requests, but it will still
                                   generate logging and count metrics for  any
                                   matches.  You  can  reduce  the logging and
                                   metrics that the rule produces by  specify-
                                   ing  a  country  that's  unlikely  to  be a
                                   source of traffic to your site.

                                   (string)

                               ForwardedIPConfig -> (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The  name  of the HTTP header to use for
                                      the IP address. For example, to use  the
                                      X-Forwarded-For  (XFF)  header, set this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The  match  status  to assign to the web
                                      request if the request  doesn't  have  a
                                      valid  IP address in the specified posi-
                                      tion.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      You  can  specify the following fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching  the  rule statement. WAF ap-
                                        plies the rule action to the request.

                                      o NO_MATCH - Treat the  web  request  as
                                        not matching the rule statement.

                            RuleGroupReferenceStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined in a  RuleGroup . To use this, create a
                               rule  group  with  your rules, then provide the
                               ARN of the rule group in this statement.

                               You cannot nest a RuleGroupReferenceStatement ,
                               for  example  for  use inside a NotStatement or
                               OrStatement . You can only  use  a  rule  group
                               reference  statement  at the top level inside a
                               web ACL.

                               ARN -> (string)
                                   The Amazon Resource Name (ARN) of  the  en-
                                   tity.

                               ExcludedRules -> (list)
                                   Rules  in  the  referenced rule group whose
                                   actions are set to Count .

                                   NOTE:
                                      Instead  of  this  option,  use  RuleAc-
                                      tionOverrides . It accepts any valid ac-
                                      tion setting, including Count .

                                   (structure)
                                      Specifies a single rule in a rule  group
                                      whose  action  you  want  to override to
                                      Count .

                                      NOTE:
                                          Instead of this option, use  RuleAc-
                                          tionOverrides . It accepts any valid
                                          action setting, including Count .

                                      Name -> (string)
                                          The name of the  rule  whose  action
                                          you want to override to Count .

                               RuleActionOverrides -> (list)
                                   Action  settings to use in the place of the
                                   rule actions that are configured inside the
                                   rule  group.  You  specify one override for
                                   each rule whose action you want to change.

                                   You can use overrides for testing, for  ex-
                                   ample  you can override all of rule actions
                                   to Count and  then  monitor  the  resulting
                                   count  metrics  to  understand how the rule
                                   group would handle your  web  traffic.  You
                                   can  also  permanently override some or all
                                   actions, to modify how the rule group  man-
                                   ages your web traffic.

                                   (structure)
                                      Action  setting to use in the place of a
                                      rule action that  is  configured  inside
                                      the rule group. You specify one override
                                      for each rule whose action you  want  to
                                      change.

                                      You  can  use overrides for testing, for
                                      example you can override all of rule ac-
                                      tions  to Count and then monitor the re-
                                      sulting count metrics to understand  how
                                      the  rule  group  would  handle your web
                                      traffic. You can also permanently  over-
                                      ride  some or all actions, to modify how
                                      the rule group manages your web traffic.

                                      Name -> (string)
                                          The name of the rule to override.

                                      ActionToUse -> (structure)
                                          The override action to use, in place
                                          of the configured action of the rule
                                          in the rule group.

                                          Block -> (structure)
                                             Instructs WAF to  block  the  web
                                             request.

                                             CustomResponse -> (structure)
                                                 Defines a custom response for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses, see Customizing  web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 ResponseCode -> (integer)
                                                    The HTTP  status  code  to
                                                    return to the client.

                                                    For a list of status codes
                                                    that you can use  in  your
                                                    custom    responses,   see
                                                    Supported status codes for
                                                    custom response in the WAF
                                                    Developer Guide .

                                                 CustomResponseBodyKey      ->
                                                 (string)
                                                    References   the  response
                                                    body that you want WAF  to
                                                    return  to the web request
                                                    client. You can  define  a
                                                    custom response for a rule
                                                    action or  a  default  web
                                                    ACL  action that is set to
                                                    block.  To  do  this,  you
                                                    first  define the response
                                                    body key and value in  the
                                                    CustomResponseBodies  set-
                                                    ting for  the   WebACL  or
                                                    RuleGroup  where  you want
                                                    to use it.  Then,  in  the
                                                    rule action or web ACL de-
                                                    fault  action  BlockAction
                                                    setting, you reference the
                                                    response body  using  this
                                                    key.

                                                 ResponseHeaders -> (list)
                                                    The HTTP headers to use in
                                                    the  response.   Duplicate
                                                    header  names  are not al-
                                                    lowed.

                                                    For information about  the
                                                    limits  on  count and size
                                                    for custom request and re-
                                                    sponse  settings,  see WAF
                                                    quotas in the  WAF  Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse  handling. This
                                                        is used in   CustomRe-
                                                        sponse  and  CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The  name  of   the
                                                           custom header.

                                                           For  custom request
                                                           header   insertion,
                                                           when   WAF  inserts
                                                           the header into the
                                                           request,   it  pre-
                                                           fixes   this   name
                                                           x-amzn-waf-   ,  to
                                                           avoid     confusion
                                                           with   the  headers
                                                           that are already in
                                                           the   request.  For
                                                           example,  for   the
                                                           header  name sample
                                                           , WAF  inserts  the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Allow -> (structure)
                                             Instructs  WAF  to  allow the web
                                             request.

                                             CustomRequestHandling ->  (struc-
                                             ture)
                                                 Defines  custom  handling for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses, see Customizing  web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into  the  request. Dupli-
                                                    cate header names are  not
                                                    allowed.

                                                    For  information about the
                                                    limits on count  and  size
                                                    for custom request and re-
                                                    sponse settings,  see  WAF
                                                    quotas  in  the WAF Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse handling.  This
                                                        is  used in  CustomRe-
                                                        sponse and   CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The   name  of  the
                                                           custom header.

                                                           For custom  request
                                                           header   insertion,
                                                           when  WAF   inserts
                                                           the header into the
                                                           request,  it   pre-
                                                           fixes   this   name
                                                           x-amzn-waf-  ,   to
                                                           avoid     confusion
                                                           with  the   headers
                                                           that are already in
                                                           the  request.   For
                                                           example,   for  the
                                                           header name  sample
                                                           ,  WAF  inserts the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Count -> (structure)
                                             Instructs WAF to  count  the  web
                                             request  and then continue evalu-
                                             ating the request using  the  re-
                                             maining rules in the web ACL.

                                             CustomRequestHandling  -> (struc-
                                             ture)
                                                 Defines custom  handling  for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses,  see Customizing web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into the  request.  Dupli-
                                                    cate  header names are not
                                                    allowed.

                                                    For information about  the
                                                    limits  on  count and size
                                                    for custom request and re-
                                                    sponse  settings,  see WAF
                                                    quotas in the  WAF  Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse  handling. This
                                                        is used in   CustomRe-
                                                        sponse  and  CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The  name  of   the
                                                           custom header.

                                                           For  custom request
                                                           header   insertion,
                                                           when   WAF  inserts
                                                           the header into the
                                                           request,   it  pre-
                                                           fixes   this   name
                                                           x-amzn-waf-   ,  to
                                                           avoid     confusion
                                                           with   the  headers
                                                           that are already in
                                                           the   request.  For
                                                           example,  for   the
                                                           header  name sample
                                                           , WAF  inserts  the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Captcha -> (structure)
                                             Instructs  WAF  to  run a CAPTCHA
                                             check against the web request.

                                             CustomRequestHandling ->  (struc-
                                             ture)
                                                 Defines  custom  handling for
                                                 the web  request,  used  when
                                                 the CAPTCHA inspection deter-
                                                 mines that the request's  to-
                                                 ken is valid and unexpired.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses,  see Customizing web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into the  request.  Dupli-
                                                    cate  header names are not
                                                    allowed.

                                                    For information about  the
                                                    limits  on  count and size
                                                    for custom request and re-
                                                    sponse  settings,  see WAF
                                                    quotas in the  WAF  Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse  handling. This
                                                        is used in   CustomRe-
                                                        sponse  and  CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The  name  of   the
                                                           custom header.

                                                           For  custom request
                                                           header   insertion,
                                                           when   WAF  inserts
                                                           the header into the
                                                           request,   it  pre-
                                                           fixes   this   name
                                                           x-amzn-waf-   ,  to
                                                           avoid     confusion
                                                           with   the  headers
                                                           that are already in
                                                           the   request.  For
                                                           example,  for   the
                                                           header  name sample
                                                           , WAF  inserts  the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Challenge -> (structure)
                                             Instructs  WAF to run a Challenge
                                             check against the web request.

                                             CustomRequestHandling ->  (struc-
                                             ture)
                                                 Defines  custom  handling for
                                                 the web  request,  used  when
                                                 the  challenge inspection de-
                                                 termines that  the  request's
                                                 token is valid and unexpired.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses,  see Customizing web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into the  request.  Dupli-
                                                    cate  header names are not
                                                    allowed.

                                                    For information about  the
                                                    limits  on  count and size
                                                    for custom request and re-
                                                    sponse  settings,  see WAF
                                                    quotas in the  WAF  Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse  handling. This
                                                        is used in   CustomRe-
                                                        sponse  and  CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The  name  of   the
                                                           custom header.

                                                           For  custom request
                                                           header   insertion,
                                                           when   WAF  inserts
                                                           the header into the
                                                           request,   it  pre-
                                                           fixes   this   name
                                                           x-amzn-waf-   ,  to
                                                           avoid     confusion
                                                           with   the  headers
                                                           that are already in
                                                           the   request.  For
                                                           example,  for   the
                                                           header  name sample
                                                           , WAF  inserts  the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                            IPSetReferenceStatement -> (structure)
                               A  rule  statement  used to detect web requests
                               coming from particular IP addresses or  address
                               ranges.  To  use  this,  create  an  IPSet that
                               specifies the addresses  you  want  to  detect,
                               then use the ARN of that set in this statement.
                               To create an IP set, see  CreateIPSet .

                               Each IP set rule  statement  references  an  IP
                               set.  You  create and maintain the set indepen-
                               dent of your rules. This allows you to use  the
                               single  set  in multiple rules. When you update
                               the referenced set, WAF  automatically  updates
                               all rules that reference it.

                               ARN -> (string)
                                   The  Amazon  Resource  Name  (ARN)  of  the
                                   IPSet that this statement references.

                               IPSetForwardedIPConfig -> (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The  name  of the HTTP header to use for
                                      the IP address. For example, to use  the
                                      X-Forwarded-For  (XFF)  header, set this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The  match  status  to assign to the web
                                      request if the request  doesn't  have  a
                                      valid  IP address in the specified posi-
                                      tion.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      You  can  specify the following fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching  the  rule statement. WAF ap-
                                        plies the rule action to the request.

                                      o NO_MATCH - Treat the  web  request  as
                                        not matching the rule statement.

                                   Position -> (string)
                                      The position in the header to search for
                                      the IP address. The header  can  contain
                                      IP  addresses of the original client and
                                      also of proxies. For example, the header
                                      value   could  be  10.1.1.1,  127.0.0.0,
                                      10.10.10.10 where the first  IP  address
                                      identifies  the  original client and the
                                      rest identify proxies that  the  request
                                      went through.

                                      The  options  for  this  setting are the
                                      following:

                                      o FIRST - Inspect the first  IP  address
                                        in  the  list  of  IP addresses in the
                                        header. This is usually  the  client's
                                        original IP.

                                      o LAST  - Inspect the last IP address in
                                        the  list  of  IP  addresses  in   the
                                        header.

                                      o ANY  - Inspect all IP addresses in the
                                        header for a match. If the header con-
                                        tains  more  than 10 IP addresses, WAF
                                        inspects the last 10.

                            RegexPatternSetReferenceStatement -> (structure)
                               A rule statement used  to  search  web  request
                               components  for  matches  with  regular expres-
                               sions. To use this, create  a   RegexPatternSet
                               that specifies the expressions that you want to
                               detect, then use the ARN of that  set  in  this
                               statement.  A  web  request matches the pattern
                               set rule statement  if  the  request  component
                               matches any of the patterns in the set. To cre-
                               ate a regex pattern set,  see   CreateRegexPat-
                               ternSet .

                               Each  regex  pattern  set rule statement refer-
                               ences a regex pattern set. You create and main-
                               tain  the  set  independent of your rules. This
                               allows you to use the single  set  in  multiple
                               rules.  When you update the referenced set, WAF
                               automatically updates all rules that  reference
                               it.

                               ARN -> (string)
                                   The Amazon Resource Name (ARN) of the  Reg-
                                   exPatternSet  that  this  statement  refer-
                                   ences.

                               FieldToMatch -> (structure)
                                   The  part  of the web request that you want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Alternately, you can filter and  inspect
                                      all  headers  with  the  Headers  Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of the web request that identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see  the  Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see the  Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect  the  request  headers. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the set of headers to and the  parts  of
                                      the headers that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size header content in the  Headers  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the headers that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of headers to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect  only  the  headers whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the headers to match
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect  the  request  cookies. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the set of cookies and the parts of  the
                                      cookies that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size cookie content in the  Cookies  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the cookies that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of cookies to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect  only  the  cookies whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts of the cookies to inspect
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  cookies
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total cookies. The underlying
                                          host  service  forwards a maximum of
                                          200 cookies and  at  most  8  KB  of
                                          cookie contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect  a string containing the list of
                                      the request's header names,  ordered  as
                                      they  appear in the web request that WAF
                                      receives for inspection.  WAF  generates
                                      the  string  and  then  uses that as the
                                      field to match component in its  inspec-
                                      tion.  WAF separates the header names in
                                      the string using  commas  and  no  added
                                      spaces.

                                      Matches  against the header order string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. Text transformations are used in rule
                                   match  statements,  to transform the Field-
                                   ToMatch request component before inspecting
                                   it,  and  they're  used  in rate-based rule
                                   statements, to transform request components
                                   before  using  them  as  custom aggregation
                                   keys. If you specify one or more  transfor-
                                   mations  to  apply, WAF performs all trans-
                                   formations on the specified content, start-
                                   ing  from  the lowest priority setting, and
                                   then uses the component contents.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations.  WAF
                                          processes  all transformations, from
                                          lowest priority to  highest,  before
                                          inspecting  the transformed content.
                                          The priorities don't need to be con-
                                          secutive,  but they must all be dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            RateBasedStatement -> (structure)
                               A  rate-based rule counts incoming requests and
                               rate limits requests when they  are  coming  at
                               too  fast a rate. The rule categorizes requests
                               according to your  aggregation  criteria,  col-
                               lects  them  into  aggregation  instances,  and
                               counts and rate limits the  requests  for  each
                               instance.

                               You  can  specify  individual aggregation keys,
                               like IP address or HTTP method.  You  can  also
                               specify  aggregation  key combinations, like IP
                               address and HTTP method, or HTTP method,  query
                               argument, and cookie.

                               Each  unique  set of values for the aggregation
                               keys that you specify is a separate aggregation
                               instance,  with  the  value  from each key con-
                               tributing to the aggregation  instance  defini-
                               tion.

                               For  example, assume the rule evaluates web re-
                               quests with the following IP address  and  HTTP
                               method values:

                               o IP address 10.1.1.1, HTTP method POST

                               o IP address 10.1.1.1, HTTP method GET

                               o IP address 127.0.0.0, HTTP method POST

                               o IP address 10.1.1.1, HTTP method GET

                               The rule would create different aggregation in-
                               stances according to your aggregation criteria,
                               for example:

                               o If  the  aggregation  criteria is just the IP
                                 address, then each individual address  is  an
                                 aggregation instance, and WAF counts requests
                                 separately  for  each.  The  aggregation  in-
                                 stances  and  request  counts for our example
                                 would be the following:

                                 o IP address 10.1.1.1: count 3

                                 o IP address 127.0.0.0: count 1

                               o If the aggregation criteria is  HTTP  method,
                                 then each individual HTTP method is an aggre-
                                 gation instance.  The  aggregation  instances
                                 and  request  counts for our example would be
                                 the following:

                                 o HTTP method POST: count 2

                                 o HTTP method GET: count 2

                               o If the aggregation criteria is IP address and
                                 HTTP  method,  then  each IP address and each
                                 HTTP method would contribute to the  combined
                                 aggregation  instance.  The  aggregation  in-
                                 stances and request counts  for  our  example
                                 would be the following:

                                 o IP  address  10.1.1.1,  HTTP  method  POST:
                                   count 1

                                 o IP address 10.1.1.1, HTTP method GET: count
                                   2

                                 o IP  address  127.0.0.0,  HTTP  method POST:
                                   count 1

                               For  any  n-tuple  of  aggregation  keys,  each
                               unique  combination  of values for the keys de-
                               fines a separate  aggregation  instance,  which
                               WAF counts and rate-limits individually.

                               You  can  optionally nest another statement in-
                               side the rate-based statement,  to  narrow  the
                               scope  of  the  rule so that it only counts and
                               rate limits  requests  that  match  the  nested
                               statement.  You  can use this nested scope-down
                               statement in conjunction with your  aggregation
                               key  specifications  or  you can just count and
                               rate  limit  all  requests   that   match   the
                               scope-down statement, without additional aggre-
                               gation. When you choose to just manage all  re-
                               quests  that  match a scope-down statement, the
                               aggregation instance is singular for the rule.

                               You cannot nest a RateBasedStatement inside an-
                               other statement, for example inside a NotState-
                               ment or OrStatement . You can  define  a  Rate-
                               BasedStatement  inside  a  web ACL and inside a
                               rule group.

                               For additional information about  the  options,
                               see Rate limiting web requests using rate-based
                               rules in the WAF Developer Guide .

                               If you only aggregate on the individual IP  ad-
                               dress or forwarded IP address, you can retrieve
                               the list of IP addresses that WAF is  currently
                               rate  limiting  for a rule through the API call
                               GetRateBasedStatementManagedKeys . This  option
                               is not available for other aggregation configu-
                               rations.

                               WAF tracks and manages web requests  separately
                               for each instance of a rate-based rule that you
                               use. For  example,  if  you  provide  the  same
                               rate-based  rule settings in two web ACLs, each
                               of the two rule statements represents  a  sepa-
                               rate  instance  of the rate-based rule and gets
                               its own tracking and management by WAF. If  you
                               define  a  rate-based rule inside a rule group,
                               and  then  use  that  rule  group  in  multiple
                               places, each use creates a separate instance of
                               the rate-based rule that gets its own  tracking
                               and management by WAF.

                               Limit -> (long)
                                   The  limit  on requests per 5-minute period
                                   for a single aggregation instance  for  the
                                   rate-based  rule.  If the rate-based state-
                                   ment includes a ScopeDownStatement  ,  this
                                   limit  is applied only to the requests that
                                   match the statement.

                                   Examples:

                                   o If you aggregate on just the IP  address,
                                     this  is  the  limit on requests from any
                                     single IP address.

                                   o If you aggregate on the HTTP  method  and
                                     the query argument name "city", then this
                                     is the limit on requests for  any  single
                                     method, city pair.

                               AggregateKeyType -> (string)
                                   Setting that indicates how to aggregate the
                                   request counts.

                                   NOTE:
                                      Web requests that are missing any of the
                                      components  specified in the aggregation
                                      keys are  omitted  from  the  rate-based
                                      rule evaluation and handling.

                                   o CONSTANT  -  Count and limit the requests
                                     that   match   the   rate-based    rule's
                                     scope-down  statement.  With this option,
                                     the counted requests aren't  further  ag-
                                     gregated. The scope-down statement is the
                                     only specification used. When  the  count
                                     of   all   requests   that   satisfy  the
                                     scope-down statement goes over the limit,
                                     WAF  applies  the  rule action to all re-
                                     quests that satisfy the scope-down state-
                                     ment.  With this option, you must config-
                                     ure the ScopeDownStatement property.

                                   o CUSTOM_KEYS  -  Aggregate   the   request
                                     counts using one or more web request com-
                                     ponents as the aggregate keys. With  this
                                     option,  you  must  specify the aggregate
                                     keys in the CustomKeys property.  To  ag-
                                     gregate  on  only  the IP address or only
                                     the forwarded IP address, don't use  cus-
                                     tom  keys. Instead, set the aggregate key
                                     type to IP or FORWARDED_IP .

                                   o FORWARDED_IP  -  Aggregate  the   request
                                     counts on the first IP address in an HTTP
                                     header.  With this option, you must spec-
                                     ify the header to use in the ForwardedIP-
                                     Config property.  To aggregate on a  com-
                                     bination of the forwarded IP address with
                                     other aggregate keys, use CUSTOM_KEYS .

                                   o IP - Aggregate the request counts on  the
                                     IP  address  from the web request origin.
                                     To aggregate on a combination of  the  IP
                                     address  with  other  aggregate keys, use
                                     CUSTOM_KEYS .

                               (  ...  recursive  ...  )ForwardedIPConfig   ->
                               (structure)
                                   The  configuration  for  inspecting  IP ad-
                                   dresses in an HTTP header that you specify,
                                   instead  of using the IP address that's re-
                                   ported by the web request origin. Commonly,
                                   this  is  the X-Forwarded-For (XFF) header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the  request, WAF doesn't apply the rule
                                      to the web request at all.

                                   This is required if you specify a forwarded
                                   IP in the rule's aggregate key settings.

                                   HeaderName -> (string)
                                      The  name  of the HTTP header to use for
                                      the IP address. For example, to use  the
                                      X-Forwarded-For  (XFF)  header, set this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The  match  status  to assign to the web
                                      request if the request  doesn't  have  a
                                      valid  IP address in the specified posi-
                                      tion.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      You  can  specify the following fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching  the  rule statement. WAF ap-
                                        plies the rule action to the request.

                                      o NO_MATCH - Treat the  web  request  as
                                        not matching the rule statement.

                               CustomKeys -> (list)
                                   Specifies  the  aggregate  keys to use in a
                                   rate-base rule.

                                   (structure)
                                      Specifies a single custom aggregate  key
                                      for a rate-base rule.

                                      NOTE:
                                          Web requests that are missing any of
                                          the components specified in the  ag-
                                          gregation  keys are omitted from the
                                          rate-based rule evaluation and  han-
                                          dling.

                                      Header -> (structure)
                                          Use the value of a header in the re-
                                          quest as an aggregate key. Each dis-
                                          tinct  value  in the header contrib-
                                          utes to the aggregation instance. If
                                          you use a single header as your cus-
                                          tom key, then each value  fully  de-
                                          fines an aggregation instance.

                                          Name -> (string)
                                             The name of the header to use.

                                          TextTransformations -> (list)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection. Text transformations are
                                             used in rule match statements, to
                                             transform  the  FieldToMatch  re-
                                             quest component before inspecting
                                             it,    and    they're   used   in
                                             rate-based  rule  statements,  to
                                             transform  request components be-
                                             fore using them as custom  aggre-
                                             gation  keys.  If you specify one
                                             or more transformations to apply,
                                             WAF  performs all transformations
                                             on the specified content,  start-
                                             ing from the lowest priority set-
                                             ting, and then uses the component
                                             contents.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing  order  for   multiple
                                                    transformations.  WAF pro-
                                                    cesses   all   transforma-
                                                    tions,  from lowest prior-
                                                    ity to highest, before in-
                                                    specting  the  transformed
                                                    content.  The   priorities
                                                    don't  need to be consecu-
                                                    tive, but they must all be
                                                    different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      Cookie -> (structure)
                                          Use the value of a cookie in the re-
                                          quest as an aggregate key. Each dis-
                                          tinct value in the  cookie  contrib-
                                          utes to the aggregation instance. If
                                          you use a single cookie as your cus-
                                          tom  key,  then each value fully de-
                                          fines an aggregation instance.

                                          Name -> (string)
                                             The name of the cookie to use.

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. Text transformations are
                                             used in rule match statements, to
                                             transform  the  FieldToMatch  re-
                                             quest component before inspecting
                                             it,   and   they're    used    in
                                             rate-based  rule  statements,  to
                                             transform request components  be-
                                             fore  using them as custom aggre-
                                             gation keys. If you  specify  one
                                             or more transformations to apply,
                                             WAF performs all  transformations
                                             on  the specified content, start-
                                             ing from the lowest priority set-
                                             ting, and then uses the component
                                             contents.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations. WAF  pro-
                                                    cesses   all   transforma-
                                                    tions, from lowest  prior-
                                                    ity to highest, before in-
                                                    specting  the  transformed
                                                    content.   The  priorities
                                                    don't need to be  consecu-
                                                    tive, but they must all be
                                                    different.

                                                 Type -> (string)
                                                    You can specify  the  fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a    Base64   -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode  a  Base64 -en-
                                                        coded string, but  use
                                                        a  forgiving implemen-
                                                        tation  that   ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE    -     Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness of  attackers
                                                        who  inject an operat-
                                                        ing    system     com-
                                                        mand-line  command and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following characters:  /
                                                      (

                                                    o Replace   the  following
                                                      characters with a space:
                                                      , ;

                                                    o Replace  multiple spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters  (A-Z) to lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace  these charac-
                                                        ters  with   a   space
                                                        character     (decimal
                                                        32):

                                                    o \f ,  formfeed,  decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE  -   Decode
                                                        characters  that  were
                                                        encoded using CSS  2.x
                                                        escape    rules   syn-
                                                        data.html#characters .
                                                        This  function uses up
                                                        to two  bytes  in  the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII  characters that
                                                        were encoded using CSS
                                                        encoding  that wouldnt
                                                        typically be  encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of  a  backslash   and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript  for java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI  C   escape   se-
                                                        quences:  \a , \b , \f
                                                        , \n , \r , \t , \v  ,
                                                        \\  ,  \?  , \' , \" ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO  (octal). Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE  - Decode a
                                                        string of  hexadecimal
                                                        characters  into a bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters with  unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs  these opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;    with     a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with  a "less than" sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal  format, (amper-
                                                      sand)#xhhhh; , with  the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal    format,   (amper-
                                                      sand)#nnnn; ,  with  the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript escape  se-
                                                        quences.  If  a  \   u
                                                        HHHH code  is  in  the
                                                        full-width  ASCII code
                                                        range of  FF01-FF5E  ,
                                                        then  the  higher byte
                                                        is used to detect  and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte  is  used and the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE  -   Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash from the data  in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you  don't  want   any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are not at the  begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This  is  the  same as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash  characters   to
                                                        forward slashes.

                                                        REMOVE_NULLS  - Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place each  occurrence
                                                        of  a  C-style comment
                                                        (/* ... */  )  with  a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments  are also re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a standalone  termina-
                                                        tion  of a comment (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS  -   Re-
                                                        place  NULL  bytes  in
                                                        the input  with  space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE  - Decode a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI -  Like
                                                        URL_DECODE  , but with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in    the   full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and  adjust  the lower
                                                        byte. Otherwise,  only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter  sequences to Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives  and false-nega-
                                                        tives for  non-English
                                                        languages.

                                      QueryArgument -> (structure)
                                          Use  the specified query argument as
                                          an  aggregate  key.  Each   distinct
                                          value  for  the named query argument
                                          contributes to the  aggregation  in-
                                          stance.  If  you  use a single query
                                          argument as your  custom  key,  then
                                          each value fully defines an aggrega-
                                          tion instance.

                                          Name -> (string)
                                             The name of the query argument to
                                             use.

                                          TextTransformations -> (list)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection. Text transformations are
                                             used in rule match statements, to
                                             transform  the  FieldToMatch  re-
                                             quest component before inspecting
                                             it,    and    they're   used   in
                                             rate-based  rule  statements,  to
                                             transform  request components be-
                                             fore using them as custom  aggre-
                                             gation  keys.  If you specify one
                                             or more transformations to apply,
                                             WAF  performs all transformations
                                             on the specified content,  start-
                                             ing from the lowest priority set-
                                             ting, and then uses the component
                                             contents.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing  order  for   multiple
                                                    transformations.  WAF pro-
                                                    cesses   all   transforma-
                                                    tions,  from lowest prior-
                                                    ity to highest, before in-
                                                    specting  the  transformed
                                                    content.  The   priorities
                                                    don't  need to be consecu-
                                                    tive, but they must all be
                                                    different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      QueryString -> (structure)
                                          Use the request's query string as an
                                          aggregate  key. Each distinct string
                                          contributes to the  aggregation  in-
                                          stance.  If  you  use just the query
                                          string as your custom key, then each
                                          string  fully defines an aggregation
                                          instance.

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. Text transformations are
                                             used in rule match statements, to
                                             transform  the  FieldToMatch  re-
                                             quest component before inspecting
                                             it,   and   they're    used    in
                                             rate-based  rule  statements,  to
                                             transform request components  be-
                                             fore  using them as custom aggre-
                                             gation keys. If you  specify  one
                                             or more transformations to apply,
                                             WAF performs all  transformations
                                             on  the specified content, start-
                                             ing from the lowest priority set-
                                             ting, and then uses the component
                                             contents.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations. WAF  pro-
                                                    cesses   all   transforma-
                                                    tions, from lowest  prior-
                                                    ity to highest, before in-
                                                    specting  the  transformed
                                                    content.   The  priorities
                                                    don't need to be  consecu-
                                                    tive, but they must all be
                                                    different.

                                                 Type -> (string)
                                                    You can specify  the  fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a    Base64   -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode  a  Base64 -en-
                                                        coded string, but  use
                                                        a  forgiving implemen-
                                                        tation  that   ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE    -     Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness of  attackers
                                                        who  inject an operat-
                                                        ing    system     com-
                                                        mand-line  command and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following characters:  /
                                                      (

                                                    o Replace   the  following
                                                      characters with a space:
                                                      , ;

                                                    o Replace  multiple spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters  (A-Z) to lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace  these charac-
                                                        ters  with   a   space
                                                        character     (decimal
                                                        32):

                                                    o \f ,  formfeed,  decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE  -   Decode
                                                        characters  that  were
                                                        encoded using CSS  2.x
                                                        escape    rules   syn-
                                                        data.html#characters .
                                                        This  function uses up
                                                        to two  bytes  in  the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII  characters that
                                                        were encoded using CSS
                                                        encoding  that wouldnt
                                                        typically be  encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of  a  backslash   and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript  for java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI  C   escape   se-
                                                        quences:  \a , \b , \f
                                                        , \n , \r , \t , \v  ,
                                                        \\  ,  \?  , \' , \" ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO  (octal). Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE  - Decode a
                                                        string of  hexadecimal
                                                        characters  into a bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters with  unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs  these opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;    with     a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with  a "less than" sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal  format, (amper-
                                                      sand)#xhhhh; , with  the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal    format,   (amper-
                                                      sand)#nnnn; ,  with  the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript escape  se-
                                                        quences.  If  a  \   u
                                                        HHHH code  is  in  the
                                                        full-width  ASCII code
                                                        range of  FF01-FF5E  ,
                                                        then  the  higher byte
                                                        is used to detect  and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte  is  used and the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE  -   Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash from the data  in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you  don't  want   any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are not at the  begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This  is  the  same as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash  characters   to
                                                        forward slashes.

                                                        REMOVE_NULLS  - Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place each  occurrence
                                                        of  a  C-style comment
                                                        (/* ... */  )  with  a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments  are also re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a standalone  termina-
                                                        tion  of a comment (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS  -   Re-
                                                        place  NULL  bytes  in
                                                        the input  with  space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE  - Decode a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI -  Like
                                                        URL_DECODE  , but with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in    the   full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and  adjust  the lower
                                                        byte. Otherwise,  only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter  sequences to Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives  and false-nega-
                                                        tives for  non-English
                                                        languages.

                                      HTTPMethod -> (structure)
                                          Use  the request's HTTP method as an
                                          aggregate key.  Each  distinct  HTTP
                                          method  contributes  to the aggrega-
                                          tion instance. If you use  just  the
                                          HTTP method as your custom key, then
                                          each method fully defines an  aggre-
                                          gation instance.

                                      ForwardedIP -> (structure)
                                          Use  the first IP address in an HTTP
                                          header as  an  aggregate  key.  Each
                                          distinct  forwarded  IP address con-
                                          tributes  to  the  aggregation   in-
                                          stance.

                                          When  you specify an IP or forwarded
                                          IP in the custom key  settings,  you
                                          must also specify at least one other
                                          key to use.  You  can  aggregate  on
                                          only  the  forwarded  IP  address by
                                          specifying  FORWARDED_IP   in   your
                                          rate-based statement's AggregateKey-
                                          Type .

                                          With this option, you  must  specify
                                          the  header to use in the rate-based
                                          rule's ForwardedIPConfig property.

                                      IP -> (structure)
                                          Use the request's originating IP ad-
                                          dress as an aggregate key. Each dis-
                                          tinct IP address contributes to  the
                                          aggregation instance.

                                          When  you specify an IP or forwarded
                                          IP in the custom key  settings,  you
                                          must also specify at least one other
                                          key to use.  You  can  aggregate  on
                                          only the IP address by specifying IP
                                          in your rate-based  statement's  Ag-
                                          gregateKeyType .

                                      LabelNamespace -> (structure)
                                          Use the specified label namespace as
                                          an  aggregate  key.  Each   distinct
                                          fully  qualified label name that has
                                          the specified label  namespace  con-
                                          tributes   to  the  aggregation  in-
                                          stance. If you use  just  one  label
                                          namespace  as  your custom key, then
                                          each label name fully defines an ag-
                                          gregation instance.

                                          This uses only labels that have been
                                          added to the request by  rules  that
                                          are evaluated before this rate-based
                                          rule in the web ACL.

                                          For information  about  label  name-
                                          spaces  and  names, see Label syntax
                                          and naming requirements in  the  WAF
                                          Developer Guide .

                                          Namespace -> (string)
                                             The namespace to use for aggrega-
                                             tion.

                            AndStatement -> (structure)
                               A logical rule statement used to combine  other
                               rule  statements  with  AND  logic. You provide
                               more than one  Statement within  the  AndState-
                               ment .

                               Statements -> (list)
                                   The  statements  to combine with AND logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   ( ... recursive ... )

                            OrStatement -> (structure)
                               A  logical rule statement used to combine other
                               rule statements with OR logic. You provide more
                               than one  Statement within the OrStatement .

                               Statements -> (list)
                                   The  statements  to  combine with OR logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   ( ... recursive ... )

                            NotStatement -> (structure)
                               A logical rule statement used to negate the re-
                               sults of another rule  statement.  You  provide
                               one  Statement within the NotStatement .

                               ( ... recursive ... )

                            ManagedRuleGroupStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined in a managed rule group. To  use  this,
                               provide  the  vendor  name  and the name of the
                               rule group in this statement. You can  retrieve
                               the  required names by calling  ListAvailableM-
                               anagedRuleGroups .

                               You cannot nest a  ManagedRuleGroupStatement  ,
                               for  example  for  use inside a NotStatement or
                               OrStatement . It can only be  referenced  as  a
                               top-level statement within a rule.

                               NOTE:
                                   You  are  charged  additional fees when you
                                   use the WAF Bot Control managed rule  group
                                   AWSManagedRulesBotControlRuleSet or the WAF
                                   Fraud Control account  takeover  prevention
                                   (ATP) managed rule group AWSManagedRulesAT-
                                   PRuleSet . For more  information,  see  WAF
                                   Pricing .

                               VendorName -> (string)
                                   The  name of the managed rule group vendor.
                                   You use this, along  with  the  rule  group
                                   name, to identify a rule group.

                               Name -> (string)
                                   The name of the managed rule group. You use
                                   this, along with the vendor name, to  iden-
                                   tify the rule group.

                               Version -> (string)
                                   The  version  of  the managed rule group to
                                   use. If you specify this, the version  set-
                                   ting  is  fixed until you change it. If you
                                   don't specify this, WAF uses  the  vendor's
                                   default version, and then keeps the version
                                   at the vendor's default when the vendor up-
                                   dates the managed rule group settings.

                               ExcludedRules -> (list)
                                   Rules  in  the  referenced rule group whose
                                   actions are set to Count .

                                   NOTE:
                                      Instead  of  this  option,  use  RuleAc-
                                      tionOverrides . It accepts any valid ac-
                                      tion setting, including Count .

                                   (structure)
                                      Specifies a single rule in a rule  group
                                      whose  action  you  want  to override to
                                      Count .

                                      NOTE:
                                          Instead of this option, use  RuleAc-
                                          tionOverrides . It accepts any valid
                                          action setting, including Count .

                                      Name -> (string)
                                          The name of the  rule  whose  action
                                          you want to override to Count .

                               ( ... recursive ... )ManagedRuleGroupConfigs ->
                               (list)
                                   Additional information  that's  used  by  a
                                   managed   rule  group.  Many  managed  rule
                                   groups don't require this.

                                   Use the AWSManagedRulesATPRuleSet  configu-
                                   ration object for the account takeover pre-
                                   vention managed rule group, to provide  in-
                                   formation  such as the sign-in page of your
                                   application and the type of content to  ac-
                                   cept or reject from the client.

                                   Use   the  AWSManagedRulesBotControlRuleSet
                                   configuration object to configure the  pro-
                                   tection level that you want the Bot Control
                                   rule group to use.

                                   (structure)
                                      Additional information that's used by  a
                                      managed  rule  group.  Many managed rule
                                      groups don't require this.

                                      Use the  AWSManagedRulesATPRuleSet  con-
                                      figuration  object for the account take-
                                      over prevention managed rule  group,  to
                                      provide  information such as the sign-in
                                      page of your application and the type of
                                      content  to  accept  or  reject from the
                                      client.

                                      Use the AWSManagedRulesBotControlRuleSet
                                      configuration  object  to  configure the
                                      protection level that you want  the  Bot
                                      Control rule group to use.

                                      For  example specifications, see the ex-
                                      amples section of  CreateWebACL .

                                      LoginPath -> (string)

                                          NOTE:
                                             Instead of this setting,  provide
                                             your  configuration under AWSMan-
                                             agedRulesATPRuleSet .

                                      PayloadType -> (string)

                                          NOTE:
                                             Instead of this setting,  provide
                                             your  configuration under AWSMan-
                                             agedRulesATPRuleSet    RequestIn-
                                             spection .

                                      UsernameField -> (structure)

                                          NOTE:
                                             Instead  of this setting, provide
                                             your configuration under  AWSMan-
                                             agedRulesATPRuleSet    RequestIn-
                                             spection .

                                          Identifier -> (string)
                                             The name of the  username  field.
                                             For example /form/username .

                                      PasswordField -> (structure)

                                          NOTE:
                                             Instead  of this setting, provide
                                             your configuration under  AWSMan-
                                             agedRulesATPRuleSet    RequestIn-
                                             spection .

                                          Identifier -> (string)
                                             The name of the  password  field.
                                             For example /form/password .

                                      AWSManagedRulesBotControlRuleSet      ->
                                      (structure)
                                          Additional configuration  for  using
                                          the  Bot Control managed rule group.
                                          Use this to specify  the  inspection
                                          level  that you want to use. For in-
                                          formation about using the  Bot  Con-
                                          trol managed rule group, see WAF Bot
                                          Control rule group and WAF Bot  Con-
                                          trol in the WAF Developer Guide .

                                          InspectionLevel -> (string)
                                             The  inspection  level to use for
                                             the Bot Control rule  group.  The
                                             common  level is the least expen-
                                             sive. The targeted level includes
                                             all  common  level rules and adds
                                             rules with more advanced  inspec-
                                             tion  criteria.  For details, see
                                             WAF Bot Control rule group in the
                                             WAF Developer Guide .

                                      AWSManagedRulesATPRuleSet -> (structure)
                                          Additional  configuration  for using
                                          the  account   takeover   prevention
                                          (ATP) managed rule group, AWSManage-
                                          dRulesATPRuleSet . Use this to  pro-
                                          vide  login  request  information to
                                          the rule group. For  web  ACLs  that
                                          protect   CloudFront  distributions,
                                          use this to also provide the  infor-
                                          mation  about  how your distribution
                                          responds to login requests.

                                          This configuration replaces the  in-
                                          dividual   configuration  fields  in
                                          ManagedRuleGroupConfig and  provides
                                          additional feature configuration.

                                          For  information about using the ATP
                                          managed rule group,  see  WAF  Fraud
                                          Control  account takeover prevention
                                          (ATP) rule group and WAF Fraud  Con-
                                          trol   account  takeover  prevention
                                          (ATP) in the WAF Developer Guide .

                                          LoginPath -> (string)
                                             The path of  the  login  endpoint
                                             for  your  application. For exam-
                                             ple, for  the  URL  https://exam-
                                             ple.com/web/login   ,  you  would
                                             provide the path /web/login .

                                             The rule group inspects only HTTP
                                             POST  requests  to your specified
                                             login endpoint.

                                          RequestInspection -> (structure)
                                             The criteria for inspecting login
                                             requests,  used  by  the ATP rule
                                             group to validate credentials us-
                                             age.

                                             PayloadType -> (string)
                                                 The payload type for your lo-
                                                 gin endpoint, either JSON  or
                                                 form encoded.

                                             UsernameField -> (structure)
                                                 Details about your login page
                                                 username field.

                                                 How you specify this  depends
                                                 on the payload type.

                                                 o For  JSON payloads, specify
                                                   the  field  name  in   JSON
                                                   pointer  syntax. For infor-
                                                   mation   about   the   JSON
                                                   Pointer syntax, see the In-
                                                   ternet   Engineering   Task
                                                   Force  (IETF) documentation
                                                   JavaScript Object  Notation
                                                   (JSON) Pointer .  For exam-
                                                   ple, for the JSON payload {
                                                   "login":    {   "username":
                                                   "THE_USERNAME", "password":
                                                   "THE_PASSWORD"  }  }  , the
                                                   username  field  specifica-
                                                   tion is /login/username and
                                                   the password field specifi-
                                                   cation is /login/password .

                                                 o For  form  encoded  payload
                                                   types, use  the  HTML  form
                                                   names.  For example, for an
                                                   HTML form with  input  ele-
                                                   ments  named  username1 and
                                                   password1  ,  the  username
                                                   field    specification   is
                                                   username1 and the  password
                                                   field    specification   is
                                                   password1 .

                                                 Identifier -> (string)
                                                    The name of  the  username
                                                    field.     For     example
                                                    /form/username .

                                             PasswordField -> (structure)
                                                 Details about your login page
                                                 password field.

                                                 How  you specify this depends
                                                 on the payload type.

                                                 o For JSON payloads,  specify
                                                   the   field  name  in  JSON
                                                   pointer syntax. For  infor-
                                                   mation   about   the   JSON
                                                   Pointer syntax, see the In-
                                                   ternet   Engineering   Task
                                                   Force (IETF)  documentation
                                                   JavaScript  Object Notation
                                                   (JSON) Pointer .  For exam-
                                                   ple, for the JSON payload {
                                                   "login":   {    "username":
                                                   "THE_USERNAME", "password":
                                                   "THE_PASSWORD" }  }  ,  the
                                                   username  field  specifica-
                                                   tion is /login/username and
                                                   the password field specifi-
                                                   cation is /login/password .

                                                 o For  form  encoded  payload
                                                   types,  use  the  HTML form
                                                   names. For example, for  an
                                                   HTML  form  with input ele-
                                                   ments named  username1  and
                                                   password1  ,  the  username
                                                   field   specification    is
                                                   username1  and the password
                                                   field   specification    is
                                                   password1 .

                                                 Identifier -> (string)
                                                    The  name  of the password
                                                    field.     For     example
                                                    /form/password .

                                          ResponseInspection -> (structure)
                                             The  criteria  for inspecting re-
                                             sponses to login  requests,  used
                                             by  the  ATP  rule group to track
                                             login failure rates.

                                             The ATP rule group evaluates  the
                                             responses that your protected re-
                                             sources send back to client login
                                             attempts,  keeping  count of suc-
                                             cessful and failed attempts  from
                                             each  IP  address and client ses-
                                             sion. Using this information, the
                                             rule  group  labels and mitigates
                                             requests from client sessions and
                                             IP addresses that submit too many
                                             failed login attempts in a  short
                                             amount of time.

                                             NOTE:
                                                 Response inspection is avail-
                                                 able only in  web  ACLs  that
                                                 protect   Amazon   CloudFront
                                                 distributions.

                                             StatusCode -> (structure)
                                                 Configures inspection of  the
                                                 response status code.

                                                 SuccessCodes -> (list)
                                                    Status  codes  in  the re-
                                                    sponse  that  indicate   a
                                                    successful  login attempt.
                                                    To be counted  as  a  suc-
                                                    cessful   login,  the  re-
                                                    sponse  status  code  must
                                                    match  one  of these. Each
                                                    code must be unique  among
                                                    the  success  and  failure
                                                    status codes.

                                                    JSON  example:   "Success-
                                                    Codes": [ 200, 201 ]

                                                    (integer)

                                                 FailureCodes -> (list)
                                                    Status  codes  in  the re-
                                                    sponse  that  indicate   a
                                                    failed  login  attempt. To
                                                    be counted as a failed lo-
                                                    gin,  the  response status
                                                    code  must  match  one  of
                                                    these.  Each  code must be
                                                    unique among  the  success
                                                    and failure status codes.

                                                    JSON   example:  "Failure-
                                                    Codes": [ 400, 404 ]

                                                    (integer)

                                             Header -> (structure)
                                                 Configures inspection of  the
                                                 response header.

                                                 Name -> (string)
                                                    The  name of the header to
                                                    match  against.  The  name
                                                    must  be  an  exact match,
                                                    including case.

                                                    JSON  example:  "Name":  [
                                                    "LoginResult" ]

                                                 SuccessValues -> (list)
                                                    Values   in  the  response
                                                    header with the  specified
                                                    name  that indicate a suc-
                                                    cessful login attempt.  To
                                                    be counted as a successful
                                                    login, the value  must  be
                                                    an  exact match, including
                                                    case. Each value  must  be
                                                    unique  among  the success
                                                    and failure values.

                                                    JSON example: "SuccessVal-
                                                    ues":   [   "LoginPassed",
                                                    "Successful login" ]

                                                    (string)

                                                 FailureValues -> (list)
                                                    Values  in  the   response
                                                    header  with the specified
                                                    name   that   indicate   a
                                                    failed  login  attempt. To
                                                    be counted as a failed lo-
                                                    gin,  the value must be an
                                                    exact   match,   including
                                                    case.  Each  value must be
                                                    unique among  the  success
                                                    and failure values.

                                                    JSON example: "FailureVal-
                                                    ues":   [   "LoginFailed",
                                                    "Failed login" ]

                                                    (string)

                                             BodyContains -> (structure)
                                                 Configures  inspection of the
                                                 response body.  WAF  can  in-
                                                 spect  the first 65,536 bytes
                                                 (64 KB) of the response body.

                                                 SuccessStrings -> (list)
                                                    Strings in the body of the
                                                    response  that  indicate a
                                                    successful login  attempt.
                                                    To  be  counted  as a suc-
                                                    cessful login, the  string
                                                    can  be  anywhere  in  the
                                                    body and must be an  exact
                                                    match,   including   case.
                                                    Each string must be unique
                                                    among   the   success  and
                                                    failure strings.

                                                    JSON    example:     "Suc-
                                                    cessStrings":   [   "Login
                                                    successful",  "Welcome  to
                                                    our site!" ]

                                                    (string)

                                                 FailureStrings -> (list)
                                                    Strings in the body of the
                                                    response that  indicate  a
                                                    failed  login  attempt. To
                                                    be counted as a failed lo-
                                                    gin,  the  string  can  be
                                                    anywhere in the  body  and
                                                    must  be  an  exact match,
                                                    including    case.    Each
                                                    string   must   be  unique
                                                    among  the   success   and
                                                    failure strings.

                                                    JSON   example:  "Failure-
                                                    Strings": [ "Login failed"
                                                    ]

                                                    (string)

                                             Json -> (structure)
                                                 Configures  inspection of the
                                                 response JSON.  WAF  can  in-
                                                 spect  the first 65,536 bytes
                                                 (64 KB) of the response JSON.

                                                 Identifier -> (string)
                                                    The  identifier  for   the
                                                    value  to match against in
                                                    the JSON.  The  identifier
                                                    must  be  an  exact match,
                                                    including case.

                                                    JSON   example:   "Identi-
                                                    fier":  [ "/login/success"
                                                    ]

                                                 SuccessValues -> (list)
                                                    Values for  the  specified
                                                    identifier in the response
                                                    JSON that indicate a  suc-
                                                    cessful  login attempt. To
                                                    be counted as a successful
                                                    login,  the  value must be
                                                    an exact match,  including
                                                    case.  Each  value must be
                                                    unique among  the  success
                                                    and failure values.

                                                    JSON example: "SuccessVal-
                                                    ues":  [   "True",   "Suc-
                                                    ceeded" ]

                                                    (string)

                                                 FailureValues -> (list)
                                                    Values  for  the specified
                                                    identifier in the response
                                                    JSON   that   indicate   a
                                                    failed login  attempt.  To
                                                    be counted as a failed lo-
                                                    gin, the value must be  an
                                                    exact   match,   including
                                                    case. Each value  must  be
                                                    unique  among  the success
                                                    and failure values.

                                                    JSON example: "FailureVal-
                                                    ues":  [ "False", "Failed"
                                                    ]

                                                    (string)

                               RuleActionOverrides -> (list)
                                   Action settings to use in the place of  the
                                   rule actions that are configured inside the
                                   rule group. You specify  one  override  for
                                   each rule whose action you want to change.

                                   You  can use overrides for testing, for ex-
                                   ample you can override all of rule  actions
                                   to  Count  and  then  monitor the resulting
                                   count metrics to understand  how  the  rule
                                   group  would  handle  your web traffic. You
                                   can also permanently override some  or  all
                                   actions,  to modify how the rule group man-
                                   ages your web traffic.

                                   (structure)
                                      Action setting to use in the place of  a
                                      rule  action  that  is configured inside
                                      the rule group. You specify one override
                                      for  each  rule whose action you want to
                                      change.

                                      You can use overrides for  testing,  for
                                      example you can override all of rule ac-
                                      tions to Count and then monitor the  re-
                                      sulting  count metrics to understand how
                                      the rule group  would  handle  your  web
                                      traffic.  You can also permanently over-
                                      ride some or all actions, to modify  how
                                      the rule group manages your web traffic.

                                      Name -> (string)
                                          The name of the rule to override.

                                      ActionToUse -> (structure)
                                          The override action to use, in place
                                          of the configured action of the rule
                                          in the rule group.

                                          Block -> (structure)
                                             Instructs  WAF  to  block the web
                                             request.

                                             CustomResponse -> (structure)
                                                 Defines a custom response for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses,  see Customizing web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 ResponseCode -> (integer)
                                                    The  HTTP  status  code to
                                                    return to the client.

                                                    For a list of status codes
                                                    that  you  can use in your
                                                    custom   responses,    see
                                                    Supported status codes for
                                                    custom response in the WAF
                                                    Developer Guide .

                                                 CustomResponseBodyKey      ->
                                                 (string)
                                                    References  the   response
                                                    body  that you want WAF to
                                                    return to the web  request
                                                    client.  You  can define a
                                                    custom response for a rule
                                                    action  or  a  default web
                                                    ACL action that is set  to
                                                    block.  To  do  this,  you
                                                    first define the  response
                                                    body  key and value in the
                                                    CustomResponseBodies  set-
                                                    ting  for  the   WebACL or
                                                    RuleGroup where  you  want
                                                    to  use  it.  Then, in the
                                                    rule action or web ACL de-
                                                    fault  action  BlockAction
                                                    setting, you reference the
                                                    response  body  using this
                                                    key.

                                                 ResponseHeaders -> (list)
                                                    The HTTP headers to use in
                                                    the   response.  Duplicate
                                                    header names are  not  al-
                                                    lowed.

                                                    For  information about the
                                                    limits on count  and  size
                                                    for custom request and re-
                                                    sponse settings,  see  WAF
                                                    quotas  in  the WAF Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse handling.  This
                                                        is  used in  CustomRe-
                                                        sponse and   CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The   name  of  the
                                                           custom header.

                                                           For custom  request
                                                           header   insertion,
                                                           when  WAF   inserts
                                                           the header into the
                                                           request,  it   pre-
                                                           fixes   this   name
                                                           x-amzn-waf-  ,   to
                                                           avoid     confusion
                                                           with  the   headers
                                                           that are already in
                                                           the  request.   For
                                                           example,   for  the
                                                           header name  sample
                                                           ,  WAF  inserts the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Allow -> (structure)
                                             Instructs WAF to  allow  the  web
                                             request.

                                             CustomRequestHandling  -> (struc-
                                             ture)
                                                 Defines custom  handling  for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses,  see Customizing web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into the  request.  Dupli-
                                                    cate  header names are not
                                                    allowed.

                                                    For information about  the
                                                    limits  on  count and size
                                                    for custom request and re-
                                                    sponse  settings,  see WAF
                                                    quotas in the  WAF  Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse  handling. This
                                                        is used in   CustomRe-
                                                        sponse  and  CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The  name  of   the
                                                           custom header.

                                                           For  custom request
                                                           header   insertion,
                                                           when   WAF  inserts
                                                           the header into the
                                                           request,   it  pre-
                                                           fixes   this   name
                                                           x-amzn-waf-   ,  to
                                                           avoid     confusion
                                                           with   the  headers
                                                           that are already in
                                                           the   request.  For
                                                           example,  for   the
                                                           header  name sample
                                                           , WAF  inserts  the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Count -> (structure)
                                             Instructs  WAF  to  count the web
                                             request and then continue  evalu-
                                             ating  the  request using the re-
                                             maining rules in the web ACL.

                                             CustomRequestHandling ->  (struc-
                                             ture)
                                                 Defines  custom  handling for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses, see Customizing  web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into  the  request. Dupli-
                                                    cate header names are  not
                                                    allowed.

                                                    For  information about the
                                                    limits on count  and  size
                                                    for custom request and re-
                                                    sponse settings,  see  WAF
                                                    quotas  in  the WAF Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse handling.  This
                                                        is  used in  CustomRe-
                                                        sponse and   CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The   name  of  the
                                                           custom header.

                                                           For custom  request
                                                           header   insertion,
                                                           when  WAF   inserts
                                                           the header into the
                                                           request,  it   pre-
                                                           fixes   this   name
                                                           x-amzn-waf-  ,   to
                                                           avoid     confusion
                                                           with  the   headers
                                                           that are already in
                                                           the  request.   For
                                                           example,   for  the
                                                           header name  sample
                                                           ,  WAF  inserts the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Captcha -> (structure)
                                             Instructs WAF to  run  a  CAPTCHA
                                             check against the web request.

                                             CustomRequestHandling  -> (struc-
                                             ture)
                                                 Defines custom  handling  for
                                                 the  web  request,  used when
                                                 the CAPTCHA inspection deter-
                                                 mines  that the request's to-
                                                 ken is valid and unexpired.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses, see Customizing  web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into  the  request. Dupli-
                                                    cate header names are  not
                                                    allowed.

                                                    For  information about the
                                                    limits on count  and  size
                                                    for custom request and re-
                                                    sponse settings,  see  WAF
                                                    quotas  in  the WAF Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse handling.  This
                                                        is  used in  CustomRe-
                                                        sponse and   CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The   name  of  the
                                                           custom header.

                                                           For custom  request
                                                           header   insertion,
                                                           when  WAF   inserts
                                                           the header into the
                                                           request,  it   pre-
                                                           fixes   this   name
                                                           x-amzn-waf-  ,   to
                                                           avoid     confusion
                                                           with  the   headers
                                                           that are already in
                                                           the  request.   For
                                                           example,   for  the
                                                           header name  sample
                                                           ,  WAF  inserts the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Challenge -> (structure)
                                             Instructs WAF to run a  Challenge
                                             check against the web request.

                                             CustomRequestHandling  -> (struc-
                                             ture)
                                                 Defines custom  handling  for
                                                 the  web  request,  used when
                                                 the challenge inspection  de-
                                                 termines  that  the request's
                                                 token is valid and unexpired.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses, see Customizing  web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into  the  request. Dupli-
                                                    cate header names are  not
                                                    allowed.

                                                    For  information about the
                                                    limits on count  and  size
                                                    for custom request and re-
                                                    sponse settings,  see  WAF
                                                    quotas  in  the WAF Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse handling.  This
                                                        is  used in  CustomRe-
                                                        sponse and   CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The   name  of  the
                                                           custom header.

                                                           For custom  request
                                                           header   insertion,
                                                           when  WAF   inserts
                                                           the header into the
                                                           request,  it   pre-
                                                           fixes   this   name
                                                           x-amzn-waf-  ,   to
                                                           avoid     confusion
                                                           with  the   headers
                                                           that are already in
                                                           the  request.   For
                                                           example,   for  the
                                                           header name  sample
                                                           ,  WAF  inserts the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                            LabelMatchStatement -> (structure)
                               A rule statement to match against  labels  that
                               have  been  added  to  the web request by rules
                               that have already run in the web ACL.

                               The label match statement provides the label or
                               namespace  string  to  search  for.  The  label
                               string can represent a part or all of the fully
                               qualified label name that had been added to the
                               web request. Fully qualified labels have a pre-
                               fix,  optional  namespaces, and label name. The
                               prefix identifies the rule  group  or  web  ACL
                               context  of  the  rule that added the label. If
                               you do not provide the fully qualified name  in
                               your  label  match  string,  WAF  performs  the
                               search for labels that were added in  the  same
                               context as the label match statement.

                               Scope -> (string)
                                   Specify whether you want to match using the
                                   label name or just the namespace.

                               Key -> (string)
                                   The string to match  against.  The  setting
                                   you  provide  for this depends on the match
                                   statement's Scope setting:

                                   o If the Scope indicates LABEL , then  this
                                     specification  must  include the name and
                                     can include any number of preceding name-
                                     space  specifications  and  prefix  up to
                                     providing the fully qualified label name.

                                   o If the Scope indicates NAMESPACE  ,  then
                                     this specification can include any number
                                     of contiguous namespace strings, and  can
                                     include the entire label namespace prefix
                                     from the rule group or web ACL where  the
                                     label originates.

                                   Labels are case sensitive and components of
                                   a label must be separated by colon, for ex-
                                   ample NS1:NS2:name .

                            RegexMatchStatement -> (structure)
                               A  rule  statement  used  to search web request
                               components for a match against a single regular
                               expression.

                               RegexString -> (string)
                                   The string representing the regular expres-
                                   sion.

                               FieldToMatch -> (structure)
                                   The part of the web request that  you  want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Alternately,  you can filter and inspect
                                      all headers  with  the  Headers   Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the part of the web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A  limited amount of the request body is
                                      forwarded to WAF for inspection  by  the
                                      underlying  host  service.  For regional
                                      resources, the  limit  is  8  KB  (8,192
                                      kilobytes)  and for CloudFront distribu-
                                      tions, the limit is 16 KB (16,384  kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you can increase the limit  in  the  web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized  request  bodies, see the Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      A  limited amount of the request body is
                                      forwarded to WAF for inspection  by  the
                                      underlying  host  service.  For regional
                                      resources, the  limit  is  8  KB  (8,192
                                      kilobytes)  and for CloudFront distribu-
                                      tions, the limit is 16 KB (16,384  kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you can increase the limit  in  the  web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized  request bodies, see the Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect the request  headers.  You  must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the  set  of headers to and the parts of
                                      the headers that WAF inspects.

                                      Only the first 8 KB (8192  bytes)  of  a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must configure how to handle  any  over-
                                      size  header  content in the Headers ob-
                                      ject. WAF applies the  pattern  matching
                                      filters  to the headers that it receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The filter to use  to  identify  the
                                          subset  of  headers  to inspect in a
                                          web request.

                                          You must specify  exactly  one  set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have  a  key  that matches one of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect only  the  headers  whose
                                             keys   don't  match  any  of  the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The parts of the  headers  to  match
                                          with  the  rule inspection criteria.
                                          If you specify All  ,  WAF  inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  headers
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total headers. The underlying
                                          host service forwards a  maximum  of
                                          200  headers  and  at  most  8 KB of
                                          header contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect the request  cookies.  You  must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the  set of cookies and the parts of the
                                      cookies that WAF inspects.

                                      Only the first 8 KB (8192  bytes)  of  a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must configure how to handle  any  over-
                                      size  cookie  content in the Cookies ob-
                                      ject. WAF applies the  pattern  matching
                                      filters  to the cookies that it receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The filter to use  to  identify  the
                                          subset  of  cookies  to inspect in a
                                          web request.

                                          You must specify  exactly  one  set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have  a  key  that matches one of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect only  the  cookies  whose
                                             keys   don't  match  any  of  the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The parts of the cookies to  inspect
                                          with  the  rule inspection criteria.
                                          If you specify All  ,  WAF  inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  cookies
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total cookies. The underlying
                                          host service forwards a  maximum  of
                                          200  cookies  and  at  most  8 KB of
                                          cookie contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect a string containing the list  of
                                      the  request's  header names, ordered as
                                      they appear in the web request that  WAF
                                      receives  for  inspection. WAF generates
                                      the string and then  uses  that  as  the
                                      field  to match component in its inspec-
                                      tion. WAF separates the header names  in
                                      the  string  using  commas  and no added
                                      spaces.

                                      Matches against the header order  string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  headers
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total headers. The underlying
                                          host service forwards a  maximum  of
                                          200  headers  and  at  most  8 KB of
                                          header contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion. Text transformations are used in rule
                                   match statements, to transform  the  Field-
                                   ToMatch request component before inspecting
                                   it, and they're  used  in  rate-based  rule
                                   statements, to transform request components
                                   before using  them  as  custom  aggregation
                                   keys.  If you specify one or more transfor-
                                   mations to apply, WAF performs  all  trans-
                                   formations on the specified content, start-
                                   ing from the lowest priority  setting,  and
                                   then uses the component contents.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations.  WAF
                                          processes all transformations,  from
                                          lowest  priority  to highest, before
                                          inspecting the transformed  content.
                                          The priorities don't need to be con-
                                          secutive, but they must all be  dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                        ForwardedIPConfig -> (structure)
                            The configuration for inspecting IP  addresses  in
                            an  HTTP header that you specify, instead of using
                            the IP address that's reported by the web  request
                            origin.  Commonly,  this  is  the  X-Forwarded-For
                            (XFF) header, but you can specify any header name.

                            NOTE:
                               If the specified header isn't  present  in  the
                               request,  WAF doesn't apply the rule to the web
                               request at all.

                            This is required if you specify a forwarded IP  in
                            the rule's aggregate key settings.

                            HeaderName -> (string)
                               The  name  of the HTTP header to use for the IP
                               address.  For  example,  to  use   the   X-For-
                               warded-For  (XFF)  header,  set  this to X-For-
                               warded-For .

                               NOTE:
                                   If the specified header  isn't  present  in
                                   the  request, WAF doesn't apply the rule to
                                   the web request at all.

                            FallbackBehavior -> (string)
                               The match status to assign to the  web  request
                               if  the request doesn't have a valid IP address
                               in the specified position.

                               NOTE:
                                   If the specified header  isn't  present  in
                                   the  request, WAF doesn't apply the rule to
                                   the web request at all.

                               You can specify the following  fallback  behav-
                               iors:

                               o MATCH - Treat the web request as matching the
                                 rule statement. WAF applies the  rule  action
                                 to the request.

                               o NO_MATCH  -  Treat  the  web  request  as not
                                 matching the rule statement.

                        CustomKeys -> (list)
                            Specifies the aggregate keys to use in a rate-base
                            rule.

                            (structure)
                               Specifies  a  single custom aggregate key for a
                               rate-base rule.

                               NOTE:
                                   Web requests that are missing  any  of  the
                                   components  specified  in  the  aggregation
                                   keys are omitted from the  rate-based  rule
                                   evaluation and handling.

                               Header -> (structure)
                                   Use the value of a header in the request as
                                   an aggregate key. Each  distinct  value  in
                                   the  header  contributes to the aggregation
                                   instance. If you use  a  single  header  as
                                   your  custom key, then each value fully de-
                                   fines an aggregation instance.

                                   Name -> (string)
                                      The name of the header to use.

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form  the FieldToMatch request component
                                      before inspecting it, and  they're  used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them  as custom aggregation keys. If you
                                      specify one or more  transformations  to
                                      apply,  WAF performs all transformations
                                      on the specified content, starting  from
                                      the  lowest  priority  setting, and then
                                      uses the component contents.

                                      (structure)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets  the relative processing or-
                                             der for multiple transformations.
                                             WAF   processes  all  transforma-
                                             tions, from  lowest  priority  to
                                             highest,  before  inspecting  the
                                             transformed content. The  priori-
                                             ties  don't  need  to be consecu-
                                             tive, but they must all  be  dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                               Cookie -> (structure)
                                   Use the value of a cookie in the request as
                                   an  aggregate  key.  Each distinct value in
                                   the cookie contributes to  the  aggregation
                                   instance.  If  you  use  a single cookie as
                                   your custom key, then each value fully  de-
                                   fines an aggregation instance.

                                   Name -> (string)
                                      The name of the cookie to use.

                                   TextTransformations -> (list)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form the FieldToMatch request  component
                                      before  inspecting  it, and they're used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them as custom aggregation keys. If  you
                                      specify  one  or more transformations to
                                      apply, WAF performs all  transformations
                                      on  the specified content, starting from
                                      the lowest priority  setting,  and  then
                                      uses the component contents.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der for multiple transformations.
                                             WAF  processes  all   transforma-
                                             tions,  from  lowest  priority to
                                             highest,  before  inspecting  the
                                             transformed  content. The priori-
                                             ties don't need  to  be  consecu-
                                             tive,  but  they must all be dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE   -   Decode  a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT - Decode  a
                                                 Base64  -encoded  string, but
                                                 use a  forgiving  implementa-
                                                 tion  that ignores characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.   These  are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual formatting to  disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete spaces before  the  fol-
                                               lowing characters: / (

                                             o Replace  the  following charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE  -   Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r , carriage  return,  decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places multiple  spaces  with
                                                 one space.

                                                 CSS_DECODE  -  Decode charac-
                                                 ters that were encoded  using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in the decoding  process,  so
                                                 it  can help to uncover ASCII
                                                 characters that were  encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's  also useful in counter-
                                                 ing evasion, which is a  com-
                                                 bination  of  a backslash and
                                                 non-hexadecimal   characters.
                                                 For  example, ja\vascript for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE  -   Decode
                                                 the  following  ANSI C escape
                                                 sequences: \a , \b , \f ,  \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 , \"  ,  \xHH  (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't valid  remain  in  the
                                                 output.

                                                 HEX_DECODE  - Decode a string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE  - Replace
                                                 HTML-encoded characters  with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces  (ampersand)quot; with
                                               "

                                             o Replaces (ampersand)nbsp;  with
                                               a  non-breaking  space, decimal
                                               160

                                             o Replaces (ampersand)lt; with  a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat,  (ampersand)#xhhhh; , with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented  in decimal format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape sequences. If a  \   u
                                                 HHHH    code    is   in   the
                                                 full-width ASCII  code  range
                                                 of   FF01-FF5E   ,  then  the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not, only the lower  byte  is
                                                 used  and  the higher byte is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5  -  Calculate an MD5 hash
                                                 from the data in  the  input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE - Specify  NONE  if  you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH - Remove  mul-
                                                 tiple    slashes,   directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not at the beginning  of  the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN  - This is
                                                 the same as NORMALIZE_PATH  ,
                                                 but  first converts backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS   -  Remove  all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS  -   Replace
                                                 each  occurrence of a C-style
                                                 comment (/* ... */ )  with  a
                                                 single  space.  Multiple con-
                                                 secutive occurrences are  not
                                                 compressed. Unterminated com-
                                                 ments are also replaced  with
                                                 a  space  (ASCII  0x20). How-
                                                 ever, a  standalone  termina-
                                                 tion  of  a  comment (*/ ) is
                                                 not acted upon.

                                                 REPLACE_NULLS - Replace  NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE -  Decode  SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE , but with  support  for
                                                 Microsoft-specific  %u encod-
                                                 ing. If the code  is  in  the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte  is  used  to detect and
                                                 adjust the lower byte. Other-
                                                 wise,  only the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8 character sequences  to
                                                 Unicode.   This  helps  input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives for  non-Eng-
                                                 lish languages.

                               QueryArgument -> (structure)
                                   Use  the specified query argument as an ag-
                                   gregate key. Each distinct  value  for  the
                                   named query argument contributes to the ag-
                                   gregation instance. If  you  use  a  single
                                   query  argument  as  your  custom key, then
                                   each value fully defines an aggregation in-
                                   stance.

                                   Name -> (string)
                                      The name of the query argument to use.

                                   TextTransformations -> (list)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form the FieldToMatch request  component
                                      before  inspecting  it, and they're used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them as custom aggregation keys. If  you
                                      specify  one  or more transformations to
                                      apply, WAF performs all  transformations
                                      on  the specified content, starting from
                                      the lowest priority  setting,  and  then
                                      uses the component contents.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der for multiple transformations.
                                             WAF  processes  all   transforma-
                                             tions,  from  lowest  priority to
                                             highest,  before  inspecting  the
                                             transformed  content. The priori-
                                             ties don't need  to  be  consecu-
                                             tive,  but  they must all be dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE   -   Decode  a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT - Decode  a
                                                 Base64  -encoded  string, but
                                                 use a  forgiving  implementa-
                                                 tion  that ignores characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.   These  are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual formatting to  disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete spaces before  the  fol-
                                               lowing characters: / (

                                             o Replace  the  following charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE  -   Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r , carriage  return,  decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places multiple  spaces  with
                                                 one space.

                                                 CSS_DECODE  -  Decode charac-
                                                 ters that were encoded  using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in the decoding  process,  so
                                                 it  can help to uncover ASCII
                                                 characters that were  encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's  also useful in counter-
                                                 ing evasion, which is a  com-
                                                 bination  of  a backslash and
                                                 non-hexadecimal   characters.
                                                 For  example, ja\vascript for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE  -   Decode
                                                 the  following  ANSI C escape
                                                 sequences: \a , \b , \f ,  \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 , \"  ,  \xHH  (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't valid  remain  in  the
                                                 output.

                                                 HEX_DECODE  - Decode a string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE  - Replace
                                                 HTML-encoded characters  with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces  (ampersand)quot; with
                                               "

                                             o Replaces (ampersand)nbsp;  with
                                               a  non-breaking  space, decimal
                                               160

                                             o Replaces (ampersand)lt; with  a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat,  (ampersand)#xhhhh; , with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented  in decimal format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape sequences. If a  \   u
                                                 HHHH    code    is   in   the
                                                 full-width ASCII  code  range
                                                 of   FF01-FF5E   ,  then  the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not, only the lower  byte  is
                                                 used  and  the higher byte is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5  -  Calculate an MD5 hash
                                                 from the data in  the  input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE - Specify  NONE  if  you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH - Remove  mul-
                                                 tiple    slashes,   directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not at the beginning  of  the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN  - This is
                                                 the same as NORMALIZE_PATH  ,
                                                 but  first converts backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS   -  Remove  all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS  -   Replace
                                                 each  occurrence of a C-style
                                                 comment (/* ... */ )  with  a
                                                 single  space.  Multiple con-
                                                 secutive occurrences are  not
                                                 compressed. Unterminated com-
                                                 ments are also replaced  with
                                                 a  space  (ASCII  0x20). How-
                                                 ever, a  standalone  termina-
                                                 tion  of  a  comment (*/ ) is
                                                 not acted upon.

                                                 REPLACE_NULLS - Replace  NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE -  Decode  SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE , but with  support  for
                                                 Microsoft-specific  %u encod-
                                                 ing. If the code  is  in  the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte  is  used  to detect and
                                                 adjust the lower byte. Other-
                                                 wise,  only the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8 character sequences  to
                                                 Unicode.   This  helps  input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives for  non-Eng-
                                                 lish languages.

                               QueryString -> (structure)
                                   Use the request's query string as an aggre-
                                   gate key. Each distinct string  contributes
                                   to  the  aggregation  instance.  If you use
                                   just the query string as your  custom  key,
                                   then  each string fully defines an aggrega-
                                   tion instance.

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form  the FieldToMatch request component
                                      before inspecting it, and  they're  used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them  as custom aggregation keys. If you
                                      specify one or more  transformations  to
                                      apply,  WAF performs all transformations
                                      on the specified content, starting  from
                                      the  lowest  priority  setting, and then
                                      uses the component contents.

                                      (structure)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets  the relative processing or-
                                             der for multiple transformations.
                                             WAF   processes  all  transforma-
                                             tions, from  lowest  priority  to
                                             highest,  before  inspecting  the
                                             transformed content. The  priori-
                                             ties  don't  need  to be consecu-
                                             tive, but they must all  be  dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                               HTTPMethod -> (structure)
                                   Use the request's HTTP method as an  aggre-
                                   gate  key.  Each  distinct HTTP method con-
                                   tributes to the  aggregation  instance.  If
                                   you use just the HTTP method as your custom
                                   key, then each method fully defines an  ag-
                                   gregation instance.

                               ForwardedIP -> (structure)
                                   Use  the first IP address in an HTTP header
                                   as an aggregate  key.  Each  distinct  for-
                                   warded IP address contributes to the aggre-
                                   gation instance.

                                   When you specify an IP or forwarded  IP  in
                                   the  custom  key  settings,  you  must also
                                   specify at least one other key to use.  You
                                   can  aggregate on only the forwarded IP ad-
                                   dress by specifying  FORWARDED_IP  in  your
                                   rate-based statement's AggregateKeyType .

                                   With  this  option,  you  must  specify the
                                   header to use in the rate-based rule's For-
                                   wardedIPConfig property.

                               IP -> (structure)
                                   Use the request's originating IP address as
                                   an aggregate key. Each distinct IP  address
                                   contributes to the aggregation instance.

                                   When  you  specify an IP or forwarded IP in
                                   the custom  key  settings,  you  must  also
                                   specify  at least one other key to use. You
                                   can aggregate on only  the  IP  address  by
                                   specifying  IP  in  your  rate-based state-
                                   ment's AggregateKeyType .

                               LabelNamespace -> (structure)
                                   Use the specified label namespace as an ag-
                                   gregate  key. Each distinct fully qualified
                                   label name that  has  the  specified  label
                                   namespace  contributes  to  the aggregation
                                   instance. If you use just one  label  name-
                                   space  as  your custom key, then each label
                                   name fully defines an aggregation instance.

                                   This uses only labels that have been  added
                                   to  the request by rules that are evaluated
                                   before this rate-based rule in the web ACL.

                                   For information about label namespaces  and
                                   names, see Label syntax and naming require-
                                   ments in the WAF Developer Guide .

                                   Namespace -> (string)
                                      The namespace to use for aggregation.

                     AndStatement -> (structure)
                        A logical rule statement used to  combine  other  rule
                        statements  with  AND logic. You provide more than one
                        Statement within the AndStatement .

                        Statements -> (list)
                            The statements to combine with AND logic. You  can
                            use any statements that can be nested.

                            (structure)
                               The  processing  guidance for a  Rule , used by
                               WAF to determine whether a web request  matches
                               the rule.

                               For  example  specifications,  see the examples
                               section of  CreateWebACL .

                               ByteMatchStatement -> (structure)
                                   A rule  statement  that  defines  a  string
                                   match  search  for  WAF to apply to web re-
                                   quests. The byte match  statement  provides
                                   the  bytes  to  search for, the location in
                                   requests that you want WAF to  search,  and
                                   other settings. The bytes to search for are
                                   typically a string  that  corresponds  with
                                   ASCII  characters.  In  the WAF console and
                                   the  developer  guide,  this  is  called  a
                                   string match statement.

                                   SearchString -> (blob)
                                      A  string  value  that  you  want WAF to
                                      search for. WAF  searches  only  in  the
                                      part  of web requests that you designate
                                      for inspection in   FieldToMatch  .  The
                                      maximum  length  of  the  value  is  200
                                      bytes.

                                      Valid values  depend  on  the  component
                                      that   you  specify  for  inspection  in
                                      FieldToMatch :

                                      o Method : The HTTP method that you want
                                        WAF  to search for. This indicates the
                                        type of operation specified in the re-
                                        quest.

                                      o UriPath  : The value that you want WAF
                                        to search for in the URI path, for ex-
                                        ample, /images/daily-ad.jpg .

                                      o HeaderOrder : The comma-separated list
                                        of header names to match for. WAF cre-
                                        ates  a  string  that contains the or-
                                        dered list of header names,  from  the
                                        headers  in  the web request, and then
                                        matches against that string.

                                      If  SearchString   includes   alphabetic
                                      characters  A-Z  and  a-z, note that the
                                      value is case sensitive.
                                          If you're using the WAF API

                                      Specify a base64-encoded version of  the
                                      value.  The  maximum length of the value
                                      before  you  base64-encode  it  is   200
                                      bytes.

                                      For  example,  suppose the value of Type
                                      is HEADER  and  the  value  of  Data  is
                                      User-Agent  .  If you want to search the
                                      User-Agent header for the value BadBot ,
                                      you   base64-encode  BadBot  using  MIME
                                      base64-encoding and include the  result-
                                      ing  value,  QmFkQm90  , in the value of
                                      SearchString .
                                          If you're using the CLI  or  one  of
                                          the Amazon Web Services SDKs

                                      The  value  that  you want WAF to search
                                      for. The SDK  automatically  base64  en-
                                      codes the value.

                                   FieldToMatch -> (structure)
                                      The  part  of  the  web request that you
                                      want WAF to inspect.

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name  of  the header to inspect, for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example   JSON:   "SingleHeader":  {
                                          "Name": "haystack" }

                                          Alternately, you can filter and  in-
                                          spect  all  headers with the Headers
                                          FieldToMatch setting.

                                          Name -> (string)
                                             The name of the query  header  to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide the name of the query  argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion . The name can be up  to
                                          30  characters  long  and isn't case
                                          sensitive.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the part of the web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          A limited amount of the request body
                                          is  forwarded  to WAF for inspection
                                          by the underlying host service.  For
                                          regional  resources,  the limit is 8
                                          KB (8,192 kilobytes) and for  Cloud-
                                          Front distributions, the limit is 16
                                          KB (16,384  kilobytes).  For  Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in  the  web  ACL's
                                          AssociationConfig  ,  for additional
                                          processing fees.

                                          For information about how to  handle
                                          oversized  request  bodies,  see the
                                          Body object configuration.

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger  than WAF can inspect. WAF
                                             does not support  inspecting  the
                                             entire  contents  of  the web re-
                                             quest body if  the  body  exceeds
                                             the  limit for the resource type.
                                             If the body is  larger  than  the
                                             limit,  the  underlying host ser-
                                             vice only forwards  the  contents
                                             that  are  below the limit to WAF
                                             for inspection.

                                             The default limit is 8 KB  (8,192
                                             kilobytes) for regional resources
                                             and 16 KB (16,384 kilobytes)  for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig  ,  for   addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  body  contents  normally,
                                               according to the  rule  inspec-
                                               tion criteria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling with your rule  and  web
                                             ACL  action settings, so that you
                                             block any request whose  body  is
                                             over the limit.

                                             Default: CONTINUE

                                      Method -> (structure)
                                          Inspect  the HTTP method. The method
                                          indicates the type of operation that
                                          the  request is asking the origin to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect the request  body  as  JSON.
                                          The request body immediately follows
                                          the request  headers.  This  is  the
                                          part  of a request that contains any
                                          additional data  that  you  want  to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          A limited amount of the request body
                                          is forwarded to WAF  for  inspection
                                          by  the underlying host service. For
                                          regional resources, the limit  is  8
                                          KB  (8,192 kilobytes) and for Cloud-
                                          Front distributions, the limit is 16
                                          KB  (16,384  kilobytes).  For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the  limit  in the web ACL's
                                          AssociationConfig ,  for  additional
                                          processing fees.

                                          For  information about how to handle
                                          oversized request  bodies,  see  the
                                          JsonBody object configuration.

                                          MatchPattern -> (structure)
                                             The  patterns  to look for in the
                                             JSON body. WAF inspects  the  re-
                                             sults  of  these  pattern matches
                                             against the rule inspection  cri-
                                             teria.

                                             All -> (structure)
                                                 Match  all  of  the elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You  must specify either this
                                                 setting or the  IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match  only the specified in-
                                                 clude paths. See also  Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing JSON Pointer syntax.  For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"]  . For infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force  (IETF)   documentation
                                                 JavaScript   Object  Notation
                                                 (JSON) Pointer .

                                                 You must specify either  this
                                                 setting  or  the All setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't use this  option  to
                                                    include   all  paths.  In-
                                                    stead, use  the  All  set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The  parts  of  the JSON to match
                                             against using the MatchPattern  .
                                             If  you specify All , WAF matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely  parse  the JSON body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING  -   Inspect
                                               the body as plain text. WAF ap-
                                               plies the text  transformations
                                               and  inspection  criteria  that
                                               you defined for  the  JSON  in-
                                               spection   to   the  body  text
                                               string.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             If  you  don't  provide this set-
                                             ting, WAF  parses  and  evaluates
                                             the  content only up to the first
                                             parsing failure that  it  encoun-
                                             ters.

                                             WAF  does  its  best to parse the
                                             entire JSON body,  but  might  be
                                             forced  to  stop for reasons such
                                             as invalid characters,  duplicate
                                             keys, truncation, and any content
                                             whose root node isn't  an  object
                                             or an array.

                                             WAF  parses  the JSON in the fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger than WAF can inspect.  WAF
                                             does  not  support inspecting the
                                             entire contents of  the  web  re-
                                             quest  body  if  the body exceeds
                                             the limit for the resource  type.
                                             If  the  body  is larger than the
                                             limit, the underlying  host  ser-
                                             vice  only  forwards the contents
                                             that are below the limit  to  WAF
                                             for inspection.

                                             The  default limit is 8 KB (8,192
                                             kilobytes) for regional resources
                                             and  16 KB (16,384 kilobytes) for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig   ,  for  addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able  body  contents  normally,
                                               according  to  the rule inspec-
                                               tion criteria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling  with  your rule and web
                                             ACL action settings, so that  you
                                             block  any  request whose body is
                                             over the limit.

                                             Default: CONTINUE

                                      Headers -> (structure)
                                          Inspect  the  request  headers.  You
                                          must  configure  scope  and  pattern
                                          matching filters in the Headers  ob-
                                          ject,  to  define the set of headers
                                          to and the parts of the headers that
                                          WAF inspects.

                                          Only  the first 8 KB (8192 bytes) of
                                          a request's  headers  and  only  the
                                          first  200  headers are forwarded to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to handle any oversize  header  con-
                                          tent  in the Headers object. WAF ap-
                                          plies the pattern  matching  filters
                                          to the headers that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of headers to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting:  either All , IncludedHead-
                                             ers , or ExcludedHeaders .

                                             Example JSON:  "MatchPattern":  {
                                             "ExcludedHeaders":     {"KeyToEx-
                                             clude1", "KeyToExclude2"} }

                                             All -> (structure)
                                                 Inspect all headers.

                                             IncludedHeaders -> (list)
                                                 Inspect only the headers that
                                                 have  a  key that matches one
                                                 of  the   strings   specified
                                                 here.

                                                 (string)

                                             ExcludedHeaders -> (list)
                                                 Inspect   only   the  headers
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the headers to match
                                             with the rule  inspection  crite-
                                             ria. If you specify All , WAF in-
                                             spects both keys and values.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             headers  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  head-
                                             ers.  The underlying host service
                                             forwards a maximum of 200 headers
                                             and  at  most 8 KB of header con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able headers normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                      Cookies -> (structure)
                                          Inspect  the  request  cookies.  You
                                          must  configure  scope  and  pattern
                                          matching  filters in the Cookies ob-
                                          ject, to define the set  of  cookies
                                          and  the  parts  of the cookies that
                                          WAF inspects.

                                          Only the first 8 KB (8192 bytes)  of
                                          a  request's  cookies  and  only the
                                          first 200 cookies are  forwarded  to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to  handle  any oversize cookie con-
                                          tent in the Cookies object. WAF  ap-
                                          plies  the  pattern matching filters
                                          to the cookies that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of cookies to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting: either All ,  IncludedCook-
                                             ies , or ExcludedCookies .

                                             Example  JSON:  "MatchPattern": {
                                             "IncludedCookies":     {"KeyToIn-
                                             clude1",  "KeyToInclude2",  "Key-
                                             ToInclude3"} }

                                             All -> (structure)
                                                 Inspect all cookies.

                                             IncludedCookies -> (list)
                                                 Inspect only the cookies that
                                                 have  a  key that matches one
                                                 of  the   strings   specified
                                                 here.

                                                 (string)

                                             ExcludedCookies -> (list)
                                                 Inspect   only   the  cookies
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The  parts  of the cookies to in-
                                             spect with  the  rule  inspection
                                             criteria.  If  you  specify All ,
                                             WAF inspects both keys  and  val-
                                             ues.

                                          OversizeHandling -> (string)
                                             What WAF should do if the cookies
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             cookies when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total cook-
                                             ies. The underlying host  service
                                             forwards a maximum of 200 cookies
                                             and at most 8 KB of  cookie  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  cookies normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                      HeaderOrder -> (structure)
                                          Inspect a string containing the list
                                          of  the  request's header names, or-
                                          dered as they appear in the web  re-
                                          quest  that WAF receives for inspec-
                                          tion. WAF generates the  string  and
                                          then uses that as the field to match
                                          component  in  its  inspection.  WAF
                                          separates  the  header  names in the
                                          string using  commas  and  no  added
                                          spaces.

                                          Matches  against  the  header  order
                                          string are case insensitive.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             headers  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  head-
                                             ers.  The underlying host service
                                             forwards a maximum of 200 headers
                                             and  at  most 8 KB of header con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able headers normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   TextTransformations -> (list)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form the FieldToMatch request  component
                                      before  inspecting  it, and they're used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them as custom aggregation keys. If  you
                                      specify  one  or more transformations to
                                      apply, WAF performs all  transformations
                                      on  the specified content, starting from
                                      the lowest priority  setting,  and  then
                                      uses the component contents.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der for multiple transformations.
                                             WAF  processes  all   transforma-
                                             tions,  from  lowest  priority to
                                             highest,  before  inspecting  the
                                             transformed  content. The priori-
                                             ties don't need  to  be  consecu-
                                             tive,  but  they must all be dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE   -   Decode  a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT - Decode  a
                                                 Base64  -encoded  string, but
                                                 use a  forgiving  implementa-
                                                 tion  that ignores characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.   These  are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual formatting to  disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete spaces before  the  fol-
                                               lowing characters: / (

                                             o Replace  the  following charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE  -   Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r , carriage  return,  decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places multiple  spaces  with
                                                 one space.

                                                 CSS_DECODE  -  Decode charac-
                                                 ters that were encoded  using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in the decoding  process,  so
                                                 it  can help to uncover ASCII
                                                 characters that were  encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's  also useful in counter-
                                                 ing evasion, which is a  com-
                                                 bination  of  a backslash and
                                                 non-hexadecimal   characters.
                                                 For  example, ja\vascript for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE  -   Decode
                                                 the  following  ANSI C escape
                                                 sequences: \a , \b , \f ,  \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 , \"  ,  \xHH  (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't valid  remain  in  the
                                                 output.

                                                 HEX_DECODE  - Decode a string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE  - Replace
                                                 HTML-encoded characters  with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces  (ampersand)quot; with
                                               "

                                             o Replaces (ampersand)nbsp;  with
                                               a  non-breaking  space, decimal
                                               160

                                             o Replaces (ampersand)lt; with  a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat,  (ampersand)#xhhhh; , with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented  in decimal format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape sequences. If a  \   u
                                                 HHHH    code    is   in   the
                                                 full-width ASCII  code  range
                                                 of   FF01-FF5E   ,  then  the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not, only the lower  byte  is
                                                 used  and  the higher byte is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5  -  Calculate an MD5 hash
                                                 from the data in  the  input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE - Specify  NONE  if  you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH - Remove  mul-
                                                 tiple    slashes,   directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not at the beginning  of  the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN  - This is
                                                 the same as NORMALIZE_PATH  ,
                                                 but  first converts backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS   -  Remove  all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS  -   Replace
                                                 each  occurrence of a C-style
                                                 comment (/* ... */ )  with  a
                                                 single  space.  Multiple con-
                                                 secutive occurrences are  not
                                                 compressed. Unterminated com-
                                                 ments are also replaced  with
                                                 a  space  (ASCII  0x20). How-
                                                 ever, a  standalone  termina-
                                                 tion  of  a  comment (*/ ) is
                                                 not acted upon.

                                                 REPLACE_NULLS - Replace  NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE -  Decode  SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE , but with  support  for
                                                 Microsoft-specific  %u encod-
                                                 ing. If the code  is  in  the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte  is  used  to detect and
                                                 adjust the lower byte. Other-
                                                 wise,  only the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8 character sequences  to
                                                 Unicode.   This  helps  input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives for  non-Eng-
                                                 lish languages.

                                   PositionalConstraint -> (string)
                                      The  area  within the portion of the web
                                      request that you want WAF to search  for
                                      SearchString  . Valid values include the
                                      following:
                                          CONTAINS

                                      The specified part of  the  web  request
                                      must include the value of SearchString ,
                                      but the location doesn't matter.
                                          CONTAINS_WORD

                                      The specified part of  the  web  request
                                      must include the value of SearchString ,
                                      and SearchString must contain  only  al-
                                      phanumeric   characters   or  underscore
                                      (A-Z, a-z,  0-9,  or  _).  In  addition,
                                      SearchString must be a word, which means
                                      that both of the following are true:

                                      o SearchString is at  the  beginning  of
                                        the  specified part of the web request
                                        or is preceded by  a  character  other
                                        than  an alphanumeric character or un-
                                        derscore  (_).  Examples  include  the
                                        value of a header and ;BadBot .

                                      o SearchString  is  at  the  end  of the
                                        specified part of the web  request  or
                                        is  followed by a character other than
                                        an alphanumeric  character  or  under-
                                        score  (_),  for  example, BadBot; and
                                        -BadBot; .
                                          EXACTLY

                                      The value of the specified part  of  the
                                      web request must exactly match the value
                                      of SearchString .
                                          STARTS_WITH

                                      The value of SearchString must appear at
                                      the  beginning  of the specified part of
                                      the web request.
                                          ENDS_WITH

                                      The value of SearchString must appear at
                                      the end of the specified part of the web
                                      request.

                               SqliMatchStatement -> (structure)
                                   A rule statement that  inspects  for  mali-
                                   cious  SQL code. Attackers insert malicious
                                   SQL code into web  requests  to  do  things
                                   like  modify  your database or extract data
                                   from it.

                                   FieldToMatch -> (structure)
                                      The part of the  web  request  that  you
                                      want WAF to inspect.

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Alternately,  you can filter and in-
                                          spect all headers with  the  Headers
                                          FieldToMatch setting.

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect  the  request URI path. This
                                          is the part of the web request  that
                                          identifies  a resource, for example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect the query  string.  This  is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect the request  body  as  plain
                                          text.  The  request body immediately
                                          follows the request headers. This is
                                          the  part of a request that contains
                                          any additional data that you want to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          A limited amount of the request body
                                          is forwarded to WAF  for  inspection
                                          by  the underlying host service. For
                                          regional resources, the limit  is  8
                                          KB  (8,192 kilobytes) and for Cloud-
                                          Front distributions, the limit is 16
                                          KB  (16,384  kilobytes).  For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the  limit  in the web ACL's
                                          AssociationConfig ,  for  additional
                                          processing fees.

                                          For  information about how to handle
                                          oversized request  bodies,  see  the
                                          Body object configuration.

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger than WAF can inspect.  WAF
                                             does  not  support inspecting the
                                             entire contents of  the  web  re-
                                             quest  body  if  the body exceeds
                                             the limit for the resource  type.
                                             If  the  body  is larger than the
                                             limit, the underlying  host  ser-
                                             vice  only  forwards the contents
                                             that are below the limit  to  WAF
                                             for inspection.

                                             The  default limit is 8 KB (8,192
                                             kilobytes) for regional resources
                                             and  16 KB (16,384 kilobytes) for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig   ,  for  addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able  body  contents  normally,
                                               according  to  the rule inspec-
                                               tion criteria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling  with  your rule and web
                                             ACL action settings, so that  you
                                             block  any  request whose body is
                                             over the limit.

                                             Default: CONTINUE

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          A limited amount of the request body
                                          is  forwarded  to WAF for inspection
                                          by the underlying host service.  For
                                          regional  resources,  the limit is 8
                                          KB (8,192 kilobytes) and for  Cloud-
                                          Front distributions, the limit is 16
                                          KB (16,384  kilobytes).  For  Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in  the  web  ACL's
                                          AssociationConfig  ,  for additional
                                          processing fees.

                                          For information about how to  handle
                                          oversized  request  bodies,  see the
                                          JsonBody object configuration.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger  than WAF can inspect. WAF
                                             does not support  inspecting  the
                                             entire  contents  of  the web re-
                                             quest body if  the  body  exceeds
                                             the  limit for the resource type.
                                             If the body is  larger  than  the
                                             limit,  the  underlying host ser-
                                             vice only forwards  the  contents
                                             that  are  below the limit to WAF
                                             for inspection.

                                             The default limit is 8 KB  (8,192
                                             kilobytes) for regional resources
                                             and 16 KB (16,384 kilobytes)  for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig  ,  for   addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  body  contents  normally,
                                               according to the  rule  inspec-
                                               tion criteria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling with your rule  and  web
                                             ACL  action settings, so that you
                                             block any request whose  body  is
                                             over the limit.

                                             Default: CONTINUE

                                      Headers -> (structure)
                                          Inspect  the  request  headers.  You
                                          must  configure  scope  and  pattern
                                          matching  filters in the Headers ob-
                                          ject, to define the set  of  headers
                                          to and the parts of the headers that
                                          WAF inspects.

                                          Only the first 8 KB (8192 bytes)  of
                                          a  request's  headers  and  only the
                                          first 200 headers are  forwarded  to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to  handle  any oversize header con-
                                          tent in the Headers object. WAF  ap-
                                          plies  the  pattern matching filters
                                          to the headers that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of headers to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting: either All ,  IncludedHead-
                                             ers , or ExcludedHeaders .

                                             Example  JSON:  "MatchPattern": {
                                             "ExcludedHeaders":     {"KeyToEx-
                                             clude1", "KeyToExclude2"} }

                                             All -> (structure)
                                                 Inspect all headers.

                                             IncludedHeaders -> (list)
                                                 Inspect only the headers that
                                                 have a key that  matches  one
                                                 of   the   strings  specified
                                                 here.

                                                 (string)

                                             ExcludedHeaders -> (list)
                                                 Inspect  only   the   headers
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the headers to match
                                             with  the  rule inspection crite-
                                             ria. If you specify All , WAF in-
                                             spects both keys and values.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             headers when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total head-
                                             ers. The underlying host  service
                                             forwards a maximum of 200 headers
                                             and at most 8 KB of  header  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  headers normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                      Cookies -> (structure)
                                          Inspect  the  request  cookies.  You
                                          must  configure  scope  and  pattern
                                          matching filters in the Cookies  ob-
                                          ject,  to  define the set of cookies
                                          and the parts of  the  cookies  that
                                          WAF inspects.

                                          Only  the first 8 KB (8192 bytes) of
                                          a request's  cookies  and  only  the
                                          first  200  cookies are forwarded to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to handle any oversize  cookie  con-
                                          tent  in the Cookies object. WAF ap-
                                          plies the pattern  matching  filters
                                          to the cookies that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of cookies to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting:  either All , IncludedCook-
                                             ies , or ExcludedCookies .

                                             Example JSON:  "MatchPattern":  {
                                             "IncludedCookies":     {"KeyToIn-
                                             clude1",  "KeyToInclude2",  "Key-
                                             ToInclude3"} }

                                             All -> (structure)
                                                 Inspect all cookies.

                                             IncludedCookies -> (list)
                                                 Inspect only the cookies that
                                                 have a key that  matches  one
                                                 of   the   strings  specified
                                                 here.

                                                 (string)

                                             ExcludedCookies -> (list)
                                                 Inspect  only   the   cookies
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the cookies  to  in-
                                             spect  with  the  rule inspection
                                             criteria. If you  specify  All  ,
                                             WAF  inspects  both keys and val-
                                             ues.

                                          OversizeHandling -> (string)
                                             What WAF should do if the cookies
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             cookies  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  cook-
                                             ies.  The underlying host service
                                             forwards a maximum of 200 cookies
                                             and  at  most 8 KB of cookie con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able cookies normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                      HeaderOrder -> (structure)
                                          Inspect a string containing the list
                                          of the request's header  names,  or-
                                          dered  as they appear in the web re-
                                          quest that WAF receives for  inspec-
                                          tion.  WAF  generates the string and
                                          then uses that as the field to match
                                          component  in  its  inspection.  WAF
                                          separates the header  names  in  the
                                          string  using  commas  and  no added
                                          spaces.

                                          Matches  against  the  header  order
                                          string are case insensitive.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             headers when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total head-
                                             ers. The underlying host  service
                                             forwards a maximum of 200 headers
                                             and at most 8 KB of  header  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  headers normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form  the FieldToMatch request component
                                      before inspecting it, and  they're  used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them  as custom aggregation keys. If you
                                      specify one or more  transformations  to
                                      apply,  WAF performs all transformations
                                      on the specified content, starting  from
                                      the  lowest  priority  setting, and then
                                      uses the component contents.

                                      (structure)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets  the relative processing or-
                                             der for multiple transformations.
                                             WAF   processes  all  transforma-
                                             tions, from  lowest  priority  to
                                             highest,  before  inspecting  the
                                             transformed content. The  priori-
                                             ties  don't  need  to be consecu-
                                             tive, but they must all  be  dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                                   SensitivityLevel -> (string)
                                      The sensitivity that you want WAF to use
                                      to inspect for SQL injection attacks.
                                          HIGH detects more attacks, but might
                                          generate more false positives, espe-
                                          cially  if  your  web  requests fre-
                                          quently contain unusual strings. For
                                          information  about  identifying  and
                                          mitigating  false   positives,   see
                                          Testing and tuning in the WAF Devel-
                                          oper Guide .

                                          LOW is generally a better choice for
                                          resources  that  already  have other
                                          protections  against  SQL  injection
                                          attacks or that have a low tolerance
                                          for false positives.

                                      Default: LOW

                               XssMatchStatement -> (structure)
                                   A  rule   statement   that   inspects   for
                                   cross-site  scripting (XSS) attacks. In XSS
                                   attacks, the attacker uses  vulnerabilities
                                   in  a benign website as a vehicle to inject
                                   malicious client-site  scripts  into  other
                                   legitimate web browsers.

                                   FieldToMatch -> (structure)
                                      The  part  of  the  web request that you
                                      want WAF to inspect.

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name  of  the header to inspect, for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example   JSON:   "SingleHeader":  {
                                          "Name": "haystack" }

                                          Alternately, you can filter and  in-
                                          spect  all  headers with the Headers
                                          FieldToMatch setting.

                                          Name -> (string)
                                             The name of the query  header  to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide the name of the query  argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion . The name can be up  to
                                          30  characters  long  and isn't case
                                          sensitive.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the part of the web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          A limited amount of the request body
                                          is  forwarded  to WAF for inspection
                                          by the underlying host service.  For
                                          regional  resources,  the limit is 8
                                          KB (8,192 kilobytes) and for  Cloud-
                                          Front distributions, the limit is 16
                                          KB (16,384  kilobytes).  For  Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in  the  web  ACL's
                                          AssociationConfig  ,  for additional
                                          processing fees.

                                          For information about how to  handle
                                          oversized  request  bodies,  see the
                                          Body object configuration.

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger  than WAF can inspect. WAF
                                             does not support  inspecting  the
                                             entire  contents  of  the web re-
                                             quest body if  the  body  exceeds
                                             the  limit for the resource type.
                                             If the body is  larger  than  the
                                             limit,  the  underlying host ser-
                                             vice only forwards  the  contents
                                             that  are  below the limit to WAF
                                             for inspection.

                                             The default limit is 8 KB  (8,192
                                             kilobytes) for regional resources
                                             and 16 KB (16,384 kilobytes)  for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig  ,  for   addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  body  contents  normally,
                                               according to the  rule  inspec-
                                               tion criteria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling with your rule  and  web
                                             ACL  action settings, so that you
                                             block any request whose  body  is
                                             over the limit.

                                             Default: CONTINUE

                                      Method -> (structure)
                                          Inspect  the HTTP method. The method
                                          indicates the type of operation that
                                          the  request is asking the origin to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect the request  body  as  JSON.
                                          The request body immediately follows
                                          the request  headers.  This  is  the
                                          part  of a request that contains any
                                          additional data  that  you  want  to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          A limited amount of the request body
                                          is forwarded to WAF  for  inspection
                                          by  the underlying host service. For
                                          regional resources, the limit  is  8
                                          KB  (8,192 kilobytes) and for Cloud-
                                          Front distributions, the limit is 16
                                          KB  (16,384  kilobytes).  For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the  limit  in the web ACL's
                                          AssociationConfig ,  for  additional
                                          processing fees.

                                          For  information about how to handle
                                          oversized request  bodies,  see  the
                                          JsonBody object configuration.

                                          MatchPattern -> (structure)
                                             The  patterns  to look for in the
                                             JSON body. WAF inspects  the  re-
                                             sults  of  these  pattern matches
                                             against the rule inspection  cri-
                                             teria.

                                             All -> (structure)
                                                 Match  all  of  the elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You  must specify either this
                                                 setting or the  IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match  only the specified in-
                                                 clude paths. See also  Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing JSON Pointer syntax.  For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"]  . For infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force  (IETF)   documentation
                                                 JavaScript   Object  Notation
                                                 (JSON) Pointer .

                                                 You must specify either  this
                                                 setting  or  the All setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't use this  option  to
                                                    include   all  paths.  In-
                                                    stead, use  the  All  set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The  parts  of  the JSON to match
                                             against using the MatchPattern  .
                                             If  you specify All , WAF matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely  parse  the JSON body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING  -   Inspect
                                               the body as plain text. WAF ap-
                                               plies the text  transformations
                                               and  inspection  criteria  that
                                               you defined for  the  JSON  in-
                                               spection   to   the  body  text
                                               string.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             If  you  don't  provide this set-
                                             ting, WAF  parses  and  evaluates
                                             the  content only up to the first
                                             parsing failure that  it  encoun-
                                             ters.

                                             WAF  does  its  best to parse the
                                             entire JSON body,  but  might  be
                                             forced  to  stop for reasons such
                                             as invalid characters,  duplicate
                                             keys, truncation, and any content
                                             whose root node isn't  an  object
                                             or an array.

                                             WAF  parses  the JSON in the fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger than WAF can inspect.  WAF
                                             does  not  support inspecting the
                                             entire contents of  the  web  re-
                                             quest  body  if  the body exceeds
                                             the limit for the resource  type.
                                             If  the  body  is larger than the
                                             limit, the underlying  host  ser-
                                             vice  only  forwards the contents
                                             that are below the limit  to  WAF
                                             for inspection.

                                             The  default limit is 8 KB (8,192
                                             kilobytes) for regional resources
                                             and  16 KB (16,384 kilobytes) for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig   ,  for  addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able  body  contents  normally,
                                               according  to  the rule inspec-
                                               tion criteria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling  with  your rule and web
                                             ACL action settings, so that  you
                                             block  any  request whose body is
                                             over the limit.

                                             Default: CONTINUE

                                      Headers -> (structure)
                                          Inspect  the  request  headers.  You
                                          must  configure  scope  and  pattern
                                          matching filters in the Headers  ob-
                                          ject,  to  define the set of headers
                                          to and the parts of the headers that
                                          WAF inspects.

                                          Only  the first 8 KB (8192 bytes) of
                                          a request's  headers  and  only  the
                                          first  200  headers are forwarded to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to handle any oversize  header  con-
                                          tent  in the Headers object. WAF ap-
                                          plies the pattern  matching  filters
                                          to the headers that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of headers to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting:  either All , IncludedHead-
                                             ers , or ExcludedHeaders .

                                             Example JSON:  "MatchPattern":  {
                                             "ExcludedHeaders":     {"KeyToEx-
                                             clude1", "KeyToExclude2"} }

                                             All -> (structure)
                                                 Inspect all headers.

                                             IncludedHeaders -> (list)
                                                 Inspect only the headers that
                                                 have  a  key that matches one
                                                 of  the   strings   specified
                                                 here.

                                                 (string)

                                             ExcludedHeaders -> (list)
                                                 Inspect   only   the  headers
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the headers to match
                                             with the rule  inspection  crite-
                                             ria. If you specify All , WAF in-
                                             spects both keys and values.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             headers  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  head-
                                             ers.  The underlying host service
                                             forwards a maximum of 200 headers
                                             and  at  most 8 KB of header con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able headers normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                      Cookies -> (structure)
                                          Inspect  the  request  cookies.  You
                                          must  configure  scope  and  pattern
                                          matching  filters in the Cookies ob-
                                          ject, to define the set  of  cookies
                                          and  the  parts  of the cookies that
                                          WAF inspects.

                                          Only the first 8 KB (8192 bytes)  of
                                          a  request's  cookies  and  only the
                                          first 200 cookies are  forwarded  to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to  handle  any oversize cookie con-
                                          tent in the Cookies object. WAF  ap-
                                          plies  the  pattern matching filters
                                          to the cookies that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of cookies to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting: either All ,  IncludedCook-
                                             ies , or ExcludedCookies .

                                             Example  JSON:  "MatchPattern": {
                                             "IncludedCookies":     {"KeyToIn-
                                             clude1",  "KeyToInclude2",  "Key-
                                             ToInclude3"} }

                                             All -> (structure)
                                                 Inspect all cookies.

                                             IncludedCookies -> (list)
                                                 Inspect only the cookies that
                                                 have  a  key that matches one
                                                 of  the   strings   specified
                                                 here.

                                                 (string)

                                             ExcludedCookies -> (list)
                                                 Inspect   only   the  cookies
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The  parts  of the cookies to in-
                                             spect with  the  rule  inspection
                                             criteria.  If  you  specify All ,
                                             WAF inspects both keys  and  val-
                                             ues.

                                          OversizeHandling -> (string)
                                             What WAF should do if the cookies
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             cookies when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total cook-
                                             ies. The underlying host  service
                                             forwards a maximum of 200 cookies
                                             and at most 8 KB of  cookie  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  cookies normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                      HeaderOrder -> (structure)
                                          Inspect a string containing the list
                                          of  the  request's header names, or-
                                          dered as they appear in the web  re-
                                          quest  that WAF receives for inspec-
                                          tion. WAF generates the  string  and
                                          then uses that as the field to match
                                          component  in  its  inspection.  WAF
                                          separates  the  header  names in the
                                          string using  commas  and  no  added
                                          spaces.

                                          Matches  against  the  header  order
                                          string are case insensitive.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             headers  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  head-
                                             ers.  The underlying host service
                                             forwards a maximum of 200 headers
                                             and  at  most 8 KB of header con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able headers normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   TextTransformations -> (list)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form the FieldToMatch request  component
                                      before  inspecting  it, and they're used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them as custom aggregation keys. If  you
                                      specify  one  or more transformations to
                                      apply, WAF performs all  transformations
                                      on  the specified content, starting from
                                      the lowest priority  setting,  and  then
                                      uses the component contents.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der for multiple transformations.
                                             WAF  processes  all   transforma-
                                             tions,  from  lowest  priority to
                                             highest,  before  inspecting  the
                                             transformed  content. The priori-
                                             ties don't need  to  be  consecu-
                                             tive,  but  they must all be dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE   -   Decode  a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT - Decode  a
                                                 Base64  -encoded  string, but
                                                 use a  forgiving  implementa-
                                                 tion  that ignores characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.   These  are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual formatting to  disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete spaces before  the  fol-
                                               lowing characters: / (

                                             o Replace  the  following charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE  -   Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r , carriage  return,  decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places multiple  spaces  with
                                                 one space.

                                                 CSS_DECODE  -  Decode charac-
                                                 ters that were encoded  using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in the decoding  process,  so
                                                 it  can help to uncover ASCII
                                                 characters that were  encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's  also useful in counter-
                                                 ing evasion, which is a  com-
                                                 bination  of  a backslash and
                                                 non-hexadecimal   characters.
                                                 For  example, ja\vascript for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE  -   Decode
                                                 the  following  ANSI C escape
                                                 sequences: \a , \b , \f ,  \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 , \"  ,  \xHH  (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't valid  remain  in  the
                                                 output.

                                                 HEX_DECODE  - Decode a string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE  - Replace
                                                 HTML-encoded characters  with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces  (ampersand)quot; with
                                               "

                                             o Replaces (ampersand)nbsp;  with
                                               a  non-breaking  space, decimal
                                               160

                                             o Replaces (ampersand)lt; with  a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat,  (ampersand)#xhhhh; , with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented  in decimal format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape sequences. If a  \   u
                                                 HHHH    code    is   in   the
                                                 full-width ASCII  code  range
                                                 of   FF01-FF5E   ,  then  the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not, only the lower  byte  is
                                                 used  and  the higher byte is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5  -  Calculate an MD5 hash
                                                 from the data in  the  input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE - Specify  NONE  if  you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH - Remove  mul-
                                                 tiple    slashes,   directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not at the beginning  of  the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN  - This is
                                                 the same as NORMALIZE_PATH  ,
                                                 but  first converts backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS   -  Remove  all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS  -   Replace
                                                 each  occurrence of a C-style
                                                 comment (/* ... */ )  with  a
                                                 single  space.  Multiple con-
                                                 secutive occurrences are  not
                                                 compressed. Unterminated com-
                                                 ments are also replaced  with
                                                 a  space  (ASCII  0x20). How-
                                                 ever, a  standalone  termina-
                                                 tion  of  a  comment (*/ ) is
                                                 not acted upon.

                                                 REPLACE_NULLS - Replace  NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE -  Decode  SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE , but with  support  for
                                                 Microsoft-specific  %u encod-
                                                 ing. If the code  is  in  the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte  is  used  to detect and
                                                 adjust the lower byte. Other-
                                                 wise,  only the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8 character sequences  to
                                                 Unicode.   This  helps  input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives for  non-Eng-
                                                 lish languages.

                               SizeConstraintStatement -> (structure)
                                   A  rule statement that compares a number of
                                   bytes against the size of a request  compo-
                                   nent,  using a comparison operator, such as
                                   greater than (>) or less than (<). For  ex-
                                   ample, you can use a size constraint state-
                                   ment to look for  query  strings  that  are
                                   longer than 100 bytes.

                                   If you configure WAF to inspect the request
                                   body, WAF inspects only the number of bytes
                                   of  the  body  up  to the limit for the web
                                   ACL. By default,  for  regional  web  ACLs,
                                   this  limit  is  8 KB (8,192 kilobytes) and
                                   for CloudFront web ACLs, this limit  is  16
                                   KB  (16,384  kilobytes). For CloudFront web
                                   ACLs, you can increase the limit in the web
                                   ACL   AssociationConfig  ,  for  additional
                                   fees. If you know that the request body for
                                   your  web  requests should never exceed the
                                   inspection limit, you could use a size con-
                                   straint  statement  to  block requests that
                                   have a larger request body size.

                                   If you choose URI for the value of Part  of
                                   the  request to filter on, the slash (/) in
                                   the URI counts as one character. For  exam-
                                   ple,  the  URI /logo.jpg is nine characters
                                   long.

                                   FieldToMatch -> (structure)
                                      The part of the  web  request  that  you
                                      want WAF to inspect.

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Alternately,  you can filter and in-
                                          spect all headers with  the  Headers
                                          FieldToMatch setting.

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect  the  request URI path. This
                                          is the part of the web request  that
                                          identifies  a resource, for example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect the query  string.  This  is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect the request  body  as  plain
                                          text.  The  request body immediately
                                          follows the request headers. This is
                                          the  part of a request that contains
                                          any additional data that you want to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          A limited amount of the request body
                                          is forwarded to WAF  for  inspection
                                          by  the underlying host service. For
                                          regional resources, the limit  is  8
                                          KB  (8,192 kilobytes) and for Cloud-
                                          Front distributions, the limit is 16
                                          KB  (16,384  kilobytes).  For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the  limit  in the web ACL's
                                          AssociationConfig ,  for  additional
                                          processing fees.

                                          For  information about how to handle
                                          oversized request  bodies,  see  the
                                          Body object configuration.

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger than WAF can inspect.  WAF
                                             does  not  support inspecting the
                                             entire contents of  the  web  re-
                                             quest  body  if  the body exceeds
                                             the limit for the resource  type.
                                             If  the  body  is larger than the
                                             limit, the underlying  host  ser-
                                             vice  only  forwards the contents
                                             that are below the limit  to  WAF
                                             for inspection.

                                             The  default limit is 8 KB (8,192
                                             kilobytes) for regional resources
                                             and  16 KB (16,384 kilobytes) for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig   ,  for  addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able  body  contents  normally,
                                               according  to  the rule inspec-
                                               tion criteria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling  with  your rule and web
                                             ACL action settings, so that  you
                                             block  any  request whose body is
                                             over the limit.

                                             Default: CONTINUE

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          A limited amount of the request body
                                          is  forwarded  to WAF for inspection
                                          by the underlying host service.  For
                                          regional  resources,  the limit is 8
                                          KB (8,192 kilobytes) and for  Cloud-
                                          Front distributions, the limit is 16
                                          KB (16,384  kilobytes).  For  Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in  the  web  ACL's
                                          AssociationConfig  ,  for additional
                                          processing fees.

                                          For information about how to  handle
                                          oversized  request  bodies,  see the
                                          JsonBody object configuration.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger  than WAF can inspect. WAF
                                             does not support  inspecting  the
                                             entire  contents  of  the web re-
                                             quest body if  the  body  exceeds
                                             the  limit for the resource type.
                                             If the body is  larger  than  the
                                             limit,  the  underlying host ser-
                                             vice only forwards  the  contents
                                             that  are  below the limit to WAF
                                             for inspection.

                                             The default limit is 8 KB  (8,192
                                             kilobytes) for regional resources
                                             and 16 KB (16,384 kilobytes)  for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig  ,  for   addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  body  contents  normally,
                                               according to the  rule  inspec-
                                               tion criteria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling with your rule  and  web
                                             ACL  action settings, so that you
                                             block any request whose  body  is
                                             over the limit.

                                             Default: CONTINUE

                                      Headers -> (structure)
                                          Inspect  the  request  headers.  You
                                          must  configure  scope  and  pattern
                                          matching  filters in the Headers ob-
                                          ject, to define the set  of  headers
                                          to and the parts of the headers that
                                          WAF inspects.

                                          Only the first 8 KB (8192 bytes)  of
                                          a  request's  headers  and  only the
                                          first 200 headers are  forwarded  to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to  handle  any oversize header con-
                                          tent in the Headers object. WAF  ap-
                                          plies  the  pattern matching filters
                                          to the headers that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of headers to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting: either All ,  IncludedHead-
                                             ers , or ExcludedHeaders .

                                             Example  JSON:  "MatchPattern": {
                                             "ExcludedHeaders":     {"KeyToEx-
                                             clude1", "KeyToExclude2"} }

                                             All -> (structure)
                                                 Inspect all headers.

                                             IncludedHeaders -> (list)
                                                 Inspect only the headers that
                                                 have a key that  matches  one
                                                 of   the   strings  specified
                                                 here.

                                                 (string)

                                             ExcludedHeaders -> (list)
                                                 Inspect  only   the   headers
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the headers to match
                                             with  the  rule inspection crite-
                                             ria. If you specify All , WAF in-
                                             spects both keys and values.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             headers when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total head-
                                             ers. The underlying host  service
                                             forwards a maximum of 200 headers
                                             and at most 8 KB of  header  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  headers normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                      Cookies -> (structure)
                                          Inspect  the  request  cookies.  You
                                          must  configure  scope  and  pattern
                                          matching filters in the Cookies  ob-
                                          ject,  to  define the set of cookies
                                          and the parts of  the  cookies  that
                                          WAF inspects.

                                          Only  the first 8 KB (8192 bytes) of
                                          a request's  cookies  and  only  the
                                          first  200  cookies are forwarded to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to handle any oversize  cookie  con-
                                          tent  in the Cookies object. WAF ap-
                                          plies the pattern  matching  filters
                                          to the cookies that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of cookies to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting:  either All , IncludedCook-
                                             ies , or ExcludedCookies .

                                             Example JSON:  "MatchPattern":  {
                                             "IncludedCookies":     {"KeyToIn-
                                             clude1",  "KeyToInclude2",  "Key-
                                             ToInclude3"} }

                                             All -> (structure)
                                                 Inspect all cookies.

                                             IncludedCookies -> (list)
                                                 Inspect only the cookies that
                                                 have a key that  matches  one
                                                 of   the   strings  specified
                                                 here.

                                                 (string)

                                             ExcludedCookies -> (list)
                                                 Inspect  only   the   cookies
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the cookies  to  in-
                                             spect  with  the  rule inspection
                                             criteria. If you  specify  All  ,
                                             WAF  inspects  both keys and val-
                                             ues.

                                          OversizeHandling -> (string)
                                             What WAF should do if the cookies
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             cookies  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  cook-
                                             ies.  The underlying host service
                                             forwards a maximum of 200 cookies
                                             and  at  most 8 KB of cookie con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able cookies normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                      HeaderOrder -> (structure)
                                          Inspect a string containing the list
                                          of the request's header  names,  or-
                                          dered  as they appear in the web re-
                                          quest that WAF receives for  inspec-
                                          tion.  WAF  generates the string and
                                          then uses that as the field to match
                                          component  in  its  inspection.  WAF
                                          separates the header  names  in  the
                                          string  using  commas  and  no added
                                          spaces.

                                          Matches  against  the  header  order
                                          string are case insensitive.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             headers when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total head-
                                             ers. The underlying host  service
                                             forwards a maximum of 200 headers
                                             and at most 8 KB of  header  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  headers normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                   ComparisonOperator -> (string)
                                      The operator to use to compare  the  re-
                                      quest part to the size setting.

                                   Size -> (long)
                                      The size, in byte, to compare to the re-
                                      quest part, after any transformations.

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form  the FieldToMatch request component
                                      before inspecting it, and  they're  used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them  as custom aggregation keys. If you
                                      specify one or more  transformations  to
                                      apply,  WAF performs all transformations
                                      on the specified content, starting  from
                                      the  lowest  priority  setting, and then
                                      uses the component contents.

                                      (structure)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets  the relative processing or-
                                             der for multiple transformations.
                                             WAF   processes  all  transforma-
                                             tions, from  lowest  priority  to
                                             highest,  before  inspecting  the
                                             transformed content. The  priori-
                                             ties  don't  need  to be consecu-
                                             tive, but they must all  be  dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                               GeoMatchStatement -> (structure)
                                   A rule statement that labels  web  requests
                                   by  country  and  region  and  that matches
                                   against web requests based on country code.
                                   A  geo match rule labels every request that
                                   it inspects regardless of whether it  finds
                                   a match.

                                   o To  manage  requests only by country, you
                                     can use  this  statement  by  itself  and
                                     specify  the  countries  that you want to
                                     match against in the CountryCodes array.

                                   o Otherwise, configure your geo match  rule
                                     with  Count action so that it only labels
                                     requests. Then, add  one  or  more  label
                                     match  rules  to  run after the geo match
                                     rule and configure them to match  against
                                     the  geographic labels and handle the re-
                                     quests as needed.

                                   WAF labels requests using the alpha-2 coun-
                                   try and region codes from the International
                                   Organization for Standardization (ISO) 3166
                                   standard.  WAF  determines  the codes using
                                   either the IP address in  the  web  request
                                   origin  or,  if you specify it, the address
                                   in the geo match ForwardedIPConfig .

                                   If you use the web request origin, the  la-
                                   bel   formats  are  awswaf:clientip:geo:re-
                                   gion:<ISO country code>-<ISO  region  code>
                                   and  awswaf:clientip:geo:country:<ISO coun-
                                   try code> .

                                   If you use a forwarded IP address, the  la-
                                   bel  formats are awswaf:forwardedip:geo:re-
                                   gion:<ISO country code>-<ISO  region  code>
                                   and     awswaf:forwardedip:geo:country:<ISO
                                   country code> .

                                   For  additional  details,  see   Geographic
                                   match  rule  statement in the WAF Developer
                                   Guide .

                                   CountryCodes -> (list)
                                      An array of two-character country  codes
                                      that  you want to match against, for ex-
                                      ample, [ "US", "CN" ] , from the alpha-2
                                      country ISO codes of the ISO 3166 inter-
                                      national standard.

                                      When you use a geo match statement  just
                                      for  the  region and country labels that
                                      it adds to requests, you still  have  to
                                      supply  a  country  code for the rule to
                                      evaluate. In this  case,  you  configure
                                      the  rule  to  only  count  matching re-
                                      quests, but it will still generate  log-
                                      ging  and count metrics for any matches.
                                      You can reduce the logging  and  metrics
                                      that  the  rule produces by specifying a
                                      country that's unlikely to be  a  source
                                      of traffic to your site.

                                      (string)

                                   ForwardedIPConfig -> (structure)
                                      The  configuration for inspecting IP ad-
                                      dresses in an HTTP header that you spec-
                                      ify,  instead  of  using  the IP address
                                      that's reported by the web request  ori-
                                      gin.   Commonly,   this  is  the  X-For-
                                      warded-For (XFF)  header,  but  you  can
                                      specify any header name.

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                      HeaderName -> (string)
                                          The name of the HTTP header  to  use
                                          for  the IP address. For example, to
                                          use   the   X-Forwarded-For    (XFF)
                                          header,  set this to X-Forwarded-For
                                          .

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                      FallbackBehavior -> (string)
                                          The  match  status  to assign to the
                                          web request if the  request  doesn't
                                          have a valid IP address in the spec-
                                          ified position.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          You  can specify the following fall-
                                          back behaviors:

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               RuleGroupReferenceStatement -> (structure)
                                   A rule statement used to run the rules that
                                   are defined in a  RuleGroup . To use  this,
                                   create  a  rule group with your rules, then
                                   provide the ARN of the rule group  in  this
                                   statement.

                                   You  cannot nest a RuleGroupReferenceState-
                                   ment , for example for use  inside  a  Not-
                                   Statement or OrStatement . You can only use
                                   a rule group reference statement at the top
                                   level inside a web ACL.

                                   ARN -> (string)
                                      The  Amazon  Resource  Name (ARN) of the
                                      entity.

                                   ExcludedRules -> (list)
                                      Rules in the referenced rule group whose
                                      actions are set to Count .

                                      NOTE:
                                          Instead  of this option, use RuleAc-
                                          tionOverrides . It accepts any valid
                                          action setting, including Count .

                                      (structure)
                                          Specifies  a  single  rule in a rule
                                          group whose action you want to over-
                                          ride to Count .

                                          NOTE:
                                             Instead of this option, use Rule-
                                             ActionOverrides . It accepts  any
                                             valid  action  setting, including
                                             Count .

                                          Name -> (string)
                                             The name of the rule whose action
                                             you want to override to Count .

                                   RuleActionOverrides -> (list)
                                      Action  settings  to use in the place of
                                      the rule actions that are configured in-
                                      side  the  rule  group.  You specify one
                                      override for each rule whose action  you
                                      want to change.

                                      You  can  use overrides for testing, for
                                      example you can override all of rule ac-
                                      tions  to Count and then monitor the re-
                                      sulting count metrics to understand  how
                                      the  rule  group  would  handle your web
                                      traffic. You can also permanently  over-
                                      ride  some or all actions, to modify how
                                      the rule group manages your web traffic.

                                      (structure)
                                          Action setting to use in  the  place
                                          of  a rule action that is configured
                                          inside the rule group.  You  specify
                                          one override for each rule whose ac-
                                          tion you want to change.

                                          You can use overrides  for  testing,
                                          for  example you can override all of
                                          rule actions to Count and then moni-
                                          tor  the  resulting count metrics to
                                          understand how the rule group  would
                                          handle  your  web  traffic.  You can
                                          also permanently  override  some  or
                                          all  actions, to modify how the rule
                                          group manages your web traffic.

                                          Name -> (string)
                                             The name of the rule to override.

                                          ActionToUse -> (structure)
                                             The override action  to  use,  in
                                             place of the configured action of
                                             the rule in the rule group.

                                             Block -> (structure)
                                                 Instructs WAF  to  block  the
                                                 web request.

                                                 CustomResponse -> (structure)
                                                    Defines  a custom response
                                                    for the web request.

                                                    For information about cus-
                                                    tomizing  web requests and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in WAF in the  WAF  Devel-
                                                    oper Guide .

                                                    ResponseCode -> (integer)
                                                        The  HTTP  status code
                                                        to   return   to   the
                                                        client.

                                                        For  a  list of status
                                                        codes that you can use
                                                        in   your  custom  re-
                                                        sponses, see Supported
                                                        status  codes for cus-
                                                        tom  response  in  the
                                                        WAF Developer Guide .

                                                    CustomResponseBodyKey   ->
                                                    (string)
                                                        References   the   re-
                                                        sponse  body  that you
                                                        want WAF to return  to
                                                        the     web    request
                                                        client. You can define
                                                        a  custom response for
                                                        a rule action or a de-
                                                        fault  web  ACL action
                                                        that is set to  block.
                                                        To  do this, you first
                                                        define  the   response
                                                        body  key and value in
                                                        the CustomResponseBod-
                                                        ies  setting  for  the
                                                        WebACL  or   RuleGroup
                                                        where  you want to use
                                                        it. Then, in the  rule
                                                        action  or web ACL de-
                                                        fault action  BlockAc-
                                                        tion setting, you ref-
                                                        erence  the   response
                                                        body using this key.

                                                    ResponseHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        use in  the  response.
                                                        Duplicate header names
                                                        are not allowed.

                                                        For information  about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas  in the WAF Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom  request and
                                                           response  handling.
                                                           This   is  used  in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For  custom re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are  already in
                                                               the    request.
                                                               For    example,
                                                               for the  header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The   value  of
                                                               the      custom
                                                               header.

                                             Allow -> (structure)
                                                 Instructs  WAF  to  allow the
                                                 web request.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines   custom  handling
                                                    for the web request.

                                                    For information about cus-
                                                    tomizing  web requests and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in WAF in the  WAF  Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header names  are  not
                                                        allowed.

                                                        For  information about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas in the WAF  Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom request  and
                                                           response  handling.
                                                           This  is  used   in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For custom  re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are already  in
                                                               the    request.
                                                               For    example,
                                                               for  the header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The  value   of
                                                               the      custom
                                                               header.

                                             Count -> (structure)
                                                 Instructs WAF  to  count  the
                                                 web request and then continue
                                                 evaluating the request  using
                                                 the  remaining  rules  in the
                                                 web ACL.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines   custom  handling
                                                    for the web request.

                                                    For information about cus-
                                                    tomizing  web requests and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in WAF in the  WAF  Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header names  are  not
                                                        allowed.

                                                        For  information about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas in the WAF  Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom request  and
                                                           response  handling.
                                                           This  is  used   in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For custom  re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are already  in
                                                               the    request.
                                                               For    example,
                                                               for  the header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The  value   of
                                                               the      custom
                                                               header.

                                             Captcha -> (structure)
                                                 Instructs  WAF   to   run   a
                                                 CAPTCHA check against the web
                                                 request.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines   custom  handling
                                                    for the web request,  used
                                                    when  the  CAPTCHA inspec-
                                                    tion determines  that  the
                                                    request's  token  is valid
                                                    and unexpired.

                                                    For information about cus-
                                                    tomizing  web requests and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in WAF in the  WAF  Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header names  are  not
                                                        allowed.

                                                        For  information about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas in the WAF  Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom request  and
                                                           response  handling.
                                                           This  is  used   in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For custom  re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are already  in
                                                               the    request.
                                                               For    example,
                                                               for  the header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The  value   of
                                                               the      custom
                                                               header.

                                             Challenge -> (structure)
                                                 Instructs WAF to run a  Chal-
                                                 lenge  check  against the web
                                                 request.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines   custom  handling
                                                    for the web request,  used
                                                    when the challenge inspec-
                                                    tion determines  that  the
                                                    request's  token  is valid
                                                    and unexpired.

                                                    For information about cus-
                                                    tomizing  web requests and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in WAF in the  WAF  Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header names  are  not
                                                        allowed.

                                                        For  information about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas in the WAF  Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom request  and
                                                           response  handling.
                                                           This  is  used   in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For custom  re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are already  in
                                                               the    request.
                                                               For    example,
                                                               for  the header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The  value   of
                                                               the      custom
                                                               header.

                               IPSetReferenceStatement -> (structure)
                                   A rule statement used  to  detect  web  re-
                                   quests  coming from particular IP addresses
                                   or address ranges. To use this,  create  an
                                   IPSet that specifies the addresses you want
                                   to detect, then use the ARN of that set  in
                                   this  statement.  To  create an IP set, see
                                   CreateIPSet .

                                   Each IP set rule statement references an IP
                                   set.  You create and maintain the set inde-
                                   pendent of your rules. This allows  you  to
                                   use  the single set in multiple rules. When
                                   you update the referenced set, WAF automat-
                                   ically updates all rules that reference it.

                                   ARN -> (string)
                                      The  Amazon  Resource  Name (ARN) of the
                                      IPSet that this statement references.

                                   IPSetForwardedIPConfig -> (structure)
                                      The configuration for inspecting IP  ad-
                                      dresses in an HTTP header that you spec-
                                      ify, instead of  using  the  IP  address
                                      that's  reported by the web request ori-
                                      gin.  Commonly,  this  is   the   X-For-
                                      warded-For  (XFF)  header,  but  you can
                                      specify any header name.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      HeaderName -> (string)
                                          The  name  of the HTTP header to use
                                          for the IP address. For example,  to
                                          use    the   X-Forwarded-For   (XFF)
                                          header, set this to  X-Forwarded-For
                                          .

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                      FallbackBehavior -> (string)
                                          The match status to  assign  to  the
                                          web  request  if the request doesn't
                                          have a valid IP address in the spec-
                                          ified position.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          You can specify the following  fall-
                                          back behaviors:

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                      Position -> (string)
                                          The position in the header to search
                                          for  the  IP address. The header can
                                          contain IP addresses of the original
                                          client  and also of proxies. For ex-
                                          ample, the  header  value  could  be
                                          10.1.1.1,   127.0.0.0,   10.10.10.10
                                          where the first IP  address  identi-
                                          fies  the  original  client  and the
                                          rest identify proxies that  the  re-
                                          quest went through.

                                          The options for this setting are the
                                          following:

                                          o FIRST - Inspect the first  IP  ad-
                                            dress  in the list of IP addresses
                                            in the header. This is usually the
                                            client's original IP.

                                          o LAST - Inspect the last IP address
                                            in the list of IP addresses in the
                                            header.

                                          o ANY  - Inspect all IP addresses in
                                            the header for  a  match.  If  the
                                            header  contains  more  than 10 IP
                                            addresses, WAF inspects  the  last
                                            10.

                               RegexPatternSetReferenceStatement   ->  (struc-
                               ture)
                                   A rule statement used to search web request
                                   components for matches with regular expres-
                                   sions. To use  this,  create  a   RegexPat-
                                   ternSet that specifies the expressions that
                                   you want to detect, then  use  the  ARN  of
                                   that  set  in this statement. A web request
                                   matches the pattern set rule  statement  if
                                   the  request  component  matches any of the
                                   patterns in the set. To create a regex pat-
                                   tern set, see  CreateRegexPatternSet .

                                   Each  regex pattern set rule statement ref-
                                   erences a regex pattern set. You create and
                                   maintain the set independent of your rules.
                                   This allows you to use the  single  set  in
                                   multiple  rules. When you update the refer-
                                   enced set, WAF  automatically  updates  all
                                   rules that reference it.

                                   ARN -> (string)
                                      The  Amazon  Resource  Name (ARN) of the
                                      RegexPatternSet that this statement ref-
                                      erences.

                                   FieldToMatch -> (structure)
                                      The  part  of  the  web request that you
                                      want WAF to inspect.

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name  of  the header to inspect, for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example   JSON:   "SingleHeader":  {
                                          "Name": "haystack" }

                                          Alternately, you can filter and  in-
                                          spect  all  headers with the Headers
                                          FieldToMatch setting.

                                          Name -> (string)
                                             The name of the query  header  to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide the name of the query  argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion . The name can be up  to
                                          30  characters  long  and isn't case
                                          sensitive.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the part of the web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          A limited amount of the request body
                                          is  forwarded  to WAF for inspection
                                          by the underlying host service.  For
                                          regional  resources,  the limit is 8
                                          KB (8,192 kilobytes) and for  Cloud-
                                          Front distributions, the limit is 16
                                          KB (16,384  kilobytes).  For  Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in  the  web  ACL's
                                          AssociationConfig  ,  for additional
                                          processing fees.

                                          For information about how to  handle
                                          oversized  request  bodies,  see the
                                          Body object configuration.

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger  than WAF can inspect. WAF
                                             does not support  inspecting  the
                                             entire  contents  of  the web re-
                                             quest body if  the  body  exceeds
                                             the  limit for the resource type.
                                             If the body is  larger  than  the
                                             limit,  the  underlying host ser-
                                             vice only forwards  the  contents
                                             that  are  below the limit to WAF
                                             for inspection.

                                             The default limit is 8 KB  (8,192
                                             kilobytes) for regional resources
                                             and 16 KB (16,384 kilobytes)  for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig  ,  for   addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  body  contents  normally,
                                               according to the  rule  inspec-
                                               tion criteria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling with your rule  and  web
                                             ACL  action settings, so that you
                                             block any request whose  body  is
                                             over the limit.

                                             Default: CONTINUE

                                      Method -> (structure)
                                          Inspect  the HTTP method. The method
                                          indicates the type of operation that
                                          the  request is asking the origin to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect the request  body  as  JSON.
                                          The request body immediately follows
                                          the request  headers.  This  is  the
                                          part  of a request that contains any
                                          additional data  that  you  want  to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          A limited amount of the request body
                                          is forwarded to WAF  for  inspection
                                          by  the underlying host service. For
                                          regional resources, the limit  is  8
                                          KB  (8,192 kilobytes) and for Cloud-
                                          Front distributions, the limit is 16
                                          KB  (16,384  kilobytes).  For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the  limit  in the web ACL's
                                          AssociationConfig ,  for  additional
                                          processing fees.

                                          For  information about how to handle
                                          oversized request  bodies,  see  the
                                          JsonBody object configuration.

                                          MatchPattern -> (structure)
                                             The  patterns  to look for in the
                                             JSON body. WAF inspects  the  re-
                                             sults  of  these  pattern matches
                                             against the rule inspection  cri-
                                             teria.

                                             All -> (structure)
                                                 Match  all  of  the elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You  must specify either this
                                                 setting or the  IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match  only the specified in-
                                                 clude paths. See also  Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing JSON Pointer syntax.  For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"]  . For infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force  (IETF)   documentation
                                                 JavaScript   Object  Notation
                                                 (JSON) Pointer .

                                                 You must specify either  this
                                                 setting  or  the All setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't use this  option  to
                                                    include   all  paths.  In-
                                                    stead, use  the  All  set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The  parts  of  the JSON to match
                                             against using the MatchPattern  .
                                             If  you specify All , WAF matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely  parse  the JSON body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING  -   Inspect
                                               the body as plain text. WAF ap-
                                               plies the text  transformations
                                               and  inspection  criteria  that
                                               you defined for  the  JSON  in-
                                               spection   to   the  body  text
                                               string.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             If  you  don't  provide this set-
                                             ting, WAF  parses  and  evaluates
                                             the  content only up to the first
                                             parsing failure that  it  encoun-
                                             ters.

                                             WAF  does  its  best to parse the
                                             entire JSON body,  but  might  be
                                             forced  to  stop for reasons such
                                             as invalid characters,  duplicate
                                             keys, truncation, and any content
                                             whose root node isn't  an  object
                                             or an array.

                                             WAF  parses  the JSON in the fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger than WAF can inspect.  WAF
                                             does  not  support inspecting the
                                             entire contents of  the  web  re-
                                             quest  body  if  the body exceeds
                                             the limit for the resource  type.
                                             If  the  body  is larger than the
                                             limit, the underlying  host  ser-
                                             vice  only  forwards the contents
                                             that are below the limit  to  WAF
                                             for inspection.

                                             The  default limit is 8 KB (8,192
                                             kilobytes) for regional resources
                                             and  16 KB (16,384 kilobytes) for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig   ,  for  addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able  body  contents  normally,
                                               according  to  the rule inspec-
                                               tion criteria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling  with  your rule and web
                                             ACL action settings, so that  you
                                             block  any  request whose body is
                                             over the limit.

                                             Default: CONTINUE

                                      Headers -> (structure)
                                          Inspect  the  request  headers.  You
                                          must  configure  scope  and  pattern
                                          matching filters in the Headers  ob-
                                          ject,  to  define the set of headers
                                          to and the parts of the headers that
                                          WAF inspects.

                                          Only  the first 8 KB (8192 bytes) of
                                          a request's  headers  and  only  the
                                          first  200  headers are forwarded to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to handle any oversize  header  con-
                                          tent  in the Headers object. WAF ap-
                                          plies the pattern  matching  filters
                                          to the headers that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of headers to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting:  either All , IncludedHead-
                                             ers , or ExcludedHeaders .

                                             Example JSON:  "MatchPattern":  {
                                             "ExcludedHeaders":     {"KeyToEx-
                                             clude1", "KeyToExclude2"} }

                                             All -> (structure)
                                                 Inspect all headers.

                                             IncludedHeaders -> (list)
                                                 Inspect only the headers that
                                                 have  a  key that matches one
                                                 of  the   strings   specified
                                                 here.

                                                 (string)

                                             ExcludedHeaders -> (list)
                                                 Inspect   only   the  headers
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the headers to match
                                             with the rule  inspection  crite-
                                             ria. If you specify All , WAF in-
                                             spects both keys and values.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             headers  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  head-
                                             ers.  The underlying host service
                                             forwards a maximum of 200 headers
                                             and  at  most 8 KB of header con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able headers normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                      Cookies -> (structure)
                                          Inspect  the  request  cookies.  You
                                          must  configure  scope  and  pattern
                                          matching  filters in the Cookies ob-
                                          ject, to define the set  of  cookies
                                          and  the  parts  of the cookies that
                                          WAF inspects.

                                          Only the first 8 KB (8192 bytes)  of
                                          a  request's  cookies  and  only the
                                          first 200 cookies are  forwarded  to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to  handle  any oversize cookie con-
                                          tent in the Cookies object. WAF  ap-
                                          plies  the  pattern matching filters
                                          to the cookies that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of cookies to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting: either All ,  IncludedCook-
                                             ies , or ExcludedCookies .

                                             Example  JSON:  "MatchPattern": {
                                             "IncludedCookies":     {"KeyToIn-
                                             clude1",  "KeyToInclude2",  "Key-
                                             ToInclude3"} }

                                             All -> (structure)
                                                 Inspect all cookies.

                                             IncludedCookies -> (list)
                                                 Inspect only the cookies that
                                                 have  a  key that matches one
                                                 of  the   strings   specified
                                                 here.

                                                 (string)

                                             ExcludedCookies -> (list)
                                                 Inspect   only   the  cookies
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The  parts  of the cookies to in-
                                             spect with  the  rule  inspection
                                             criteria.  If  you  specify All ,
                                             WAF inspects both keys  and  val-
                                             ues.

                                          OversizeHandling -> (string)
                                             What WAF should do if the cookies
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             cookies when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total cook-
                                             ies. The underlying host  service
                                             forwards a maximum of 200 cookies
                                             and at most 8 KB of  cookie  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  cookies normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                      HeaderOrder -> (structure)
                                          Inspect a string containing the list
                                          of  the  request's header names, or-
                                          dered as they appear in the web  re-
                                          quest  that WAF receives for inspec-
                                          tion. WAF generates the  string  and
                                          then uses that as the field to match
                                          component  in  its  inspection.  WAF
                                          separates  the  header  names in the
                                          string using  commas  and  no  added
                                          spaces.

                                          Matches  against  the  header  order
                                          string are case insensitive.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             headers  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  head-
                                             ers.  The underlying host service
                                             forwards a maximum of 200 headers
                                             and  at  most 8 KB of header con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able headers normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   TextTransformations -> (list)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form the FieldToMatch request  component
                                      before  inspecting  it, and they're used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them as custom aggregation keys. If  you
                                      specify  one  or more transformations to
                                      apply, WAF performs all  transformations
                                      on  the specified content, starting from
                                      the lowest priority  setting,  and  then
                                      uses the component contents.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der for multiple transformations.
                                             WAF  processes  all   transforma-
                                             tions,  from  lowest  priority to
                                             highest,  before  inspecting  the
                                             transformed  content. The priori-
                                             ties don't need  to  be  consecu-
                                             tive,  but  they must all be dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE   -   Decode  a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT - Decode  a
                                                 Base64  -encoded  string, but
                                                 use a  forgiving  implementa-
                                                 tion  that ignores characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.   These  are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual formatting to  disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete spaces before  the  fol-
                                               lowing characters: / (

                                             o Replace  the  following charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE  -   Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r , carriage  return,  decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places multiple  spaces  with
                                                 one space.

                                                 CSS_DECODE  -  Decode charac-
                                                 ters that were encoded  using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in the decoding  process,  so
                                                 it  can help to uncover ASCII
                                                 characters that were  encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's  also useful in counter-
                                                 ing evasion, which is a  com-
                                                 bination  of  a backslash and
                                                 non-hexadecimal   characters.
                                                 For  example, ja\vascript for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE  -   Decode
                                                 the  following  ANSI C escape
                                                 sequences: \a , \b , \f ,  \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 , \"  ,  \xHH  (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't valid  remain  in  the
                                                 output.

                                                 HEX_DECODE  - Decode a string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE  - Replace
                                                 HTML-encoded characters  with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces  (ampersand)quot; with
                                               "

                                             o Replaces (ampersand)nbsp;  with
                                               a  non-breaking  space, decimal
                                               160

                                             o Replaces (ampersand)lt; with  a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat,  (ampersand)#xhhhh; , with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented  in decimal format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape sequences. If a  \   u
                                                 HHHH    code    is   in   the
                                                 full-width ASCII  code  range
                                                 of   FF01-FF5E   ,  then  the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not, only the lower  byte  is
                                                 used  and  the higher byte is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5  -  Calculate an MD5 hash
                                                 from the data in  the  input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE - Specify  NONE  if  you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH - Remove  mul-
                                                 tiple    slashes,   directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not at the beginning  of  the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN  - This is
                                                 the same as NORMALIZE_PATH  ,
                                                 but  first converts backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS   -  Remove  all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS  -   Replace
                                                 each  occurrence of a C-style
                                                 comment (/* ... */ )  with  a
                                                 single  space.  Multiple con-
                                                 secutive occurrences are  not
                                                 compressed. Unterminated com-
                                                 ments are also replaced  with
                                                 a  space  (ASCII  0x20). How-
                                                 ever, a  standalone  termina-
                                                 tion  of  a  comment (*/ ) is
                                                 not acted upon.

                                                 REPLACE_NULLS - Replace  NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE -  Decode  SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE , but with  support  for
                                                 Microsoft-specific  %u encod-
                                                 ing. If the code  is  in  the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte  is  used  to detect and
                                                 adjust the lower byte. Other-
                                                 wise,  only the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8 character sequences  to
                                                 Unicode.   This  helps  input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives for  non-Eng-
                                                 lish languages.

                               RateBasedStatement -> (structure)
                                   A  rate-based rule counts incoming requests
                                   and rate limits requests when they are com-
                                   ing  at  too  fast a rate. The rule catego-
                                   rizes requests according to  your  aggrega-
                                   tion  criteria, collects them into aggrega-
                                   tion instances, and counts and rate  limits
                                   the requests for each instance.

                                   You   can  specify  individual  aggregation
                                   keys, like IP address or HTTP  method.  You
                                   can  also  specify aggregation key combina-
                                   tions, like IP address and HTTP method,  or
                                   HTTP method, query argument, and cookie.

                                   Each  unique set of values for the aggrega-
                                   tion keys that you specify  is  a  separate
                                   aggregation  instance,  with the value from
                                   each key contributing  to  the  aggregation
                                   instance definition.

                                   For  example, assume the rule evaluates web
                                   requests with the following IP address  and
                                   HTTP method values:

                                   o IP address 10.1.1.1, HTTP method POST

                                   o IP address 10.1.1.1, HTTP method GET

                                   o IP address 127.0.0.0, HTTP method POST

                                   o IP address 10.1.1.1, HTTP method GET

                                   The rule would create different aggregation
                                   instances  according  to  your  aggregation
                                   criteria, for example:

                                   o If  the  aggregation criteria is just the
                                     IP address, then each individual  address
                                     is   an  aggregation  instance,  and  WAF
                                     counts requests separately for each.  The
                                     aggregation  instances and request counts
                                     for our example would be the following:

                                     o IP address 10.1.1.1: count 3

                                     o IP address 127.0.0.0: count 1

                                   o If  the  aggregation  criteria  is   HTTP
                                     method,  then each individual HTTP method
                                     is an aggregation instance. The  aggrega-
                                     tion instances and request counts for our
                                     example would be the following:

                                     o HTTP method POST: count 2

                                     o HTTP method GET: count 2

                                   o If the aggregation criteria is IP address
                                     and HTTP method, then each IP address and
                                     each HTTP method would contribute to  the
                                     combined aggregation instance. The aggre-
                                     gation instances and request  counts  for
                                     our example would be the following:

                                     o IP  address 10.1.1.1, HTTP method POST:
                                       count 1

                                     o IP address 10.1.1.1, HTTP  method  GET:
                                       count 2

                                     o IP address 127.0.0.0, HTTP method POST:
                                       count 1

                                   For any n-tuple of aggregation  keys,  each
                                   unique  combination  of values for the keys
                                   defines a  separate  aggregation  instance,
                                   which  WAF counts and rate-limits individu-
                                   ally.

                                   You can optionally nest  another  statement
                                   inside  the rate-based statement, to narrow
                                   the scope of  the  rule  so  that  it  only
                                   counts  and rate limits requests that match
                                   the nested  statement.  You  can  use  this
                                   nested  scope-down statement in conjunction
                                   with your aggregation key specifications or
                                   you  can  just count and rate limit all re-
                                   quests that match the scope-down statement,
                                   without  additional  aggregation.  When you
                                   choose to just  manage  all  requests  that
                                   match  a scope-down statement, the aggrega-
                                   tion instance is singular for the rule.

                                   You cannot nest a RateBasedStatement inside
                                   another  statement,  for  example  inside a
                                   NotStatement or OrStatement . You  can  de-
                                   fine  a RateBasedStatement inside a web ACL
                                   and inside a rule group.

                                   For additional information  about  the  op-
                                   tions, see Rate limiting web requests using
                                   rate-based rules in the WAF Developer Guide
                                   .

                                   If  you only aggregate on the individual IP
                                   address or forwarded IP  address,  you  can
                                   retrieve  the list of IP addresses that WAF
                                   is  currently  rate  limiting  for  a  rule
                                   through the API call GetRateBasedStatement-
                                   ManagedKeys . This option is not  available
                                   for other aggregation configurations.

                                   WAF  tracks  and manages web requests sepa-
                                   rately for each instance  of  a  rate-based
                                   rule that you use. For example, if you pro-
                                   vide the same rate-based rule  settings  in
                                   two  web  ACLs, each of the two rule state-
                                   ments represents a separate instance of the
                                   rate-based  rule  and gets its own tracking
                                   and management by  WAF.  If  you  define  a
                                   rate-based  rule  inside  a rule group, and
                                   then  use  that  rule  group  in   multiple
                                   places,  each  use  creates  a separate in-
                                   stance of the rate-based rule that gets its
                                   own tracking and management by WAF.

                                   Limit -> (long)
                                      The  limit  on requests per 5-minute pe-
                                      riod for a single  aggregation  instance
                                      for   the   rate-based   rule.   If  the
                                      rate-based statement includes  a  Scope-
                                      DownStatement  ,  this  limit is applied
                                      only to  the  requests  that  match  the
                                      statement.

                                      Examples:

                                      o If  you  aggregate  on just the IP ad-
                                        dress, this is the limit  on  requests
                                        from any single IP address.

                                      o If  you  aggregate  on the HTTP method
                                        and the query  argument  name  "city",
                                        then this is the limit on requests for
                                        any single method, city pair.

                                   AggregateKeyType -> (string)
                                      Setting that indicates how to  aggregate
                                      the request counts.

                                      NOTE:
                                          Web requests that are missing any of
                                          the components specified in the  ag-
                                          gregation  keys are omitted from the
                                          rate-based rule evaluation and  han-
                                          dling.

                                      o CONSTANT  -  Count  and  limit the re-
                                        quests  that  match   the   rate-based
                                        rule's scope-down statement. With this
                                        option, the  counted  requests  aren't
                                        further   aggregated.  The  scope-down
                                        statement is  the  only  specification
                                        used.  When  the count of all requests
                                        that satisfy the scope-down  statement
                                        goes  over  the limit, WAF applies the
                                        rule action to all requests that  sat-
                                        isfy  the  scope-down statement.  With
                                        this option, you  must  configure  the
                                        ScopeDownStatement property.

                                      o CUSTOM_KEYS  -  Aggregate  the request
                                        counts using one or more  web  request
                                        components as the aggregate keys. With
                                        this option, you must specify the  ag-
                                        gregate  keys  in the CustomKeys prop-
                                        erty.  To aggregate on only the IP ad-
                                        dress  or  only  the  forwarded IP ad-
                                        dress, don't use custom keys. Instead,
                                        set  the  aggregate  key type to IP or
                                        FORWARDED_IP .

                                      o FORWARDED_IP - Aggregate  the  request
                                        counts  on  the first IP address in an
                                        HTTP header.  With  this  option,  you
                                        must  specify the header to use in the
                                        ForwardedIPConfig property.  To aggre-
                                        gate on a combination of the forwarded
                                        IP address with other aggregate  keys,
                                        use CUSTOM_KEYS .

                                      o IP  -  Aggregate the request counts on
                                        the IP address from  the  web  request
                                        origin.  To aggregate on a combination
                                        of the IP address with other aggregate
                                        keys, use CUSTOM_KEYS .

                                   (  ...  recursive ... )ForwardedIPConfig ->
                                   (structure)
                                      The configuration for inspecting IP  ad-
                                      dresses in an HTTP header that you spec-
                                      ify, instead of  using  the  IP  address
                                      that's  reported by the web request ori-
                                      gin.  Commonly,  this  is   the   X-For-
                                      warded-For  (XFF)  header,  but  you can
                                      specify any header name.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      This  is  required if you specify a for-
                                      warded IP in the  rule's  aggregate  key
                                      settings.

                                      HeaderName -> (string)
                                          The  name  of the HTTP header to use
                                          for the IP address. For example,  to
                                          use    the   X-Forwarded-For   (XFF)
                                          header, set this to  X-Forwarded-For
                                          .

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                      FallbackBehavior -> (string)
                                          The match status to  assign  to  the
                                          web  request  if the request doesn't
                                          have a valid IP address in the spec-
                                          ified position.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          You can specify the following  fall-
                                          back behaviors:

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                   CustomKeys -> (list)
                                      Specifies the aggregate keys to use in a
                                      rate-base rule.

                                      (structure)
                                          Specifies  a single custom aggregate
                                          key for a rate-base rule.

                                          NOTE:
                                             Web requests that are missing any
                                             of  the  components  specified in
                                             the aggregation keys are  omitted
                                             from  the rate-based rule evalua-
                                             tion and handling.

                                          Header -> (structure)
                                             Use the value of a header in  the
                                             request as an aggregate key. Each
                                             distinct value in the header con-
                                             tributes  to  the aggregation in-
                                             stance.  If  you  use  a   single
                                             header  as  your custom key, then
                                             each value fully defines  an  ag-
                                             gregation instance.

                                             Name -> (string)
                                                 The  name  of  the  header to
                                                 use.

                                             TextTransformations -> (list)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection. Text trans-
                                                 formations  are  used in rule
                                                 match statements,  to  trans-
                                                 form the FieldToMatch request
                                                 component  before  inspecting
                                                 it,   and   they're  used  in
                                                 rate-based  rule  statements,
                                                 to  transform  request compo-
                                                 nents before  using  them  as
                                                 custom  aggregation  keys. If
                                                 you  specify  one   or   more
                                                 transformations to apply, WAF
                                                 performs all  transformations
                                                 on   the  specified  content,
                                                 starting from the lowest pri-
                                                 ority  setting, and then uses
                                                 the component contents.

                                                 (structure)
                                                    Text transformations elim-
                                                    inate  some of the unusual
                                                    formatting that  attackers
                                                    use  in web requests in an
                                                    effort  to  bypass  detec-
                                                    tion.

                                                    Priority -> (integer)
                                                        Sets the relative pro-
                                                        cessing order for mul-
                                                        tiple transformations.
                                                        WAF   processes    all
                                                        transformations,  from
                                                        lowest   priority   to
                                                        highest,   before  in-
                                                        specting  the   trans-
                                                        formed   content.  The
                                                        priorities don't  need
                                                        to be consecutive, but
                                                        they must all be  dif-
                                                        ferent.

                                                    Type -> (string)
                                                        You  can  specify  the
                                                        following  transforma-
                                                        tion types:
                                                           BASE64_DECODE - De-
                                                           code a Base64  -en-
                                                           coded string.

                                                           BASE64_DECODE_EXT -
                                                           Decode   a   Base64
                                                           -encoded    string,
                                                           but use a forgiving
                                                           implementation that
                                                           ignores  characters
                                                           that aren't valid.

                                                           CMD_LINE   -   Com-
                                                           mand-line transfor-
                                                           mations.  These are
                                                           helpful in reducing
                                                           effectiveness    of
                                                           attackers  who  in-
                                                           ject  an  operating
                                                           system command-line
                                                           command and use un-
                                                           usual formatting to
                                                           disguise   some  or
                                                           all of the command.

                                                        o Delete the following
                                                          characters: \ " ' ^

                                                        o Delete spaces before
                                                          the following  char-
                                                          acters: / (

                                                        o Replace  the follow-
                                                          ing characters  with
                                                          a space: , ;

                                                        o Replace     multiple
                                                          spaces   with    one
                                                          space

                                                        o Convert    uppercase
                                                          letters   (A-Z)   to
                                                          lowercase (a-z)
                                                           COM-
                                                           PRESS_WHITE_SPACE -
                                                           Replace these char-
                                                           acters with a space
                                                           character  (decimal
                                                           32):

                                                        o \f , formfeed, deci-
                                                          mal 12

                                                        o \t , tab, decimal 9

                                                        o \n  , newline, deci-
                                                          mal 10

                                                        o \r  ,  carriage  re-
                                                          turn, decimal 13

                                                        o \v  ,  vertical tab,
                                                          decimal 11

                                                        o Non-breaking  space,
                                                          decimal 160
                                                           COM-
                                                           PRESS_WHITE_SPACE
                                                           also  replaces mul-
                                                           tiple  spaces  with
                                                           one space.

                                                           CSS_DECODE - Decode
                                                           characters     that
                                                           were  encoded using
                                                           CSS   2.x    escape
                                                           rules          syn-
                                                           data.html#charac-
                                                           ters  .  This func-
                                                           tion uses up to two
                                                           bytes in the decod-
                                                           ing process, so  it
                                                           can help to uncover
                                                           ASCII    characters
                                                           that  were  encoded
                                                           using CSS  encoding
                                                           that  wouldnt typi-
                                                           cally  be  encoded.
                                                           It's also useful in
                                                           countering evasion,
                                                           which is a combina-
                                                           tion of a backslash
                                                           and non-hexadecimal
                                                           characters. For ex-
                                                           ample,  ja\vascript
                                                           for javascript.

                                                           ESCAPE_SEQ_DECODE -
                                                           Decode  the follow-
                                                           ing ANSI  C  escape
                                                           sequences:  \a , \b
                                                           , \f , \n , \r , \t
                                                           , \v , \\ , \? , \'
                                                           , \" , \xHH  (hexa-
                                                           decimal),     \0OOO
                                                           (octal).  Encodings
                                                           that  aren't  valid
                                                           remain in the  out-
                                                           put.

                                                           HEX_DECODE - Decode
                                                           a string  of  hexa-
                                                           decimal  characters
                                                           into a binary.

                                                           HTML_ENTITY_DECODE
                                                           -  Replace HTML-en-
                                                           coded    characters
                                                           with      unencoded
                                                           characters.
                                                           HTML_ENTITY_DECODE
                                                           performs these  op-
                                                           erations:

                                                        o Replaces     (amper-
                                                          sand)quot; with "

                                                        o Replaces     (amper-
                                                          sand)nbsp;   with  a
                                                          non-breaking  space,
                                                          decimal 160

                                                        o Replaces     (amper-
                                                          sand)lt;   with    a
                                                          "less than" symbol

                                                        o Replaces     (amper-
                                                          sand)gt; with >

                                                        o Replaces  characters
                                                          that are represented
                                                          in hexadecimal  for-
                                                          mat, (ampersand)#xh-
                                                          hhh; , with the cor-
                                                          responding   charac-
                                                          ters

                                                        o Replaces  characters
                                                          that are represented
                                                          in  decimal  format,
                                                          (ampersand)#nnnn;  ,
                                                          with the correspond-
                                                          ing characters
                                                           JS_DECODE  - Decode
                                                           JavaScript   escape
                                                           sequences.  If  a \
                                                           u  HHHH code is  in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E   ,  then
                                                           the higher byte  is
                                                           used  to detect and
                                                           adjust  the   lower
                                                           byte.  If not, only
                                                           the lower  byte  is
                                                           used and the higher
                                                           byte   is   zeroed,
                                                           causing  a possible
                                                           loss  of   informa-
                                                           tion.

                                                           LOWERCASE - Convert
                                                           uppercase   letters
                                                           (A-Z)  to lowercase
                                                           (a-z).

                                                           MD5 - Calculate  an
                                                           MD5  hash  from the
                                                           data in the  input.
                                                           The  computed  hash
                                                           is in a raw  binary
                                                           form.

                                                           NONE - Specify NONE
                                                           if you  don't  want
                                                           any  text transfor-
                                                           mations.

                                                           NORMALIZE_PATH    -
                                                           Remove     multiple
                                                           slashes,  directory
                                                           self-references,
                                                           and       directory
                                                           back-references
                                                           that are not at the
                                                           beginning   of  the
                                                           input from an input
                                                           string.

                                                           NORMALIZE_PATH_WIN
                                                           - This is the  same
                                                           as NORMALIZE_PATH ,
                                                           but first  converts
                                                           backslash   charac-
                                                           ters   to   forward
                                                           slashes.

                                                           REMOVE_NULLS  - Re-
                                                           move all NULL bytes
                                                           from the input.

                                                           REPLACE_COMMENTS  -
                                                           Replace each occur-
                                                           rence  of a C-style
                                                           comment (/* ...  */
                                                           )   with  a  single
                                                           space.     Multiple
                                                           consecutive  occur-
                                                           rences are not com-
                                                           pressed.   Untermi-
                                                           nated comments  are
                                                           also  replaced with
                                                           a   space    (ASCII
                                                           0x20).  However,  a
                                                           standalone termina-
                                                           tion  of  a comment
                                                           (*/ ) is not  acted
                                                           upon.

                                                           REPLACE_NULLS - Re-
                                                           place NULL bytes in
                                                           the    input   with
                                                           space    characters
                                                           (ASCII 0x20 ).

                                                           SQL_HEX_DECODE    -
                                                           Decode   SQL    hex
                                                           data.       Example
                                                           (0x414243 ) will be
                                                           decoded to (ABC ).

                                                           URL_DECODE - Decode
                                                           a       URL-encoded
                                                           value.

                                                           URL_DECODE_UNI    -
                                                           Like  URL_DECODE  ,
                                                           but   with  support
                                                           for  Microsoft-spe-
                                                           cific  %u encoding.
                                                           If the code  is  in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E   ,   the
                                                           higher byte is used
                                                           to  detect  and ad-
                                                           just   the    lower
                                                           byte.    Otherwise,
                                                           only the lower byte
                                                           is   used  and  the
                                                           higher byte is  ze-
                                                           roed.

                                                           UTF8_TO_UNICODE   -
                                                           Convert  all  UTF-8
                                                           character sequences
                                                           to  Unicode.   This
                                                           helps input normal-
                                                           ization, and  mini-
                                                           mizing  false-posi-
                                                           tives           and
                                                           false-negatives for
                                                           non-English    lan-
                                                           guages.

                                          Cookie -> (structure)
                                             Use  the value of a cookie in the
                                             request as an aggregate key. Each
                                             distinct value in the cookie con-
                                             tributes to the  aggregation  in-
                                             stance.   If  you  use  a  single
                                             cookie as your custom  key,  then
                                             each  value  fully defines an ag-
                                             gregation instance.

                                             Name -> (string)
                                                 The name  of  the  cookie  to
                                                 use.

                                             TextTransformations -> (list)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection. Text trans-
                                                 formations are used  in  rule
                                                 match  statements,  to trans-
                                                 form the FieldToMatch request
                                                 component  before  inspecting
                                                 it,  and  they're   used   in
                                                 rate-based  rule  statements,
                                                 to transform  request  compo-
                                                 nents  before  using  them as
                                                 custom aggregation  keys.  If
                                                 you   specify   one  or  more
                                                 transformations to apply, WAF
                                                 performs  all transformations
                                                 on  the  specified   content,
                                                 starting from the lowest pri-
                                                 ority setting, and then  uses
                                                 the component contents.

                                                 (structure)
                                                    Text transformations elim-
                                                    inate some of the  unusual
                                                    formatting  that attackers
                                                    use in web requests in  an
                                                    effort  to  bypass  detec-
                                                    tion.

                                                    Priority -> (integer)
                                                        Sets the relative pro-
                                                        cessing order for mul-
                                                        tiple transformations.
                                                        WAF    processes   all
                                                        transformations,  from
                                                        lowest   priority   to
                                                        highest,  before   in-
                                                        specting   the  trans-
                                                        formed  content.   The
                                                        priorities  don't need
                                                        to be consecutive, but
                                                        they  must all be dif-
                                                        ferent.

                                                    Type -> (string)
                                                        You  can  specify  the
                                                        following  transforma-
                                                        tion types:
                                                           BASE64_DECODE - De-
                                                           code  a Base64 -en-
                                                           coded string.

                                                           BASE64_DECODE_EXT -
                                                           Decode   a   Base64
                                                           -encoded    string,
                                                           but use a forgiving
                                                           implementation that
                                                           ignores  characters
                                                           that aren't valid.

                                                           CMD_LINE   -   Com-
                                                           mand-line transfor-
                                                           mations. These  are
                                                           helpful in reducing
                                                           effectiveness    of
                                                           attackers  who  in-
                                                           ject  an  operating
                                                           system command-line
                                                           command and use un-
                                                           usual formatting to
                                                           disguise  some   or
                                                           all of the command.

                                                        o Delete the following
                                                          characters: \ " ' ^

                                                        o Delete spaces before
                                                          the  following char-
                                                          acters: / (

                                                        o Replace the  follow-
                                                          ing  characters with
                                                          a space: , ;

                                                        o Replace     multiple
                                                          spaces    with   one
                                                          space

                                                        o Convert    uppercase
                                                          letters   (A-Z)   to
                                                          lowercase (a-z)
                                                           COM-
                                                           PRESS_WHITE_SPACE -
                                                           Replace these char-
                                                           acters with a space
                                                           character  (decimal
                                                           32):

                                                        o \f , formfeed, deci-
                                                          mal 12

                                                        o \t , tab, decimal 9

                                                        o \n , newline,  deci-
                                                          mal 10

                                                        o \r  ,  carriage  re-
                                                          turn, decimal 13

                                                        o \v ,  vertical  tab,
                                                          decimal 11

                                                        o Non-breaking  space,
                                                          decimal 160
                                                           COM-
                                                           PRESS_WHITE_SPACE
                                                           also replaces  mul-
                                                           tiple  spaces  with
                                                           one space.

                                                           CSS_DECODE - Decode
                                                           characters     that
                                                           were encoded  using
                                                           CSS    2.x   escape
                                                           rules          syn-
                                                           data.html#charac-
                                                           ters .  This  func-
                                                           tion uses up to two
                                                           bytes in the decod-
                                                           ing  process, so it
                                                           can help to uncover
                                                           ASCII    characters
                                                           that  were  encoded
                                                           using  CSS encoding
                                                           that wouldnt  typi-
                                                           cally  be  encoded.
                                                           It's also useful in
                                                           countering evasion,
                                                           which is a combina-
                                                           tion of a backslash
                                                           and non-hexadecimal
                                                           characters. For ex-
                                                           ample,  ja\vascript
                                                           for javascript.

                                                           ESCAPE_SEQ_DECODE -
                                                           Decode the  follow-
                                                           ing  ANSI  C escape
                                                           sequences: \a ,  \b
                                                           , \f , \n , \r , \t
                                                           , \v , \\ , \? , \'
                                                           ,  \" , \xHH (hexa-
                                                           decimal),     \0OOO
                                                           (octal).  Encodings
                                                           that  aren't  valid
                                                           remain  in the out-
                                                           put.

                                                           HEX_DECODE - Decode
                                                           a  string  of hexa-
                                                           decimal  characters
                                                           into a binary.

                                                           HTML_ENTITY_DECODE
                                                           - Replace  HTML-en-
                                                           coded    characters
                                                           with      unencoded
                                                           characters.
                                                           HTML_ENTITY_DECODE
                                                           performs  these op-
                                                           erations:

                                                        o Replaces     (amper-
                                                          sand)quot; with "

                                                        o Replaces     (amper-
                                                          sand)nbsp;  with   a
                                                          non-breaking  space,
                                                          decimal 160

                                                        o Replaces     (amper-
                                                          sand)lt;    with   a
                                                          "less than" symbol

                                                        o Replaces     (amper-
                                                          sand)gt; with >

                                                        o Replaces  characters
                                                          that are represented
                                                          in  hexadecimal for-
                                                          mat, (ampersand)#xh-
                                                          hhh; , with the cor-
                                                          responding   charac-
                                                          ters

                                                        o Replaces  characters
                                                          that are represented
                                                          in  decimal  format,
                                                          (ampersand)#nnnn;  ,
                                                          with the correspond-
                                                          ing characters
                                                           JS_DECODE -  Decode
                                                           JavaScript   escape
                                                           sequences. If  a  \
                                                           u   HHHH code is in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E  ,   then
                                                           the  higher byte is
                                                           used to detect  and
                                                           adjust   the  lower
                                                           byte. If not,  only
                                                           the  lower  byte is
                                                           used and the higher
                                                           byte   is   zeroed,
                                                           causing a  possible
                                                           loss   of  informa-
                                                           tion.

                                                           LOWERCASE - Convert
                                                           uppercase   letters
                                                           (A-Z) to  lowercase
                                                           (a-z).

                                                           MD5  - Calculate an
                                                           MD5 hash  from  the
                                                           data  in the input.
                                                           The  computed  hash
                                                           is  in a raw binary
                                                           form.

                                                           NONE - Specify NONE
                                                           if  you  don't want
                                                           any text  transfor-
                                                           mations.

                                                           NORMALIZE_PATH    -
                                                           Remove     multiple
                                                           slashes,  directory
                                                           self-references,
                                                           and       directory
                                                           back-references
                                                           that are not at the
                                                           beginning  of   the
                                                           input from an input
                                                           string.

                                                           NORMALIZE_PATH_WIN
                                                           -  This is the same
                                                           as NORMALIZE_PATH ,
                                                           but  first converts
                                                           backslash   charac-
                                                           ters   to   forward
                                                           slashes.

                                                           REMOVE_NULLS -  Re-
                                                           move all NULL bytes
                                                           from the input.

                                                           REPLACE_COMMENTS  -
                                                           Replace each occur-
                                                           rence of a  C-style
                                                           comment  (/* ... */
                                                           )  with  a   single
                                                           space.     Multiple
                                                           consecutive  occur-
                                                           rences are not com-
                                                           pressed.   Untermi-
                                                           nated  comments are
                                                           also replaced  with
                                                           a    space   (ASCII
                                                           0x20).  However,  a
                                                           standalone termina-
                                                           tion of  a  comment
                                                           (*/  ) is not acted
                                                           upon.

                                                           REPLACE_NULLS - Re-
                                                           place NULL bytes in
                                                           the   input    with
                                                           space    characters
                                                           (ASCII 0x20 ).

                                                           SQL_HEX_DECODE    -
                                                           Decode    SQL   hex
                                                           data.       Example
                                                           (0x414243 ) will be
                                                           decoded to (ABC ).

                                                           URL_DECODE - Decode
                                                           a       URL-encoded
                                                           value.

                                                           URL_DECODE_UNI    -
                                                           Like  URL_DECODE  ,
                                                           but  with   support
                                                           for  Microsoft-spe-
                                                           cific %u  encoding.
                                                           If  the  code is in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E   ,   the
                                                           higher byte is used
                                                           to detect  and  ad-
                                                           just    the   lower
                                                           byte.    Otherwise,
                                                           only the lower byte
                                                           is  used  and   the
                                                           higher  byte is ze-
                                                           roed.

                                                           UTF8_TO_UNICODE   -
                                                           Convert  all  UTF-8
                                                           character sequences
                                                           to   Unicode.  This
                                                           helps input normal-
                                                           ization,  and mini-
                                                           mizing  false-posi-
                                                           tives           and
                                                           false-negatives for
                                                           non-English    lan-
                                                           guages.

                                          QueryArgument -> (structure)
                                             Use the specified query  argument
                                             as  an  aggregate  key. Each dis-
                                             tinct value for the  named  query
                                             argument  contributes  to the ag-
                                             gregation instance. If you use  a
                                             single  query  argument  as  your
                                             custom key, then each value fully
                                             defines an aggregation instance.

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to use.

                                             TextTransformations -> (list)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection. Text trans-
                                                 formations  are  used in rule
                                                 match statements,  to  trans-
                                                 form the FieldToMatch request
                                                 component  before  inspecting
                                                 it,   and   they're  used  in
                                                 rate-based  rule  statements,
                                                 to  transform  request compo-
                                                 nents before  using  them  as
                                                 custom  aggregation  keys. If
                                                 you  specify  one   or   more
                                                 transformations to apply, WAF
                                                 performs all  transformations
                                                 on   the  specified  content,
                                                 starting from the lowest pri-
                                                 ority  setting, and then uses
                                                 the component contents.

                                                 (structure)
                                                    Text transformations elim-
                                                    inate  some of the unusual
                                                    formatting that  attackers
                                                    use  in web requests in an
                                                    effort  to  bypass  detec-
                                                    tion.

                                                    Priority -> (integer)
                                                        Sets the relative pro-
                                                        cessing order for mul-
                                                        tiple transformations.
                                                        WAF   processes    all
                                                        transformations,  from
                                                        lowest   priority   to
                                                        highest,   before  in-
                                                        specting  the   trans-
                                                        formed   content.  The
                                                        priorities don't  need
                                                        to be consecutive, but
                                                        they must all be  dif-
                                                        ferent.

                                                    Type -> (string)
                                                        You  can  specify  the
                                                        following  transforma-
                                                        tion types:
                                                           BASE64_DECODE - De-
                                                           code a Base64  -en-
                                                           coded string.

                                                           BASE64_DECODE_EXT -
                                                           Decode   a   Base64
                                                           -encoded    string,
                                                           but use a forgiving
                                                           implementation that
                                                           ignores  characters
                                                           that aren't valid.

                                                           CMD_LINE   -   Com-
                                                           mand-line transfor-
                                                           mations.  These are
                                                           helpful in reducing
                                                           effectiveness    of
                                                           attackers  who  in-
                                                           ject  an  operating
                                                           system command-line
                                                           command and use un-
                                                           usual formatting to
                                                           disguise   some  or
                                                           all of the command.

                                                        o Delete the following
                                                          characters: \ " ' ^

                                                        o Delete spaces before
                                                          the following  char-
                                                          acters: / (

                                                        o Replace  the follow-
                                                          ing characters  with
                                                          a space: , ;

                                                        o Replace     multiple
                                                          spaces   with    one
                                                          space

                                                        o Convert    uppercase
                                                          letters   (A-Z)   to
                                                          lowercase (a-z)
                                                           COM-
                                                           PRESS_WHITE_SPACE -
                                                           Replace these char-
                                                           acters with a space
                                                           character  (decimal
                                                           32):

                                                        o \f , formfeed, deci-
                                                          mal 12

                                                        o \t , tab, decimal 9

                                                        o \n  , newline, deci-
                                                          mal 10

                                                        o \r  ,  carriage  re-
                                                          turn, decimal 13

                                                        o \v  ,  vertical tab,
                                                          decimal 11

                                                        o Non-breaking  space,
                                                          decimal 160
                                                           COM-
                                                           PRESS_WHITE_SPACE
                                                           also  replaces mul-
                                                           tiple  spaces  with
                                                           one space.

                                                           CSS_DECODE - Decode
                                                           characters     that
                                                           were  encoded using
                                                           CSS   2.x    escape
                                                           rules          syn-
                                                           data.html#charac-
                                                           ters  .  This func-
                                                           tion uses up to two
                                                           bytes in the decod-
                                                           ing process, so  it
                                                           can help to uncover
                                                           ASCII    characters
                                                           that  were  encoded
                                                           using CSS  encoding
                                                           that  wouldnt typi-
                                                           cally  be  encoded.
                                                           It's also useful in
                                                           countering evasion,
                                                           which is a combina-
                                                           tion of a backslash
                                                           and non-hexadecimal
                                                           characters. For ex-
                                                           ample,  ja\vascript
                                                           for javascript.

                                                           ESCAPE_SEQ_DECODE -
                                                           Decode  the follow-
                                                           ing ANSI  C  escape
                                                           sequences:  \a , \b
                                                           , \f , \n , \r , \t
                                                           , \v , \\ , \? , \'
                                                           , \" , \xHH  (hexa-
                                                           decimal),     \0OOO
                                                           (octal).  Encodings
                                                           that  aren't  valid
                                                           remain in the  out-
                                                           put.

                                                           HEX_DECODE - Decode
                                                           a string  of  hexa-
                                                           decimal  characters
                                                           into a binary.

                                                           HTML_ENTITY_DECODE
                                                           -  Replace HTML-en-
                                                           coded    characters
                                                           with      unencoded
                                                           characters.
                                                           HTML_ENTITY_DECODE
                                                           performs these  op-
                                                           erations:

                                                        o Replaces     (amper-
                                                          sand)quot; with "

                                                        o Replaces     (amper-
                                                          sand)nbsp;   with  a
                                                          non-breaking  space,
                                                          decimal 160

                                                        o Replaces     (amper-
                                                          sand)lt;   with    a
                                                          "less than" symbol

                                                        o Replaces     (amper-
                                                          sand)gt; with >

                                                        o Replaces  characters
                                                          that are represented
                                                          in hexadecimal  for-
                                                          mat, (ampersand)#xh-
                                                          hhh; , with the cor-
                                                          responding   charac-
                                                          ters

                                                        o Replaces  characters
                                                          that are represented
                                                          in  decimal  format,
                                                          (ampersand)#nnnn;  ,
                                                          with the correspond-
                                                          ing characters
                                                           JS_DECODE  - Decode
                                                           JavaScript   escape
                                                           sequences.  If  a \
                                                           u  HHHH code is  in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E   ,  then
                                                           the higher byte  is
                                                           used  to detect and
                                                           adjust  the   lower
                                                           byte.  If not, only
                                                           the lower  byte  is
                                                           used and the higher
                                                           byte   is   zeroed,
                                                           causing  a possible
                                                           loss  of   informa-
                                                           tion.

                                                           LOWERCASE - Convert
                                                           uppercase   letters
                                                           (A-Z)  to lowercase
                                                           (a-z).

                                                           MD5 - Calculate  an
                                                           MD5  hash  from the
                                                           data in the  input.
                                                           The  computed  hash
                                                           is in a raw  binary
                                                           form.

                                                           NONE - Specify NONE
                                                           if you  don't  want
                                                           any  text transfor-
                                                           mations.

                                                           NORMALIZE_PATH    -
                                                           Remove     multiple
                                                           slashes,  directory
                                                           self-references,
                                                           and       directory
                                                           back-references
                                                           that are not at the
                                                           beginning   of  the
                                                           input from an input
                                                           string.

                                                           NORMALIZE_PATH_WIN
                                                           - This is the  same
                                                           as NORMALIZE_PATH ,
                                                           but first  converts
                                                           backslash   charac-
                                                           ters   to   forward
                                                           slashes.

                                                           REMOVE_NULLS  - Re-
                                                           move all NULL bytes
                                                           from the input.

                                                           REPLACE_COMMENTS  -
                                                           Replace each occur-
                                                           rence  of a C-style
                                                           comment (/* ...  */
                                                           )   with  a  single
                                                           space.     Multiple
                                                           consecutive  occur-
                                                           rences are not com-
                                                           pressed.   Untermi-
                                                           nated comments  are
                                                           also  replaced with
                                                           a   space    (ASCII
                                                           0x20).  However,  a
                                                           standalone termina-
                                                           tion  of  a comment
                                                           (*/ ) is not  acted
                                                           upon.

                                                           REPLACE_NULLS - Re-
                                                           place NULL bytes in
                                                           the    input   with
                                                           space    characters
                                                           (ASCII 0x20 ).

                                                           SQL_HEX_DECODE    -
                                                           Decode   SQL    hex
                                                           data.       Example
                                                           (0x414243 ) will be
                                                           decoded to (ABC ).

                                                           URL_DECODE - Decode
                                                           a       URL-encoded
                                                           value.

                                                           URL_DECODE_UNI    -
                                                           Like  URL_DECODE  ,
                                                           but   with  support
                                                           for  Microsoft-spe-
                                                           cific  %u encoding.
                                                           If the code  is  in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E   ,   the
                                                           higher byte is used
                                                           to  detect  and ad-
                                                           just   the    lower
                                                           byte.    Otherwise,
                                                           only the lower byte
                                                           is   used  and  the
                                                           higher byte is  ze-
                                                           roed.

                                                           UTF8_TO_UNICODE   -
                                                           Convert  all  UTF-8
                                                           character sequences
                                                           to  Unicode.   This
                                                           helps input normal-
                                                           ization, and  mini-
                                                           mizing  false-posi-
                                                           tives           and
                                                           false-negatives for
                                                           non-English    lan-
                                                           guages.

                                          QueryString -> (structure)
                                             Use the request's query string as
                                             an aggregate key.  Each  distinct
                                             string  contributes to the aggre-
                                             gation instance. If you use  just
                                             the  query  string as your custom
                                             key, then each string  fully  de-
                                             fines an aggregation instance.

                                             TextTransformations -> (list)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection. Text trans-
                                                 formations are used  in  rule
                                                 match  statements,  to trans-
                                                 form the FieldToMatch request
                                                 component  before  inspecting
                                                 it,  and  they're   used   in
                                                 rate-based  rule  statements,
                                                 to transform  request  compo-
                                                 nents  before  using  them as
                                                 custom aggregation  keys.  If
                                                 you   specify   one  or  more
                                                 transformations to apply, WAF
                                                 performs  all transformations
                                                 on  the  specified   content,
                                                 starting from the lowest pri-
                                                 ority setting, and then  uses
                                                 the component contents.

                                                 (structure)
                                                    Text transformations elim-
                                                    inate some of the  unusual
                                                    formatting  that attackers
                                                    use in web requests in  an
                                                    effort  to  bypass  detec-
                                                    tion.

                                                    Priority -> (integer)
                                                        Sets the relative pro-
                                                        cessing order for mul-
                                                        tiple transformations.
                                                        WAF    processes   all
                                                        transformations,  from
                                                        lowest   priority   to
                                                        highest,  before   in-
                                                        specting   the  trans-
                                                        formed  content.   The
                                                        priorities  don't need
                                                        to be consecutive, but
                                                        they  must all be dif-
                                                        ferent.

                                                    Type -> (string)
                                                        You  can  specify  the
                                                        following  transforma-
                                                        tion types:
                                                           BASE64_DECODE - De-
                                                           code  a Base64 -en-
                                                           coded string.

                                                           BASE64_DECODE_EXT -
                                                           Decode   a   Base64
                                                           -encoded    string,
                                                           but use a forgiving
                                                           implementation that
                                                           ignores  characters
                                                           that aren't valid.

                                                           CMD_LINE   -   Com-
                                                           mand-line transfor-
                                                           mations. These  are
                                                           helpful in reducing
                                                           effectiveness    of
                                                           attackers  who  in-
                                                           ject  an  operating
                                                           system command-line
                                                           command and use un-
                                                           usual formatting to
                                                           disguise  some   or
                                                           all of the command.

                                                        o Delete the following
                                                          characters: \ " ' ^

                                                        o Delete spaces before
                                                          the  following char-
                                                          acters: / (

                                                        o Replace the  follow-
                                                          ing  characters with
                                                          a space: , ;

                                                        o Replace     multiple
                                                          spaces    with   one
                                                          space

                                                        o Convert    uppercase
                                                          letters   (A-Z)   to
                                                          lowercase (a-z)
                                                           COM-
                                                           PRESS_WHITE_SPACE -
                                                           Replace these char-
                                                           acters with a space
                                                           character  (decimal
                                                           32):

                                                        o \f , formfeed, deci-
                                                          mal 12

                                                        o \t , tab, decimal 9

                                                        o \n , newline,  deci-
                                                          mal 10

                                                        o \r  ,  carriage  re-
                                                          turn, decimal 13

                                                        o \v ,  vertical  tab,
                                                          decimal 11

                                                        o Non-breaking  space,
                                                          decimal 160
                                                           COM-
                                                           PRESS_WHITE_SPACE
                                                           also replaces  mul-
                                                           tiple  spaces  with
                                                           one space.

                                                           CSS_DECODE - Decode
                                                           characters     that
                                                           were encoded  using
                                                           CSS    2.x   escape
                                                           rules          syn-
                                                           data.html#charac-
                                                           ters .  This  func-
                                                           tion uses up to two
                                                           bytes in the decod-
                                                           ing  process, so it
                                                           can help to uncover
                                                           ASCII    characters
                                                           that  were  encoded
                                                           using  CSS encoding
                                                           that wouldnt  typi-
                                                           cally  be  encoded.
                                                           It's also useful in
                                                           countering evasion,
                                                           which is a combina-
                                                           tion of a backslash
                                                           and non-hexadecimal
                                                           characters. For ex-
                                                           ample,  ja\vascript
                                                           for javascript.

                                                           ESCAPE_SEQ_DECODE -
                                                           Decode the  follow-
                                                           ing  ANSI  C escape
                                                           sequences: \a ,  \b
                                                           , \f , \n , \r , \t
                                                           , \v , \\ , \? , \'
                                                           ,  \" , \xHH (hexa-
                                                           decimal),     \0OOO
                                                           (octal).  Encodings
                                                           that  aren't  valid
                                                           remain  in the out-
                                                           put.

                                                           HEX_DECODE - Decode
                                                           a  string  of hexa-
                                                           decimal  characters
                                                           into a binary.

                                                           HTML_ENTITY_DECODE
                                                           - Replace  HTML-en-
                                                           coded    characters
                                                           with      unencoded
                                                           characters.
                                                           HTML_ENTITY_DECODE
                                                           performs  these op-
                                                           erations:

                                                        o Replaces     (amper-
                                                          sand)quot; with "

                                                        o Replaces     (amper-
                                                          sand)nbsp;  with   a
                                                          non-breaking  space,
                                                          decimal 160

                                                        o Replaces     (amper-
                                                          sand)lt;    with   a
                                                          "less than" symbol

                                                        o Replaces     (amper-
                                                          sand)gt; with >

                                                        o Replaces  characters
                                                          that are represented
                                                          in  hexadecimal for-
                                                          mat, (ampersand)#xh-
                                                          hhh; , with the cor-
                                                          responding   charac-
                                                          ters

                                                        o Replaces  characters
                                                          that are represented
                                                          in  decimal  format,
                                                          (ampersand)#nnnn;  ,
                                                          with the correspond-
                                                          ing characters
                                                           JS_DECODE -  Decode
                                                           JavaScript   escape
                                                           sequences. If  a  \
                                                           u   HHHH code is in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E  ,   then
                                                           the  higher byte is
                                                           used to detect  and
                                                           adjust   the  lower
                                                           byte. If not,  only
                                                           the  lower  byte is
                                                           used and the higher
                                                           byte   is   zeroed,
                                                           causing a  possible
                                                           loss   of  informa-
                                                           tion.

                                                           LOWERCASE - Convert
                                                           uppercase   letters
                                                           (A-Z) to  lowercase
                                                           (a-z).

                                                           MD5  - Calculate an
                                                           MD5 hash  from  the
                                                           data  in the input.
                                                           The  computed  hash
                                                           is  in a raw binary
                                                           form.

                                                           NONE - Specify NONE
                                                           if  you  don't want
                                                           any text  transfor-
                                                           mations.

                                                           NORMALIZE_PATH    -
                                                           Remove     multiple
                                                           slashes,  directory
                                                           self-references,
                                                           and       directory
                                                           back-references
                                                           that are not at the
                                                           beginning  of   the
                                                           input from an input
                                                           string.

                                                           NORMALIZE_PATH_WIN
                                                           -  This is the same
                                                           as NORMALIZE_PATH ,
                                                           but  first converts
                                                           backslash   charac-
                                                           ters   to   forward
                                                           slashes.

                                                           REMOVE_NULLS -  Re-
                                                           move all NULL bytes
                                                           from the input.

                                                           REPLACE_COMMENTS  -
                                                           Replace each occur-
                                                           rence of a  C-style
                                                           comment  (/* ... */
                                                           )  with  a   single
                                                           space.     Multiple
                                                           consecutive  occur-
                                                           rences are not com-
                                                           pressed.   Untermi-
                                                           nated  comments are
                                                           also replaced  with
                                                           a    space   (ASCII
                                                           0x20).  However,  a
                                                           standalone termina-
                                                           tion of  a  comment
                                                           (*/  ) is not acted
                                                           upon.

                                                           REPLACE_NULLS - Re-
                                                           place NULL bytes in
                                                           the   input    with
                                                           space    characters
                                                           (ASCII 0x20 ).

                                                           SQL_HEX_DECODE    -
                                                           Decode    SQL   hex
                                                           data.       Example
                                                           (0x414243 ) will be
                                                           decoded to (ABC ).

                                                           URL_DECODE - Decode
                                                           a       URL-encoded
                                                           value.

                                                           URL_DECODE_UNI    -
                                                           Like  URL_DECODE  ,
                                                           but  with   support
                                                           for  Microsoft-spe-
                                                           cific %u  encoding.
                                                           If  the  code is in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E   ,   the
                                                           higher byte is used
                                                           to detect  and  ad-
                                                           just    the   lower
                                                           byte.    Otherwise,
                                                           only the lower byte
                                                           is  used  and   the
                                                           higher  byte is ze-
                                                           roed.

                                                           UTF8_TO_UNICODE   -
                                                           Convert  all  UTF-8
                                                           character sequences
                                                           to   Unicode.  This
                                                           helps input normal-
                                                           ization,  and mini-
                                                           mizing  false-posi-
                                                           tives           and
                                                           false-negatives for
                                                           non-English    lan-
                                                           guages.

                                          HTTPMethod -> (structure)
                                             Use the request's HTTP method  as
                                             an  aggregate  key. Each distinct
                                             HTTP method  contributes  to  the
                                             aggregation  instance. If you use
                                             just the HTTP method as your cus-
                                             tom  key,  then each method fully
                                             defines an aggregation instance.

                                          ForwardedIP -> (structure)
                                             Use the first IP  address  in  an
                                             HTTP  header as an aggregate key.
                                             Each distinct  forwarded  IP  ad-
                                             dress contributes to the aggrega-
                                             tion instance.

                                             When you specify an  IP  or  for-
                                             warded  IP in the custom key set-
                                             tings, you must also  specify  at
                                             least  one  other key to use. You
                                             can aggregate on  only  the  for-
                                             warded  IP  address by specifying
                                             FORWARDED_IP in  your  rate-based
                                             statement's AggregateKeyType .

                                             With  this option, you must spec-
                                             ify the  header  to  use  in  the
                                             rate-based rule's ForwardedIPCon-
                                             fig property.

                                          IP -> (structure)
                                             Use the request's originating  IP
                                             address as an aggregate key. Each
                                             distinct IP  address  contributes
                                             to the aggregation instance.

                                             When  you  specify  an IP or for-
                                             warded IP in the custom key  set-
                                             tings,  you  must also specify at
                                             least one other key to  use.  You
                                             can  aggregate on only the IP ad-
                                             dress by specifying  IP  in  your
                                             rate-based   statement's   Aggre-
                                             gateKeyType .

                                          LabelNamespace -> (structure)
                                             Use the specified label namespace
                                             as  an  aggregate  key. Each dis-
                                             tinct fully qualified label  name
                                             that   has  the  specified  label
                                             namespace contributes to the  ag-
                                             gregation  instance.  If  you use
                                             just one label namespace as  your
                                             custom  key, then each label name
                                             fully defines an aggregation  in-
                                             stance.

                                             This  uses  only labels that have
                                             been  added  to  the  request  by
                                             rules  that  are evaluated before
                                             this rate-based rule in  the  web
                                             ACL.

                                             For information about label name-
                                             spaces and names, see Label  syn-
                                             tax  and  naming  requirements in
                                             the WAF Developer Guide .

                                             Namespace -> (string)
                                                 The namespace to use for  ag-
                                                 gregation.

                               AndStatement -> (structure)
                                   A  logical  rule  statement used to combine
                                   other rule statements with AND  logic.  You
                                   provide more than one  Statement within the
                                   AndStatement .

                                   Statements -> (list)
                                      The  statements  to  combine  with   AND
                                      logic.  You  can use any statements that
                                      can be nested.

                                      ( ... recursive ... )

                               OrStatement -> (structure)
                                   A logical rule statement  used  to  combine
                                   other  rule  statements  with OR logic. You
                                   provide more than one  Statement within the
                                   OrStatement .

                                   Statements -> (list)
                                      The statements to combine with OR logic.
                                      You can use any statements that  can  be
                                      nested.

                                      ( ... recursive ... )

                               NotStatement -> (structure)
                                   A logical rule statement used to negate the
                                   results of another rule statement. You pro-
                                   vide one  Statement within the NotStatement
                                   .

                                   ( ... recursive ... )

                               ManagedRuleGroupStatement -> (structure)
                                   A rule statement used to run the rules that
                                   are defined in a managed rule group. To use
                                   this, provide the vendor name and the  name
                                   of  the  rule  group in this statement. You
                                   can retrieve the required names by  calling
                                   ListAvailableManagedRuleGroups .

                                   You cannot nest a ManagedRuleGroupStatement
                                   , for example for use inside a NotStatement
                                   or  OrStatement . It can only be referenced
                                   as a top-level statement within a rule.

                                   NOTE:
                                      You are charged additional fees when you
                                      use  the  WAF  Bot  Control managed rule
                                      group   AWSManagedRulesBotControlRuleSet
                                      or  the  WAF Fraud Control account take-
                                      over prevention (ATP) managed rule group
                                      AWSManagedRulesATPRuleSet . For more in-
                                      formation, see WAF Pricing .

                                   VendorName -> (string)
                                      The name of the managed rule group  ven-
                                      dor.  You  use this, along with the rule
                                      group name, to identify a rule group.

                                   Name -> (string)
                                      The name of the managed rule group.  You
                                      use this, along with the vendor name, to
                                      identify the rule group.

                                   Version -> (string)
                                      The version of the managed rule group to
                                      use.  If  you  specify this, the version
                                      setting is fixed until you change it. If
                                      you  don't  specify  this,  WAF uses the
                                      vendor's default version, and then keeps
                                      the version at the vendor's default when
                                      the  vendor  updates  the  managed  rule
                                      group settings.

                                   ExcludedRules -> (list)
                                      Rules in the referenced rule group whose
                                      actions are set to Count .

                                      NOTE:
                                          Instead of this option, use  RuleAc-
                                          tionOverrides . It accepts any valid
                                          action setting, including Count .

                                      (structure)
                                          Specifies a single rule  in  a  rule
                                          group whose action you want to over-
                                          ride to Count .

                                          NOTE:
                                             Instead of this option, use Rule-
                                             ActionOverrides  . It accepts any
                                             valid action  setting,  including
                                             Count .

                                          Name -> (string)
                                             The name of the rule whose action
                                             you want to override to Count .

                                   ( ... recursive  ...  )ManagedRuleGroupCon-
                                   figs -> (list)
                                      Additional  information that's used by a
                                      managed rule group.  Many  managed  rule
                                      groups don't require this.

                                      Use  the  AWSManagedRulesATPRuleSet con-
                                      figuration object for the account  take-
                                      over  prevention  managed rule group, to
                                      provide information such as the  sign-in
                                      page of your application and the type of
                                      content to accept  or  reject  from  the
                                      client.

                                      Use the AWSManagedRulesBotControlRuleSet
                                      configuration object  to  configure  the
                                      protection  level  that you want the Bot
                                      Control rule group to use.

                                      (structure)
                                          Additional information  that's  used
                                          by  a  managed rule group. Many man-
                                          aged rule groups don't require this.

                                          Use  the   AWSManagedRulesATPRuleSet
                                          configuration object for the account
                                          takeover  prevention  managed   rule
                                          group,  to  provide information such
                                          as the sign-in page of your applica-
                                          tion  and the type of content to ac-
                                          cept or reject from the client.

                                          Use  the  AWSManagedRulesBotControl-
                                          RuleSet configuration object to con-
                                          figure the protection level that you
                                          want  the  Bot Control rule group to
                                          use.

                                          For example specifications, see  the
                                          examples section of  CreateWebACL .

                                          LoginPath -> (string)

                                             NOTE:
                                                 Instead of this setting, pro-
                                                 vide your configuration under
                                                 AWSManagedRulesATPRuleSet .

                                          PayloadType -> (string)

                                             NOTE:
                                                 Instead of this setting, pro-
                                                 vide your configuration under
                                                 AWSManagedRulesATPRuleSet
                                                 RequestInspection .

                                          UsernameField -> (structure)

                                             NOTE:
                                                 Instead of this setting, pro-
                                                 vide your configuration under
                                                 AWSManagedRulesATPRuleSet
                                                 RequestInspection .

                                             Identifier -> (string)
                                                 The   name  of  the  username
                                                 field.      For       example
                                                 /form/username .

                                          PasswordField -> (structure)

                                             NOTE:
                                                 Instead of this setting, pro-
                                                 vide your configuration under
                                                 AWSManagedRulesATPRuleSet
                                                 RequestInspection .

                                             Identifier -> (string)
                                                 The  name  of  the   password
                                                 field.       For      example
                                                 /form/password .

                                          AWSManagedRulesBotControlRuleSet  ->
                                          (structure)
                                             Additional  configuration for us-
                                             ing the Bot Control managed  rule
                                             group.  Use  this  to specify the
                                             inspection level that you want to
                                             use.  For information about using
                                             the  Bot  Control  managed   rule
                                             group,  see  WAF Bot Control rule
                                             group and WAF Bot Control in  the
                                             WAF Developer Guide .

                                             InspectionLevel -> (string)
                                                 The  inspection  level to use
                                                 for  the  Bot  Control   rule
                                                 group.  The  common  level is
                                                 the least expensive. The tar-
                                                 geted level includes all com-
                                                 mon  level  rules  and   adds
                                                 rules  with more advanced in-
                                                 spection  criteria.  For  de-
                                                 tails,  see  WAF  Bot Control
                                                 rule group in the WAF  Devel-
                                                 oper Guide .

                                          AWSManagedRulesATPRuleSet -> (struc-
                                          ture)
                                             Additional configuration for  us-
                                             ing  the account takeover preven-
                                             tion (ATP)  managed  rule  group,
                                             AWSManagedRulesATPRuleSet  .  Use
                                             this to provide login request in-
                                             formation  to the rule group. For
                                             web ACLs that protect  CloudFront
                                             distributions,  use  this to also
                                             provide the information about how
                                             your distribution responds to lo-
                                             gin requests.

                                             This configuration  replaces  the
                                             individual  configuration  fields
                                             in   ManagedRuleGroupConfig   and
                                             provides  additional feature con-
                                             figuration.

                                             For information about  using  the
                                             ATP  managed  rule group, see WAF
                                             Fraud  Control  account  takeover
                                             prevention  (ATP)  rule group and
                                             WAF Fraud Control  account  take-
                                             over  prevention (ATP) in the WAF
                                             Developer Guide .

                                             LoginPath -> (string)
                                                 The path of  the  login  end-
                                                 point  for  your application.
                                                 For  example,  for  the   URL
                                                 https://example.com/web/login
                                                 , you would provide the  path
                                                 /web/login .

                                                 The  rule group inspects only
                                                 HTTP POST  requests  to  your
                                                 specified login endpoint.

                                             RequestInspection -> (structure)
                                                 The  criteria  for inspecting
                                                 login requests, used  by  the
                                                 ATP  rule  group  to validate
                                                 credentials usage.

                                                 PayloadType -> (string)
                                                    The payload type for  your
                                                    login   endpoint,   either
                                                    JSON or form encoded.

                                                 UsernameField -> (structure)
                                                    Details about  your  login
                                                    page username field.

                                                    How  you  specify this de-
                                                    pends on the payload type.

                                                    o For JSON payloads, spec-
                                                      ify  the  field  name in
                                                      JSON pointer syntax. For
                                                      information   about  the
                                                      JSON Pointer syntax, see
                                                      the Internet Engineering
                                                      Task Force (IETF)  docu-
                                                      mentation JavaScript Ob-
                                                      ject   Notation   (JSON)
                                                      Pointer  .  For example,
                                                      for the JSON  payload  {
                                                      "login":  {  "username":
                                                      "THE_USERNAME",   "pass-
                                                      word":  "THE_PASSWORD" }
                                                      } , the  username  field
                                                      specification   is  /lo-
                                                      gin/username   and   the
                                                      password  field specifi-
                                                      cation  is  /login/pass-
                                                      word .

                                                    o For form encoded payload
                                                      types, use the HTML form
                                                      names.  For example, for
                                                      an HTML form with  input
                                                      elements named username1
                                                      and  password1   ,   the
                                                      username  field specifi-
                                                      cation is username1  and
                                                      the password field spec-
                                                      ification is password1 .

                                                    Identifier -> (string)
                                                        The name of the  user-
                                                        name  field. For exam-
                                                        ple /form/username .

                                                 PasswordField -> (structure)
                                                    Details about  your  login
                                                    page password field.

                                                    How  you  specify this de-
                                                    pends on the payload type.

                                                    o For JSON payloads, spec-
                                                      ify  the  field  name in
                                                      JSON pointer syntax. For
                                                      information   about  the
                                                      JSON Pointer syntax, see
                                                      the Internet Engineering
                                                      Task Force (IETF)  docu-
                                                      mentation JavaScript Ob-
                                                      ject   Notation   (JSON)
                                                      Pointer  .  For example,
                                                      for the JSON  payload  {
                                                      "login":  {  "username":
                                                      "THE_USERNAME",   "pass-
                                                      word":  "THE_PASSWORD" }
                                                      } , the  username  field
                                                      specification   is  /lo-
                                                      gin/username   and   the
                                                      password  field specifi-
                                                      cation  is  /login/pass-
                                                      word .

                                                    o For form encoded payload
                                                      types, use the HTML form
                                                      names.  For example, for
                                                      an HTML form with  input
                                                      elements named username1
                                                      and  password1   ,   the
                                                      username  field specifi-
                                                      cation is username1  and
                                                      the password field spec-
                                                      ification is password1 .

                                                    Identifier -> (string)
                                                        The name of the  pass-
                                                        word  field. For exam-
                                                        ple /form/password .

                                             ResponseInspection -> (structure)
                                                 The criteria  for  inspecting
                                                 responses  to login requests,
                                                 used by the ATP rule group to
                                                 track login failure rates.

                                                 The  ATP rule group evaluates
                                                 the responses that your  pro-
                                                 tected resources send back to
                                                 client login attempts,  keep-
                                                 ing  count  of successful and
                                                 failed attempts from each  IP
                                                 address  and  client session.
                                                 Using this  information,  the
                                                 rule  group  labels and miti-
                                                 gates  requests  from  client
                                                 sessions   and  IP  addresses
                                                 that submit too  many  failed
                                                 login  attempts  in  a  short
                                                 amount of time.

                                                 NOTE:
                                                    Response   inspection   is
                                                    available only in web ACLs
                                                    that protect Amazon Cloud-
                                                    Front distributions.

                                                 StatusCode -> (structure)
                                                    Configures  inspection  of
                                                    the response status code.

                                                    SuccessCodes -> (list)
                                                        Status  codes  in  the
                                                        response that indicate
                                                        a successful login at-
                                                        tempt.  To  be counted
                                                        as a successful login,
                                                        the   response  status
                                                        code must match one of
                                                        these.  Each code must
                                                        be  unique  among  the
                                                        success   and  failure
                                                        status codes.

                                                        JSON  example:   "Suc-
                                                        cessCodes": [ 200, 201
                                                        ]

                                                        (integer)

                                                    FailureCodes -> (list)
                                                        Status  codes  in  the
                                                        response that indicate
                                                        a  failed  login   at-
                                                        tempt.  To  be counted
                                                        as a failed login, the
                                                        response  status  code
                                                        must  match   one   of
                                                        these.  Each code must
                                                        be  unique  among  the
                                                        success   and  failure
                                                        status codes.

                                                        JSON  example:  "Fail-
                                                        ureCodes":  [ 400, 404
                                                        ]

                                                        (integer)

                                                 Header -> (structure)
                                                    Configures  inspection  of
                                                    the response header.

                                                    Name -> (string)
                                                        The name of the header
                                                        to match against.  The
                                                        name  must be an exact
                                                        match, including case.

                                                        JSON example:  "Name":
                                                        [ "LoginResult" ]

                                                    SuccessValues -> (list)
                                                        Values in the response
                                                        header with the speci-
                                                        fied  name  that indi-
                                                        cate a successful  lo-
                                                        gin   attempt.  To  be
                                                        counted as a  success-
                                                        ful  login,  the value
                                                        must   be   an   exact
                                                        match, including case.
                                                        Each  value  must   be
                                                        unique  among the suc-
                                                        cess and failure  val-
                                                        ues.

                                                        JSON   example:  "Suc-
                                                        cessValues": [ "Login-
                                                        Passed",   "Successful
                                                        login" ]

                                                        (string)

                                                    FailureValues -> (list)
                                                        Values in the response
                                                        header with the speci-
                                                        fied name  that  indi-
                                                        cate  a  failed  login
                                                        attempt. To be counted
                                                        as a failed login, the
                                                        value must be an exact
                                                        match, including case.
                                                        Each  value  must   be
                                                        unique  among the suc-
                                                        cess and failure  val-
                                                        ues.

                                                        JSON  example:  "Fail-
                                                        ureValues": [  "Login-
                                                        Failed",  "Failed  lo-
                                                        gin" ]

                                                        (string)

                                                 BodyContains -> (structure)
                                                    Configures  inspection  of
                                                    the response body. WAF can
                                                    inspect the  first  65,536
                                                    bytes  (64  KB) of the re-
                                                    sponse body.

                                                    SuccessStrings -> (list)
                                                        Strings in the body of
                                                        the  response that in-
                                                        dicate  a   successful
                                                        login  attempt.  To be
                                                        counted as a  success-
                                                        ful  login, the string
                                                        can be anywhere in the
                                                        body  and  must  be an
                                                        exact match, including
                                                        case. Each string must
                                                        be  unique  among  the
                                                        success   and  failure
                                                        strings.

                                                        JSON  example:   "Suc-
                                                        cessStrings": [ "Login
                                                        successful",  "Welcome
                                                        to our site!" ]

                                                        (string)

                                                    FailureStrings -> (list)
                                                        Strings in the body of
                                                        the response that  in-
                                                        dicate  a failed login
                                                        attempt. To be counted
                                                        as a failed login, the
                                                        string can be anywhere
                                                        in  the  body and must
                                                        be an exact match, in-
                                                        cluding   case.   Each
                                                        string must be  unique
                                                        among  the success and
                                                        failure strings.

                                                        JSON  example:  "Fail-
                                                        ureStrings":  [ "Login
                                                        failed" ]

                                                        (string)

                                                 Json -> (structure)
                                                    Configures  inspection  of
                                                    the response JSON. WAF can
                                                    inspect the  first  65,536
                                                    bytes  (64  KB) of the re-
                                                    sponse JSON.

                                                    Identifier -> (string)
                                                        The identifier for the
                                                        value to match against
                                                        in the JSON. The iden-
                                                        tifier  must be an ex-
                                                        act  match,  including
                                                        case.

                                                        JSON example: "Identi-
                                                        fier": [  "/login/suc-
                                                        cess" ]

                                                    SuccessValues -> (list)
                                                        Values  for the speci-
                                                        fied identifier in the
                                                        response JSON that in-
                                                        dicate  a   successful
                                                        login  attempt.  To be
                                                        counted as a  success-
                                                        ful  login,  the value
                                                        must   be   an   exact
                                                        match, including case.
                                                        Each  value  must   be
                                                        unique  among the suc-
                                                        cess and failure  val-
                                                        ues.

                                                        JSON   example:  "Suc-
                                                        cessValues": [ "True",
                                                        "Succeeded" ]

                                                        (string)

                                                    FailureValues -> (list)
                                                        Values  for the speci-
                                                        fied identifier in the
                                                        response JSON that in-
                                                        dicate a failed  login
                                                        attempt. To be counted
                                                        as a failed login, the
                                                        value must be an exact
                                                        match, including case.
                                                        Each   value  must  be
                                                        unique among the  suc-
                                                        cess  and failure val-
                                                        ues.

                                                        JSON  example:  "Fail-
                                                        ureValues": [ "False",
                                                        "Failed" ]

                                                        (string)

                                   RuleActionOverrides -> (list)
                                      Action settings to use in the  place  of
                                      the rule actions that are configured in-
                                      side the rule  group.  You  specify  one
                                      override  for each rule whose action you
                                      want to change.

                                      You can use overrides for  testing,  for
                                      example you can override all of rule ac-
                                      tions to Count and then monitor the  re-
                                      sulting  count metrics to understand how
                                      the rule group  would  handle  your  web
                                      traffic.  You can also permanently over-
                                      ride some or all actions, to modify  how
                                      the rule group manages your web traffic.

                                      (structure)
                                          Action  setting  to use in the place
                                          of a rule action that is  configured
                                          inside  the  rule group. You specify
                                          one override for each rule whose ac-
                                          tion you want to change.

                                          You  can  use overrides for testing,
                                          for example you can override all  of
                                          rule actions to Count and then moni-
                                          tor the resulting count  metrics  to
                                          understand  how the rule group would
                                          handle your  web  traffic.  You  can
                                          also  permanently  override  some or
                                          all actions, to modify how the  rule
                                          group manages your web traffic.

                                          Name -> (string)
                                             The name of the rule to override.

                                          ActionToUse -> (structure)
                                             The  override  action  to use, in
                                             place of the configured action of
                                             the rule in the rule group.

                                             Block -> (structure)
                                                 Instructs  WAF  to  block the
                                                 web request.

                                                 CustomResponse -> (structure)
                                                    Defines a custom  response
                                                    for the web request.

                                                    For information about cus-
                                                    tomizing web requests  and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in  WAF  in the WAF Devel-
                                                    oper Guide .

                                                    ResponseCode -> (integer)
                                                        The HTTP  status  code
                                                        to   return   to   the
                                                        client.

                                                        For a list  of  status
                                                        codes that you can use
                                                        in  your  custom   re-
                                                        sponses, see Supported
                                                        status codes for  cus-
                                                        tom  response  in  the
                                                        WAF Developer Guide .

                                                    CustomResponseBodyKey   ->
                                                    (string)
                                                        References   the   re-
                                                        sponse body  that  you
                                                        want  WAF to return to
                                                        the    web     request
                                                        client. You can define
                                                        a custom response  for
                                                        a rule action or a de-
                                                        fault web  ACL  action
                                                        that  is set to block.
                                                        To do this, you  first
                                                        define   the  response
                                                        body key and value  in
                                                        the CustomResponseBod-
                                                        ies  setting  for  the
                                                        WebACL  or   RuleGroup
                                                        where you want to  use
                                                        it.  Then, in the rule
                                                        action or web ACL  de-
                                                        fault  action BlockAc-
                                                        tion setting, you ref-
                                                        erence   the  response
                                                        body using this key.

                                                    ResponseHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        use  in  the response.
                                                        Duplicate header names
                                                        are not allowed.

                                                        For  information about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas in the WAF  Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom request  and
                                                           response  handling.
                                                           This  is  used   in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For custom  re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are already  in
                                                               the    request.
                                                               For    example,
                                                               for  the header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The  value   of
                                                               the      custom
                                                               header.

                                             Allow -> (structure)
                                                 Instructs WAF  to  allow  the
                                                 web request.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines  custom   handling
                                                    for the web request.

                                                    For information about cus-
                                                    tomizing web requests  and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in  WAF  in the WAF Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header  names  are not
                                                        allowed.

                                                        For information  about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas  in the WAF Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom  request and
                                                           response  handling.
                                                           This   is  used  in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For  custom re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are  already in
                                                               the    request.
                                                               For    example,
                                                               for the  header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The   value  of
                                                               the      custom
                                                               header.

                                             Count -> (structure)
                                                 Instructs  WAF  to  count the
                                                 web request and then continue
                                                 evaluating  the request using
                                                 the remaining  rules  in  the
                                                 web ACL.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines  custom   handling
                                                    for the web request.

                                                    For information about cus-
                                                    tomizing web requests  and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in  WAF  in the WAF Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header  names  are not
                                                        allowed.

                                                        For information  about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas  in the WAF Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom  request and
                                                           response  handling.
                                                           This   is  used  in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For  custom re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are  already in
                                                               the    request.
                                                               For    example,
                                                               for the  header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The   value  of
                                                               the      custom
                                                               header.

                                             Captcha -> (structure)
                                                 Instructs   WAF   to   run  a
                                                 CAPTCHA check against the web
                                                 request.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines  custom   handling
                                                    for  the web request, used
                                                    when the  CAPTCHA  inspec-
                                                    tion  determines  that the
                                                    request's token  is  valid
                                                    and unexpired.

                                                    For information about cus-
                                                    tomizing web requests  and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in  WAF  in the WAF Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header  names  are not
                                                        allowed.

                                                        For information  about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas  in the WAF Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom  request and
                                                           response  handling.
                                                           This   is  used  in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For  custom re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are  already in
                                                               the    request.
                                                               For    example,
                                                               for the  header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The   value  of
                                                               the      custom
                                                               header.

                                             Challenge -> (structure)
                                                 Instructs  WAF to run a Chal-
                                                 lenge check against  the  web
                                                 request.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines  custom   handling
                                                    for  the web request, used
                                                    when the challenge inspec-
                                                    tion  determines  that the
                                                    request's token  is  valid
                                                    and unexpired.

                                                    For information about cus-
                                                    tomizing web requests  and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in  WAF  in the WAF Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header  names  are not
                                                        allowed.

                                                        For information  about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas  in the WAF Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom  request and
                                                           response  handling.
                                                           This   is  used  in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For  custom re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are  already in
                                                               the    request.
                                                               For    example,
                                                               for the  header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The   value  of
                                                               the      custom
                                                               header.

                               LabelMatchStatement -> (structure)
                                   A  rule  statement  to match against labels
                                   that have been added to the web request  by
                                   rules that have already run in the web ACL.

                                   The  label match statement provides the la-
                                   bel or namespace string to search for.  The
                                   label string can represent a part or all of
                                   the fully qualified  label  name  that  had
                                   been added to the web request. Fully quali-
                                   fied labels have a prefix,  optional  name-
                                   spaces,  and label name. The prefix identi-
                                   fies the rule group or web ACL  context  of
                                   the  rule  that  added the label. If you do
                                   not provide the  fully  qualified  name  in
                                   your  label  match string, WAF performs the
                                   search for labels that were  added  in  the
                                   same context as the label match statement.

                                   Scope -> (string)
                                      Specify  whether you want to match using
                                      the label name or just the namespace.

                                   Key -> (string)
                                      The string to match against. The setting
                                      you  provide  for  this  depends  on the
                                      match statement's Scope setting:

                                      o If the Scope indicates  LABEL  ,  then
                                        this  specification  must  include the
                                        name and can  include  any  number  of
                                        preceding namespace specifications and
                                        prefix up to providing the fully qual-
                                        ified label name.

                                      o If  the  Scope  indicates  NAMESPACE ,
                                        then this  specification  can  include
                                        any  number  of  contiguous  namespace
                                        strings, and can  include  the  entire
                                        label  namespace  prefix from the rule
                                        group or web ACL where the label orig-
                                        inates.

                                      Labels are case sensitive and components
                                      of a label must be separated  by  colon,
                                      for example NS1:NS2:name .

                               RegexMatchStatement -> (structure)
                                   A rule statement used to search web request
                                   components for a  match  against  a  single
                                   regular expression.

                                   RegexString -> (string)
                                      The  string representing the regular ex-
                                      pression.

                                   FieldToMatch -> (structure)
                                      The part of the  web  request  that  you
                                      want WAF to inspect.

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Alternately,  you can filter and in-
                                          spect all headers with  the  Headers
                                          FieldToMatch setting.

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect  the  request URI path. This
                                          is the part of the web request  that
                                          identifies  a resource, for example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect the query  string.  This  is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect the request  body  as  plain
                                          text.  The  request body immediately
                                          follows the request headers. This is
                                          the  part of a request that contains
                                          any additional data that you want to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          A limited amount of the request body
                                          is forwarded to WAF  for  inspection
                                          by  the underlying host service. For
                                          regional resources, the limit  is  8
                                          KB  (8,192 kilobytes) and for Cloud-
                                          Front distributions, the limit is 16
                                          KB  (16,384  kilobytes).  For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the  limit  in the web ACL's
                                          AssociationConfig ,  for  additional
                                          processing fees.

                                          For  information about how to handle
                                          oversized request  bodies,  see  the
                                          Body object configuration.

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger than WAF can inspect.  WAF
                                             does  not  support inspecting the
                                             entire contents of  the  web  re-
                                             quest  body  if  the body exceeds
                                             the limit for the resource  type.
                                             If  the  body  is larger than the
                                             limit, the underlying  host  ser-
                                             vice  only  forwards the contents
                                             that are below the limit  to  WAF
                                             for inspection.

                                             The  default limit is 8 KB (8,192
                                             kilobytes) for regional resources
                                             and  16 KB (16,384 kilobytes) for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig   ,  for  addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able  body  contents  normally,
                                               according  to  the rule inspec-
                                               tion criteria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling  with  your rule and web
                                             ACL action settings, so that  you
                                             block  any  request whose body is
                                             over the limit.

                                             Default: CONTINUE

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          A limited amount of the request body
                                          is  forwarded  to WAF for inspection
                                          by the underlying host service.  For
                                          regional  resources,  the limit is 8
                                          KB (8,192 kilobytes) and for  Cloud-
                                          Front distributions, the limit is 16
                                          KB (16,384  kilobytes).  For  Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in  the  web  ACL's
                                          AssociationConfig  ,  for additional
                                          processing fees.

                                          For information about how to  handle
                                          oversized  request  bodies,  see the
                                          JsonBody object configuration.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger  than WAF can inspect. WAF
                                             does not support  inspecting  the
                                             entire  contents  of  the web re-
                                             quest body if  the  body  exceeds
                                             the  limit for the resource type.
                                             If the body is  larger  than  the
                                             limit,  the  underlying host ser-
                                             vice only forwards  the  contents
                                             that  are  below the limit to WAF
                                             for inspection.

                                             The default limit is 8 KB  (8,192
                                             kilobytes) for regional resources
                                             and 16 KB (16,384 kilobytes)  for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig  ,  for   addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  body  contents  normally,
                                               according to the  rule  inspec-
                                               tion criteria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling with your rule  and  web
                                             ACL  action settings, so that you
                                             block any request whose  body  is
                                             over the limit.

                                             Default: CONTINUE

                                      Headers -> (structure)
                                          Inspect  the  request  headers.  You
                                          must  configure  scope  and  pattern
                                          matching  filters in the Headers ob-
                                          ject, to define the set  of  headers
                                          to and the parts of the headers that
                                          WAF inspects.

                                          Only the first 8 KB (8192 bytes)  of
                                          a  request's  headers  and  only the
                                          first 200 headers are  forwarded  to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to  handle  any oversize header con-
                                          tent in the Headers object. WAF  ap-
                                          plies  the  pattern matching filters
                                          to the headers that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of headers to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting: either All ,  IncludedHead-
                                             ers , or ExcludedHeaders .

                                             Example  JSON:  "MatchPattern": {
                                             "ExcludedHeaders":     {"KeyToEx-
                                             clude1", "KeyToExclude2"} }

                                             All -> (structure)
                                                 Inspect all headers.

                                             IncludedHeaders -> (list)
                                                 Inspect only the headers that
                                                 have a key that  matches  one
                                                 of   the   strings  specified
                                                 here.

                                                 (string)

                                             ExcludedHeaders -> (list)
                                                 Inspect  only   the   headers
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the headers to match
                                             with  the  rule inspection crite-
                                             ria. If you specify All , WAF in-
                                             spects both keys and values.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             headers when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total head-
                                             ers. The underlying host  service
                                             forwards a maximum of 200 headers
                                             and at most 8 KB of  header  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  headers normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                      Cookies -> (structure)
                                          Inspect  the  request  cookies.  You
                                          must  configure  scope  and  pattern
                                          matching filters in the Cookies  ob-
                                          ject,  to  define the set of cookies
                                          and the parts of  the  cookies  that
                                          WAF inspects.

                                          Only  the first 8 KB (8192 bytes) of
                                          a request's  cookies  and  only  the
                                          first  200  cookies are forwarded to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to handle any oversize  cookie  con-
                                          tent  in the Cookies object. WAF ap-
                                          plies the pattern  matching  filters
                                          to the cookies that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of cookies to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting:  either All , IncludedCook-
                                             ies , or ExcludedCookies .

                                             Example JSON:  "MatchPattern":  {
                                             "IncludedCookies":     {"KeyToIn-
                                             clude1",  "KeyToInclude2",  "Key-
                                             ToInclude3"} }

                                             All -> (structure)
                                                 Inspect all cookies.

                                             IncludedCookies -> (list)
                                                 Inspect only the cookies that
                                                 have a key that  matches  one
                                                 of   the   strings  specified
                                                 here.

                                                 (string)

                                             ExcludedCookies -> (list)
                                                 Inspect  only   the   cookies
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the cookies  to  in-
                                             spect  with  the  rule inspection
                                             criteria. If you  specify  All  ,
                                             WAF  inspects  both keys and val-
                                             ues.

                                          OversizeHandling -> (string)
                                             What WAF should do if the cookies
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             cookies  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  cook-
                                             ies.  The underlying host service
                                             forwards a maximum of 200 cookies
                                             and  at  most 8 KB of cookie con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able cookies normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                      HeaderOrder -> (structure)
                                          Inspect a string containing the list
                                          of the request's header  names,  or-
                                          dered  as they appear in the web re-
                                          quest that WAF receives for  inspec-
                                          tion.  WAF  generates the string and
                                          then uses that as the field to match
                                          component  in  its  inspection.  WAF
                                          separates the header  names  in  the
                                          string  using  commas  and  no added
                                          spaces.

                                          Matches  against  the  header  order
                                          string are case insensitive.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             headers when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total head-
                                             ers. The underlying host  service
                                             forwards a maximum of 200 headers
                                             and at most 8 KB of  header  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  headers normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form  the FieldToMatch request component
                                      before inspecting it, and  they're  used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them  as custom aggregation keys. If you
                                      specify one or more  transformations  to
                                      apply,  WAF performs all transformations
                                      on the specified content, starting  from
                                      the  lowest  priority  setting, and then
                                      uses the component contents.

                                      (structure)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets  the relative processing or-
                                             der for multiple transformations.
                                             WAF   processes  all  transforma-
                                             tions, from  lowest  priority  to
                                             highest,  before  inspecting  the
                                             transformed content. The  priori-
                                             ties  don't  need  to be consecu-
                                             tive, but they must all  be  dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                     OrStatement -> (structure)
                        A logical rule statement used to  combine  other  rule
                        statements  with  OR  logic. You provide more than one
                        Statement within the OrStatement .

                        Statements -> (list)
                            The statements to combine with OR logic.  You  can
                            use any statements that can be nested.

                            (structure)
                               The  processing  guidance for a  Rule , used by
                               WAF to determine whether a web request  matches
                               the rule.

                               For  example  specifications,  see the examples
                               section of  CreateWebACL .

                               ByteMatchStatement -> (structure)
                                   A rule  statement  that  defines  a  string
                                   match  search  for  WAF to apply to web re-
                                   quests. The byte match  statement  provides
                                   the  bytes  to  search for, the location in
                                   requests that you want WAF to  search,  and
                                   other settings. The bytes to search for are
                                   typically a string  that  corresponds  with
                                   ASCII  characters.  In  the WAF console and
                                   the  developer  guide,  this  is  called  a
                                   string match statement.

                                   SearchString -> (blob)
                                      A  string  value  that  you  want WAF to
                                      search for. WAF  searches  only  in  the
                                      part  of web requests that you designate
                                      for inspection in   FieldToMatch  .  The
                                      maximum  length  of  the  value  is  200
                                      bytes.

                                      Valid values  depend  on  the  component
                                      that   you  specify  for  inspection  in
                                      FieldToMatch :

                                      o Method : The HTTP method that you want
                                        WAF  to search for. This indicates the
                                        type of operation specified in the re-
                                        quest.

                                      o UriPath  : The value that you want WAF
                                        to search for in the URI path, for ex-
                                        ample, /images/daily-ad.jpg .

                                      o HeaderOrder : The comma-separated list
                                        of header names to match for. WAF cre-
                                        ates  a  string  that contains the or-
                                        dered list of header names,  from  the
                                        headers  in  the web request, and then
                                        matches against that string.

                                      If  SearchString   includes   alphabetic
                                      characters  A-Z  and  a-z, note that the
                                      value is case sensitive.
                                          If you're using the WAF API

                                      Specify a base64-encoded version of  the
                                      value.  The  maximum length of the value
                                      before  you  base64-encode  it  is   200
                                      bytes.

                                      For  example,  suppose the value of Type
                                      is HEADER  and  the  value  of  Data  is
                                      User-Agent  .  If you want to search the
                                      User-Agent header for the value BadBot ,
                                      you   base64-encode  BadBot  using  MIME
                                      base64-encoding and include the  result-
                                      ing  value,  QmFkQm90  , in the value of
                                      SearchString .
                                          If you're using the CLI  or  one  of
                                          the Amazon Web Services SDKs

                                      The  value  that  you want WAF to search
                                      for. The SDK  automatically  base64  en-
                                      codes the value.

                                   FieldToMatch -> (structure)
                                      The  part  of  the  web request that you
                                      want WAF to inspect.

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name  of  the header to inspect, for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example   JSON:   "SingleHeader":  {
                                          "Name": "haystack" }

                                          Alternately, you can filter and  in-
                                          spect  all  headers with the Headers
                                          FieldToMatch setting.

                                          Name -> (string)
                                             The name of the query  header  to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide the name of the query  argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion . The name can be up  to
                                          30  characters  long  and isn't case
                                          sensitive.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the part of the web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          A limited amount of the request body
                                          is  forwarded  to WAF for inspection
                                          by the underlying host service.  For
                                          regional  resources,  the limit is 8
                                          KB (8,192 kilobytes) and for  Cloud-
                                          Front distributions, the limit is 16
                                          KB (16,384  kilobytes).  For  Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in  the  web  ACL's
                                          AssociationConfig  ,  for additional
                                          processing fees.

                                          For information about how to  handle
                                          oversized  request  bodies,  see the
                                          Body object configuration.

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger  than WAF can inspect. WAF
                                             does not support  inspecting  the
                                             entire  contents  of  the web re-
                                             quest body if  the  body  exceeds
                                             the  limit for the resource type.
                                             If the body is  larger  than  the
                                             limit,  the  underlying host ser-
                                             vice only forwards  the  contents
                                             that  are  below the limit to WAF
                                             for inspection.

                                             The default limit is 8 KB  (8,192
                                             kilobytes) for regional resources
                                             and 16 KB (16,384 kilobytes)  for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig  ,  for   addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  body  contents  normally,
                                               according to the  rule  inspec-
                                               tion criteria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling with your rule  and  web
                                             ACL  action settings, so that you
                                             block any request whose  body  is
                                             over the limit.

                                             Default: CONTINUE

                                      Method -> (structure)
                                          Inspect  the HTTP method. The method
                                          indicates the type of operation that
                                          the  request is asking the origin to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect the request  body  as  JSON.
                                          The request body immediately follows
                                          the request  headers.  This  is  the
                                          part  of a request that contains any
                                          additional data  that  you  want  to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          A limited amount of the request body
                                          is forwarded to WAF  for  inspection
                                          by  the underlying host service. For
                                          regional resources, the limit  is  8
                                          KB  (8,192 kilobytes) and for Cloud-
                                          Front distributions, the limit is 16
                                          KB  (16,384  kilobytes).  For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the  limit  in the web ACL's
                                          AssociationConfig ,  for  additional
                                          processing fees.

                                          For  information about how to handle
                                          oversized request  bodies,  see  the
                                          JsonBody object configuration.

                                          MatchPattern -> (structure)
                                             The  patterns  to look for in the
                                             JSON body. WAF inspects  the  re-
                                             sults  of  these  pattern matches
                                             against the rule inspection  cri-
                                             teria.

                                             All -> (structure)
                                                 Match  all  of  the elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You  must specify either this
                                                 setting or the  IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match  only the specified in-
                                                 clude paths. See also  Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing JSON Pointer syntax.  For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"]  . For infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force  (IETF)   documentation
                                                 JavaScript   Object  Notation
                                                 (JSON) Pointer .

                                                 You must specify either  this
                                                 setting  or  the All setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't use this  option  to
                                                    include   all  paths.  In-
                                                    stead, use  the  All  set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The  parts  of  the JSON to match
                                             against using the MatchPattern  .
                                             If  you specify All , WAF matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely  parse  the JSON body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING  -   Inspect
                                               the body as plain text. WAF ap-
                                               plies the text  transformations
                                               and  inspection  criteria  that
                                               you defined for  the  JSON  in-
                                               spection   to   the  body  text
                                               string.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             If  you  don't  provide this set-
                                             ting, WAF  parses  and  evaluates
                                             the  content only up to the first
                                             parsing failure that  it  encoun-
                                             ters.

                                             WAF  does  its  best to parse the
                                             entire JSON body,  but  might  be
                                             forced  to  stop for reasons such
                                             as invalid characters,  duplicate
                                             keys, truncation, and any content
                                             whose root node isn't  an  object
                                             or an array.

                                             WAF  parses  the JSON in the fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger than WAF can inspect.  WAF
                                             does  not  support inspecting the
                                             entire contents of  the  web  re-
                                             quest  body  if  the body exceeds
                                             the limit for the resource  type.
                                             If  the  body  is larger than the
                                             limit, the underlying  host  ser-
                                             vice  only  forwards the contents
                                             that are below the limit  to  WAF
                                             for inspection.

                                             The  default limit is 8 KB (8,192
                                             kilobytes) for regional resources
                                             and  16 KB (16,384 kilobytes) for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig   ,  for  addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able  body  contents  normally,
                                               according  to  the rule inspec-
                                               tion criteria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling  with  your rule and web
                                             ACL action settings, so that  you
                                             block  any  request whose body is
                                             over the limit.

                                             Default: CONTINUE

                                      Headers -> (structure)
                                          Inspect  the  request  headers.  You
                                          must  configure  scope  and  pattern
                                          matching filters in the Headers  ob-
                                          ject,  to  define the set of headers
                                          to and the parts of the headers that
                                          WAF inspects.

                                          Only  the first 8 KB (8192 bytes) of
                                          a request's  headers  and  only  the
                                          first  200  headers are forwarded to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to handle any oversize  header  con-
                                          tent  in the Headers object. WAF ap-
                                          plies the pattern  matching  filters
                                          to the headers that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of headers to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting:  either All , IncludedHead-
                                             ers , or ExcludedHeaders .

                                             Example JSON:  "MatchPattern":  {
                                             "ExcludedHeaders":     {"KeyToEx-
                                             clude1", "KeyToExclude2"} }

                                             All -> (structure)
                                                 Inspect all headers.

                                             IncludedHeaders -> (list)
                                                 Inspect only the headers that
                                                 have  a  key that matches one
                                                 of  the   strings   specified
                                                 here.

                                                 (string)

                                             ExcludedHeaders -> (list)
                                                 Inspect   only   the  headers
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the headers to match
                                             with the rule  inspection  crite-
                                             ria. If you specify All , WAF in-
                                             spects both keys and values.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             headers  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  head-
                                             ers.  The underlying host service
                                             forwards a maximum of 200 headers
                                             and  at  most 8 KB of header con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able headers normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                      Cookies -> (structure)
                                          Inspect  the  request  cookies.  You
                                          must  configure  scope  and  pattern
                                          matching  filters in the Cookies ob-
                                          ject, to define the set  of  cookies
                                          and  the  parts  of the cookies that
                                          WAF inspects.

                                          Only the first 8 KB (8192 bytes)  of
                                          a  request's  cookies  and  only the
                                          first 200 cookies are  forwarded  to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to  handle  any oversize cookie con-
                                          tent in the Cookies object. WAF  ap-
                                          plies  the  pattern matching filters
                                          to the cookies that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of cookies to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting: either All ,  IncludedCook-
                                             ies , or ExcludedCookies .

                                             Example  JSON:  "MatchPattern": {
                                             "IncludedCookies":     {"KeyToIn-
                                             clude1",  "KeyToInclude2",  "Key-
                                             ToInclude3"} }

                                             All -> (structure)
                                                 Inspect all cookies.

                                             IncludedCookies -> (list)
                                                 Inspect only the cookies that
                                                 have  a  key that matches one
                                                 of  the   strings   specified
                                                 here.

                                                 (string)

                                             ExcludedCookies -> (list)
                                                 Inspect   only   the  cookies
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The  parts  of the cookies to in-
                                             spect with  the  rule  inspection
                                             criteria.  If  you  specify All ,
                                             WAF inspects both keys  and  val-
                                             ues.

                                          OversizeHandling -> (string)
                                             What WAF should do if the cookies
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             cookies when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total cook-
                                             ies. The underlying host  service
                                             forwards a maximum of 200 cookies
                                             and at most 8 KB of  cookie  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  cookies normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                      HeaderOrder -> (structure)
                                          Inspect a string containing the list
                                          of  the  request's header names, or-
                                          dered as they appear in the web  re-
                                          quest  that WAF receives for inspec-
                                          tion. WAF generates the  string  and
                                          then uses that as the field to match
                                          component  in  its  inspection.  WAF
                                          separates  the  header  names in the
                                          string using  commas  and  no  added
                                          spaces.

                                          Matches  against  the  header  order
                                          string are case insensitive.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             headers  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  head-
                                             ers.  The underlying host service
                                             forwards a maximum of 200 headers
                                             and  at  most 8 KB of header con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able headers normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   TextTransformations -> (list)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form the FieldToMatch request  component
                                      before  inspecting  it, and they're used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them as custom aggregation keys. If  you
                                      specify  one  or more transformations to
                                      apply, WAF performs all  transformations
                                      on  the specified content, starting from
                                      the lowest priority  setting,  and  then
                                      uses the component contents.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der for multiple transformations.
                                             WAF  processes  all   transforma-
                                             tions,  from  lowest  priority to
                                             highest,  before  inspecting  the
                                             transformed  content. The priori-
                                             ties don't need  to  be  consecu-
                                             tive,  but  they must all be dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE   -   Decode  a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT - Decode  a
                                                 Base64  -encoded  string, but
                                                 use a  forgiving  implementa-
                                                 tion  that ignores characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.   These  are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual formatting to  disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete spaces before  the  fol-
                                               lowing characters: / (

                                             o Replace  the  following charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE  -   Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r , carriage  return,  decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places multiple  spaces  with
                                                 one space.

                                                 CSS_DECODE  -  Decode charac-
                                                 ters that were encoded  using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in the decoding  process,  so
                                                 it  can help to uncover ASCII
                                                 characters that were  encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's  also useful in counter-
                                                 ing evasion, which is a  com-
                                                 bination  of  a backslash and
                                                 non-hexadecimal   characters.
                                                 For  example, ja\vascript for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE  -   Decode
                                                 the  following  ANSI C escape
                                                 sequences: \a , \b , \f ,  \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 , \"  ,  \xHH  (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't valid  remain  in  the
                                                 output.

                                                 HEX_DECODE  - Decode a string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE  - Replace
                                                 HTML-encoded characters  with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces  (ampersand)quot; with
                                               "

                                             o Replaces (ampersand)nbsp;  with
                                               a  non-breaking  space, decimal
                                               160

                                             o Replaces (ampersand)lt; with  a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat,  (ampersand)#xhhhh; , with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented  in decimal format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape sequences. If a  \   u
                                                 HHHH    code    is   in   the
                                                 full-width ASCII  code  range
                                                 of   FF01-FF5E   ,  then  the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not, only the lower  byte  is
                                                 used  and  the higher byte is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5  -  Calculate an MD5 hash
                                                 from the data in  the  input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE - Specify  NONE  if  you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH - Remove  mul-
                                                 tiple    slashes,   directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not at the beginning  of  the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN  - This is
                                                 the same as NORMALIZE_PATH  ,
                                                 but  first converts backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS   -  Remove  all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS  -   Replace
                                                 each  occurrence of a C-style
                                                 comment (/* ... */ )  with  a
                                                 single  space.  Multiple con-
                                                 secutive occurrences are  not
                                                 compressed. Unterminated com-
                                                 ments are also replaced  with
                                                 a  space  (ASCII  0x20). How-
                                                 ever, a  standalone  termina-
                                                 tion  of  a  comment (*/ ) is
                                                 not acted upon.

                                                 REPLACE_NULLS - Replace  NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE -  Decode  SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE , but with  support  for
                                                 Microsoft-specific  %u encod-
                                                 ing. If the code  is  in  the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte  is  used  to detect and
                                                 adjust the lower byte. Other-
                                                 wise,  only the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8 character sequences  to
                                                 Unicode.   This  helps  input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives for  non-Eng-
                                                 lish languages.

                                   PositionalConstraint -> (string)
                                      The  area  within the portion of the web
                                      request that you want WAF to search  for
                                      SearchString  . Valid values include the
                                      following:
                                          CONTAINS

                                      The specified part of  the  web  request
                                      must include the value of SearchString ,
                                      but the location doesn't matter.
                                          CONTAINS_WORD

                                      The specified part of  the  web  request
                                      must include the value of SearchString ,
                                      and SearchString must contain  only  al-
                                      phanumeric   characters   or  underscore
                                      (A-Z, a-z,  0-9,  or  _).  In  addition,
                                      SearchString must be a word, which means
                                      that both of the following are true:

                                      o SearchString is at  the  beginning  of
                                        the  specified part of the web request
                                        or is preceded by  a  character  other
                                        than  an alphanumeric character or un-
                                        derscore  (_).  Examples  include  the
                                        value of a header and ;BadBot .

                                      o SearchString  is  at  the  end  of the
                                        specified part of the web  request  or
                                        is  followed by a character other than
                                        an alphanumeric  character  or  under-
                                        score  (_),  for  example, BadBot; and
                                        -BadBot; .
                                          EXACTLY

                                      The value of the specified part  of  the
                                      web request must exactly match the value
                                      of SearchString .
                                          STARTS_WITH

                                      The value of SearchString must appear at
                                      the  beginning  of the specified part of
                                      the web request.
                                          ENDS_WITH

                                      The value of SearchString must appear at
                                      the end of the specified part of the web
                                      request.

                               SqliMatchStatement -> (structure)
                                   A rule statement that  inspects  for  mali-
                                   cious  SQL code. Attackers insert malicious
                                   SQL code into web  requests  to  do  things
                                   like  modify  your database or extract data
                                   from it.

                                   FieldToMatch -> (structure)
                                      The part of the  web  request  that  you
                                      want WAF to inspect.

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Alternately,  you can filter and in-
                                          spect all headers with  the  Headers
                                          FieldToMatch setting.

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect  the  request URI path. This
                                          is the part of the web request  that
                                          identifies  a resource, for example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect the query  string.  This  is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect the request  body  as  plain
                                          text.  The  request body immediately
                                          follows the request headers. This is
                                          the  part of a request that contains
                                          any additional data that you want to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          A limited amount of the request body
                                          is forwarded to WAF  for  inspection
                                          by  the underlying host service. For
                                          regional resources, the limit  is  8
                                          KB  (8,192 kilobytes) and for Cloud-
                                          Front distributions, the limit is 16
                                          KB  (16,384  kilobytes).  For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the  limit  in the web ACL's
                                          AssociationConfig ,  for  additional
                                          processing fees.

                                          For  information about how to handle
                                          oversized request  bodies,  see  the
                                          Body object configuration.

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger than WAF can inspect.  WAF
                                             does  not  support inspecting the
                                             entire contents of  the  web  re-
                                             quest  body  if  the body exceeds
                                             the limit for the resource  type.
                                             If  the  body  is larger than the
                                             limit, the underlying  host  ser-
                                             vice  only  forwards the contents
                                             that are below the limit  to  WAF
                                             for inspection.

                                             The  default limit is 8 KB (8,192
                                             kilobytes) for regional resources
                                             and  16 KB (16,384 kilobytes) for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig   ,  for  addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able  body  contents  normally,
                                               according  to  the rule inspec-
                                               tion criteria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling  with  your rule and web
                                             ACL action settings, so that  you
                                             block  any  request whose body is
                                             over the limit.

                                             Default: CONTINUE

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          A limited amount of the request body
                                          is  forwarded  to WAF for inspection
                                          by the underlying host service.  For
                                          regional  resources,  the limit is 8
                                          KB (8,192 kilobytes) and for  Cloud-
                                          Front distributions, the limit is 16
                                          KB (16,384  kilobytes).  For  Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in  the  web  ACL's
                                          AssociationConfig  ,  for additional
                                          processing fees.

                                          For information about how to  handle
                                          oversized  request  bodies,  see the
                                          JsonBody object configuration.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger  than WAF can inspect. WAF
                                             does not support  inspecting  the
                                             entire  contents  of  the web re-
                                             quest body if  the  body  exceeds
                                             the  limit for the resource type.
                                             If the body is  larger  than  the
                                             limit,  the  underlying host ser-
                                             vice only forwards  the  contents
                                             that  are  below the limit to WAF
                                             for inspection.

                                             The default limit is 8 KB  (8,192
                                             kilobytes) for regional resources
                                             and 16 KB (16,384 kilobytes)  for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig  ,  for   addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  body  contents  normally,
                                               according to the  rule  inspec-
                                               tion criteria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling with your rule  and  web
                                             ACL  action settings, so that you
                                             block any request whose  body  is
                                             over the limit.

                                             Default: CONTINUE

                                      Headers -> (structure)
                                          Inspect  the  request  headers.  You
                                          must  configure  scope  and  pattern
                                          matching  filters in the Headers ob-
                                          ject, to define the set  of  headers
                                          to and the parts of the headers that
                                          WAF inspects.

                                          Only the first 8 KB (8192 bytes)  of
                                          a  request's  headers  and  only the
                                          first 200 headers are  forwarded  to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to  handle  any oversize header con-
                                          tent in the Headers object. WAF  ap-
                                          plies  the  pattern matching filters
                                          to the headers that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of headers to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting: either All ,  IncludedHead-
                                             ers , or ExcludedHeaders .

                                             Example  JSON:  "MatchPattern": {
                                             "ExcludedHeaders":     {"KeyToEx-
                                             clude1", "KeyToExclude2"} }

                                             All -> (structure)
                                                 Inspect all headers.

                                             IncludedHeaders -> (list)
                                                 Inspect only the headers that
                                                 have a key that  matches  one
                                                 of   the   strings  specified
                                                 here.

                                                 (string)

                                             ExcludedHeaders -> (list)
                                                 Inspect  only   the   headers
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the headers to match
                                             with  the  rule inspection crite-
                                             ria. If you specify All , WAF in-
                                             spects both keys and values.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             headers when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total head-
                                             ers. The underlying host  service
                                             forwards a maximum of 200 headers
                                             and at most 8 KB of  header  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  headers normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                      Cookies -> (structure)
                                          Inspect  the  request  cookies.  You
                                          must  configure  scope  and  pattern
                                          matching filters in the Cookies  ob-
                                          ject,  to  define the set of cookies
                                          and the parts of  the  cookies  that
                                          WAF inspects.

                                          Only  the first 8 KB (8192 bytes) of
                                          a request's  cookies  and  only  the
                                          first  200  cookies are forwarded to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to handle any oversize  cookie  con-
                                          tent  in the Cookies object. WAF ap-
                                          plies the pattern  matching  filters
                                          to the cookies that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of cookies to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting:  either All , IncludedCook-
                                             ies , or ExcludedCookies .

                                             Example JSON:  "MatchPattern":  {
                                             "IncludedCookies":     {"KeyToIn-
                                             clude1",  "KeyToInclude2",  "Key-
                                             ToInclude3"} }

                                             All -> (structure)
                                                 Inspect all cookies.

                                             IncludedCookies -> (list)
                                                 Inspect only the cookies that
                                                 have a key that  matches  one
                                                 of   the   strings  specified
                                                 here.

                                                 (string)

                                             ExcludedCookies -> (list)
                                                 Inspect  only   the   cookies
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the cookies  to  in-
                                             spect  with  the  rule inspection
                                             criteria. If you  specify  All  ,
                                             WAF  inspects  both keys and val-
                                             ues.

                                          OversizeHandling -> (string)
                                             What WAF should do if the cookies
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             cookies  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  cook-
                                             ies.  The underlying host service
                                             forwards a maximum of 200 cookies
                                             and  at  most 8 KB of cookie con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able cookies normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                      HeaderOrder -> (structure)
                                          Inspect a string containing the list
                                          of the request's header  names,  or-
                                          dered  as they appear in the web re-
                                          quest that WAF receives for  inspec-
                                          tion.  WAF  generates the string and
                                          then uses that as the field to match
                                          component  in  its  inspection.  WAF
                                          separates the header  names  in  the
                                          string  using  commas  and  no added
                                          spaces.

                                          Matches  against  the  header  order
                                          string are case insensitive.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             headers when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total head-
                                             ers. The underlying host  service
                                             forwards a maximum of 200 headers
                                             and at most 8 KB of  header  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  headers normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form  the FieldToMatch request component
                                      before inspecting it, and  they're  used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them  as custom aggregation keys. If you
                                      specify one or more  transformations  to
                                      apply,  WAF performs all transformations
                                      on the specified content, starting  from
                                      the  lowest  priority  setting, and then
                                      uses the component contents.

                                      (structure)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets  the relative processing or-
                                             der for multiple transformations.
                                             WAF   processes  all  transforma-
                                             tions, from  lowest  priority  to
                                             highest,  before  inspecting  the
                                             transformed content. The  priori-
                                             ties  don't  need  to be consecu-
                                             tive, but they must all  be  dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                                   SensitivityLevel -> (string)
                                      The sensitivity that you want WAF to use
                                      to inspect for SQL injection attacks.
                                          HIGH detects more attacks, but might
                                          generate more false positives, espe-
                                          cially  if  your  web  requests fre-
                                          quently contain unusual strings. For
                                          information  about  identifying  and
                                          mitigating  false   positives,   see
                                          Testing and tuning in the WAF Devel-
                                          oper Guide .

                                          LOW is generally a better choice for
                                          resources  that  already  have other
                                          protections  against  SQL  injection
                                          attacks or that have a low tolerance
                                          for false positives.

                                      Default: LOW

                               XssMatchStatement -> (structure)
                                   A  rule   statement   that   inspects   for
                                   cross-site  scripting (XSS) attacks. In XSS
                                   attacks, the attacker uses  vulnerabilities
                                   in  a benign website as a vehicle to inject
                                   malicious client-site  scripts  into  other
                                   legitimate web browsers.

                                   FieldToMatch -> (structure)
                                      The  part  of  the  web request that you
                                      want WAF to inspect.

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name  of  the header to inspect, for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example   JSON:   "SingleHeader":  {
                                          "Name": "haystack" }

                                          Alternately, you can filter and  in-
                                          spect  all  headers with the Headers
                                          FieldToMatch setting.

                                          Name -> (string)
                                             The name of the query  header  to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide the name of the query  argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion . The name can be up  to
                                          30  characters  long  and isn't case
                                          sensitive.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the part of the web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          A limited amount of the request body
                                          is  forwarded  to WAF for inspection
                                          by the underlying host service.  For
                                          regional  resources,  the limit is 8
                                          KB (8,192 kilobytes) and for  Cloud-
                                          Front distributions, the limit is 16
                                          KB (16,384  kilobytes).  For  Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in  the  web  ACL's
                                          AssociationConfig  ,  for additional
                                          processing fees.

                                          For information about how to  handle
                                          oversized  request  bodies,  see the
                                          Body object configuration.

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger  than WAF can inspect. WAF
                                             does not support  inspecting  the
                                             entire  contents  of  the web re-
                                             quest body if  the  body  exceeds
                                             the  limit for the resource type.
                                             If the body is  larger  than  the
                                             limit,  the  underlying host ser-
                                             vice only forwards  the  contents
                                             that  are  below the limit to WAF
                                             for inspection.

                                             The default limit is 8 KB  (8,192
                                             kilobytes) for regional resources
                                             and 16 KB (16,384 kilobytes)  for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig  ,  for   addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  body  contents  normally,
                                               according to the  rule  inspec-
                                               tion criteria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling with your rule  and  web
                                             ACL  action settings, so that you
                                             block any request whose  body  is
                                             over the limit.

                                             Default: CONTINUE

                                      Method -> (structure)
                                          Inspect  the HTTP method. The method
                                          indicates the type of operation that
                                          the  request is asking the origin to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect the request  body  as  JSON.
                                          The request body immediately follows
                                          the request  headers.  This  is  the
                                          part  of a request that contains any
                                          additional data  that  you  want  to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          A limited amount of the request body
                                          is forwarded to WAF  for  inspection
                                          by  the underlying host service. For
                                          regional resources, the limit  is  8
                                          KB  (8,192 kilobytes) and for Cloud-
                                          Front distributions, the limit is 16
                                          KB  (16,384  kilobytes).  For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the  limit  in the web ACL's
                                          AssociationConfig ,  for  additional
                                          processing fees.

                                          For  information about how to handle
                                          oversized request  bodies,  see  the
                                          JsonBody object configuration.

                                          MatchPattern -> (structure)
                                             The  patterns  to look for in the
                                             JSON body. WAF inspects  the  re-
                                             sults  of  these  pattern matches
                                             against the rule inspection  cri-
                                             teria.

                                             All -> (structure)
                                                 Match  all  of  the elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You  must specify either this
                                                 setting or the  IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match  only the specified in-
                                                 clude paths. See also  Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing JSON Pointer syntax.  For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"]  . For infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force  (IETF)   documentation
                                                 JavaScript   Object  Notation
                                                 (JSON) Pointer .

                                                 You must specify either  this
                                                 setting  or  the All setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't use this  option  to
                                                    include   all  paths.  In-
                                                    stead, use  the  All  set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The  parts  of  the JSON to match
                                             against using the MatchPattern  .
                                             If  you specify All , WAF matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely  parse  the JSON body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING  -   Inspect
                                               the body as plain text. WAF ap-
                                               plies the text  transformations
                                               and  inspection  criteria  that
                                               you defined for  the  JSON  in-
                                               spection   to   the  body  text
                                               string.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             If  you  don't  provide this set-
                                             ting, WAF  parses  and  evaluates
                                             the  content only up to the first
                                             parsing failure that  it  encoun-
                                             ters.

                                             WAF  does  its  best to parse the
                                             entire JSON body,  but  might  be
                                             forced  to  stop for reasons such
                                             as invalid characters,  duplicate
                                             keys, truncation, and any content
                                             whose root node isn't  an  object
                                             or an array.

                                             WAF  parses  the JSON in the fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger than WAF can inspect.  WAF
                                             does  not  support inspecting the
                                             entire contents of  the  web  re-
                                             quest  body  if  the body exceeds
                                             the limit for the resource  type.
                                             If  the  body  is larger than the
                                             limit, the underlying  host  ser-
                                             vice  only  forwards the contents
                                             that are below the limit  to  WAF
                                             for inspection.

                                             The  default limit is 8 KB (8,192
                                             kilobytes) for regional resources
                                             and  16 KB (16,384 kilobytes) for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig   ,  for  addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able  body  contents  normally,
                                               according  to  the rule inspec-
                                               tion criteria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling  with  your rule and web
                                             ACL action settings, so that  you
                                             block  any  request whose body is
                                             over the limit.

                                             Default: CONTINUE

                                      Headers -> (structure)
                                          Inspect  the  request  headers.  You
                                          must  configure  scope  and  pattern
                                          matching filters in the Headers  ob-
                                          ject,  to  define the set of headers
                                          to and the parts of the headers that
                                          WAF inspects.

                                          Only  the first 8 KB (8192 bytes) of
                                          a request's  headers  and  only  the
                                          first  200  headers are forwarded to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to handle any oversize  header  con-
                                          tent  in the Headers object. WAF ap-
                                          plies the pattern  matching  filters
                                          to the headers that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of headers to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting:  either All , IncludedHead-
                                             ers , or ExcludedHeaders .

                                             Example JSON:  "MatchPattern":  {
                                             "ExcludedHeaders":     {"KeyToEx-
                                             clude1", "KeyToExclude2"} }

                                             All -> (structure)
                                                 Inspect all headers.

                                             IncludedHeaders -> (list)
                                                 Inspect only the headers that
                                                 have  a  key that matches one
                                                 of  the   strings   specified
                                                 here.

                                                 (string)

                                             ExcludedHeaders -> (list)
                                                 Inspect   only   the  headers
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the headers to match
                                             with the rule  inspection  crite-
                                             ria. If you specify All , WAF in-
                                             spects both keys and values.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             headers  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  head-
                                             ers.  The underlying host service
                                             forwards a maximum of 200 headers
                                             and  at  most 8 KB of header con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able headers normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                      Cookies -> (structure)
                                          Inspect  the  request  cookies.  You
                                          must  configure  scope  and  pattern
                                          matching  filters in the Cookies ob-
                                          ject, to define the set  of  cookies
                                          and  the  parts  of the cookies that
                                          WAF inspects.

                                          Only the first 8 KB (8192 bytes)  of
                                          a  request's  cookies  and  only the
                                          first 200 cookies are  forwarded  to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to  handle  any oversize cookie con-
                                          tent in the Cookies object. WAF  ap-
                                          plies  the  pattern matching filters
                                          to the cookies that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of cookies to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting: either All ,  IncludedCook-
                                             ies , or ExcludedCookies .

                                             Example  JSON:  "MatchPattern": {
                                             "IncludedCookies":     {"KeyToIn-
                                             clude1",  "KeyToInclude2",  "Key-
                                             ToInclude3"} }

                                             All -> (structure)
                                                 Inspect all cookies.

                                             IncludedCookies -> (list)
                                                 Inspect only the cookies that
                                                 have  a  key that matches one
                                                 of  the   strings   specified
                                                 here.

                                                 (string)

                                             ExcludedCookies -> (list)
                                                 Inspect   only   the  cookies
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The  parts  of the cookies to in-
                                             spect with  the  rule  inspection
                                             criteria.  If  you  specify All ,
                                             WAF inspects both keys  and  val-
                                             ues.

                                          OversizeHandling -> (string)
                                             What WAF should do if the cookies
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             cookies when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total cook-
                                             ies. The underlying host  service
                                             forwards a maximum of 200 cookies
                                             and at most 8 KB of  cookie  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  cookies normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                      HeaderOrder -> (structure)
                                          Inspect a string containing the list
                                          of  the  request's header names, or-
                                          dered as they appear in the web  re-
                                          quest  that WAF receives for inspec-
                                          tion. WAF generates the  string  and
                                          then uses that as the field to match
                                          component  in  its  inspection.  WAF
                                          separates  the  header  names in the
                                          string using  commas  and  no  added
                                          spaces.

                                          Matches  against  the  header  order
                                          string are case insensitive.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             headers  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  head-
                                             ers.  The underlying host service
                                             forwards a maximum of 200 headers
                                             and  at  most 8 KB of header con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able headers normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   TextTransformations -> (list)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form the FieldToMatch request  component
                                      before  inspecting  it, and they're used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them as custom aggregation keys. If  you
                                      specify  one  or more transformations to
                                      apply, WAF performs all  transformations
                                      on  the specified content, starting from
                                      the lowest priority  setting,  and  then
                                      uses the component contents.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der for multiple transformations.
                                             WAF  processes  all   transforma-
                                             tions,  from  lowest  priority to
                                             highest,  before  inspecting  the
                                             transformed  content. The priori-
                                             ties don't need  to  be  consecu-
                                             tive,  but  they must all be dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE   -   Decode  a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT - Decode  a
                                                 Base64  -encoded  string, but
                                                 use a  forgiving  implementa-
                                                 tion  that ignores characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.   These  are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual formatting to  disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete spaces before  the  fol-
                                               lowing characters: / (

                                             o Replace  the  following charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE  -   Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r , carriage  return,  decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places multiple  spaces  with
                                                 one space.

                                                 CSS_DECODE  -  Decode charac-
                                                 ters that were encoded  using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in the decoding  process,  so
                                                 it  can help to uncover ASCII
                                                 characters that were  encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's  also useful in counter-
                                                 ing evasion, which is a  com-
                                                 bination  of  a backslash and
                                                 non-hexadecimal   characters.
                                                 For  example, ja\vascript for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE  -   Decode
                                                 the  following  ANSI C escape
                                                 sequences: \a , \b , \f ,  \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 , \"  ,  \xHH  (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't valid  remain  in  the
                                                 output.

                                                 HEX_DECODE  - Decode a string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE  - Replace
                                                 HTML-encoded characters  with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces  (ampersand)quot; with
                                               "

                                             o Replaces (ampersand)nbsp;  with
                                               a  non-breaking  space, decimal
                                               160

                                             o Replaces (ampersand)lt; with  a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat,  (ampersand)#xhhhh; , with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented  in decimal format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape sequences. If a  \   u
                                                 HHHH    code    is   in   the
                                                 full-width ASCII  code  range
                                                 of   FF01-FF5E   ,  then  the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not, only the lower  byte  is
                                                 used  and  the higher byte is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5  -  Calculate an MD5 hash
                                                 from the data in  the  input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE - Specify  NONE  if  you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH - Remove  mul-
                                                 tiple    slashes,   directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not at the beginning  of  the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN  - This is
                                                 the same as NORMALIZE_PATH  ,
                                                 but  first converts backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS   -  Remove  all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS  -   Replace
                                                 each  occurrence of a C-style
                                                 comment (/* ... */ )  with  a
                                                 single  space.  Multiple con-
                                                 secutive occurrences are  not
                                                 compressed. Unterminated com-
                                                 ments are also replaced  with
                                                 a  space  (ASCII  0x20). How-
                                                 ever, a  standalone  termina-
                                                 tion  of  a  comment (*/ ) is
                                                 not acted upon.

                                                 REPLACE_NULLS - Replace  NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE -  Decode  SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE , but with  support  for
                                                 Microsoft-specific  %u encod-
                                                 ing. If the code  is  in  the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte  is  used  to detect and
                                                 adjust the lower byte. Other-
                                                 wise,  only the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8 character sequences  to
                                                 Unicode.   This  helps  input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives for  non-Eng-
                                                 lish languages.

                               SizeConstraintStatement -> (structure)
                                   A  rule statement that compares a number of
                                   bytes against the size of a request  compo-
                                   nent,  using a comparison operator, such as
                                   greater than (>) or less than (<). For  ex-
                                   ample, you can use a size constraint state-
                                   ment to look for  query  strings  that  are
                                   longer than 100 bytes.

                                   If you configure WAF to inspect the request
                                   body, WAF inspects only the number of bytes
                                   of  the  body  up  to the limit for the web
                                   ACL. By default,  for  regional  web  ACLs,
                                   this  limit  is  8 KB (8,192 kilobytes) and
                                   for CloudFront web ACLs, this limit  is  16
                                   KB  (16,384  kilobytes). For CloudFront web
                                   ACLs, you can increase the limit in the web
                                   ACL   AssociationConfig  ,  for  additional
                                   fees. If you know that the request body for
                                   your  web  requests should never exceed the
                                   inspection limit, you could use a size con-
                                   straint  statement  to  block requests that
                                   have a larger request body size.

                                   If you choose URI for the value of Part  of
                                   the  request to filter on, the slash (/) in
                                   the URI counts as one character. For  exam-
                                   ple,  the  URI /logo.jpg is nine characters
                                   long.

                                   FieldToMatch -> (structure)
                                      The part of the  web  request  that  you
                                      want WAF to inspect.

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Alternately,  you can filter and in-
                                          spect all headers with  the  Headers
                                          FieldToMatch setting.

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect  the  request URI path. This
                                          is the part of the web request  that
                                          identifies  a resource, for example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect the query  string.  This  is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect the request  body  as  plain
                                          text.  The  request body immediately
                                          follows the request headers. This is
                                          the  part of a request that contains
                                          any additional data that you want to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          A limited amount of the request body
                                          is forwarded to WAF  for  inspection
                                          by  the underlying host service. For
                                          regional resources, the limit  is  8
                                          KB  (8,192 kilobytes) and for Cloud-
                                          Front distributions, the limit is 16
                                          KB  (16,384  kilobytes).  For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the  limit  in the web ACL's
                                          AssociationConfig ,  for  additional
                                          processing fees.

                                          For  information about how to handle
                                          oversized request  bodies,  see  the
                                          Body object configuration.

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger than WAF can inspect.  WAF
                                             does  not  support inspecting the
                                             entire contents of  the  web  re-
                                             quest  body  if  the body exceeds
                                             the limit for the resource  type.
                                             If  the  body  is larger than the
                                             limit, the underlying  host  ser-
                                             vice  only  forwards the contents
                                             that are below the limit  to  WAF
                                             for inspection.

                                             The  default limit is 8 KB (8,192
                                             kilobytes) for regional resources
                                             and  16 KB (16,384 kilobytes) for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig   ,  for  addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able  body  contents  normally,
                                               according  to  the rule inspec-
                                               tion criteria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling  with  your rule and web
                                             ACL action settings, so that  you
                                             block  any  request whose body is
                                             over the limit.

                                             Default: CONTINUE

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          A limited amount of the request body
                                          is  forwarded  to WAF for inspection
                                          by the underlying host service.  For
                                          regional  resources,  the limit is 8
                                          KB (8,192 kilobytes) and for  Cloud-
                                          Front distributions, the limit is 16
                                          KB (16,384  kilobytes).  For  Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in  the  web  ACL's
                                          AssociationConfig  ,  for additional
                                          processing fees.

                                          For information about how to  handle
                                          oversized  request  bodies,  see the
                                          JsonBody object configuration.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger  than WAF can inspect. WAF
                                             does not support  inspecting  the
                                             entire  contents  of  the web re-
                                             quest body if  the  body  exceeds
                                             the  limit for the resource type.
                                             If the body is  larger  than  the
                                             limit,  the  underlying host ser-
                                             vice only forwards  the  contents
                                             that  are  below the limit to WAF
                                             for inspection.

                                             The default limit is 8 KB  (8,192
                                             kilobytes) for regional resources
                                             and 16 KB (16,384 kilobytes)  for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig  ,  for   addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  body  contents  normally,
                                               according to the  rule  inspec-
                                               tion criteria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling with your rule  and  web
                                             ACL  action settings, so that you
                                             block any request whose  body  is
                                             over the limit.

                                             Default: CONTINUE

                                      Headers -> (structure)
                                          Inspect  the  request  headers.  You
                                          must  configure  scope  and  pattern
                                          matching  filters in the Headers ob-
                                          ject, to define the set  of  headers
                                          to and the parts of the headers that
                                          WAF inspects.

                                          Only the first 8 KB (8192 bytes)  of
                                          a  request's  headers  and  only the
                                          first 200 headers are  forwarded  to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to  handle  any oversize header con-
                                          tent in the Headers object. WAF  ap-
                                          plies  the  pattern matching filters
                                          to the headers that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of headers to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting: either All ,  IncludedHead-
                                             ers , or ExcludedHeaders .

                                             Example  JSON:  "MatchPattern": {
                                             "ExcludedHeaders":     {"KeyToEx-
                                             clude1", "KeyToExclude2"} }

                                             All -> (structure)
                                                 Inspect all headers.

                                             IncludedHeaders -> (list)
                                                 Inspect only the headers that
                                                 have a key that  matches  one
                                                 of   the   strings  specified
                                                 here.

                                                 (string)

                                             ExcludedHeaders -> (list)
                                                 Inspect  only   the   headers
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the headers to match
                                             with  the  rule inspection crite-
                                             ria. If you specify All , WAF in-
                                             spects both keys and values.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             headers when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total head-
                                             ers. The underlying host  service
                                             forwards a maximum of 200 headers
                                             and at most 8 KB of  header  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  headers normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                      Cookies -> (structure)
                                          Inspect  the  request  cookies.  You
                                          must  configure  scope  and  pattern
                                          matching filters in the Cookies  ob-
                                          ject,  to  define the set of cookies
                                          and the parts of  the  cookies  that
                                          WAF inspects.

                                          Only  the first 8 KB (8192 bytes) of
                                          a request's  cookies  and  only  the
                                          first  200  cookies are forwarded to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to handle any oversize  cookie  con-
                                          tent  in the Cookies object. WAF ap-
                                          plies the pattern  matching  filters
                                          to the cookies that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of cookies to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting:  either All , IncludedCook-
                                             ies , or ExcludedCookies .

                                             Example JSON:  "MatchPattern":  {
                                             "IncludedCookies":     {"KeyToIn-
                                             clude1",  "KeyToInclude2",  "Key-
                                             ToInclude3"} }

                                             All -> (structure)
                                                 Inspect all cookies.

                                             IncludedCookies -> (list)
                                                 Inspect only the cookies that
                                                 have a key that  matches  one
                                                 of   the   strings  specified
                                                 here.

                                                 (string)

                                             ExcludedCookies -> (list)
                                                 Inspect  only   the   cookies
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the cookies  to  in-
                                             spect  with  the  rule inspection
                                             criteria. If you  specify  All  ,
                                             WAF  inspects  both keys and val-
                                             ues.

                                          OversizeHandling -> (string)
                                             What WAF should do if the cookies
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             cookies  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  cook-
                                             ies.  The underlying host service
                                             forwards a maximum of 200 cookies
                                             and  at  most 8 KB of cookie con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able cookies normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                      HeaderOrder -> (structure)
                                          Inspect a string containing the list
                                          of the request's header  names,  or-
                                          dered  as they appear in the web re-
                                          quest that WAF receives for  inspec-
                                          tion.  WAF  generates the string and
                                          then uses that as the field to match
                                          component  in  its  inspection.  WAF
                                          separates the header  names  in  the
                                          string  using  commas  and  no added
                                          spaces.

                                          Matches  against  the  header  order
                                          string are case insensitive.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             headers when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total head-
                                             ers. The underlying host  service
                                             forwards a maximum of 200 headers
                                             and at most 8 KB of  header  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  headers normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                   ComparisonOperator -> (string)
                                      The operator to use to compare  the  re-
                                      quest part to the size setting.

                                   Size -> (long)
                                      The size, in byte, to compare to the re-
                                      quest part, after any transformations.

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form  the FieldToMatch request component
                                      before inspecting it, and  they're  used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them  as custom aggregation keys. If you
                                      specify one or more  transformations  to
                                      apply,  WAF performs all transformations
                                      on the specified content, starting  from
                                      the  lowest  priority  setting, and then
                                      uses the component contents.

                                      (structure)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets  the relative processing or-
                                             der for multiple transformations.
                                             WAF   processes  all  transforma-
                                             tions, from  lowest  priority  to
                                             highest,  before  inspecting  the
                                             transformed content. The  priori-
                                             ties  don't  need  to be consecu-
                                             tive, but they must all  be  dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                               GeoMatchStatement -> (structure)
                                   A rule statement that labels  web  requests
                                   by  country  and  region  and  that matches
                                   against web requests based on country code.
                                   A  geo match rule labels every request that
                                   it inspects regardless of whether it  finds
                                   a match.

                                   o To  manage  requests only by country, you
                                     can use  this  statement  by  itself  and
                                     specify  the  countries  that you want to
                                     match against in the CountryCodes array.

                                   o Otherwise, configure your geo match  rule
                                     with  Count action so that it only labels
                                     requests. Then, add  one  or  more  label
                                     match  rules  to  run after the geo match
                                     rule and configure them to match  against
                                     the  geographic labels and handle the re-
                                     quests as needed.

                                   WAF labels requests using the alpha-2 coun-
                                   try and region codes from the International
                                   Organization for Standardization (ISO) 3166
                                   standard.  WAF  determines  the codes using
                                   either the IP address in  the  web  request
                                   origin  or,  if you specify it, the address
                                   in the geo match ForwardedIPConfig .

                                   If you use the web request origin, the  la-
                                   bel   formats  are  awswaf:clientip:geo:re-
                                   gion:<ISO country code>-<ISO  region  code>
                                   and  awswaf:clientip:geo:country:<ISO coun-
                                   try code> .

                                   If you use a forwarded IP address, the  la-
                                   bel  formats are awswaf:forwardedip:geo:re-
                                   gion:<ISO country code>-<ISO  region  code>
                                   and     awswaf:forwardedip:geo:country:<ISO
                                   country code> .

                                   For  additional  details,  see   Geographic
                                   match  rule  statement in the WAF Developer
                                   Guide .

                                   CountryCodes -> (list)
                                      An array of two-character country  codes
                                      that  you want to match against, for ex-
                                      ample, [ "US", "CN" ] , from the alpha-2
                                      country ISO codes of the ISO 3166 inter-
                                      national standard.

                                      When you use a geo match statement  just
                                      for  the  region and country labels that
                                      it adds to requests, you still  have  to
                                      supply  a  country  code for the rule to
                                      evaluate. In this  case,  you  configure
                                      the  rule  to  only  count  matching re-
                                      quests, but it will still generate  log-
                                      ging  and count metrics for any matches.
                                      You can reduce the logging  and  metrics
                                      that  the  rule produces by specifying a
                                      country that's unlikely to be  a  source
                                      of traffic to your site.

                                      (string)

                                   ForwardedIPConfig -> (structure)
                                      The  configuration for inspecting IP ad-
                                      dresses in an HTTP header that you spec-
                                      ify,  instead  of  using  the IP address
                                      that's reported by the web request  ori-
                                      gin.   Commonly,   this  is  the  X-For-
                                      warded-For (XFF)  header,  but  you  can
                                      specify any header name.

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                      HeaderName -> (string)
                                          The name of the HTTP header  to  use
                                          for  the IP address. For example, to
                                          use   the   X-Forwarded-For    (XFF)
                                          header,  set this to X-Forwarded-For
                                          .

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                      FallbackBehavior -> (string)
                                          The  match  status  to assign to the
                                          web request if the  request  doesn't
                                          have a valid IP address in the spec-
                                          ified position.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          You  can specify the following fall-
                                          back behaviors:

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               RuleGroupReferenceStatement -> (structure)
                                   A rule statement used to run the rules that
                                   are defined in a  RuleGroup . To use  this,
                                   create  a  rule group with your rules, then
                                   provide the ARN of the rule group  in  this
                                   statement.

                                   You  cannot nest a RuleGroupReferenceState-
                                   ment , for example for use  inside  a  Not-
                                   Statement or OrStatement . You can only use
                                   a rule group reference statement at the top
                                   level inside a web ACL.

                                   ARN -> (string)
                                      The  Amazon  Resource  Name (ARN) of the
                                      entity.

                                   ExcludedRules -> (list)
                                      Rules in the referenced rule group whose
                                      actions are set to Count .

                                      NOTE:
                                          Instead  of this option, use RuleAc-
                                          tionOverrides . It accepts any valid
                                          action setting, including Count .

                                      (structure)
                                          Specifies  a  single  rule in a rule
                                          group whose action you want to over-
                                          ride to Count .

                                          NOTE:
                                             Instead of this option, use Rule-
                                             ActionOverrides . It accepts  any
                                             valid  action  setting, including
                                             Count .

                                          Name -> (string)
                                             The name of the rule whose action
                                             you want to override to Count .

                                   RuleActionOverrides -> (list)
                                      Action  settings  to use in the place of
                                      the rule actions that are configured in-
                                      side  the  rule  group.  You specify one
                                      override for each rule whose action  you
                                      want to change.

                                      You  can  use overrides for testing, for
                                      example you can override all of rule ac-
                                      tions  to Count and then monitor the re-
                                      sulting count metrics to understand  how
                                      the  rule  group  would  handle your web
                                      traffic. You can also permanently  over-
                                      ride  some or all actions, to modify how
                                      the rule group manages your web traffic.

                                      (structure)
                                          Action setting to use in  the  place
                                          of  a rule action that is configured
                                          inside the rule group.  You  specify
                                          one override for each rule whose ac-
                                          tion you want to change.

                                          You can use overrides  for  testing,
                                          for  example you can override all of
                                          rule actions to Count and then moni-
                                          tor  the  resulting count metrics to
                                          understand how the rule group  would
                                          handle  your  web  traffic.  You can
                                          also permanently  override  some  or
                                          all  actions, to modify how the rule
                                          group manages your web traffic.

                                          Name -> (string)
                                             The name of the rule to override.

                                          ActionToUse -> (structure)
                                             The override action  to  use,  in
                                             place of the configured action of
                                             the rule in the rule group.

                                             Block -> (structure)
                                                 Instructs WAF  to  block  the
                                                 web request.

                                                 CustomResponse -> (structure)
                                                    Defines  a custom response
                                                    for the web request.

                                                    For information about cus-
                                                    tomizing  web requests and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in WAF in the  WAF  Devel-
                                                    oper Guide .

                                                    ResponseCode -> (integer)
                                                        The  HTTP  status code
                                                        to   return   to   the
                                                        client.

                                                        For  a  list of status
                                                        codes that you can use
                                                        in   your  custom  re-
                                                        sponses, see Supported
                                                        status  codes for cus-
                                                        tom  response  in  the
                                                        WAF Developer Guide .

                                                    CustomResponseBodyKey   ->
                                                    (string)
                                                        References   the   re-
                                                        sponse  body  that you
                                                        want WAF to return  to
                                                        the     web    request
                                                        client. You can define
                                                        a  custom response for
                                                        a rule action or a de-
                                                        fault  web  ACL action
                                                        that is set to  block.
                                                        To  do this, you first
                                                        define  the   response
                                                        body  key and value in
                                                        the CustomResponseBod-
                                                        ies  setting  for  the
                                                        WebACL  or   RuleGroup
                                                        where  you want to use
                                                        it. Then, in the  rule
                                                        action  or web ACL de-
                                                        fault action  BlockAc-
                                                        tion setting, you ref-
                                                        erence  the   response
                                                        body using this key.

                                                    ResponseHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        use in  the  response.
                                                        Duplicate header names
                                                        are not allowed.

                                                        For information  about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas  in the WAF Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom  request and
                                                           response  handling.
                                                           This   is  used  in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For  custom re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are  already in
                                                               the    request.
                                                               For    example,
                                                               for the  header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The   value  of
                                                               the      custom
                                                               header.

                                             Allow -> (structure)
                                                 Instructs  WAF  to  allow the
                                                 web request.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines   custom  handling
                                                    for the web request.

                                                    For information about cus-
                                                    tomizing  web requests and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in WAF in the  WAF  Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header names  are  not
                                                        allowed.

                                                        For  information about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas in the WAF  Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom request  and
                                                           response  handling.
                                                           This  is  used   in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For custom  re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are already  in
                                                               the    request.
                                                               For    example,
                                                               for  the header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The  value   of
                                                               the      custom
                                                               header.

                                             Count -> (structure)
                                                 Instructs WAF  to  count  the
                                                 web request and then continue
                                                 evaluating the request  using
                                                 the  remaining  rules  in the
                                                 web ACL.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines   custom  handling
                                                    for the web request.

                                                    For information about cus-
                                                    tomizing  web requests and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in WAF in the  WAF  Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header names  are  not
                                                        allowed.

                                                        For  information about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas in the WAF  Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom request  and
                                                           response  handling.
                                                           This  is  used   in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For custom  re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are already  in
                                                               the    request.
                                                               For    example,
                                                               for  the header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The  value   of
                                                               the      custom
                                                               header.

                                             Captcha -> (structure)
                                                 Instructs  WAF   to   run   a
                                                 CAPTCHA check against the web
                                                 request.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines   custom  handling
                                                    for the web request,  used
                                                    when  the  CAPTCHA inspec-
                                                    tion determines  that  the
                                                    request's  token  is valid
                                                    and unexpired.

                                                    For information about cus-
                                                    tomizing  web requests and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in WAF in the  WAF  Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header names  are  not
                                                        allowed.

                                                        For  information about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas in the WAF  Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom request  and
                                                           response  handling.
                                                           This  is  used   in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For custom  re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are already  in
                                                               the    request.
                                                               For    example,
                                                               for  the header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The  value   of
                                                               the      custom
                                                               header.

                                             Challenge -> (structure)
                                                 Instructs WAF to run a  Chal-
                                                 lenge  check  against the web
                                                 request.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines   custom  handling
                                                    for the web request,  used
                                                    when the challenge inspec-
                                                    tion determines  that  the
                                                    request's  token  is valid
                                                    and unexpired.

                                                    For information about cus-
                                                    tomizing  web requests and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in WAF in the  WAF  Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header names  are  not
                                                        allowed.

                                                        For  information about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas in the WAF  Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom request  and
                                                           response  handling.
                                                           This  is  used   in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For custom  re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are already  in
                                                               the    request.
                                                               For    example,
                                                               for  the header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The  value   of
                                                               the      custom
                                                               header.

                               IPSetReferenceStatement -> (structure)
                                   A rule statement used  to  detect  web  re-
                                   quests  coming from particular IP addresses
                                   or address ranges. To use this,  create  an
                                   IPSet that specifies the addresses you want
                                   to detect, then use the ARN of that set  in
                                   this  statement.  To  create an IP set, see
                                   CreateIPSet .

                                   Each IP set rule statement references an IP
                                   set.  You create and maintain the set inde-
                                   pendent of your rules. This allows  you  to
                                   use  the single set in multiple rules. When
                                   you update the referenced set, WAF automat-
                                   ically updates all rules that reference it.

                                   ARN -> (string)
                                      The  Amazon  Resource  Name (ARN) of the
                                      IPSet that this statement references.

                                   IPSetForwardedIPConfig -> (structure)
                                      The configuration for inspecting IP  ad-
                                      dresses in an HTTP header that you spec-
                                      ify, instead of  using  the  IP  address
                                      that's  reported by the web request ori-
                                      gin.  Commonly,  this  is   the   X-For-
                                      warded-For  (XFF)  header,  but  you can
                                      specify any header name.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      HeaderName -> (string)
                                          The  name  of the HTTP header to use
                                          for the IP address. For example,  to
                                          use    the   X-Forwarded-For   (XFF)
                                          header, set this to  X-Forwarded-For
                                          .

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                      FallbackBehavior -> (string)
                                          The match status to  assign  to  the
                                          web  request  if the request doesn't
                                          have a valid IP address in the spec-
                                          ified position.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          You can specify the following  fall-
                                          back behaviors:

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                      Position -> (string)
                                          The position in the header to search
                                          for  the  IP address. The header can
                                          contain IP addresses of the original
                                          client  and also of proxies. For ex-
                                          ample, the  header  value  could  be
                                          10.1.1.1,   127.0.0.0,   10.10.10.10
                                          where the first IP  address  identi-
                                          fies  the  original  client  and the
                                          rest identify proxies that  the  re-
                                          quest went through.

                                          The options for this setting are the
                                          following:

                                          o FIRST - Inspect the first  IP  ad-
                                            dress  in the list of IP addresses
                                            in the header. This is usually the
                                            client's original IP.

                                          o LAST - Inspect the last IP address
                                            in the list of IP addresses in the
                                            header.

                                          o ANY  - Inspect all IP addresses in
                                            the header for  a  match.  If  the
                                            header  contains  more  than 10 IP
                                            addresses, WAF inspects  the  last
                                            10.

                               RegexPatternSetReferenceStatement   ->  (struc-
                               ture)
                                   A rule statement used to search web request
                                   components for matches with regular expres-
                                   sions. To use  this,  create  a   RegexPat-
                                   ternSet that specifies the expressions that
                                   you want to detect, then  use  the  ARN  of
                                   that  set  in this statement. A web request
                                   matches the pattern set rule  statement  if
                                   the  request  component  matches any of the
                                   patterns in the set. To create a regex pat-
                                   tern set, see  CreateRegexPatternSet .

                                   Each  regex pattern set rule statement ref-
                                   erences a regex pattern set. You create and
                                   maintain the set independent of your rules.
                                   This allows you to use the  single  set  in
                                   multiple  rules. When you update the refer-
                                   enced set, WAF  automatically  updates  all
                                   rules that reference it.

                                   ARN -> (string)
                                      The  Amazon  Resource  Name (ARN) of the
                                      RegexPatternSet that this statement ref-
                                      erences.

                                   FieldToMatch -> (structure)
                                      The  part  of  the  web request that you
                                      want WAF to inspect.

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name  of  the header to inspect, for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example   JSON:   "SingleHeader":  {
                                          "Name": "haystack" }

                                          Alternately, you can filter and  in-
                                          spect  all  headers with the Headers
                                          FieldToMatch setting.

                                          Name -> (string)
                                             The name of the query  header  to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide the name of the query  argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion . The name can be up  to
                                          30  characters  long  and isn't case
                                          sensitive.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the part of the web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          A limited amount of the request body
                                          is  forwarded  to WAF for inspection
                                          by the underlying host service.  For
                                          regional  resources,  the limit is 8
                                          KB (8,192 kilobytes) and for  Cloud-
                                          Front distributions, the limit is 16
                                          KB (16,384  kilobytes).  For  Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in  the  web  ACL's
                                          AssociationConfig  ,  for additional
                                          processing fees.

                                          For information about how to  handle
                                          oversized  request  bodies,  see the
                                          Body object configuration.

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger  than WAF can inspect. WAF
                                             does not support  inspecting  the
                                             entire  contents  of  the web re-
                                             quest body if  the  body  exceeds
                                             the  limit for the resource type.
                                             If the body is  larger  than  the
                                             limit,  the  underlying host ser-
                                             vice only forwards  the  contents
                                             that  are  below the limit to WAF
                                             for inspection.

                                             The default limit is 8 KB  (8,192
                                             kilobytes) for regional resources
                                             and 16 KB (16,384 kilobytes)  for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig  ,  for   addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  body  contents  normally,
                                               according to the  rule  inspec-
                                               tion criteria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling with your rule  and  web
                                             ACL  action settings, so that you
                                             block any request whose  body  is
                                             over the limit.

                                             Default: CONTINUE

                                      Method -> (structure)
                                          Inspect  the HTTP method. The method
                                          indicates the type of operation that
                                          the  request is asking the origin to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect the request  body  as  JSON.
                                          The request body immediately follows
                                          the request  headers.  This  is  the
                                          part  of a request that contains any
                                          additional data  that  you  want  to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          A limited amount of the request body
                                          is forwarded to WAF  for  inspection
                                          by  the underlying host service. For
                                          regional resources, the limit  is  8
                                          KB  (8,192 kilobytes) and for Cloud-
                                          Front distributions, the limit is 16
                                          KB  (16,384  kilobytes).  For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the  limit  in the web ACL's
                                          AssociationConfig ,  for  additional
                                          processing fees.

                                          For  information about how to handle
                                          oversized request  bodies,  see  the
                                          JsonBody object configuration.

                                          MatchPattern -> (structure)
                                             The  patterns  to look for in the
                                             JSON body. WAF inspects  the  re-
                                             sults  of  these  pattern matches
                                             against the rule inspection  cri-
                                             teria.

                                             All -> (structure)
                                                 Match  all  of  the elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You  must specify either this
                                                 setting or the  IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match  only the specified in-
                                                 clude paths. See also  Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing JSON Pointer syntax.  For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"]  . For infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force  (IETF)   documentation
                                                 JavaScript   Object  Notation
                                                 (JSON) Pointer .

                                                 You must specify either  this
                                                 setting  or  the All setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't use this  option  to
                                                    include   all  paths.  In-
                                                    stead, use  the  All  set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The  parts  of  the JSON to match
                                             against using the MatchPattern  .
                                             If  you specify All , WAF matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely  parse  the JSON body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING  -   Inspect
                                               the body as plain text. WAF ap-
                                               plies the text  transformations
                                               and  inspection  criteria  that
                                               you defined for  the  JSON  in-
                                               spection   to   the  body  text
                                               string.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             If  you  don't  provide this set-
                                             ting, WAF  parses  and  evaluates
                                             the  content only up to the first
                                             parsing failure that  it  encoun-
                                             ters.

                                             WAF  does  its  best to parse the
                                             entire JSON body,  but  might  be
                                             forced  to  stop for reasons such
                                             as invalid characters,  duplicate
                                             keys, truncation, and any content
                                             whose root node isn't  an  object
                                             or an array.

                                             WAF  parses  the JSON in the fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger than WAF can inspect.  WAF
                                             does  not  support inspecting the
                                             entire contents of  the  web  re-
                                             quest  body  if  the body exceeds
                                             the limit for the resource  type.
                                             If  the  body  is larger than the
                                             limit, the underlying  host  ser-
                                             vice  only  forwards the contents
                                             that are below the limit  to  WAF
                                             for inspection.

                                             The  default limit is 8 KB (8,192
                                             kilobytes) for regional resources
                                             and  16 KB (16,384 kilobytes) for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig   ,  for  addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able  body  contents  normally,
                                               according  to  the rule inspec-
                                               tion criteria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling  with  your rule and web
                                             ACL action settings, so that  you
                                             block  any  request whose body is
                                             over the limit.

                                             Default: CONTINUE

                                      Headers -> (structure)
                                          Inspect  the  request  headers.  You
                                          must  configure  scope  and  pattern
                                          matching filters in the Headers  ob-
                                          ject,  to  define the set of headers
                                          to and the parts of the headers that
                                          WAF inspects.

                                          Only  the first 8 KB (8192 bytes) of
                                          a request's  headers  and  only  the
                                          first  200  headers are forwarded to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to handle any oversize  header  con-
                                          tent  in the Headers object. WAF ap-
                                          plies the pattern  matching  filters
                                          to the headers that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of headers to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting:  either All , IncludedHead-
                                             ers , or ExcludedHeaders .

                                             Example JSON:  "MatchPattern":  {
                                             "ExcludedHeaders":     {"KeyToEx-
                                             clude1", "KeyToExclude2"} }

                                             All -> (structure)
                                                 Inspect all headers.

                                             IncludedHeaders -> (list)
                                                 Inspect only the headers that
                                                 have  a  key that matches one
                                                 of  the   strings   specified
                                                 here.

                                                 (string)

                                             ExcludedHeaders -> (list)
                                                 Inspect   only   the  headers
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the headers to match
                                             with the rule  inspection  crite-
                                             ria. If you specify All , WAF in-
                                             spects both keys and values.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             headers  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  head-
                                             ers.  The underlying host service
                                             forwards a maximum of 200 headers
                                             and  at  most 8 KB of header con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able headers normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                      Cookies -> (structure)
                                          Inspect  the  request  cookies.  You
                                          must  configure  scope  and  pattern
                                          matching  filters in the Cookies ob-
                                          ject, to define the set  of  cookies
                                          and  the  parts  of the cookies that
                                          WAF inspects.

                                          Only the first 8 KB (8192 bytes)  of
                                          a  request's  cookies  and  only the
                                          first 200 cookies are  forwarded  to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to  handle  any oversize cookie con-
                                          tent in the Cookies object. WAF  ap-
                                          plies  the  pattern matching filters
                                          to the cookies that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of cookies to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting: either All ,  IncludedCook-
                                             ies , or ExcludedCookies .

                                             Example  JSON:  "MatchPattern": {
                                             "IncludedCookies":     {"KeyToIn-
                                             clude1",  "KeyToInclude2",  "Key-
                                             ToInclude3"} }

                                             All -> (structure)
                                                 Inspect all cookies.

                                             IncludedCookies -> (list)
                                                 Inspect only the cookies that
                                                 have  a  key that matches one
                                                 of  the   strings   specified
                                                 here.

                                                 (string)

                                             ExcludedCookies -> (list)
                                                 Inspect   only   the  cookies
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The  parts  of the cookies to in-
                                             spect with  the  rule  inspection
                                             criteria.  If  you  specify All ,
                                             WAF inspects both keys  and  val-
                                             ues.

                                          OversizeHandling -> (string)
                                             What WAF should do if the cookies
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             cookies when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total cook-
                                             ies. The underlying host  service
                                             forwards a maximum of 200 cookies
                                             and at most 8 KB of  cookie  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  cookies normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                      HeaderOrder -> (structure)
                                          Inspect a string containing the list
                                          of  the  request's header names, or-
                                          dered as they appear in the web  re-
                                          quest  that WAF receives for inspec-
                                          tion. WAF generates the  string  and
                                          then uses that as the field to match
                                          component  in  its  inspection.  WAF
                                          separates  the  header  names in the
                                          string using  commas  and  no  added
                                          spaces.

                                          Matches  against  the  header  order
                                          string are case insensitive.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             headers  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  head-
                                             ers.  The underlying host service
                                             forwards a maximum of 200 headers
                                             and  at  most 8 KB of header con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able headers normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   TextTransformations -> (list)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form the FieldToMatch request  component
                                      before  inspecting  it, and they're used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them as custom aggregation keys. If  you
                                      specify  one  or more transformations to
                                      apply, WAF performs all  transformations
                                      on  the specified content, starting from
                                      the lowest priority  setting,  and  then
                                      uses the component contents.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der for multiple transformations.
                                             WAF  processes  all   transforma-
                                             tions,  from  lowest  priority to
                                             highest,  before  inspecting  the
                                             transformed  content. The priori-
                                             ties don't need  to  be  consecu-
                                             tive,  but  they must all be dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE   -   Decode  a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT - Decode  a
                                                 Base64  -encoded  string, but
                                                 use a  forgiving  implementa-
                                                 tion  that ignores characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.   These  are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual formatting to  disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete spaces before  the  fol-
                                               lowing characters: / (

                                             o Replace  the  following charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE  -   Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r , carriage  return,  decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places multiple  spaces  with
                                                 one space.

                                                 CSS_DECODE  -  Decode charac-
                                                 ters that were encoded  using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in the decoding  process,  so
                                                 it  can help to uncover ASCII
                                                 characters that were  encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's  also useful in counter-
                                                 ing evasion, which is a  com-
                                                 bination  of  a backslash and
                                                 non-hexadecimal   characters.
                                                 For  example, ja\vascript for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE  -   Decode
                                                 the  following  ANSI C escape
                                                 sequences: \a , \b , \f ,  \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 , \"  ,  \xHH  (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't valid  remain  in  the
                                                 output.

                                                 HEX_DECODE  - Decode a string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE  - Replace
                                                 HTML-encoded characters  with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces  (ampersand)quot; with
                                               "

                                             o Replaces (ampersand)nbsp;  with
                                               a  non-breaking  space, decimal
                                               160

                                             o Replaces (ampersand)lt; with  a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat,  (ampersand)#xhhhh; , with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented  in decimal format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape sequences. If a  \   u
                                                 HHHH    code    is   in   the
                                                 full-width ASCII  code  range
                                                 of   FF01-FF5E   ,  then  the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not, only the lower  byte  is
                                                 used  and  the higher byte is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5  -  Calculate an MD5 hash
                                                 from the data in  the  input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE - Specify  NONE  if  you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH - Remove  mul-
                                                 tiple    slashes,   directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not at the beginning  of  the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN  - This is
                                                 the same as NORMALIZE_PATH  ,
                                                 but  first converts backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS   -  Remove  all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS  -   Replace
                                                 each  occurrence of a C-style
                                                 comment (/* ... */ )  with  a
                                                 single  space.  Multiple con-
                                                 secutive occurrences are  not
                                                 compressed. Unterminated com-
                                                 ments are also replaced  with
                                                 a  space  (ASCII  0x20). How-
                                                 ever, a  standalone  termina-
                                                 tion  of  a  comment (*/ ) is
                                                 not acted upon.

                                                 REPLACE_NULLS - Replace  NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE -  Decode  SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE , but with  support  for
                                                 Microsoft-specific  %u encod-
                                                 ing. If the code  is  in  the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte  is  used  to detect and
                                                 adjust the lower byte. Other-
                                                 wise,  only the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8 character sequences  to
                                                 Unicode.   This  helps  input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives for  non-Eng-
                                                 lish languages.

                               RateBasedStatement -> (structure)
                                   A  rate-based rule counts incoming requests
                                   and rate limits requests when they are com-
                                   ing  at  too  fast a rate. The rule catego-
                                   rizes requests according to  your  aggrega-
                                   tion  criteria, collects them into aggrega-
                                   tion instances, and counts and rate  limits
                                   the requests for each instance.

                                   You   can  specify  individual  aggregation
                                   keys, like IP address or HTTP  method.  You
                                   can  also  specify aggregation key combina-
                                   tions, like IP address and HTTP method,  or
                                   HTTP method, query argument, and cookie.

                                   Each  unique set of values for the aggrega-
                                   tion keys that you specify  is  a  separate
                                   aggregation  instance,  with the value from
                                   each key contributing  to  the  aggregation
                                   instance definition.

                                   For  example, assume the rule evaluates web
                                   requests with the following IP address  and
                                   HTTP method values:

                                   o IP address 10.1.1.1, HTTP method POST

                                   o IP address 10.1.1.1, HTTP method GET

                                   o IP address 127.0.0.0, HTTP method POST

                                   o IP address 10.1.1.1, HTTP method GET

                                   The rule would create different aggregation
                                   instances  according  to  your  aggregation
                                   criteria, for example:

                                   o If  the  aggregation criteria is just the
                                     IP address, then each individual  address
                                     is   an  aggregation  instance,  and  WAF
                                     counts requests separately for each.  The
                                     aggregation  instances and request counts
                                     for our example would be the following:

                                     o IP address 10.1.1.1: count 3

                                     o IP address 127.0.0.0: count 1

                                   o If  the  aggregation  criteria  is   HTTP
                                     method,  then each individual HTTP method
                                     is an aggregation instance. The  aggrega-
                                     tion instances and request counts for our
                                     example would be the following:

                                     o HTTP method POST: count 2

                                     o HTTP method GET: count 2

                                   o If the aggregation criteria is IP address
                                     and HTTP method, then each IP address and
                                     each HTTP method would contribute to  the
                                     combined aggregation instance. The aggre-
                                     gation instances and request  counts  for
                                     our example would be the following:

                                     o IP  address 10.1.1.1, HTTP method POST:
                                       count 1

                                     o IP address 10.1.1.1, HTTP  method  GET:
                                       count 2

                                     o IP address 127.0.0.0, HTTP method POST:
                                       count 1

                                   For any n-tuple of aggregation  keys,  each
                                   unique  combination  of values for the keys
                                   defines a  separate  aggregation  instance,
                                   which  WAF counts and rate-limits individu-
                                   ally.

                                   You can optionally nest  another  statement
                                   inside  the rate-based statement, to narrow
                                   the scope of  the  rule  so  that  it  only
                                   counts  and rate limits requests that match
                                   the nested  statement.  You  can  use  this
                                   nested  scope-down statement in conjunction
                                   with your aggregation key specifications or
                                   you  can  just count and rate limit all re-
                                   quests that match the scope-down statement,
                                   without  additional  aggregation.  When you
                                   choose to just  manage  all  requests  that
                                   match  a scope-down statement, the aggrega-
                                   tion instance is singular for the rule.

                                   You cannot nest a RateBasedStatement inside
                                   another  statement,  for  example  inside a
                                   NotStatement or OrStatement . You  can  de-
                                   fine  a RateBasedStatement inside a web ACL
                                   and inside a rule group.

                                   For additional information  about  the  op-
                                   tions, see Rate limiting web requests using
                                   rate-based rules in the WAF Developer Guide
                                   .

                                   If  you only aggregate on the individual IP
                                   address or forwarded IP  address,  you  can
                                   retrieve  the list of IP addresses that WAF
                                   is  currently  rate  limiting  for  a  rule
                                   through the API call GetRateBasedStatement-
                                   ManagedKeys . This option is not  available
                                   for other aggregation configurations.

                                   WAF  tracks  and manages web requests sepa-
                                   rately for each instance  of  a  rate-based
                                   rule that you use. For example, if you pro-
                                   vide the same rate-based rule  settings  in
                                   two  web  ACLs, each of the two rule state-
                                   ments represents a separate instance of the
                                   rate-based  rule  and gets its own tracking
                                   and management by  WAF.  If  you  define  a
                                   rate-based  rule  inside  a rule group, and
                                   then  use  that  rule  group  in   multiple
                                   places,  each  use  creates  a separate in-
                                   stance of the rate-based rule that gets its
                                   own tracking and management by WAF.

                                   Limit -> (long)
                                      The  limit  on requests per 5-minute pe-
                                      riod for a single  aggregation  instance
                                      for   the   rate-based   rule.   If  the
                                      rate-based statement includes  a  Scope-
                                      DownStatement  ,  this  limit is applied
                                      only to  the  requests  that  match  the
                                      statement.

                                      Examples:

                                      o If  you  aggregate  on just the IP ad-
                                        dress, this is the limit  on  requests
                                        from any single IP address.

                                      o If  you  aggregate  on the HTTP method
                                        and the query  argument  name  "city",
                                        then this is the limit on requests for
                                        any single method, city pair.

                                   AggregateKeyType -> (string)
                                      Setting that indicates how to  aggregate
                                      the request counts.

                                      NOTE:
                                          Web requests that are missing any of
                                          the components specified in the  ag-
                                          gregation  keys are omitted from the
                                          rate-based rule evaluation and  han-
                                          dling.

                                      o CONSTANT  -  Count  and  limit the re-
                                        quests  that  match   the   rate-based
                                        rule's scope-down statement. With this
                                        option, the  counted  requests  aren't
                                        further   aggregated.  The  scope-down
                                        statement is  the  only  specification
                                        used.  When  the count of all requests
                                        that satisfy the scope-down  statement
                                        goes  over  the limit, WAF applies the
                                        rule action to all requests that  sat-
                                        isfy  the  scope-down statement.  With
                                        this option, you  must  configure  the
                                        ScopeDownStatement property.

                                      o CUSTOM_KEYS  -  Aggregate  the request
                                        counts using one or more  web  request
                                        components as the aggregate keys. With
                                        this option, you must specify the  ag-
                                        gregate  keys  in the CustomKeys prop-
                                        erty.  To aggregate on only the IP ad-
                                        dress  or  only  the  forwarded IP ad-
                                        dress, don't use custom keys. Instead,
                                        set  the  aggregate  key type to IP or
                                        FORWARDED_IP .

                                      o FORWARDED_IP - Aggregate  the  request
                                        counts  on  the first IP address in an
                                        HTTP header.  With  this  option,  you
                                        must  specify the header to use in the
                                        ForwardedIPConfig property.  To aggre-
                                        gate on a combination of the forwarded
                                        IP address with other aggregate  keys,
                                        use CUSTOM_KEYS .

                                      o IP  -  Aggregate the request counts on
                                        the IP address from  the  web  request
                                        origin.  To aggregate on a combination
                                        of the IP address with other aggregate
                                        keys, use CUSTOM_KEYS .

                                   (  ...  recursive ... )ForwardedIPConfig ->
                                   (structure)
                                      The configuration for inspecting IP  ad-
                                      dresses in an HTTP header that you spec-
                                      ify, instead of  using  the  IP  address
                                      that's  reported by the web request ori-
                                      gin.  Commonly,  this  is   the   X-For-
                                      warded-For  (XFF)  header,  but  you can
                                      specify any header name.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      This  is  required if you specify a for-
                                      warded IP in the  rule's  aggregate  key
                                      settings.

                                      HeaderName -> (string)
                                          The  name  of the HTTP header to use
                                          for the IP address. For example,  to
                                          use    the   X-Forwarded-For   (XFF)
                                          header, set this to  X-Forwarded-For
                                          .

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                      FallbackBehavior -> (string)
                                          The match status to  assign  to  the
                                          web  request  if the request doesn't
                                          have a valid IP address in the spec-
                                          ified position.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          You can specify the following  fall-
                                          back behaviors:

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                   CustomKeys -> (list)
                                      Specifies the aggregate keys to use in a
                                      rate-base rule.

                                      (structure)
                                          Specifies  a single custom aggregate
                                          key for a rate-base rule.

                                          NOTE:
                                             Web requests that are missing any
                                             of  the  components  specified in
                                             the aggregation keys are  omitted
                                             from  the rate-based rule evalua-
                                             tion and handling.

                                          Header -> (structure)
                                             Use the value of a header in  the
                                             request as an aggregate key. Each
                                             distinct value in the header con-
                                             tributes  to  the aggregation in-
                                             stance.  If  you  use  a   single
                                             header  as  your custom key, then
                                             each value fully defines  an  ag-
                                             gregation instance.

                                             Name -> (string)
                                                 The  name  of  the  header to
                                                 use.

                                             TextTransformations -> (list)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection. Text trans-
                                                 formations  are  used in rule
                                                 match statements,  to  trans-
                                                 form the FieldToMatch request
                                                 component  before  inspecting
                                                 it,   and   they're  used  in
                                                 rate-based  rule  statements,
                                                 to  transform  request compo-
                                                 nents before  using  them  as
                                                 custom  aggregation  keys. If
                                                 you  specify  one   or   more
                                                 transformations to apply, WAF
                                                 performs all  transformations
                                                 on   the  specified  content,
                                                 starting from the lowest pri-
                                                 ority  setting, and then uses
                                                 the component contents.

                                                 (structure)
                                                    Text transformations elim-
                                                    inate  some of the unusual
                                                    formatting that  attackers
                                                    use  in web requests in an
                                                    effort  to  bypass  detec-
                                                    tion.

                                                    Priority -> (integer)
                                                        Sets the relative pro-
                                                        cessing order for mul-
                                                        tiple transformations.
                                                        WAF   processes    all
                                                        transformations,  from
                                                        lowest   priority   to
                                                        highest,   before  in-
                                                        specting  the   trans-
                                                        formed   content.  The
                                                        priorities don't  need
                                                        to be consecutive, but
                                                        they must all be  dif-
                                                        ferent.

                                                    Type -> (string)
                                                        You  can  specify  the
                                                        following  transforma-
                                                        tion types:
                                                           BASE64_DECODE - De-
                                                           code a Base64  -en-
                                                           coded string.

                                                           BASE64_DECODE_EXT -
                                                           Decode   a   Base64
                                                           -encoded    string,
                                                           but use a forgiving
                                                           implementation that
                                                           ignores  characters
                                                           that aren't valid.

                                                           CMD_LINE   -   Com-
                                                           mand-line transfor-
                                                           mations.  These are
                                                           helpful in reducing
                                                           effectiveness    of
                                                           attackers  who  in-
                                                           ject  an  operating
                                                           system command-line
                                                           command and use un-
                                                           usual formatting to
                                                           disguise   some  or
                                                           all of the command.

                                                        o Delete the following
                                                          characters: \ " ' ^

                                                        o Delete spaces before
                                                          the following  char-
                                                          acters: / (

                                                        o Replace  the follow-
                                                          ing characters  with
                                                          a space: , ;

                                                        o Replace     multiple
                                                          spaces   with    one
                                                          space

                                                        o Convert    uppercase
                                                          letters   (A-Z)   to
                                                          lowercase (a-z)
                                                           COM-
                                                           PRESS_WHITE_SPACE -
                                                           Replace these char-
                                                           acters with a space
                                                           character  (decimal
                                                           32):

                                                        o \f , formfeed, deci-
                                                          mal 12

                                                        o \t , tab, decimal 9

                                                        o \n  , newline, deci-
                                                          mal 10

                                                        o \r  ,  carriage  re-
                                                          turn, decimal 13

                                                        o \v  ,  vertical tab,
                                                          decimal 11

                                                        o Non-breaking  space,
                                                          decimal 160
                                                           COM-
                                                           PRESS_WHITE_SPACE
                                                           also  replaces mul-
                                                           tiple  spaces  with
                                                           one space.

                                                           CSS_DECODE - Decode
                                                           characters     that
                                                           were  encoded using
                                                           CSS   2.x    escape
                                                           rules          syn-
                                                           data.html#charac-
                                                           ters  .  This func-
                                                           tion uses up to two
                                                           bytes in the decod-
                                                           ing process, so  it
                                                           can help to uncover
                                                           ASCII    characters
                                                           that  were  encoded
                                                           using CSS  encoding
                                                           that  wouldnt typi-
                                                           cally  be  encoded.
                                                           It's also useful in
                                                           countering evasion,
                                                           which is a combina-
                                                           tion of a backslash
                                                           and non-hexadecimal
                                                           characters. For ex-
                                                           ample,  ja\vascript
                                                           for javascript.

                                                           ESCAPE_SEQ_DECODE -
                                                           Decode  the follow-
                                                           ing ANSI  C  escape
                                                           sequences:  \a , \b
                                                           , \f , \n , \r , \t
                                                           , \v , \\ , \? , \'
                                                           , \" , \xHH  (hexa-
                                                           decimal),     \0OOO
                                                           (octal).  Encodings
                                                           that  aren't  valid
                                                           remain in the  out-
                                                           put.

                                                           HEX_DECODE - Decode
                                                           a string  of  hexa-
                                                           decimal  characters
                                                           into a binary.

                                                           HTML_ENTITY_DECODE
                                                           -  Replace HTML-en-
                                                           coded    characters
                                                           with      unencoded
                                                           characters.
                                                           HTML_ENTITY_DECODE
                                                           performs these  op-
                                                           erations:

                                                        o Replaces     (amper-
                                                          sand)quot; with "

                                                        o Replaces     (amper-
                                                          sand)nbsp;   with  a
                                                          non-breaking  space,
                                                          decimal 160

                                                        o Replaces     (amper-
                                                          sand)lt;   with    a
                                                          "less than" symbol

                                                        o Replaces     (amper-
                                                          sand)gt; with >

                                                        o Replaces  characters
                                                          that are represented
                                                          in hexadecimal  for-
                                                          mat, (ampersand)#xh-
                                                          hhh; , with the cor-
                                                          responding   charac-
                                                          ters

                                                        o Replaces  characters
                                                          that are represented
                                                          in  decimal  format,
                                                          (ampersand)#nnnn;  ,
                                                          with the correspond-
                                                          ing characters
                                                           JS_DECODE  - Decode
                                                           JavaScript   escape
                                                           sequences.  If  a \
                                                           u  HHHH code is  in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E   ,  then
                                                           the higher byte  is
                                                           used  to detect and
                                                           adjust  the   lower
                                                           byte.  If not, only
                                                           the lower  byte  is
                                                           used and the higher
                                                           byte   is   zeroed,
                                                           causing  a possible
                                                           loss  of   informa-
                                                           tion.

                                                           LOWERCASE - Convert
                                                           uppercase   letters
                                                           (A-Z)  to lowercase
                                                           (a-z).

                                                           MD5 - Calculate  an
                                                           MD5  hash  from the
                                                           data in the  input.
                                                           The  computed  hash
                                                           is in a raw  binary
                                                           form.

                                                           NONE - Specify NONE
                                                           if you  don't  want
                                                           any  text transfor-
                                                           mations.

                                                           NORMALIZE_PATH    -
                                                           Remove     multiple
                                                           slashes,  directory
                                                           self-references,
                                                           and       directory
                                                           back-references
                                                           that are not at the
                                                           beginning   of  the
                                                           input from an input
                                                           string.

                                                           NORMALIZE_PATH_WIN
                                                           - This is the  same
                                                           as NORMALIZE_PATH ,
                                                           but first  converts
                                                           backslash   charac-
                                                           ters   to   forward
                                                           slashes.

                                                           REMOVE_NULLS  - Re-
                                                           move all NULL bytes
                                                           from the input.

                                                           REPLACE_COMMENTS  -
                                                           Replace each occur-
                                                           rence  of a C-style
                                                           comment (/* ...  */
                                                           )   with  a  single
                                                           space.     Multiple
                                                           consecutive  occur-
                                                           rences are not com-
                                                           pressed.   Untermi-
                                                           nated comments  are
                                                           also  replaced with
                                                           a   space    (ASCII
                                                           0x20).  However,  a
                                                           standalone termina-
                                                           tion  of  a comment
                                                           (*/ ) is not  acted
                                                           upon.

                                                           REPLACE_NULLS - Re-
                                                           place NULL bytes in
                                                           the    input   with
                                                           space    characters
                                                           (ASCII 0x20 ).

                                                           SQL_HEX_DECODE    -
                                                           Decode   SQL    hex
                                                           data.       Example
                                                           (0x414243 ) will be
                                                           decoded to (ABC ).

                                                           URL_DECODE - Decode
                                                           a       URL-encoded
                                                           value.

                                                           URL_DECODE_UNI    -
                                                           Like  URL_DECODE  ,
                                                           but   with  support
                                                           for  Microsoft-spe-
                                                           cific  %u encoding.
                                                           If the code  is  in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E   ,   the
                                                           higher byte is used
                                                           to  detect  and ad-
                                                           just   the    lower
                                                           byte.    Otherwise,
                                                           only the lower byte
                                                           is   used  and  the
                                                           higher byte is  ze-
                                                           roed.

                                                           UTF8_TO_UNICODE   -
                                                           Convert  all  UTF-8
                                                           character sequences
                                                           to  Unicode.   This
                                                           helps input normal-
                                                           ization, and  mini-
                                                           mizing  false-posi-
                                                           tives           and
                                                           false-negatives for
                                                           non-English    lan-
                                                           guages.

                                          Cookie -> (structure)
                                             Use  the value of a cookie in the
                                             request as an aggregate key. Each
                                             distinct value in the cookie con-
                                             tributes to the  aggregation  in-
                                             stance.   If  you  use  a  single
                                             cookie as your custom  key,  then
                                             each  value  fully defines an ag-
                                             gregation instance.

                                             Name -> (string)
                                                 The name  of  the  cookie  to
                                                 use.

                                             TextTransformations -> (list)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection. Text trans-
                                                 formations are used  in  rule
                                                 match  statements,  to trans-
                                                 form the FieldToMatch request
                                                 component  before  inspecting
                                                 it,  and  they're   used   in
                                                 rate-based  rule  statements,
                                                 to transform  request  compo-
                                                 nents  before  using  them as
                                                 custom aggregation  keys.  If
                                                 you   specify   one  or  more
                                                 transformations to apply, WAF
                                                 performs  all transformations
                                                 on  the  specified   content,
                                                 starting from the lowest pri-
                                                 ority setting, and then  uses
                                                 the component contents.

                                                 (structure)
                                                    Text transformations elim-
                                                    inate some of the  unusual
                                                    formatting  that attackers
                                                    use in web requests in  an
                                                    effort  to  bypass  detec-
                                                    tion.

                                                    Priority -> (integer)
                                                        Sets the relative pro-
                                                        cessing order for mul-
                                                        tiple transformations.
                                                        WAF    processes   all
                                                        transformations,  from
                                                        lowest   priority   to
                                                        highest,  before   in-
                                                        specting   the  trans-
                                                        formed  content.   The
                                                        priorities  don't need
                                                        to be consecutive, but
                                                        they  must all be dif-
                                                        ferent.

                                                    Type -> (string)
                                                        You  can  specify  the
                                                        following  transforma-
                                                        tion types:
                                                           BASE64_DECODE - De-
                                                           code  a Base64 -en-
                                                           coded string.

                                                           BASE64_DECODE_EXT -
                                                           Decode   a   Base64
                                                           -encoded    string,
                                                           but use a forgiving
                                                           implementation that
                                                           ignores  characters
                                                           that aren't valid.

                                                           CMD_LINE   -   Com-
                                                           mand-line transfor-
                                                           mations. These  are
                                                           helpful in reducing
                                                           effectiveness    of
                                                           attackers  who  in-
                                                           ject  an  operating
                                                           system command-line
                                                           command and use un-
                                                           usual formatting to
                                                           disguise  some   or
                                                           all of the command.

                                                        o Delete the following
                                                          characters: \ " ' ^

                                                        o Delete spaces before
                                                          the  following char-
                                                          acters: / (

                                                        o Replace the  follow-
                                                          ing  characters with
                                                          a space: , ;

                                                        o Replace     multiple
                                                          spaces    with   one
                                                          space

                                                        o Convert    uppercase
                                                          letters   (A-Z)   to
                                                          lowercase (a-z)
                                                           COM-
                                                           PRESS_WHITE_SPACE -
                                                           Replace these char-
                                                           acters with a space
                                                           character  (decimal
                                                           32):

                                                        o \f , formfeed, deci-
                                                          mal 12

                                                        o \t , tab, decimal 9

                                                        o \n , newline,  deci-
                                                          mal 10

                                                        o \r  ,  carriage  re-
                                                          turn, decimal 13

                                                        o \v ,  vertical  tab,
                                                          decimal 11

                                                        o Non-breaking  space,
                                                          decimal 160
                                                           COM-
                                                           PRESS_WHITE_SPACE
                                                           also replaces  mul-
                                                           tiple  spaces  with
                                                           one space.

                                                           CSS_DECODE - Decode
                                                           characters     that
                                                           were encoded  using
                                                           CSS    2.x   escape
                                                           rules          syn-
                                                           data.html#charac-
                                                           ters .  This  func-
                                                           tion uses up to two
                                                           bytes in the decod-
                                                           ing  process, so it
                                                           can help to uncover
                                                           ASCII    characters
                                                           that  were  encoded
                                                           using  CSS encoding
                                                           that wouldnt  typi-
                                                           cally  be  encoded.
                                                           It's also useful in
                                                           countering evasion,
                                                           which is a combina-
                                                           tion of a backslash
                                                           and non-hexadecimal
                                                           characters. For ex-
                                                           ample,  ja\vascript
                                                           for javascript.

                                                           ESCAPE_SEQ_DECODE -
                                                           Decode the  follow-
                                                           ing  ANSI  C escape
                                                           sequences: \a ,  \b
                                                           , \f , \n , \r , \t
                                                           , \v , \\ , \? , \'
                                                           ,  \" , \xHH (hexa-
                                                           decimal),     \0OOO
                                                           (octal).  Encodings
                                                           that  aren't  valid
                                                           remain  in the out-
                                                           put.

                                                           HEX_DECODE - Decode
                                                           a  string  of hexa-
                                                           decimal  characters
                                                           into a binary.

                                                           HTML_ENTITY_DECODE
                                                           - Replace  HTML-en-
                                                           coded    characters
                                                           with      unencoded
                                                           characters.
                                                           HTML_ENTITY_DECODE
                                                           performs  these op-
                                                           erations:

                                                        o Replaces     (amper-
                                                          sand)quot; with "

                                                        o Replaces     (amper-
                                                          sand)nbsp;  with   a
                                                          non-breaking  space,
                                                          decimal 160

                                                        o Replaces     (amper-
                                                          sand)lt;    with   a
                                                          "less than" symbol

                                                        o Replaces     (amper-
                                                          sand)gt; with >

                                                        o Replaces  characters
                                                          that are represented
                                                          in  hexadecimal for-
                                                          mat, (ampersand)#xh-
                                                          hhh; , with the cor-
                                                          responding   charac-
                                                          ters

                                                        o Replaces  characters
                                                          that are represented
                                                          in  decimal  format,
                                                          (ampersand)#nnnn;  ,
                                                          with the correspond-
                                                          ing characters
                                                           JS_DECODE -  Decode
                                                           JavaScript   escape
                                                           sequences. If  a  \
                                                           u   HHHH code is in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E  ,   then
                                                           the  higher byte is
                                                           used to detect  and
                                                           adjust   the  lower
                                                           byte. If not,  only
                                                           the  lower  byte is
                                                           used and the higher
                                                           byte   is   zeroed,
                                                           causing a  possible
                                                           loss   of  informa-
                                                           tion.

                                                           LOWERCASE - Convert
                                                           uppercase   letters
                                                           (A-Z) to  lowercase
                                                           (a-z).

                                                           MD5  - Calculate an
                                                           MD5 hash  from  the
                                                           data  in the input.
                                                           The  computed  hash
                                                           is  in a raw binary
                                                           form.

                                                           NONE - Specify NONE
                                                           if  you  don't want
                                                           any text  transfor-
                                                           mations.

                                                           NORMALIZE_PATH    -
                                                           Remove     multiple
                                                           slashes,  directory
                                                           self-references,
                                                           and       directory
                                                           back-references
                                                           that are not at the
                                                           beginning  of   the
                                                           input from an input
                                                           string.

                                                           NORMALIZE_PATH_WIN
                                                           -  This is the same
                                                           as NORMALIZE_PATH ,
                                                           but  first converts
                                                           backslash   charac-
                                                           ters   to   forward
                                                           slashes.

                                                           REMOVE_NULLS -  Re-
                                                           move all NULL bytes
                                                           from the input.

                                                           REPLACE_COMMENTS  -
                                                           Replace each occur-
                                                           rence of a  C-style
                                                           comment  (/* ... */
                                                           )  with  a   single
                                                           space.     Multiple
                                                           consecutive  occur-
                                                           rences are not com-
                                                           pressed.   Untermi-
                                                           nated  comments are
                                                           also replaced  with
                                                           a    space   (ASCII
                                                           0x20).  However,  a
                                                           standalone termina-
                                                           tion of  a  comment
                                                           (*/  ) is not acted
                                                           upon.

                                                           REPLACE_NULLS - Re-
                                                           place NULL bytes in
                                                           the   input    with
                                                           space    characters
                                                           (ASCII 0x20 ).

                                                           SQL_HEX_DECODE    -
                                                           Decode    SQL   hex
                                                           data.       Example
                                                           (0x414243 ) will be
                                                           decoded to (ABC ).

                                                           URL_DECODE - Decode
                                                           a       URL-encoded
                                                           value.

                                                           URL_DECODE_UNI    -
                                                           Like  URL_DECODE  ,
                                                           but  with   support
                                                           for  Microsoft-spe-
                                                           cific %u  encoding.
                                                           If  the  code is in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E   ,   the
                                                           higher byte is used
                                                           to detect  and  ad-
                                                           just    the   lower
                                                           byte.    Otherwise,
                                                           only the lower byte
                                                           is  used  and   the
                                                           higher  byte is ze-
                                                           roed.

                                                           UTF8_TO_UNICODE   -
                                                           Convert  all  UTF-8
                                                           character sequences
                                                           to   Unicode.  This
                                                           helps input normal-
                                                           ization,  and mini-
                                                           mizing  false-posi-
                                                           tives           and
                                                           false-negatives for
                                                           non-English    lan-
                                                           guages.

                                          QueryArgument -> (structure)
                                             Use the specified query  argument
                                             as  an  aggregate  key. Each dis-
                                             tinct value for the  named  query
                                             argument  contributes  to the ag-
                                             gregation instance. If you use  a
                                             single  query  argument  as  your
                                             custom key, then each value fully
                                             defines an aggregation instance.

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to use.

                                             TextTransformations -> (list)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection. Text trans-
                                                 formations  are  used in rule
                                                 match statements,  to  trans-
                                                 form the FieldToMatch request
                                                 component  before  inspecting
                                                 it,   and   they're  used  in
                                                 rate-based  rule  statements,
                                                 to  transform  request compo-
                                                 nents before  using  them  as
                                                 custom  aggregation  keys. If
                                                 you  specify  one   or   more
                                                 transformations to apply, WAF
                                                 performs all  transformations
                                                 on   the  specified  content,
                                                 starting from the lowest pri-
                                                 ority  setting, and then uses
                                                 the component contents.

                                                 (structure)
                                                    Text transformations elim-
                                                    inate  some of the unusual
                                                    formatting that  attackers
                                                    use  in web requests in an
                                                    effort  to  bypass  detec-
                                                    tion.

                                                    Priority -> (integer)
                                                        Sets the relative pro-
                                                        cessing order for mul-
                                                        tiple transformations.
                                                        WAF   processes    all
                                                        transformations,  from
                                                        lowest   priority   to
                                                        highest,   before  in-
                                                        specting  the   trans-
                                                        formed   content.  The
                                                        priorities don't  need
                                                        to be consecutive, but
                                                        they must all be  dif-
                                                        ferent.

                                                    Type -> (string)
                                                        You  can  specify  the
                                                        following  transforma-
                                                        tion types:
                                                           BASE64_DECODE - De-
                                                           code a Base64  -en-
                                                           coded string.

                                                           BASE64_DECODE_EXT -
                                                           Decode   a   Base64
                                                           -encoded    string,
                                                           but use a forgiving
                                                           implementation that
                                                           ignores  characters
                                                           that aren't valid.

                                                           CMD_LINE   -   Com-
                                                           mand-line transfor-
                                                           mations.  These are
                                                           helpful in reducing
                                                           effectiveness    of
                                                           attackers  who  in-
                                                           ject  an  operating
                                                           system command-line
                                                           command and use un-
                                                           usual formatting to
                                                           disguise   some  or
                                                           all of the command.

                                                        o Delete the following
                                                          characters: \ " ' ^

                                                        o Delete spaces before
                                                          the following  char-
                                                          acters: / (

                                                        o Replace  the follow-
                                                          ing characters  with
                                                          a space: , ;

                                                        o Replace     multiple
                                                          spaces   with    one
                                                          space

                                                        o Convert    uppercase
                                                          letters   (A-Z)   to
                                                          lowercase (a-z)
                                                           COM-
                                                           PRESS_WHITE_SPACE -
                                                           Replace these char-
                                                           acters with a space
                                                           character  (decimal
                                                           32):

                                                        o \f , formfeed, deci-
                                                          mal 12

                                                        o \t , tab, decimal 9

                                                        o \n  , newline, deci-
                                                          mal 10

                                                        o \r  ,  carriage  re-
                                                          turn, decimal 13

                                                        o \v  ,  vertical tab,
                                                          decimal 11

                                                        o Non-breaking  space,
                                                          decimal 160
                                                           COM-
                                                           PRESS_WHITE_SPACE
                                                           also  replaces mul-
                                                           tiple  spaces  with
                                                           one space.

                                                           CSS_DECODE - Decode
                                                           characters     that
                                                           were  encoded using
                                                           CSS   2.x    escape
                                                           rules          syn-
                                                           data.html#charac-
                                                           ters  .  This func-
                                                           tion uses up to two
                                                           bytes in the decod-
                                                           ing process, so  it
                                                           can help to uncover
                                                           ASCII    characters
                                                           that  were  encoded
                                                           using CSS  encoding
                                                           that  wouldnt typi-
                                                           cally  be  encoded.
                                                           It's also useful in
                                                           countering evasion,
                                                           which is a combina-
                                                           tion of a backslash
                                                           and non-hexadecimal
                                                           characters. For ex-
                                                           ample,  ja\vascript
                                                           for javascript.

                                                           ESCAPE_SEQ_DECODE -
                                                           Decode  the follow-
                                                           ing ANSI  C  escape
                                                           sequences:  \a , \b
                                                           , \f , \n , \r , \t
                                                           , \v , \\ , \? , \'
                                                           , \" , \xHH  (hexa-
                                                           decimal),     \0OOO
                                                           (octal).  Encodings
                                                           that  aren't  valid
                                                           remain in the  out-
                                                           put.

                                                           HEX_DECODE - Decode
                                                           a string  of  hexa-
                                                           decimal  characters
                                                           into a binary.

                                                           HTML_ENTITY_DECODE
                                                           -  Replace HTML-en-
                                                           coded    characters
                                                           with      unencoded
                                                           characters.
                                                           HTML_ENTITY_DECODE
                                                           performs these  op-
                                                           erations:

                                                        o Replaces     (amper-
                                                          sand)quot; with "

                                                        o Replaces     (amper-
                                                          sand)nbsp;   with  a
                                                          non-breaking  space,
                                                          decimal 160

                                                        o Replaces     (amper-
                                                          sand)lt;   with    a
                                                          "less than" symbol

                                                        o Replaces     (amper-
                                                          sand)gt; with >

                                                        o Replaces  characters
                                                          that are represented
                                                          in hexadecimal  for-
                                                          mat, (ampersand)#xh-
                                                          hhh; , with the cor-
                                                          responding   charac-
                                                          ters

                                                        o Replaces  characters
                                                          that are represented
                                                          in  decimal  format,
                                                          (ampersand)#nnnn;  ,
                                                          with the correspond-
                                                          ing characters
                                                           JS_DECODE  - Decode
                                                           JavaScript   escape
                                                           sequences.  If  a \
                                                           u  HHHH code is  in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E   ,  then
                                                           the higher byte  is
                                                           used  to detect and
                                                           adjust  the   lower
                                                           byte.  If not, only
                                                           the lower  byte  is
                                                           used and the higher
                                                           byte   is   zeroed,
                                                           causing  a possible
                                                           loss  of   informa-
                                                           tion.

                                                           LOWERCASE - Convert
                                                           uppercase   letters
                                                           (A-Z)  to lowercase
                                                           (a-z).

                                                           MD5 - Calculate  an
                                                           MD5  hash  from the
                                                           data in the  input.
                                                           The  computed  hash
                                                           is in a raw  binary
                                                           form.

                                                           NONE - Specify NONE
                                                           if you  don't  want
                                                           any  text transfor-
                                                           mations.

                                                           NORMALIZE_PATH    -
                                                           Remove     multiple
                                                           slashes,  directory
                                                           self-references,
                                                           and       directory
                                                           back-references
                                                           that are not at the
                                                           beginning   of  the
                                                           input from an input
                                                           string.

                                                           NORMALIZE_PATH_WIN
                                                           - This is the  same
                                                           as NORMALIZE_PATH ,
                                                           but first  converts
                                                           backslash   charac-
                                                           ters   to   forward
                                                           slashes.

                                                           REMOVE_NULLS  - Re-
                                                           move all NULL bytes
                                                           from the input.

                                                           REPLACE_COMMENTS  -
                                                           Replace each occur-
                                                           rence  of a C-style
                                                           comment (/* ...  */
                                                           )   with  a  single
                                                           space.     Multiple
                                                           consecutive  occur-
                                                           rences are not com-
                                                           pressed.   Untermi-
                                                           nated comments  are
                                                           also  replaced with
                                                           a   space    (ASCII
                                                           0x20).  However,  a
                                                           standalone termina-
                                                           tion  of  a comment
                                                           (*/ ) is not  acted
                                                           upon.

                                                           REPLACE_NULLS - Re-
                                                           place NULL bytes in
                                                           the    input   with
                                                           space    characters
                                                           (ASCII 0x20 ).

                                                           SQL_HEX_DECODE    -
                                                           Decode   SQL    hex
                                                           data.       Example
                                                           (0x414243 ) will be
                                                           decoded to (ABC ).

                                                           URL_DECODE - Decode
                                                           a       URL-encoded
                                                           value.

                                                           URL_DECODE_UNI    -
                                                           Like  URL_DECODE  ,
                                                           but   with  support
                                                           for  Microsoft-spe-
                                                           cific  %u encoding.
                                                           If the code  is  in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E   ,   the
                                                           higher byte is used
                                                           to  detect  and ad-
                                                           just   the    lower
                                                           byte.    Otherwise,
                                                           only the lower byte
                                                           is   used  and  the
                                                           higher byte is  ze-
                                                           roed.

                                                           UTF8_TO_UNICODE   -
                                                           Convert  all  UTF-8
                                                           character sequences
                                                           to  Unicode.   This
                                                           helps input normal-
                                                           ization, and  mini-
                                                           mizing  false-posi-
                                                           tives           and
                                                           false-negatives for
                                                           non-English    lan-
                                                           guages.

                                          QueryString -> (structure)
                                             Use the request's query string as
                                             an aggregate key.  Each  distinct
                                             string  contributes to the aggre-
                                             gation instance. If you use  just
                                             the  query  string as your custom
                                             key, then each string  fully  de-
                                             fines an aggregation instance.

                                             TextTransformations -> (list)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection. Text trans-
                                                 formations are used  in  rule
                                                 match  statements,  to trans-
                                                 form the FieldToMatch request
                                                 component  before  inspecting
                                                 it,  and  they're   used   in
                                                 rate-based  rule  statements,
                                                 to transform  request  compo-
                                                 nents  before  using  them as
                                                 custom aggregation  keys.  If
                                                 you   specify   one  or  more
                                                 transformations to apply, WAF
                                                 performs  all transformations
                                                 on  the  specified   content,
                                                 starting from the lowest pri-
                                                 ority setting, and then  uses
                                                 the component contents.

                                                 (structure)
                                                    Text transformations elim-
                                                    inate some of the  unusual
                                                    formatting  that attackers
                                                    use in web requests in  an
                                                    effort  to  bypass  detec-
                                                    tion.

                                                    Priority -> (integer)
                                                        Sets the relative pro-
                                                        cessing order for mul-
                                                        tiple transformations.
                                                        WAF    processes   all
                                                        transformations,  from
                                                        lowest   priority   to
                                                        highest,  before   in-
                                                        specting   the  trans-
                                                        formed  content.   The
                                                        priorities  don't need
                                                        to be consecutive, but
                                                        they  must all be dif-
                                                        ferent.

                                                    Type -> (string)
                                                        You  can  specify  the
                                                        following  transforma-
                                                        tion types:
                                                           BASE64_DECODE - De-
                                                           code  a Base64 -en-
                                                           coded string.

                                                           BASE64_DECODE_EXT -
                                                           Decode   a   Base64
                                                           -encoded    string,
                                                           but use a forgiving
                                                           implementation that
                                                           ignores  characters
                                                           that aren't valid.

                                                           CMD_LINE   -   Com-
                                                           mand-line transfor-
                                                           mations. These  are
                                                           helpful in reducing
                                                           effectiveness    of
                                                           attackers  who  in-
                                                           ject  an  operating
                                                           system command-line
                                                           command and use un-
                                                           usual formatting to
                                                           disguise  some   or
                                                           all of the command.

                                                        o Delete the following
                                                          characters: \ " ' ^

                                                        o Delete spaces before
                                                          the  following char-
                                                          acters: / (

                                                        o Replace the  follow-
                                                          ing  characters with
                                                          a space: , ;

                                                        o Replace     multiple
                                                          spaces    with   one
                                                          space

                                                        o Convert    uppercase
                                                          letters   (A-Z)   to
                                                          lowercase (a-z)
                                                           COM-
                                                           PRESS_WHITE_SPACE -
                                                           Replace these char-
                                                           acters with a space
                                                           character  (decimal
                                                           32):

                                                        o \f , formfeed, deci-
                                                          mal 12

                                                        o \t , tab, decimal 9

                                                        o \n , newline,  deci-
                                                          mal 10

                                                        o \r  ,  carriage  re-
                                                          turn, decimal 13

                                                        o \v ,  vertical  tab,
                                                          decimal 11

                                                        o Non-breaking  space,
                                                          decimal 160
                                                           COM-
                                                           PRESS_WHITE_SPACE
                                                           also replaces  mul-
                                                           tiple  spaces  with
                                                           one space.

                                                           CSS_DECODE - Decode
                                                           characters     that
                                                           were encoded  using
                                                           CSS    2.x   escape
                                                           rules          syn-
                                                           data.html#charac-
                                                           ters .  This  func-
                                                           tion uses up to two
                                                           bytes in the decod-
                                                           ing  process, so it
                                                           can help to uncover
                                                           ASCII    characters
                                                           that  were  encoded
                                                           using  CSS encoding
                                                           that wouldnt  typi-
                                                           cally  be  encoded.
                                                           It's also useful in
                                                           countering evasion,
                                                           which is a combina-
                                                           tion of a backslash
                                                           and non-hexadecimal
                                                           characters. For ex-
                                                           ample,  ja\vascript
                                                           for javascript.

                                                           ESCAPE_SEQ_DECODE -
                                                           Decode the  follow-
                                                           ing  ANSI  C escape
                                                           sequences: \a ,  \b
                                                           , \f , \n , \r , \t
                                                           , \v , \\ , \? , \'
                                                           ,  \" , \xHH (hexa-
                                                           decimal),     \0OOO
                                                           (octal).  Encodings
                                                           that  aren't  valid
                                                           remain  in the out-
                                                           put.

                                                           HEX_DECODE - Decode
                                                           a  string  of hexa-
                                                           decimal  characters
                                                           into a binary.

                                                           HTML_ENTITY_DECODE
                                                           - Replace  HTML-en-
                                                           coded    characters
                                                           with      unencoded
                                                           characters.
                                                           HTML_ENTITY_DECODE
                                                           performs  these op-
                                                           erations:

                                                        o Replaces     (amper-
                                                          sand)quot; with "

                                                        o Replaces     (amper-
                                                          sand)nbsp;  with   a
                                                          non-breaking  space,
                                                          decimal 160

                                                        o Replaces     (amper-
                                                          sand)lt;    with   a
                                                          "less than" symbol

                                                        o Replaces     (amper-
                                                          sand)gt; with >

                                                        o Replaces  characters
                                                          that are represented
                                                          in  hexadecimal for-
                                                          mat, (ampersand)#xh-
                                                          hhh; , with the cor-
                                                          responding   charac-
                                                          ters

                                                        o Replaces  characters
                                                          that are represented
                                                          in  decimal  format,
                                                          (ampersand)#nnnn;  ,
                                                          with the correspond-
                                                          ing characters
                                                           JS_DECODE -  Decode
                                                           JavaScript   escape
                                                           sequences. If  a  \
                                                           u   HHHH code is in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E  ,   then
                                                           the  higher byte is
                                                           used to detect  and
                                                           adjust   the  lower
                                                           byte. If not,  only
                                                           the  lower  byte is
                                                           used and the higher
                                                           byte   is   zeroed,
                                                           causing a  possible
                                                           loss   of  informa-
                                                           tion.

                                                           LOWERCASE - Convert
                                                           uppercase   letters
                                                           (A-Z) to  lowercase
                                                           (a-z).

                                                           MD5  - Calculate an
                                                           MD5 hash  from  the
                                                           data  in the input.
                                                           The  computed  hash
                                                           is  in a raw binary
                                                           form.

                                                           NONE - Specify NONE
                                                           if  you  don't want
                                                           any text  transfor-
                                                           mations.

                                                           NORMALIZE_PATH    -
                                                           Remove     multiple
                                                           slashes,  directory
                                                           self-references,
                                                           and       directory
                                                           back-references
                                                           that are not at the
                                                           beginning  of   the
                                                           input from an input
                                                           string.

                                                           NORMALIZE_PATH_WIN
                                                           -  This is the same
                                                           as NORMALIZE_PATH ,
                                                           but  first converts
                                                           backslash   charac-
                                                           ters   to   forward
                                                           slashes.

                                                           REMOVE_NULLS -  Re-
                                                           move all NULL bytes
                                                           from the input.

                                                           REPLACE_COMMENTS  -
                                                           Replace each occur-
                                                           rence of a  C-style
                                                           comment  (/* ... */
                                                           )  with  a   single
                                                           space.     Multiple
                                                           consecutive  occur-
                                                           rences are not com-
                                                           pressed.   Untermi-
                                                           nated  comments are
                                                           also replaced  with
                                                           a    space   (ASCII
                                                           0x20).  However,  a
                                                           standalone termina-
                                                           tion of  a  comment
                                                           (*/  ) is not acted
                                                           upon.

                                                           REPLACE_NULLS - Re-
                                                           place NULL bytes in
                                                           the   input    with
                                                           space    characters
                                                           (ASCII 0x20 ).

                                                           SQL_HEX_DECODE    -
                                                           Decode    SQL   hex
                                                           data.       Example
                                                           (0x414243 ) will be
                                                           decoded to (ABC ).

                                                           URL_DECODE - Decode
                                                           a       URL-encoded
                                                           value.

                                                           URL_DECODE_UNI    -
                                                           Like  URL_DECODE  ,
                                                           but  with   support
                                                           for  Microsoft-spe-
                                                           cific %u  encoding.
                                                           If  the  code is in
                                                           the      full-width
                                                           ASCII code range of
                                                           FF01-FF5E   ,   the
                                                           higher byte is used
                                                           to detect  and  ad-
                                                           just    the   lower
                                                           byte.    Otherwise,
                                                           only the lower byte
                                                           is  used  and   the
                                                           higher  byte is ze-
                                                           roed.

                                                           UTF8_TO_UNICODE   -
                                                           Convert  all  UTF-8
                                                           character sequences
                                                           to   Unicode.  This
                                                           helps input normal-
                                                           ization,  and mini-
                                                           mizing  false-posi-
                                                           tives           and
                                                           false-negatives for
                                                           non-English    lan-
                                                           guages.

                                          HTTPMethod -> (structure)
                                             Use the request's HTTP method  as
                                             an  aggregate  key. Each distinct
                                             HTTP method  contributes  to  the
                                             aggregation  instance. If you use
                                             just the HTTP method as your cus-
                                             tom  key,  then each method fully
                                             defines an aggregation instance.

                                          ForwardedIP -> (structure)
                                             Use the first IP  address  in  an
                                             HTTP  header as an aggregate key.
                                             Each distinct  forwarded  IP  ad-
                                             dress contributes to the aggrega-
                                             tion instance.

                                             When you specify an  IP  or  for-
                                             warded  IP in the custom key set-
                                             tings, you must also  specify  at
                                             least  one  other key to use. You
                                             can aggregate on  only  the  for-
                                             warded  IP  address by specifying
                                             FORWARDED_IP in  your  rate-based
                                             statement's AggregateKeyType .

                                             With  this option, you must spec-
                                             ify the  header  to  use  in  the
                                             rate-based rule's ForwardedIPCon-
                                             fig property.

                                          IP -> (structure)
                                             Use the request's originating  IP
                                             address as an aggregate key. Each
                                             distinct IP  address  contributes
                                             to the aggregation instance.

                                             When  you  specify  an IP or for-
                                             warded IP in the custom key  set-
                                             tings,  you  must also specify at
                                             least one other key to  use.  You
                                             can  aggregate on only the IP ad-
                                             dress by specifying  IP  in  your
                                             rate-based   statement's   Aggre-
                                             gateKeyType .

                                          LabelNamespace -> (structure)
                                             Use the specified label namespace
                                             as  an  aggregate  key. Each dis-
                                             tinct fully qualified label  name
                                             that   has  the  specified  label
                                             namespace contributes to the  ag-
                                             gregation  instance.  If  you use
                                             just one label namespace as  your
                                             custom  key, then each label name
                                             fully defines an aggregation  in-
                                             stance.

                                             This  uses  only labels that have
                                             been  added  to  the  request  by
                                             rules  that  are evaluated before
                                             this rate-based rule in  the  web
                                             ACL.

                                             For information about label name-
                                             spaces and names, see Label  syn-
                                             tax  and  naming  requirements in
                                             the WAF Developer Guide .

                                             Namespace -> (string)
                                                 The namespace to use for  ag-
                                                 gregation.

                               AndStatement -> (structure)
                                   A  logical  rule  statement used to combine
                                   other rule statements with AND  logic.  You
                                   provide more than one  Statement within the
                                   AndStatement .

                                   Statements -> (list)
                                      The  statements  to  combine  with   AND
                                      logic.  You  can use any statements that
                                      can be nested.

                                      ( ... recursive ... )

                               OrStatement -> (structure)
                                   A logical rule statement  used  to  combine
                                   other  rule  statements  with OR logic. You
                                   provide more than one  Statement within the
                                   OrStatement .

                                   Statements -> (list)
                                      The statements to combine with OR logic.
                                      You can use any statements that  can  be
                                      nested.

                                      ( ... recursive ... )

                               NotStatement -> (structure)
                                   A logical rule statement used to negate the
                                   results of another rule statement. You pro-
                                   vide one  Statement within the NotStatement
                                   .

                                   ( ... recursive ... )

                               ManagedRuleGroupStatement -> (structure)
                                   A rule statement used to run the rules that
                                   are defined in a managed rule group. To use
                                   this, provide the vendor name and the  name
                                   of  the  rule  group in this statement. You
                                   can retrieve the required names by  calling
                                   ListAvailableManagedRuleGroups .

                                   You cannot nest a ManagedRuleGroupStatement
                                   , for example for use inside a NotStatement
                                   or  OrStatement . It can only be referenced
                                   as a top-level statement within a rule.

                                   NOTE:
                                      You are charged additional fees when you
                                      use  the  WAF  Bot  Control managed rule
                                      group   AWSManagedRulesBotControlRuleSet
                                      or  the  WAF Fraud Control account take-
                                      over prevention (ATP) managed rule group
                                      AWSManagedRulesATPRuleSet . For more in-
                                      formation, see WAF Pricing .

                                   VendorName -> (string)
                                      The name of the managed rule group  ven-
                                      dor.  You  use this, along with the rule
                                      group name, to identify a rule group.

                                   Name -> (string)
                                      The name of the managed rule group.  You
                                      use this, along with the vendor name, to
                                      identify the rule group.

                                   Version -> (string)
                                      The version of the managed rule group to
                                      use.  If  you  specify this, the version
                                      setting is fixed until you change it. If
                                      you  don't  specify  this,  WAF uses the
                                      vendor's default version, and then keeps
                                      the version at the vendor's default when
                                      the  vendor  updates  the  managed  rule
                                      group settings.

                                   ExcludedRules -> (list)
                                      Rules in the referenced rule group whose
                                      actions are set to Count .

                                      NOTE:
                                          Instead of this option, use  RuleAc-
                                          tionOverrides . It accepts any valid
                                          action setting, including Count .

                                      (structure)
                                          Specifies a single rule  in  a  rule
                                          group whose action you want to over-
                                          ride to Count .

                                          NOTE:
                                             Instead of this option, use Rule-
                                             ActionOverrides  . It accepts any
                                             valid action  setting,  including
                                             Count .

                                          Name -> (string)
                                             The name of the rule whose action
                                             you want to override to Count .

                                   ( ... recursive  ...  )ManagedRuleGroupCon-
                                   figs -> (list)
                                      Additional  information that's used by a
                                      managed rule group.  Many  managed  rule
                                      groups don't require this.

                                      Use  the  AWSManagedRulesATPRuleSet con-
                                      figuration object for the account  take-
                                      over  prevention  managed rule group, to
                                      provide information such as the  sign-in
                                      page of your application and the type of
                                      content to accept  or  reject  from  the
                                      client.

                                      Use the AWSManagedRulesBotControlRuleSet
                                      configuration object  to  configure  the
                                      protection  level  that you want the Bot
                                      Control rule group to use.

                                      (structure)
                                          Additional information  that's  used
                                          by  a  managed rule group. Many man-
                                          aged rule groups don't require this.

                                          Use  the   AWSManagedRulesATPRuleSet
                                          configuration object for the account
                                          takeover  prevention  managed   rule
                                          group,  to  provide information such
                                          as the sign-in page of your applica-
                                          tion  and the type of content to ac-
                                          cept or reject from the client.

                                          Use  the  AWSManagedRulesBotControl-
                                          RuleSet configuration object to con-
                                          figure the protection level that you
                                          want  the  Bot Control rule group to
                                          use.

                                          For example specifications, see  the
                                          examples section of  CreateWebACL .

                                          LoginPath -> (string)

                                             NOTE:
                                                 Instead of this setting, pro-
                                                 vide your configuration under
                                                 AWSManagedRulesATPRuleSet .

                                          PayloadType -> (string)

                                             NOTE:
                                                 Instead of this setting, pro-
                                                 vide your configuration under
                                                 AWSManagedRulesATPRuleSet
                                                 RequestInspection .

                                          UsernameField -> (structure)

                                             NOTE:
                                                 Instead of this setting, pro-
                                                 vide your configuration under
                                                 AWSManagedRulesATPRuleSet
                                                 RequestInspection .

                                             Identifier -> (string)
                                                 The   name  of  the  username
                                                 field.      For       example
                                                 /form/username .

                                          PasswordField -> (structure)

                                             NOTE:
                                                 Instead of this setting, pro-
                                                 vide your configuration under
                                                 AWSManagedRulesATPRuleSet
                                                 RequestInspection .

                                             Identifier -> (string)
                                                 The  name  of  the   password
                                                 field.       For      example
                                                 /form/password .

                                          AWSManagedRulesBotControlRuleSet  ->
                                          (structure)
                                             Additional  configuration for us-
                                             ing the Bot Control managed  rule
                                             group.  Use  this  to specify the
                                             inspection level that you want to
                                             use.  For information about using
                                             the  Bot  Control  managed   rule
                                             group,  see  WAF Bot Control rule
                                             group and WAF Bot Control in  the
                                             WAF Developer Guide .

                                             InspectionLevel -> (string)
                                                 The  inspection  level to use
                                                 for  the  Bot  Control   rule
                                                 group.  The  common  level is
                                                 the least expensive. The tar-
                                                 geted level includes all com-
                                                 mon  level  rules  and   adds
                                                 rules  with more advanced in-
                                                 spection  criteria.  For  de-
                                                 tails,  see  WAF  Bot Control
                                                 rule group in the WAF  Devel-
                                                 oper Guide .

                                          AWSManagedRulesATPRuleSet -> (struc-
                                          ture)
                                             Additional configuration for  us-
                                             ing  the account takeover preven-
                                             tion (ATP)  managed  rule  group,
                                             AWSManagedRulesATPRuleSet  .  Use
                                             this to provide login request in-
                                             formation  to the rule group. For
                                             web ACLs that protect  CloudFront
                                             distributions,  use  this to also
                                             provide the information about how
                                             your distribution responds to lo-
                                             gin requests.

                                             This configuration  replaces  the
                                             individual  configuration  fields
                                             in   ManagedRuleGroupConfig   and
                                             provides  additional feature con-
                                             figuration.

                                             For information about  using  the
                                             ATP  managed  rule group, see WAF
                                             Fraud  Control  account  takeover
                                             prevention  (ATP)  rule group and
                                             WAF Fraud Control  account  take-
                                             over  prevention (ATP) in the WAF
                                             Developer Guide .

                                             LoginPath -> (string)
                                                 The path of  the  login  end-
                                                 point  for  your application.
                                                 For  example,  for  the   URL
                                                 https://example.com/web/login
                                                 , you would provide the  path
                                                 /web/login .

                                                 The  rule group inspects only
                                                 HTTP POST  requests  to  your
                                                 specified login endpoint.

                                             RequestInspection -> (structure)
                                                 The  criteria  for inspecting
                                                 login requests, used  by  the
                                                 ATP  rule  group  to validate
                                                 credentials usage.

                                                 PayloadType -> (string)
                                                    The payload type for  your
                                                    login   endpoint,   either
                                                    JSON or form encoded.

                                                 UsernameField -> (structure)
                                                    Details about  your  login
                                                    page username field.

                                                    How  you  specify this de-
                                                    pends on the payload type.

                                                    o For JSON payloads, spec-
                                                      ify  the  field  name in
                                                      JSON pointer syntax. For
                                                      information   about  the
                                                      JSON Pointer syntax, see
                                                      the Internet Engineering
                                                      Task Force (IETF)  docu-
                                                      mentation JavaScript Ob-
                                                      ject   Notation   (JSON)
                                                      Pointer  .  For example,
                                                      for the JSON  payload  {
                                                      "login":  {  "username":
                                                      "THE_USERNAME",   "pass-
                                                      word":  "THE_PASSWORD" }
                                                      } , the  username  field
                                                      specification   is  /lo-
                                                      gin/username   and   the
                                                      password  field specifi-
                                                      cation  is  /login/pass-
                                                      word .

                                                    o For form encoded payload
                                                      types, use the HTML form
                                                      names.  For example, for
                                                      an HTML form with  input
                                                      elements named username1
                                                      and  password1   ,   the
                                                      username  field specifi-
                                                      cation is username1  and
                                                      the password field spec-
                                                      ification is password1 .

                                                    Identifier -> (string)
                                                        The name of the  user-
                                                        name  field. For exam-
                                                        ple /form/username .

                                                 PasswordField -> (structure)
                                                    Details about  your  login
                                                    page password field.

                                                    How  you  specify this de-
                                                    pends on the payload type.

                                                    o For JSON payloads, spec-
                                                      ify  the  field  name in
                                                      JSON pointer syntax. For
                                                      information   about  the
                                                      JSON Pointer syntax, see
                                                      the Internet Engineering
                                                      Task Force (IETF)  docu-
                                                      mentation JavaScript Ob-
                                                      ject   Notation   (JSON)
                                                      Pointer  .  For example,
                                                      for the JSON  payload  {
                                                      "login":  {  "username":
                                                      "THE_USERNAME",   "pass-
                                                      word":  "THE_PASSWORD" }
                                                      } , the  username  field
                                                      specification   is  /lo-
                                                      gin/username   and   the
                                                      password  field specifi-
                                                      cation  is  /login/pass-
                                                      word .

                                                    o For form encoded payload
                                                      types, use the HTML form
                                                      names.  For example, for
                                                      an HTML form with  input
                                                      elements named username1
                                                      and  password1   ,   the
                                                      username  field specifi-
                                                      cation is username1  and
                                                      the password field spec-
                                                      ification is password1 .

                                                    Identifier -> (string)
                                                        The name of the  pass-
                                                        word  field. For exam-
                                                        ple /form/password .

                                             ResponseInspection -> (structure)
                                                 The criteria  for  inspecting
                                                 responses  to login requests,
                                                 used by the ATP rule group to
                                                 track login failure rates.

                                                 The  ATP rule group evaluates
                                                 the responses that your  pro-
                                                 tected resources send back to
                                                 client login attempts,  keep-
                                                 ing  count  of successful and
                                                 failed attempts from each  IP
                                                 address  and  client session.
                                                 Using this  information,  the
                                                 rule  group  labels and miti-
                                                 gates  requests  from  client
                                                 sessions   and  IP  addresses
                                                 that submit too  many  failed
                                                 login  attempts  in  a  short
                                                 amount of time.

                                                 NOTE:
                                                    Response   inspection   is
                                                    available only in web ACLs
                                                    that protect Amazon Cloud-
                                                    Front distributions.

                                                 StatusCode -> (structure)
                                                    Configures  inspection  of
                                                    the response status code.

                                                    SuccessCodes -> (list)
                                                        Status  codes  in  the
                                                        response that indicate
                                                        a successful login at-
                                                        tempt.  To  be counted
                                                        as a successful login,
                                                        the   response  status
                                                        code must match one of
                                                        these.  Each code must
                                                        be  unique  among  the
                                                        success   and  failure
                                                        status codes.

                                                        JSON  example:   "Suc-
                                                        cessCodes": [ 200, 201
                                                        ]

                                                        (integer)

                                                    FailureCodes -> (list)
                                                        Status  codes  in  the
                                                        response that indicate
                                                        a  failed  login   at-
                                                        tempt.  To  be counted
                                                        as a failed login, the
                                                        response  status  code
                                                        must  match   one   of
                                                        these.  Each code must
                                                        be  unique  among  the
                                                        success   and  failure
                                                        status codes.

                                                        JSON  example:  "Fail-
                                                        ureCodes":  [ 400, 404
                                                        ]

                                                        (integer)

                                                 Header -> (structure)
                                                    Configures  inspection  of
                                                    the response header.

                                                    Name -> (string)
                                                        The name of the header
                                                        to match against.  The
                                                        name  must be an exact
                                                        match, including case.

                                                        JSON example:  "Name":
                                                        [ "LoginResult" ]

                                                    SuccessValues -> (list)
                                                        Values in the response
                                                        header with the speci-
                                                        fied  name  that indi-
                                                        cate a successful  lo-
                                                        gin   attempt.  To  be
                                                        counted as a  success-
                                                        ful  login,  the value
                                                        must   be   an   exact
                                                        match, including case.
                                                        Each  value  must   be
                                                        unique  among the suc-
                                                        cess and failure  val-
                                                        ues.

                                                        JSON   example:  "Suc-
                                                        cessValues": [ "Login-
                                                        Passed",   "Successful
                                                        login" ]

                                                        (string)

                                                    FailureValues -> (list)
                                                        Values in the response
                                                        header with the speci-
                                                        fied name  that  indi-
                                                        cate  a  failed  login
                                                        attempt. To be counted
                                                        as a failed login, the
                                                        value must be an exact
                                                        match, including case.
                                                        Each  value  must   be
                                                        unique  among the suc-
                                                        cess and failure  val-
                                                        ues.

                                                        JSON  example:  "Fail-
                                                        ureValues": [  "Login-
                                                        Failed",  "Failed  lo-
                                                        gin" ]

                                                        (string)

                                                 BodyContains -> (structure)
                                                    Configures  inspection  of
                                                    the response body. WAF can
                                                    inspect the  first  65,536
                                                    bytes  (64  KB) of the re-
                                                    sponse body.

                                                    SuccessStrings -> (list)
                                                        Strings in the body of
                                                        the  response that in-
                                                        dicate  a   successful
                                                        login  attempt.  To be
                                                        counted as a  success-
                                                        ful  login, the string
                                                        can be anywhere in the
                                                        body  and  must  be an
                                                        exact match, including
                                                        case. Each string must
                                                        be  unique  among  the
                                                        success   and  failure
                                                        strings.

                                                        JSON  example:   "Suc-
                                                        cessStrings": [ "Login
                                                        successful",  "Welcome
                                                        to our site!" ]

                                                        (string)

                                                    FailureStrings -> (list)
                                                        Strings in the body of
                                                        the response that  in-
                                                        dicate  a failed login
                                                        attempt. To be counted
                                                        as a failed login, the
                                                        string can be anywhere
                                                        in  the  body and must
                                                        be an exact match, in-
                                                        cluding   case.   Each
                                                        string must be  unique
                                                        among  the success and
                                                        failure strings.

                                                        JSON  example:  "Fail-
                                                        ureStrings":  [ "Login
                                                        failed" ]

                                                        (string)

                                                 Json -> (structure)
                                                    Configures  inspection  of
                                                    the response JSON. WAF can
                                                    inspect the  first  65,536
                                                    bytes  (64  KB) of the re-
                                                    sponse JSON.

                                                    Identifier -> (string)
                                                        The identifier for the
                                                        value to match against
                                                        in the JSON. The iden-
                                                        tifier  must be an ex-
                                                        act  match,  including
                                                        case.

                                                        JSON example: "Identi-
                                                        fier": [  "/login/suc-
                                                        cess" ]

                                                    SuccessValues -> (list)
                                                        Values  for the speci-
                                                        fied identifier in the
                                                        response JSON that in-
                                                        dicate  a   successful
                                                        login  attempt.  To be
                                                        counted as a  success-
                                                        ful  login,  the value
                                                        must   be   an   exact
                                                        match, including case.
                                                        Each  value  must   be
                                                        unique  among the suc-
                                                        cess and failure  val-
                                                        ues.

                                                        JSON   example:  "Suc-
                                                        cessValues": [ "True",
                                                        "Succeeded" ]

                                                        (string)

                                                    FailureValues -> (list)
                                                        Values  for the speci-
                                                        fied identifier in the
                                                        response JSON that in-
                                                        dicate a failed  login
                                                        attempt. To be counted
                                                        as a failed login, the
                                                        value must be an exact
                                                        match, including case.
                                                        Each   value  must  be
                                                        unique among the  suc-
                                                        cess  and failure val-
                                                        ues.

                                                        JSON  example:  "Fail-
                                                        ureValues": [ "False",
                                                        "Failed" ]

                                                        (string)

                                   RuleActionOverrides -> (list)
                                      Action settings to use in the  place  of
                                      the rule actions that are configured in-
                                      side the rule  group.  You  specify  one
                                      override  for each rule whose action you
                                      want to change.

                                      You can use overrides for  testing,  for
                                      example you can override all of rule ac-
                                      tions to Count and then monitor the  re-
                                      sulting  count metrics to understand how
                                      the rule group  would  handle  your  web
                                      traffic.  You can also permanently over-
                                      ride some or all actions, to modify  how
                                      the rule group manages your web traffic.

                                      (structure)
                                          Action  setting  to use in the place
                                          of a rule action that is  configured
                                          inside  the  rule group. You specify
                                          one override for each rule whose ac-
                                          tion you want to change.

                                          You  can  use overrides for testing,
                                          for example you can override all  of
                                          rule actions to Count and then moni-
                                          tor the resulting count  metrics  to
                                          understand  how the rule group would
                                          handle your  web  traffic.  You  can
                                          also  permanently  override  some or
                                          all actions, to modify how the  rule
                                          group manages your web traffic.

                                          Name -> (string)
                                             The name of the rule to override.

                                          ActionToUse -> (structure)
                                             The  override  action  to use, in
                                             place of the configured action of
                                             the rule in the rule group.

                                             Block -> (structure)
                                                 Instructs  WAF  to  block the
                                                 web request.

                                                 CustomResponse -> (structure)
                                                    Defines a custom  response
                                                    for the web request.

                                                    For information about cus-
                                                    tomizing web requests  and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in  WAF  in the WAF Devel-
                                                    oper Guide .

                                                    ResponseCode -> (integer)
                                                        The HTTP  status  code
                                                        to   return   to   the
                                                        client.

                                                        For a list  of  status
                                                        codes that you can use
                                                        in  your  custom   re-
                                                        sponses, see Supported
                                                        status codes for  cus-
                                                        tom  response  in  the
                                                        WAF Developer Guide .

                                                    CustomResponseBodyKey   ->
                                                    (string)
                                                        References   the   re-
                                                        sponse body  that  you
                                                        want  WAF to return to
                                                        the    web     request
                                                        client. You can define
                                                        a custom response  for
                                                        a rule action or a de-
                                                        fault web  ACL  action
                                                        that  is set to block.
                                                        To do this, you  first
                                                        define   the  response
                                                        body key and value  in
                                                        the CustomResponseBod-
                                                        ies  setting  for  the
                                                        WebACL  or   RuleGroup
                                                        where you want to  use
                                                        it.  Then, in the rule
                                                        action or web ACL  de-
                                                        fault  action BlockAc-
                                                        tion setting, you ref-
                                                        erence   the  response
                                                        body using this key.

                                                    ResponseHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        use  in  the response.
                                                        Duplicate header names
                                                        are not allowed.

                                                        For  information about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas in the WAF  Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom request  and
                                                           response  handling.
                                                           This  is  used   in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For custom  re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are already  in
                                                               the    request.
                                                               For    example,
                                                               for  the header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The  value   of
                                                               the      custom
                                                               header.

                                             Allow -> (structure)
                                                 Instructs WAF  to  allow  the
                                                 web request.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines  custom   handling
                                                    for the web request.

                                                    For information about cus-
                                                    tomizing web requests  and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in  WAF  in the WAF Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header  names  are not
                                                        allowed.

                                                        For information  about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas  in the WAF Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom  request and
                                                           response  handling.
                                                           This   is  used  in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For  custom re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are  already in
                                                               the    request.
                                                               For    example,
                                                               for the  header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The   value  of
                                                               the      custom
                                                               header.

                                             Count -> (structure)
                                                 Instructs  WAF  to  count the
                                                 web request and then continue
                                                 evaluating  the request using
                                                 the remaining  rules  in  the
                                                 web ACL.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines  custom   handling
                                                    for the web request.

                                                    For information about cus-
                                                    tomizing web requests  and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in  WAF  in the WAF Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header  names  are not
                                                        allowed.

                                                        For information  about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas  in the WAF Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom  request and
                                                           response  handling.
                                                           This   is  used  in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For  custom re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are  already in
                                                               the    request.
                                                               For    example,
                                                               for the  header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The   value  of
                                                               the      custom
                                                               header.

                                             Captcha -> (structure)
                                                 Instructs   WAF   to   run  a
                                                 CAPTCHA check against the web
                                                 request.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines  custom   handling
                                                    for  the web request, used
                                                    when the  CAPTCHA  inspec-
                                                    tion  determines  that the
                                                    request's token  is  valid
                                                    and unexpired.

                                                    For information about cus-
                                                    tomizing web requests  and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in  WAF  in the WAF Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header  names  are not
                                                        allowed.

                                                        For information  about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas  in the WAF Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom  request and
                                                           response  handling.
                                                           This   is  used  in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For  custom re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are  already in
                                                               the    request.
                                                               For    example,
                                                               for the  header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The   value  of
                                                               the      custom
                                                               header.

                                             Challenge -> (structure)
                                                 Instructs  WAF to run a Chal-
                                                 lenge check against  the  web
                                                 request.

                                                 CustomRequestHandling      ->
                                                 (structure)
                                                    Defines  custom   handling
                                                    for  the web request, used
                                                    when the challenge inspec-
                                                    tion  determines  that the
                                                    request's token  is  valid
                                                    and unexpired.

                                                    For information about cus-
                                                    tomizing web requests  and
                                                    responses, see Customizing
                                                    web requests and responses
                                                    in  WAF  in the WAF Devel-
                                                    oper Guide .

                                                    InsertHeaders -> (list)
                                                        The  HTTP  headers  to
                                                        insert  into  the  re-
                                                        quest.       Duplicate
                                                        header  names  are not
                                                        allowed.

                                                        For information  about
                                                        the  limits  on  count
                                                        and  size  for  custom
                                                        request  and  response
                                                        settings, see WAF quo-
                                                        tas  in the WAF Devel-
                                                        oper Guide .

                                                        (structure)
                                                           A custom header for
                                                           custom  request and
                                                           response  handling.
                                                           This   is  used  in
                                                           CustomResponse  and
                                                           CustomRe-
                                                           questHandling .

                                                           Name -> (string)
                                                               The name of the
                                                               custom header.

                                                               For  custom re-
                                                               quest    header
                                                               insertion, when
                                                               WAF inserts the
                                                               header into the
                                                               request,     it
                                                               prefixes   this
                                                               name
                                                               x-amzn-waf-   ,
                                                               to avoid confu-
                                                               sion  with  the
                                                               headers    that
                                                               are  already in
                                                               the    request.
                                                               For    example,
                                                               for the  header
                                                               name  sample  ,
                                                               WAF inserts the
                                                               header
                                                               x-amzn-waf-sam-
                                                               ple .

                                                           Value -> (string)
                                                               The   value  of
                                                               the      custom
                                                               header.

                               LabelMatchStatement -> (structure)
                                   A  rule  statement  to match against labels
                                   that have been added to the web request  by
                                   rules that have already run in the web ACL.

                                   The  label match statement provides the la-
                                   bel or namespace string to search for.  The
                                   label string can represent a part or all of
                                   the fully qualified  label  name  that  had
                                   been added to the web request. Fully quali-
                                   fied labels have a prefix,  optional  name-
                                   spaces,  and label name. The prefix identi-
                                   fies the rule group or web ACL  context  of
                                   the  rule  that  added the label. If you do
                                   not provide the  fully  qualified  name  in
                                   your  label  match string, WAF performs the
                                   search for labels that were  added  in  the
                                   same context as the label match statement.

                                   Scope -> (string)
                                      Specify  whether you want to match using
                                      the label name or just the namespace.

                                   Key -> (string)
                                      The string to match against. The setting
                                      you  provide  for  this  depends  on the
                                      match statement's Scope setting:

                                      o If the Scope indicates  LABEL  ,  then
                                        this  specification  must  include the
                                        name and can  include  any  number  of
                                        preceding namespace specifications and
                                        prefix up to providing the fully qual-
                                        ified label name.

                                      o If  the  Scope  indicates  NAMESPACE ,
                                        then this  specification  can  include
                                        any  number  of  contiguous  namespace
                                        strings, and can  include  the  entire
                                        label  namespace  prefix from the rule
                                        group or web ACL where the label orig-
                                        inates.

                                      Labels are case sensitive and components
                                      of a label must be separated  by  colon,
                                      for example NS1:NS2:name .

                               RegexMatchStatement -> (structure)
                                   A rule statement used to search web request
                                   components for a  match  against  a  single
                                   regular expression.

                                   RegexString -> (string)
                                      The  string representing the regular ex-
                                      pression.

                                   FieldToMatch -> (structure)
                                      The part of the  web  request  that  you
                                      want WAF to inspect.

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Alternately,  you can filter and in-
                                          spect all headers with  the  Headers
                                          FieldToMatch setting.

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect  the  request URI path. This
                                          is the part of the web request  that
                                          identifies  a resource, for example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect the query  string.  This  is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect the request  body  as  plain
                                          text.  The  request body immediately
                                          follows the request headers. This is
                                          the  part of a request that contains
                                          any additional data that you want to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          A limited amount of the request body
                                          is forwarded to WAF  for  inspection
                                          by  the underlying host service. For
                                          regional resources, the limit  is  8
                                          KB  (8,192 kilobytes) and for Cloud-
                                          Front distributions, the limit is 16
                                          KB  (16,384  kilobytes).  For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the  limit  in the web ACL's
                                          AssociationConfig ,  for  additional
                                          processing fees.

                                          For  information about how to handle
                                          oversized request  bodies,  see  the
                                          Body object configuration.

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger than WAF can inspect.  WAF
                                             does  not  support inspecting the
                                             entire contents of  the  web  re-
                                             quest  body  if  the body exceeds
                                             the limit for the resource  type.
                                             If  the  body  is larger than the
                                             limit, the underlying  host  ser-
                                             vice  only  forwards the contents
                                             that are below the limit  to  WAF
                                             for inspection.

                                             The  default limit is 8 KB (8,192
                                             kilobytes) for regional resources
                                             and  16 KB (16,384 kilobytes) for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig   ,  for  addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able  body  contents  normally,
                                               according  to  the rule inspec-
                                               tion criteria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling  with  your rule and web
                                             ACL action settings, so that  you
                                             block  any  request whose body is
                                             over the limit.

                                             Default: CONTINUE

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          A limited amount of the request body
                                          is  forwarded  to WAF for inspection
                                          by the underlying host service.  For
                                          regional  resources,  the limit is 8
                                          KB (8,192 kilobytes) and for  Cloud-
                                          Front distributions, the limit is 16
                                          KB (16,384  kilobytes).  For  Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in  the  web  ACL's
                                          AssociationConfig  ,  for additional
                                          processing fees.

                                          For information about how to  handle
                                          oversized  request  bodies,  see the
                                          JsonBody object configuration.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                          OversizeHandling -> (string)
                                             What WAF should do if the body is
                                             larger  than WAF can inspect. WAF
                                             does not support  inspecting  the
                                             entire  contents  of  the web re-
                                             quest body if  the  body  exceeds
                                             the  limit for the resource type.
                                             If the body is  larger  than  the
                                             limit,  the  underlying host ser-
                                             vice only forwards  the  contents
                                             that  are  below the limit to WAF
                                             for inspection.

                                             The default limit is 8 KB  (8,192
                                             kilobytes) for regional resources
                                             and 16 KB (16,384 kilobytes)  for
                                             CloudFront   distributions.   For
                                             CloudFront distributions, you can
                                             increase the limit in the web ACL
                                             AssociationConfig  ,  for   addi-
                                             tional processing fees.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  body  contents  normally,
                                               according to the  rule  inspec-
                                               tion criteria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             You  can  combine  the  MATCH  or
                                             NO_MATCH  settings  for  oversize
                                             handling with your rule  and  web
                                             ACL  action settings, so that you
                                             block any request whose  body  is
                                             over the limit.

                                             Default: CONTINUE

                                      Headers -> (structure)
                                          Inspect  the  request  headers.  You
                                          must  configure  scope  and  pattern
                                          matching  filters in the Headers ob-
                                          ject, to define the set  of  headers
                                          to and the parts of the headers that
                                          WAF inspects.

                                          Only the first 8 KB (8192 bytes)  of
                                          a  request's  headers  and  only the
                                          first 200 headers are  forwarded  to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to  handle  any oversize header con-
                                          tent in the Headers object. WAF  ap-
                                          plies  the  pattern matching filters
                                          to the headers that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of headers to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting: either All ,  IncludedHead-
                                             ers , or ExcludedHeaders .

                                             Example  JSON:  "MatchPattern": {
                                             "ExcludedHeaders":     {"KeyToEx-
                                             clude1", "KeyToExclude2"} }

                                             All -> (structure)
                                                 Inspect all headers.

                                             IncludedHeaders -> (list)
                                                 Inspect only the headers that
                                                 have a key that  matches  one
                                                 of   the   strings  specified
                                                 here.

                                                 (string)

                                             ExcludedHeaders -> (list)
                                                 Inspect  only   the   headers
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the headers to match
                                             with  the  rule inspection crite-
                                             ria. If you specify All , WAF in-
                                             spects both keys and values.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             headers when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total head-
                                             ers. The underlying host  service
                                             forwards a maximum of 200 headers
                                             and at most 8 KB of  header  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  headers normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                      Cookies -> (structure)
                                          Inspect  the  request  cookies.  You
                                          must  configure  scope  and  pattern
                                          matching filters in the Cookies  ob-
                                          ject,  to  define the set of cookies
                                          and the parts of  the  cookies  that
                                          WAF inspects.

                                          Only  the first 8 KB (8192 bytes) of
                                          a request's  cookies  and  only  the
                                          first  200  cookies are forwarded to
                                          WAF for inspection by the underlying
                                          host service. You must configure how
                                          to handle any oversize  cookie  con-
                                          tent  in the Cookies object. WAF ap-
                                          plies the pattern  matching  filters
                                          to the cookies that it receives from
                                          the underlying host service.

                                          MatchPattern -> (structure)
                                             The filter to use to identify the
                                             subset of cookies to inspect in a
                                             web request.

                                             You must specify exactly one set-
                                             ting:  either All , IncludedCook-
                                             ies , or ExcludedCookies .

                                             Example JSON:  "MatchPattern":  {
                                             "IncludedCookies":     {"KeyToIn-
                                             clude1",  "KeyToInclude2",  "Key-
                                             ToInclude3"} }

                                             All -> (structure)
                                                 Inspect all cookies.

                                             IncludedCookies -> (list)
                                                 Inspect only the cookies that
                                                 have a key that  matches  one
                                                 of   the   strings  specified
                                                 here.

                                                 (string)

                                             ExcludedCookies -> (list)
                                                 Inspect  only   the   cookies
                                                 whose keys don't match any of
                                                 the strings specified here.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the cookies  to  in-
                                             spect  with  the  rule inspection
                                             criteria. If you  specify  All  ,
                                             WAF  inspects  both keys and val-
                                             ues.

                                          OversizeHandling -> (string)
                                             What WAF should do if the cookies
                                             of  the request are more numerous
                                             or larger than WAF  can  inspect.
                                             WAF  does  not support inspecting
                                             the entire  contents  of  request
                                             cookies  when  they  exceed  8 KB
                                             (8192 bytes) or 200  total  cook-
                                             ies.  The underlying host service
                                             forwards a maximum of 200 cookies
                                             and  at  most 8 KB of cookie con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE  -  Inspect the avail-
                                               able cookies normally,  accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                      HeaderOrder -> (structure)
                                          Inspect a string containing the list
                                          of the request's header  names,  or-
                                          dered  as they appear in the web re-
                                          quest that WAF receives for  inspec-
                                          tion.  WAF  generates the string and
                                          then uses that as the field to match
                                          component  in  its  inspection.  WAF
                                          separates the header  names  in  the
                                          string  using  commas  and  no added
                                          spaces.

                                          Matches  against  the  header  order
                                          string are case insensitive.

                                          OversizeHandling -> (string)
                                             What WAF should do if the headers
                                             of the request are more  numerous
                                             or  larger  than WAF can inspect.
                                             WAF does not  support  inspecting
                                             the  entire  contents  of request
                                             headers when  they  exceed  8  KB
                                             (8192  bytes)  or 200 total head-
                                             ers. The underlying host  service
                                             forwards a maximum of 200 headers
                                             and at most 8 KB of  header  con-
                                             tents to WAF.

                                             The options for oversize handling
                                             are the following:

                                             o CONTINUE - Inspect  the  avail-
                                               able  headers normally, accord-
                                               ing to the rule inspection cri-
                                               teria.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection. Text transformations are
                                      used in rule match statements, to trans-
                                      form  the FieldToMatch request component
                                      before inspecting it, and  they're  used
                                      in rate-based rule statements, to trans-
                                      form  request  components  before  using
                                      them  as custom aggregation keys. If you
                                      specify one or more  transformations  to
                                      apply,  WAF performs all transformations
                                      on the specified content, starting  from
                                      the  lowest  priority  setting, and then
                                      uses the component contents.

                                      (structure)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets  the relative processing or-
                                             der for multiple transformations.
                                             WAF   processes  all  transforma-
                                             tions, from  lowest  priority  to
                                             highest,  before  inspecting  the
                                             transformed content. The  priori-
                                             ties  don't  need  to be consecu-
                                             tive, but they must all  be  dif-
                                             ferent.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                     NotStatement -> (structure)
                        A logical rule statement used to negate the results of
                        another  rule  statement.  You  provide one  Statement
                        within the NotStatement .

                        Statement -> (structure)
                            The statement to negate. You can use any statement
                            that can be nested.

                            ByteMatchStatement -> (structure)
                               A  rule  statement  that defines a string match
                               search for WAF to apply to  web  requests.  The
                               byte  match  statement  provides  the  bytes to
                               search for, the location in requests  that  you
                               want  WAF  to  search,  and other settings. The
                               bytes to search for are typically a string that
                               corresponds  with  ASCII characters. In the WAF
                               console and the developer guide, this is called
                               a string match statement.

                               SearchString -> (blob)
                                   A  string value that you want WAF to search
                                   for. WAF searches only in the part  of  web
                                   requests  that you designate for inspection
                                   in  FieldToMatch . The  maximum  length  of
                                   the value is 200 bytes.

                                   Valid  values  depend on the component that
                                   you specify for inspection in  FieldToMatch
                                   :

                                   o Method  :  The  HTTP method that you want
                                     WAF to search  for.  This  indicates  the
                                     type  of  operation  specified in the re-
                                     quest.

                                   o UriPath : The value that you want WAF  to
                                     search  for in the URI path, for example,
                                     /images/daily-ad.jpg .

                                   o HeaderOrder : The comma-separated list of
                                     header  names to match for. WAF creates a
                                     string that contains the ordered list  of
                                     header names, from the headers in the web
                                     request, and then  matches  against  that
                                     string.

                                   If SearchString includes alphabetic charac-
                                   ters A-Z and a-z, note that  the  value  is
                                   case sensitive.
                                      If you're using the WAF API

                                   Specify  a  base64-encoded  version  of the
                                   value. The maximum length of the value  be-
                                   fore you base64-encode it is 200 bytes.

                                   For  example,  suppose the value of Type is
                                   HEADER and the value of Data is  User-Agent
                                   .  If  you  want  to  search the User-Agent
                                   header  for  the   value   BadBot   ,   you
                                   base64-encode  BadBot using MIME base64-en-
                                   coding and include the resulting value, Qm-
                                   FkQm90 , in the value of SearchString .
                                      If  you're  using  the CLI or one of the
                                      Amazon Web Services SDKs

                                   The value that you want WAF to search  for.
                                   The  SDK  automatically  base64 encodes the
                                   value.

                               FieldToMatch -> (structure)
                                   The part of the web request that  you  want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Alternately,  you can filter and inspect
                                      all headers  with  the  Headers   Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the part of the web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A  limited amount of the request body is
                                      forwarded to WAF for inspection  by  the
                                      underlying  host  service.  For regional
                                      resources, the  limit  is  8  KB  (8,192
                                      kilobytes)  and for CloudFront distribu-
                                      tions, the limit is 16 KB (16,384  kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you can increase the limit  in  the  web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized  request  bodies, see the Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      A  limited amount of the request body is
                                      forwarded to WAF for inspection  by  the
                                      underlying  host  service.  For regional
                                      resources, the  limit  is  8  KB  (8,192
                                      kilobytes)  and for CloudFront distribu-
                                      tions, the limit is 16 KB (16,384  kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you can increase the limit  in  the  web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized  request bodies, see the Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect the request  headers.  You  must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the  set  of headers to and the parts of
                                      the headers that WAF inspects.

                                      Only the first 8 KB (8192  bytes)  of  a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must configure how to handle  any  over-
                                      size  header  content in the Headers ob-
                                      ject. WAF applies the  pattern  matching
                                      filters  to the headers that it receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The filter to use  to  identify  the
                                          subset  of  headers  to inspect in a
                                          web request.

                                          You must specify  exactly  one  set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have  a  key  that matches one of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect only  the  headers  whose
                                             keys   don't  match  any  of  the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The parts of the  headers  to  match
                                          with  the  rule inspection criteria.
                                          If you specify All  ,  WAF  inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  headers
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total headers. The underlying
                                          host service forwards a  maximum  of
                                          200  headers  and  at  most  8 KB of
                                          header contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect the request  cookies.  You  must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the  set of cookies and the parts of the
                                      cookies that WAF inspects.

                                      Only the first 8 KB (8192  bytes)  of  a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must configure how to handle  any  over-
                                      size  cookie  content in the Cookies ob-
                                      ject. WAF applies the  pattern  matching
                                      filters  to the cookies that it receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The filter to use  to  identify  the
                                          subset  of  cookies  to inspect in a
                                          web request.

                                          You must specify  exactly  one  set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have  a  key  that matches one of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect only  the  cookies  whose
                                             keys   don't  match  any  of  the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The parts of the cookies to  inspect
                                          with  the  rule inspection criteria.
                                          If you specify All  ,  WAF  inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  cookies
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total cookies. The underlying
                                          host service forwards a  maximum  of
                                          200  cookies  and  at  most  8 KB of
                                          cookie contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect a string containing the list  of
                                      the  request's  header names, ordered as
                                      they appear in the web request that  WAF
                                      receives  for  inspection. WAF generates
                                      the string and then  uses  that  as  the
                                      field  to match component in its inspec-
                                      tion. WAF separates the header names  in
                                      the  string  using  commas  and no added
                                      spaces.

                                      Matches against the header order  string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  headers
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total headers. The underlying
                                          host service forwards a  maximum  of
                                          200  headers  and  at  most  8 KB of
                                          header contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion. Text transformations are used in rule
                                   match statements, to transform  the  Field-
                                   ToMatch request component before inspecting
                                   it, and they're  used  in  rate-based  rule
                                   statements, to transform request components
                                   before using  them  as  custom  aggregation
                                   keys.  If you specify one or more transfor-
                                   mations to apply, WAF performs  all  trans-
                                   formations on the specified content, start-
                                   ing from the lowest priority  setting,  and
                                   then uses the component contents.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations.  WAF
                                          processes all transformations,  from
                                          lowest  priority  to highest, before
                                          inspecting the transformed  content.
                                          The priorities don't need to be con-
                                          secutive, but they must all be  dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                               PositionalConstraint -> (string)
                                   The area within the portion of the web  re-
                                   quest  that  you  want  WAF  to  search for
                                   SearchString .  Valid  values  include  the
                                   following:
                                      CONTAINS

                                   The  specified part of the web request must
                                   include the value of SearchString , but the
                                   location doesn't matter.
                                      CONTAINS_WORD

                                   The  specified part of the web request must
                                   include the value  of  SearchString  ,  and
                                   SearchString must contain only alphanumeric
                                   characters or underscore (A-Z, a-z, 0-9, or
                                   _).  In  addition,  SearchString  must be a
                                   word, which means that both of the  follow-
                                   ing are true:

                                   o SearchString  is  at the beginning of the
                                     specified part of the web request  or  is
                                     preceded by a character other than an al-
                                     phanumeric character or  underscore  (_).
                                     Examples  include  the  value of a header
                                     and ;BadBot .

                                   o SearchString is at the end of the  speci-
                                     fied  part  of the web request or is fol-
                                     lowed by a character other  than  an  al-
                                     phanumeric  character  or underscore (_),
                                     for example, BadBot; and -BadBot; .
                                      EXACTLY

                                   The value of the specified part of the  web
                                   request  must  exactly  match  the value of
                                   SearchString .
                                      STARTS_WITH

                                   The value of SearchString  must  appear  at
                                   the  beginning of the specified part of the
                                   web request.
                                      ENDS_WITH

                                   The value of SearchString  must  appear  at
                                   the  end  of  the specified part of the web
                                   request.

                            SqliMatchStatement -> (structure)
                               A rule statement that  inspects  for  malicious
                               SQL  code.  Attackers insert malicious SQL code
                               into web requests to do things like modify your
                               database or extract data from it.

                               FieldToMatch -> (structure)
                                   The  part  of the web request that you want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Alternately, you can filter and  inspect
                                      all  headers  with  the  Headers  Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of the web request that identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see  the  Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see the  Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect  the  request  headers. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the set of headers to and the  parts  of
                                      the headers that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size header content in the  Headers  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the headers that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of headers to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect  only  the  headers whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the headers to match
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect  the  request  cookies. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the set of cookies and the parts of  the
                                      cookies that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size cookie content in the  Cookies  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the cookies that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of cookies to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect  only  the  cookies whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts of the cookies to inspect
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  cookies
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total cookies. The underlying
                                          host  service  forwards a maximum of
                                          200 cookies and  at  most  8  KB  of
                                          cookie contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect  a string containing the list of
                                      the request's header names,  ordered  as
                                      they  appear in the web request that WAF
                                      receives for inspection.  WAF  generates
                                      the  string  and  then  uses that as the
                                      field to match component in its  inspec-
                                      tion.  WAF separates the header names in
                                      the string using  commas  and  no  added
                                      spaces.

                                      Matches  against the header order string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. Text transformations are used in rule
                                   match  statements,  to transform the Field-
                                   ToMatch request component before inspecting
                                   it,  and  they're  used  in rate-based rule
                                   statements, to transform request components
                                   before  using  them  as  custom aggregation
                                   keys. If you specify one or more  transfor-
                                   mations  to  apply, WAF performs all trans-
                                   formations on the specified content, start-
                                   ing  from  the lowest priority setting, and
                                   then uses the component contents.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations.  WAF
                                          processes  all transformations, from
                                          lowest priority to  highest,  before
                                          inspecting  the transformed content.
                                          The priorities don't need to be con-
                                          secutive,  but they must all be dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                               SensitivityLevel -> (string)
                                   The sensitivity that you want WAF to use to
                                   inspect for SQL injection attacks.
                                      HIGH detects  more  attacks,  but  might
                                      generate  more  false  positives,  espe-
                                      cially if your web  requests  frequently
                                      contain unusual strings. For information
                                      about identifying and  mitigating  false
                                      positives, see Testing and tuning in the
                                      WAF Developer Guide .

                                      LOW is generally a better choice for re-
                                      sources  that already have other protec-
                                      tions against SQL injection  attacks  or
                                      that have a low tolerance for false pos-
                                      itives.

                                   Default: LOW

                            XssMatchStatement -> (structure)
                               A rule statement that inspects  for  cross-site
                               scripting  (XSS)  attacks.  In XSS attacks, the
                               attacker uses vulnerabilities in a benign  web-
                               site   as   a   vehicle   to  inject  malicious
                               client-site scripts into other  legitimate  web
                               browsers.

                               FieldToMatch -> (structure)
                                   The  part  of the web request that you want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Alternately, you can filter and  inspect
                                      all  headers  with  the  Headers  Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of the web request that identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see  the  Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see the  Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect  the  request  headers. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the set of headers to and the  parts  of
                                      the headers that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size header content in the  Headers  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the headers that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of headers to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect  only  the  headers whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the headers to match
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect  the  request  cookies. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the set of cookies and the parts of  the
                                      cookies that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size cookie content in the  Cookies  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the cookies that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of cookies to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect  only  the  cookies whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts of the cookies to inspect
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  cookies
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total cookies. The underlying
                                          host  service  forwards a maximum of
                                          200 cookies and  at  most  8  KB  of
                                          cookie contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect  a string containing the list of
                                      the request's header names,  ordered  as
                                      they  appear in the web request that WAF
                                      receives for inspection.  WAF  generates
                                      the  string  and  then  uses that as the
                                      field to match component in its  inspec-
                                      tion.  WAF separates the header names in
                                      the string using  commas  and  no  added
                                      spaces.

                                      Matches  against the header order string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. Text transformations are used in rule
                                   match  statements,  to transform the Field-
                                   ToMatch request component before inspecting
                                   it,  and  they're  used  in rate-based rule
                                   statements, to transform request components
                                   before  using  them  as  custom aggregation
                                   keys. If you specify one or more  transfor-
                                   mations  to  apply, WAF performs all trans-
                                   formations on the specified content, start-
                                   ing  from  the lowest priority setting, and
                                   then uses the component contents.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations.  WAF
                                          processes  all transformations, from
                                          lowest priority to  highest,  before
                                          inspecting  the transformed content.
                                          The priorities don't need to be con-
                                          secutive,  but they must all be dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            SizeConstraintStatement -> (structure)
                               A  rule  statement  that  compares  a number of
                               bytes against the size of a request  component,
                               using  a  comparison  operator, such as greater
                               than (>) or less than (<). For example, you can
                               use  a  size  constraint  statement to look for
                               query strings that are longer than 100 bytes.

                               If you configure WAF  to  inspect  the  request
                               body,  WAF inspects only the number of bytes of
                               the body up to the limit for the  web  ACL.  By
                               default, for regional web ACLs, this limit is 8
                               KB (8,192 kilobytes)  and  for  CloudFront  web
                               ACLs,  this  limit is 16 KB (16,384 kilobytes).
                               For CloudFront web ACLs, you can  increase  the
                               limit  in  the  web ACL AssociationConfig , for
                               additional fees. If you know that  the  request
                               body  for your web requests should never exceed
                               the inspection limit, you could use a size con-
                               straint statement to block requests that have a
                               larger request body size.

                               If you choose URI for the value of Part of  the
                               request  to filter on, the slash (/) in the URI
                               counts as one character. For example,  the  URI
                               /logo.jpg is nine characters long.

                               FieldToMatch -> (structure)
                                   The  part  of the web request that you want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Alternately, you can filter and  inspect
                                      all  headers  with  the  Headers  Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of the web request that identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see  the  Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see the  Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect  the  request  headers. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the set of headers to and the  parts  of
                                      the headers that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size header content in the  Headers  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the headers that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of headers to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect  only  the  headers whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the headers to match
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect  the  request  cookies. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the set of cookies and the parts of  the
                                      cookies that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size cookie content in the  Cookies  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the cookies that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of cookies to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect  only  the  cookies whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts of the cookies to inspect
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  cookies
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total cookies. The underlying
                                          host  service  forwards a maximum of
                                          200 cookies and  at  most  8  KB  of
                                          cookie contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect  a string containing the list of
                                      the request's header names,  ordered  as
                                      they  appear in the web request that WAF
                                      receives for inspection.  WAF  generates
                                      the  string  and  then  uses that as the
                                      field to match component in its  inspec-
                                      tion.  WAF separates the header names in
                                      the string using  commas  and  no  added
                                      spaces.

                                      Matches  against the header order string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               ComparisonOperator -> (string)
                                   The  operator to use to compare the request
                                   part to the size setting.

                               Size -> (long)
                                   The size, in byte, to compare  to  the  re-
                                   quest part, after any transformations.

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. Text transformations are used in rule
                                   match  statements,  to transform the Field-
                                   ToMatch request component before inspecting
                                   it,  and  they're  used  in rate-based rule
                                   statements, to transform request components
                                   before  using  them  as  custom aggregation
                                   keys. If you specify one or more  transfor-
                                   mations  to  apply, WAF performs all trans-
                                   formations on the specified content, start-
                                   ing  from  the lowest priority setting, and
                                   then uses the component contents.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations.  WAF
                                          processes  all transformations, from
                                          lowest priority to  highest,  before
                                          inspecting  the transformed content.
                                          The priorities don't need to be con-
                                          secutive,  but they must all be dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            GeoMatchStatement -> (structure)
                               A  rule  statement  that labels web requests by
                               country and region and that matches against web
                               requests  based  on  country  code. A geo match
                               rule labels every request that it inspects  re-
                               gardless of whether it finds a match.

                               o To  manage  requests only by country, you can
                                 use this statement by itself and specify  the
                                 countries  that  you want to match against in
                                 the CountryCodes array.

                               o Otherwise, configure your geo match rule with
                                 Count action so that it only labels requests.
                                 Then, add one or more label  match  rules  to
                                 run  after  the  geo match rule and configure
                                 them to match against the  geographic  labels
                                 and handle the requests as needed.

                               WAF  labels  requests using the alpha-2 country
                               and region codes from the International Organi-
                               zation for Standardization (ISO) 3166 standard.
                               WAF determines the codes using  either  the  IP
                               address  in  the  web request origin or, if you
                               specify it, the address in the geo  match  For-
                               wardedIPConfig .

                               If  you  use  the web request origin, the label
                               formats   are   awswaf:clientip:geo:region:<ISO
                               country code>-<ISO region code> and awswaf:cli-
                               entip:geo:country:<ISO country code> .

                               If you use a forwarded IP  address,  the  label
                               formats  are awswaf:forwardedip:geo:region:<ISO
                               country code>-<ISO region code> and awswaf:for-
                               wardedip:geo:country:<ISO country code> .

                               For  additional  details,  see Geographic match
                               rule statement in the WAF Developer Guide .

                               CountryCodes -> (list)
                                   An array  of  two-character  country  codes
                                   that  you  want to match against, for exam-
                                   ple, [ "US", "CN"  ]  ,  from  the  alpha-2
                                   country  ISO codes of the ISO 3166 interna-
                                   tional standard.

                                   When you use a geo match statement just for
                                   the  region and country labels that it adds
                                   to requests, you still  have  to  supply  a
                                   country  code  for the rule to evaluate. In
                                   this case, you configure the rule  to  only
                                   count  matching requests, but it will still
                                   generate logging and count metrics for  any
                                   matches.  You  can  reduce  the logging and
                                   metrics that the rule produces by  specify-
                                   ing  a  country  that's  unlikely  to  be a
                                   source of traffic to your site.

                                   (string)

                               ForwardedIPConfig -> (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The  name  of the HTTP header to use for
                                      the IP address. For example, to use  the
                                      X-Forwarded-For  (XFF)  header, set this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The  match  status  to assign to the web
                                      request if the request  doesn't  have  a
                                      valid  IP address in the specified posi-
                                      tion.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      You  can  specify the following fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching  the  rule statement. WAF ap-
                                        plies the rule action to the request.

                                      o NO_MATCH - Treat the  web  request  as
                                        not matching the rule statement.

                            RuleGroupReferenceStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined in a  RuleGroup . To use this, create a
                               rule  group  with  your rules, then provide the
                               ARN of the rule group in this statement.

                               You cannot nest a RuleGroupReferenceStatement ,
                               for  example  for  use inside a NotStatement or
                               OrStatement . You can only  use  a  rule  group
                               reference  statement  at the top level inside a
                               web ACL.

                               ARN -> (string)
                                   The Amazon Resource Name (ARN) of  the  en-
                                   tity.

                               ExcludedRules -> (list)
                                   Rules  in  the  referenced rule group whose
                                   actions are set to Count .

                                   NOTE:
                                      Instead  of  this  option,  use  RuleAc-
                                      tionOverrides . It accepts any valid ac-
                                      tion setting, including Count .

                                   (structure)
                                      Specifies a single rule in a rule  group
                                      whose  action  you  want  to override to
                                      Count .

                                      NOTE:
                                          Instead of this option, use  RuleAc-
                                          tionOverrides . It accepts any valid
                                          action setting, including Count .

                                      Name -> (string)
                                          The name of the  rule  whose  action
                                          you want to override to Count .

                               RuleActionOverrides -> (list)
                                   Action  settings to use in the place of the
                                   rule actions that are configured inside the
                                   rule  group.  You  specify one override for
                                   each rule whose action you want to change.

                                   You can use overrides for testing, for  ex-
                                   ample  you can override all of rule actions
                                   to Count and  then  monitor  the  resulting
                                   count  metrics  to  understand how the rule
                                   group would handle your  web  traffic.  You
                                   can  also  permanently override some or all
                                   actions, to modify how the rule group  man-
                                   ages your web traffic.

                                   (structure)
                                      Action  setting to use in the place of a
                                      rule action that  is  configured  inside
                                      the rule group. You specify one override
                                      for each rule whose action you  want  to
                                      change.

                                      You  can  use overrides for testing, for
                                      example you can override all of rule ac-
                                      tions  to Count and then monitor the re-
                                      sulting count metrics to understand  how
                                      the  rule  group  would  handle your web
                                      traffic. You can also permanently  over-
                                      ride  some or all actions, to modify how
                                      the rule group manages your web traffic.

                                      Name -> (string)
                                          The name of the rule to override.

                                      ActionToUse -> (structure)
                                          The override action to use, in place
                                          of the configured action of the rule
                                          in the rule group.

                                          Block -> (structure)
                                             Instructs WAF to  block  the  web
                                             request.

                                             CustomResponse -> (structure)
                                                 Defines a custom response for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses, see Customizing  web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 ResponseCode -> (integer)
                                                    The HTTP  status  code  to
                                                    return to the client.

                                                    For a list of status codes
                                                    that you can use  in  your
                                                    custom    responses,   see
                                                    Supported status codes for
                                                    custom response in the WAF
                                                    Developer Guide .

                                                 CustomResponseBodyKey      ->
                                                 (string)
                                                    References   the  response
                                                    body that you want WAF  to
                                                    return  to the web request
                                                    client. You can  define  a
                                                    custom response for a rule
                                                    action or  a  default  web
                                                    ACL  action that is set to
                                                    block.  To  do  this,  you
                                                    first  define the response
                                                    body key and value in  the
                                                    CustomResponseBodies  set-
                                                    ting for  the   WebACL  or
                                                    RuleGroup  where  you want
                                                    to use it.  Then,  in  the
                                                    rule action or web ACL de-
                                                    fault  action  BlockAction
                                                    setting, you reference the
                                                    response body  using  this
                                                    key.

                                                 ResponseHeaders -> (list)
                                                    The HTTP headers to use in
                                                    the  response.   Duplicate
                                                    header  names  are not al-
                                                    lowed.

                                                    For information about  the
                                                    limits  on  count and size
                                                    for custom request and re-
                                                    sponse  settings,  see WAF
                                                    quotas in the  WAF  Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse  handling. This
                                                        is used in   CustomRe-
                                                        sponse  and  CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The  name  of   the
                                                           custom header.

                                                           For  custom request
                                                           header   insertion,
                                                           when   WAF  inserts
                                                           the header into the
                                                           request,   it  pre-
                                                           fixes   this   name
                                                           x-amzn-waf-   ,  to
                                                           avoid     confusion
                                                           with   the  headers
                                                           that are already in
                                                           the   request.  For
                                                           example,  for   the
                                                           header  name sample
                                                           , WAF  inserts  the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Allow -> (structure)
                                             Instructs  WAF  to  allow the web
                                             request.

                                             CustomRequestHandling ->  (struc-
                                             ture)
                                                 Defines  custom  handling for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses, see Customizing  web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into  the  request. Dupli-
                                                    cate header names are  not
                                                    allowed.

                                                    For  information about the
                                                    limits on count  and  size
                                                    for custom request and re-
                                                    sponse settings,  see  WAF
                                                    quotas  in  the WAF Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse handling.  This
                                                        is  used in  CustomRe-
                                                        sponse and   CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The   name  of  the
                                                           custom header.

                                                           For custom  request
                                                           header   insertion,
                                                           when  WAF   inserts
                                                           the header into the
                                                           request,  it   pre-
                                                           fixes   this   name
                                                           x-amzn-waf-  ,   to
                                                           avoid     confusion
                                                           with  the   headers
                                                           that are already in
                                                           the  request.   For
                                                           example,   for  the
                                                           header name  sample
                                                           ,  WAF  inserts the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Count -> (structure)
                                             Instructs WAF to  count  the  web
                                             request  and then continue evalu-
                                             ating the request using  the  re-
                                             maining rules in the web ACL.

                                             CustomRequestHandling  -> (struc-
                                             ture)
                                                 Defines custom  handling  for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses,  see Customizing web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into the  request.  Dupli-
                                                    cate  header names are not
                                                    allowed.

                                                    For information about  the
                                                    limits  on  count and size
                                                    for custom request and re-
                                                    sponse  settings,  see WAF
                                                    quotas in the  WAF  Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse  handling. This
                                                        is used in   CustomRe-
                                                        sponse  and  CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The  name  of   the
                                                           custom header.

                                                           For  custom request
                                                           header   insertion,
                                                           when   WAF  inserts
                                                           the header into the
                                                           request,   it  pre-
                                                           fixes   this   name
                                                           x-amzn-waf-   ,  to
                                                           avoid     confusion
                                                           with   the  headers
                                                           that are already in
                                                           the   request.  For
                                                           example,  for   the
                                                           header  name sample
                                                           , WAF  inserts  the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Captcha -> (structure)
                                             Instructs  WAF  to  run a CAPTCHA
                                             check against the web request.

                                             CustomRequestHandling ->  (struc-
                                             ture)
                                                 Defines  custom  handling for
                                                 the web  request,  used  when
                                                 the CAPTCHA inspection deter-
                                                 mines that the request's  to-
                                                 ken is valid and unexpired.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses,  see Customizing web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into the  request.  Dupli-
                                                    cate  header names are not
                                                    allowed.

                                                    For information about  the
                                                    limits  on  count and size
                                                    for custom request and re-
                                                    sponse  settings,  see WAF
                                                    quotas in the  WAF  Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse  handling. This
                                                        is used in   CustomRe-
                                                        sponse  and  CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The  name  of   the
                                                           custom header.

                                                           For  custom request
                                                           header   insertion,
                                                           when   WAF  inserts
                                                           the header into the
                                                           request,   it  pre-
                                                           fixes   this   name
                                                           x-amzn-waf-   ,  to
                                                           avoid     confusion
                                                           with   the  headers
                                                           that are already in
                                                           the   request.  For
                                                           example,  for   the
                                                           header  name sample
                                                           , WAF  inserts  the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Challenge -> (structure)
                                             Instructs  WAF to run a Challenge
                                             check against the web request.

                                             CustomRequestHandling ->  (struc-
                                             ture)
                                                 Defines  custom  handling for
                                                 the web  request,  used  when
                                                 the  challenge inspection de-
                                                 termines that  the  request's
                                                 token is valid and unexpired.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses,  see Customizing web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into the  request.  Dupli-
                                                    cate  header names are not
                                                    allowed.

                                                    For information about  the
                                                    limits  on  count and size
                                                    for custom request and re-
                                                    sponse  settings,  see WAF
                                                    quotas in the  WAF  Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse  handling. This
                                                        is used in   CustomRe-
                                                        sponse  and  CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The  name  of   the
                                                           custom header.

                                                           For  custom request
                                                           header   insertion,
                                                           when   WAF  inserts
                                                           the header into the
                                                           request,   it  pre-
                                                           fixes   this   name
                                                           x-amzn-waf-   ,  to
                                                           avoid     confusion
                                                           with   the  headers
                                                           that are already in
                                                           the   request.  For
                                                           example,  for   the
                                                           header  name sample
                                                           , WAF  inserts  the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                            IPSetReferenceStatement -> (structure)
                               A  rule  statement  used to detect web requests
                               coming from particular IP addresses or  address
                               ranges.  To  use  this,  create  an  IPSet that
                               specifies the addresses  you  want  to  detect,
                               then use the ARN of that set in this statement.
                               To create an IP set, see  CreateIPSet .

                               Each IP set rule  statement  references  an  IP
                               set.  You  create and maintain the set indepen-
                               dent of your rules. This allows you to use  the
                               single  set  in multiple rules. When you update
                               the referenced set, WAF  automatically  updates
                               all rules that reference it.

                               ARN -> (string)
                                   The  Amazon  Resource  Name  (ARN)  of  the
                                   IPSet that this statement references.

                               IPSetForwardedIPConfig -> (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The  name  of the HTTP header to use for
                                      the IP address. For example, to use  the
                                      X-Forwarded-For  (XFF)  header, set this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The  match  status  to assign to the web
                                      request if the request  doesn't  have  a
                                      valid  IP address in the specified posi-
                                      tion.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      You  can  specify the following fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching  the  rule statement. WAF ap-
                                        plies the rule action to the request.

                                      o NO_MATCH - Treat the  web  request  as
                                        not matching the rule statement.

                                   Position -> (string)
                                      The position in the header to search for
                                      the IP address. The header  can  contain
                                      IP  addresses of the original client and
                                      also of proxies. For example, the header
                                      value   could  be  10.1.1.1,  127.0.0.0,
                                      10.10.10.10 where the first  IP  address
                                      identifies  the  original client and the
                                      rest identify proxies that  the  request
                                      went through.

                                      The  options  for  this  setting are the
                                      following:

                                      o FIRST - Inspect the first  IP  address
                                        in  the  list  of  IP addresses in the
                                        header. This is usually  the  client's
                                        original IP.

                                      o LAST  - Inspect the last IP address in
                                        the  list  of  IP  addresses  in   the
                                        header.

                                      o ANY  - Inspect all IP addresses in the
                                        header for a match. If the header con-
                                        tains  more  than 10 IP addresses, WAF
                                        inspects the last 10.

                            RegexPatternSetReferenceStatement -> (structure)
                               A rule statement used  to  search  web  request
                               components  for  matches  with  regular expres-
                               sions. To use this, create  a   RegexPatternSet
                               that specifies the expressions that you want to
                               detect, then use the ARN of that  set  in  this
                               statement.  A  web  request matches the pattern
                               set rule statement  if  the  request  component
                               matches any of the patterns in the set. To cre-
                               ate a regex pattern set,  see   CreateRegexPat-
                               ternSet .

                               Each  regex  pattern  set rule statement refer-
                               ences a regex pattern set. You create and main-
                               tain  the  set  independent of your rules. This
                               allows you to use the single  set  in  multiple
                               rules.  When you update the referenced set, WAF
                               automatically updates all rules that  reference
                               it.

                               ARN -> (string)
                                   The Amazon Resource Name (ARN) of the  Reg-
                                   exPatternSet  that  this  statement  refer-
                                   ences.

                               FieldToMatch -> (structure)
                                   The  part  of the web request that you want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Alternately, you can filter and  inspect
                                      all  headers  with  the  Headers  Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of the web request that identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see  the  Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see the  Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect  the  request  headers. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the set of headers to and the  parts  of
                                      the headers that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size header content in the  Headers  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the headers that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of headers to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect  only  the  headers whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the headers to match
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect  the  request  cookies. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the set of cookies and the parts of  the
                                      cookies that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size cookie content in the  Cookies  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the cookies that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of cookies to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect  only  the  cookies whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts of the cookies to inspect
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  cookies
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total cookies. The underlying
                                          host  service  forwards a maximum of
                                          200 cookies and  at  most  8  KB  of
                                          cookie contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect  a string containing the list of
                                      the request's header names,  ordered  as
                                      they  appear in the web request that WAF
                                      receives for inspection.  WAF  generates
                                      the  string  and  then  uses that as the
                                      field to match component in its  inspec-
                                      tion.  WAF separates the header names in
                                      the string using  commas  and  no  added
                                      spaces.

                                      Matches  against the header order string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. Text transformations are used in rule
                                   match  statements,  to transform the Field-
                                   ToMatch request component before inspecting
                                   it,  and  they're  used  in rate-based rule
                                   statements, to transform request components
                                   before  using  them  as  custom aggregation
                                   keys. If you specify one or more  transfor-
                                   mations  to  apply, WAF performs all trans-
                                   formations on the specified content, start-
                                   ing  from  the lowest priority setting, and
                                   then uses the component contents.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations.  WAF
                                          processes  all transformations, from
                                          lowest priority to  highest,  before
                                          inspecting  the transformed content.
                                          The priorities don't need to be con-
                                          secutive,  but they must all be dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            RateBasedStatement -> (structure)
                               A  rate-based rule counts incoming requests and
                               rate limits requests when they  are  coming  at
                               too  fast a rate. The rule categorizes requests
                               according to your  aggregation  criteria,  col-
                               lects  them  into  aggregation  instances,  and
                               counts and rate limits the  requests  for  each
                               instance.

                               You  can  specify  individual aggregation keys,
                               like IP address or HTTP method.  You  can  also
                               specify  aggregation  key combinations, like IP
                               address and HTTP method, or HTTP method,  query
                               argument, and cookie.

                               Each  unique  set of values for the aggregation
                               keys that you specify is a separate aggregation
                               instance,  with  the  value  from each key con-
                               tributing to the aggregation  instance  defini-
                               tion.

                               For  example, assume the rule evaluates web re-
                               quests with the following IP address  and  HTTP
                               method values:

                               o IP address 10.1.1.1, HTTP method POST

                               o IP address 10.1.1.1, HTTP method GET

                               o IP address 127.0.0.0, HTTP method POST

                               o IP address 10.1.1.1, HTTP method GET

                               The rule would create different aggregation in-
                               stances according to your aggregation criteria,
                               for example:

                               o If  the  aggregation  criteria is just the IP
                                 address, then each individual address  is  an
                                 aggregation instance, and WAF counts requests
                                 separately  for  each.  The  aggregation  in-
                                 stances  and  request  counts for our example
                                 would be the following:

                                 o IP address 10.1.1.1: count 3

                                 o IP address 127.0.0.0: count 1

                               o If the aggregation criteria is  HTTP  method,
                                 then each individual HTTP method is an aggre-
                                 gation instance.  The  aggregation  instances
                                 and  request  counts for our example would be
                                 the following:

                                 o HTTP method POST: count 2

                                 o HTTP method GET: count 2

                               o If the aggregation criteria is IP address and
                                 HTTP  method,  then  each IP address and each
                                 HTTP method would contribute to the  combined
                                 aggregation  instance.  The  aggregation  in-
                                 stances and request counts  for  our  example
                                 would be the following:

                                 o IP  address  10.1.1.1,  HTTP  method  POST:
                                   count 1

                                 o IP address 10.1.1.1, HTTP method GET: count
                                   2

                                 o IP  address  127.0.0.0,  HTTP  method POST:
                                   count 1

                               For  any  n-tuple  of  aggregation  keys,  each
                               unique  combination  of values for the keys de-
                               fines a separate  aggregation  instance,  which
                               WAF counts and rate-limits individually.

                               You  can  optionally nest another statement in-
                               side the rate-based statement,  to  narrow  the
                               scope  of  the  rule so that it only counts and
                               rate limits  requests  that  match  the  nested
                               statement.  You  can use this nested scope-down
                               statement in conjunction with your  aggregation
                               key  specifications  or  you can just count and
                               rate  limit  all  requests   that   match   the
                               scope-down statement, without additional aggre-
                               gation. When you choose to just manage all  re-
                               quests  that  match a scope-down statement, the
                               aggregation instance is singular for the rule.

                               You cannot nest a RateBasedStatement inside an-
                               other statement, for example inside a NotState-
                               ment or OrStatement . You can  define  a  Rate-
                               BasedStatement  inside  a  web ACL and inside a
                               rule group.

                               For additional information about  the  options,
                               see Rate limiting web requests using rate-based
                               rules in the WAF Developer Guide .

                               If you only aggregate on the individual IP  ad-
                               dress or forwarded IP address, you can retrieve
                               the list of IP addresses that WAF is  currently
                               rate  limiting  for a rule through the API call
                               GetRateBasedStatementManagedKeys . This  option
                               is not available for other aggregation configu-
                               rations.

                               WAF tracks and manages web requests  separately
                               for each instance of a rate-based rule that you
                               use. For  example,  if  you  provide  the  same
                               rate-based  rule settings in two web ACLs, each
                               of the two rule statements represents  a  sepa-
                               rate  instance  of the rate-based rule and gets
                               its own tracking and management by WAF. If  you
                               define  a  rate-based rule inside a rule group,
                               and  then  use  that  rule  group  in  multiple
                               places, each use creates a separate instance of
                               the rate-based rule that gets its own  tracking
                               and management by WAF.

                               Limit -> (long)
                                   The  limit  on requests per 5-minute period
                                   for a single aggregation instance  for  the
                                   rate-based  rule.  If the rate-based state-
                                   ment includes a ScopeDownStatement  ,  this
                                   limit  is applied only to the requests that
                                   match the statement.

                                   Examples:

                                   o If you aggregate on just the IP  address,
                                     this  is  the  limit on requests from any
                                     single IP address.

                                   o If you aggregate on the HTTP  method  and
                                     the query argument name "city", then this
                                     is the limit on requests for  any  single
                                     method, city pair.

                               AggregateKeyType -> (string)
                                   Setting that indicates how to aggregate the
                                   request counts.

                                   NOTE:
                                      Web requests that are missing any of the
                                      components  specified in the aggregation
                                      keys are  omitted  from  the  rate-based
                                      rule evaluation and handling.

                                   o CONSTANT  -  Count and limit the requests
                                     that   match   the   rate-based    rule's
                                     scope-down  statement.  With this option,
                                     the counted requests aren't  further  ag-
                                     gregated. The scope-down statement is the
                                     only specification used. When  the  count
                                     of   all   requests   that   satisfy  the
                                     scope-down statement goes over the limit,
                                     WAF  applies  the  rule action to all re-
                                     quests that satisfy the scope-down state-
                                     ment.  With this option, you must config-
                                     ure the ScopeDownStatement property.

                                   o CUSTOM_KEYS  -  Aggregate   the   request
                                     counts using one or more web request com-
                                     ponents as the aggregate keys. With  this
                                     option,  you  must  specify the aggregate
                                     keys in the CustomKeys property.  To  ag-
                                     gregate  on  only  the IP address or only
                                     the forwarded IP address, don't use  cus-
                                     tom  keys. Instead, set the aggregate key
                                     type to IP or FORWARDED_IP .

                                   o FORWARDED_IP  -  Aggregate  the   request
                                     counts on the first IP address in an HTTP
                                     header.  With this option, you must spec-
                                     ify the header to use in the ForwardedIP-
                                     Config property.  To aggregate on a  com-
                                     bination of the forwarded IP address with
                                     other aggregate keys, use CUSTOM_KEYS .

                                   o IP - Aggregate the request counts on  the
                                     IP  address  from the web request origin.
                                     To aggregate on a combination of  the  IP
                                     address  with  other  aggregate keys, use
                                     CUSTOM_KEYS .

                               (  ...  recursive  ...  )ForwardedIPConfig   ->
                               (structure)
                                   The  configuration  for  inspecting  IP ad-
                                   dresses in an HTTP header that you specify,
                                   instead  of using the IP address that's re-
                                   ported by the web request origin. Commonly,
                                   this  is  the X-Forwarded-For (XFF) header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the  request, WAF doesn't apply the rule
                                      to the web request at all.

                                   This is required if you specify a forwarded
                                   IP in the rule's aggregate key settings.

                                   HeaderName -> (string)
                                      The  name  of the HTTP header to use for
                                      the IP address. For example, to use  the
                                      X-Forwarded-For  (XFF)  header, set this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The  match  status  to assign to the web
                                      request if the request  doesn't  have  a
                                      valid  IP address in the specified posi-
                                      tion.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      You  can  specify the following fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching  the  rule statement. WAF ap-
                                        plies the rule action to the request.

                                      o NO_MATCH - Treat the  web  request  as
                                        not matching the rule statement.

                               CustomKeys -> (list)
                                   Specifies  the  aggregate  keys to use in a
                                   rate-base rule.

                                   (structure)
                                      Specifies a single custom aggregate  key
                                      for a rate-base rule.

                                      NOTE:
                                          Web requests that are missing any of
                                          the components specified in the  ag-
                                          gregation  keys are omitted from the
                                          rate-based rule evaluation and  han-
                                          dling.

                                      Header -> (structure)
                                          Use the value of a header in the re-
                                          quest as an aggregate key. Each dis-
                                          tinct  value  in the header contrib-
                                          utes to the aggregation instance. If
                                          you use a single header as your cus-
                                          tom key, then each value  fully  de-
                                          fines an aggregation instance.

                                          Name -> (string)
                                             The name of the header to use.

                                          TextTransformations -> (list)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection. Text transformations are
                                             used in rule match statements, to
                                             transform  the  FieldToMatch  re-
                                             quest component before inspecting
                                             it,    and    they're   used   in
                                             rate-based  rule  statements,  to
                                             transform  request components be-
                                             fore using them as custom  aggre-
                                             gation  keys.  If you specify one
                                             or more transformations to apply,
                                             WAF  performs all transformations
                                             on the specified content,  start-
                                             ing from the lowest priority set-
                                             ting, and then uses the component
                                             contents.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing  order  for   multiple
                                                    transformations.  WAF pro-
                                                    cesses   all   transforma-
                                                    tions,  from lowest prior-
                                                    ity to highest, before in-
                                                    specting  the  transformed
                                                    content.  The   priorities
                                                    don't  need to be consecu-
                                                    tive, but they must all be
                                                    different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      Cookie -> (structure)
                                          Use the value of a cookie in the re-
                                          quest as an aggregate key. Each dis-
                                          tinct value in the  cookie  contrib-
                                          utes to the aggregation instance. If
                                          you use a single cookie as your cus-
                                          tom  key,  then each value fully de-
                                          fines an aggregation instance.

                                          Name -> (string)
                                             The name of the cookie to use.

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. Text transformations are
                                             used in rule match statements, to
                                             transform  the  FieldToMatch  re-
                                             quest component before inspecting
                                             it,   and   they're    used    in
                                             rate-based  rule  statements,  to
                                             transform request components  be-
                                             fore  using them as custom aggre-
                                             gation keys. If you  specify  one
                                             or more transformations to apply,
                                             WAF performs all  transformations
                                             on  the specified content, start-
                                             ing from the lowest priority set-
                                             ting, and then uses the component
                                             contents.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations. WAF  pro-
                                                    cesses   all   transforma-
                                                    tions, from lowest  prior-
                                                    ity to highest, before in-
                                                    specting  the  transformed
                                                    content.   The  priorities
                                                    don't need to be  consecu-
                                                    tive, but they must all be
                                                    different.

                                                 Type -> (string)
                                                    You can specify  the  fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a    Base64   -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode  a  Base64 -en-
                                                        coded string, but  use
                                                        a  forgiving implemen-
                                                        tation  that   ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE    -     Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness of  attackers
                                                        who  inject an operat-
                                                        ing    system     com-
                                                        mand-line  command and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following characters:  /
                                                      (

                                                    o Replace   the  following
                                                      characters with a space:
                                                      , ;

                                                    o Replace  multiple spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters  (A-Z) to lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace  these charac-
                                                        ters  with   a   space
                                                        character     (decimal
                                                        32):

                                                    o \f ,  formfeed,  decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE  -   Decode
                                                        characters  that  were
                                                        encoded using CSS  2.x
                                                        escape    rules   syn-
                                                        data.html#characters .
                                                        This  function uses up
                                                        to two  bytes  in  the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII  characters that
                                                        were encoded using CSS
                                                        encoding  that wouldnt
                                                        typically be  encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of  a  backslash   and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript  for java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI  C   escape   se-
                                                        quences:  \a , \b , \f
                                                        , \n , \r , \t , \v  ,
                                                        \\  ,  \?  , \' , \" ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO  (octal). Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE  - Decode a
                                                        string of  hexadecimal
                                                        characters  into a bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters with  unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs  these opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;    with     a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with  a "less than" sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal  format, (amper-
                                                      sand)#xhhhh; , with  the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal    format,   (amper-
                                                      sand)#nnnn; ,  with  the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript escape  se-
                                                        quences.  If  a  \   u
                                                        HHHH code  is  in  the
                                                        full-width  ASCII code
                                                        range of  FF01-FF5E  ,
                                                        then  the  higher byte
                                                        is used to detect  and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte  is  used and the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE  -   Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash from the data  in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you  don't  want   any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are not at the  begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This  is  the  same as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash  characters   to
                                                        forward slashes.

                                                        REMOVE_NULLS  - Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place each  occurrence
                                                        of  a  C-style comment
                                                        (/* ... */  )  with  a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments  are also re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a standalone  termina-
                                                        tion  of a comment (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS  -   Re-
                                                        place  NULL  bytes  in
                                                        the input  with  space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE  - Decode a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI -  Like
                                                        URL_DECODE  , but with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in    the   full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and  adjust  the lower
                                                        byte. Otherwise,  only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter  sequences to Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives  and false-nega-
                                                        tives for  non-English
                                                        languages.

                                      QueryArgument -> (structure)
                                          Use  the specified query argument as
                                          an  aggregate  key.  Each   distinct
                                          value  for  the named query argument
                                          contributes to the  aggregation  in-
                                          stance.  If  you  use a single query
                                          argument as your  custom  key,  then
                                          each value fully defines an aggrega-
                                          tion instance.

                                          Name -> (string)
                                             The name of the query argument to
                                             use.

                                          TextTransformations -> (list)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection. Text transformations are
                                             used in rule match statements, to
                                             transform  the  FieldToMatch  re-
                                             quest component before inspecting
                                             it,    and    they're   used   in
                                             rate-based  rule  statements,  to
                                             transform  request components be-
                                             fore using them as custom  aggre-
                                             gation  keys.  If you specify one
                                             or more transformations to apply,
                                             WAF  performs all transformations
                                             on the specified content,  start-
                                             ing from the lowest priority set-
                                             ting, and then uses the component
                                             contents.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing  order  for   multiple
                                                    transformations.  WAF pro-
                                                    cesses   all   transforma-
                                                    tions,  from lowest prior-
                                                    ity to highest, before in-
                                                    specting  the  transformed
                                                    content.  The   priorities
                                                    don't  need to be consecu-
                                                    tive, but they must all be
                                                    different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      QueryString -> (structure)
                                          Use the request's query string as an
                                          aggregate  key. Each distinct string
                                          contributes to the  aggregation  in-
                                          stance.  If  you  use just the query
                                          string as your custom key, then each
                                          string  fully defines an aggregation
                                          instance.

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. Text transformations are
                                             used in rule match statements, to
                                             transform  the  FieldToMatch  re-
                                             quest component before inspecting
                                             it,   and   they're    used    in
                                             rate-based  rule  statements,  to
                                             transform request components  be-
                                             fore  using them as custom aggre-
                                             gation keys. If you  specify  one
                                             or more transformations to apply,
                                             WAF performs all  transformations
                                             on  the specified content, start-
                                             ing from the lowest priority set-
                                             ting, and then uses the component
                                             contents.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations. WAF  pro-
                                                    cesses   all   transforma-
                                                    tions, from lowest  prior-
                                                    ity to highest, before in-
                                                    specting  the  transformed
                                                    content.   The  priorities
                                                    don't need to be  consecu-
                                                    tive, but they must all be
                                                    different.

                                                 Type -> (string)
                                                    You can specify  the  fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a    Base64   -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode  a  Base64 -en-
                                                        coded string, but  use
                                                        a  forgiving implemen-
                                                        tation  that   ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE    -     Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness of  attackers
                                                        who  inject an operat-
                                                        ing    system     com-
                                                        mand-line  command and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following characters:  /
                                                      (

                                                    o Replace   the  following
                                                      characters with a space:
                                                      , ;

                                                    o Replace  multiple spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters  (A-Z) to lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace  these charac-
                                                        ters  with   a   space
                                                        character     (decimal
                                                        32):

                                                    o \f ,  formfeed,  decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE  -   Decode
                                                        characters  that  were
                                                        encoded using CSS  2.x
                                                        escape    rules   syn-
                                                        data.html#characters .
                                                        This  function uses up
                                                        to two  bytes  in  the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII  characters that
                                                        were encoded using CSS
                                                        encoding  that wouldnt
                                                        typically be  encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of  a  backslash   and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript  for java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI  C   escape   se-
                                                        quences:  \a , \b , \f
                                                        , \n , \r , \t , \v  ,
                                                        \\  ,  \?  , \' , \" ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO  (octal). Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE  - Decode a
                                                        string of  hexadecimal
                                                        characters  into a bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters with  unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs  these opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;    with     a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with  a "less than" sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal  format, (amper-
                                                      sand)#xhhhh; , with  the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal    format,   (amper-
                                                      sand)#nnnn; ,  with  the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript escape  se-
                                                        quences.  If  a  \   u
                                                        HHHH code  is  in  the
                                                        full-width  ASCII code
                                                        range of  FF01-FF5E  ,
                                                        then  the  higher byte
                                                        is used to detect  and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte  is  used and the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE  -   Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash from the data  in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you  don't  want   any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are not at the  begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This  is  the  same as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash  characters   to
                                                        forward slashes.

                                                        REMOVE_NULLS  - Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place each  occurrence
                                                        of  a  C-style comment
                                                        (/* ... */  )  with  a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments  are also re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a standalone  termina-
                                                        tion  of a comment (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS  -   Re-
                                                        place  NULL  bytes  in
                                                        the input  with  space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE  - Decode a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI -  Like
                                                        URL_DECODE  , but with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in    the   full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and  adjust  the lower
                                                        byte. Otherwise,  only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter  sequences to Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives  and false-nega-
                                                        tives for  non-English
                                                        languages.

                                      HTTPMethod -> (structure)
                                          Use  the request's HTTP method as an
                                          aggregate key.  Each  distinct  HTTP
                                          method  contributes  to the aggrega-
                                          tion instance. If you use  just  the
                                          HTTP method as your custom key, then
                                          each method fully defines an  aggre-
                                          gation instance.

                                      ForwardedIP -> (structure)
                                          Use  the first IP address in an HTTP
                                          header as  an  aggregate  key.  Each
                                          distinct  forwarded  IP address con-
                                          tributes  to  the  aggregation   in-
                                          stance.

                                          When  you specify an IP or forwarded
                                          IP in the custom key  settings,  you
                                          must also specify at least one other
                                          key to use.  You  can  aggregate  on
                                          only  the  forwarded  IP  address by
                                          specifying  FORWARDED_IP   in   your
                                          rate-based statement's AggregateKey-
                                          Type .

                                          With this option, you  must  specify
                                          the  header to use in the rate-based
                                          rule's ForwardedIPConfig property.

                                      IP -> (structure)
                                          Use the request's originating IP ad-
                                          dress as an aggregate key. Each dis-
                                          tinct IP address contributes to  the
                                          aggregation instance.

                                          When  you specify an IP or forwarded
                                          IP in the custom key  settings,  you
                                          must also specify at least one other
                                          key to use.  You  can  aggregate  on
                                          only the IP address by specifying IP
                                          in your rate-based  statement's  Ag-
                                          gregateKeyType .

                                      LabelNamespace -> (structure)
                                          Use the specified label namespace as
                                          an  aggregate  key.  Each   distinct
                                          fully  qualified label name that has
                                          the specified label  namespace  con-
                                          tributes   to  the  aggregation  in-
                                          stance. If you use  just  one  label
                                          namespace  as  your custom key, then
                                          each label name fully defines an ag-
                                          gregation instance.

                                          This uses only labels that have been
                                          added to the request by  rules  that
                                          are evaluated before this rate-based
                                          rule in the web ACL.

                                          For information  about  label  name-
                                          spaces  and  names, see Label syntax
                                          and naming requirements in  the  WAF
                                          Developer Guide .

                                          Namespace -> (string)
                                             The namespace to use for aggrega-
                                             tion.

                            AndStatement -> (structure)
                               A logical rule statement used to combine  other
                               rule  statements  with  AND  logic. You provide
                               more than one  Statement within  the  AndState-
                               ment .

                               Statements -> (list)
                                   The  statements  to combine with AND logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   ( ... recursive ... )

                            OrStatement -> (structure)
                               A  logical rule statement used to combine other
                               rule statements with OR logic. You provide more
                               than one  Statement within the OrStatement .

                               Statements -> (list)
                                   The  statements  to  combine with OR logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   ( ... recursive ... )

                            NotStatement -> (structure)
                               A logical rule statement used to negate the re-
                               sults of another rule  statement.  You  provide
                               one  Statement within the NotStatement .

                               ( ... recursive ... )

                            ManagedRuleGroupStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined in a managed rule group. To  use  this,
                               provide  the  vendor  name  and the name of the
                               rule group in this statement. You can  retrieve
                               the  required names by calling  ListAvailableM-
                               anagedRuleGroups .

                               You cannot nest a  ManagedRuleGroupStatement  ,
                               for  example  for  use inside a NotStatement or
                               OrStatement . It can only be  referenced  as  a
                               top-level statement within a rule.

                               NOTE:
                                   You  are  charged  additional fees when you
                                   use the WAF Bot Control managed rule  group
                                   AWSManagedRulesBotControlRuleSet or the WAF
                                   Fraud Control account  takeover  prevention
                                   (ATP) managed rule group AWSManagedRulesAT-
                                   PRuleSet . For more  information,  see  WAF
                                   Pricing .

                               VendorName -> (string)
                                   The  name of the managed rule group vendor.
                                   You use this, along  with  the  rule  group
                                   name, to identify a rule group.

                               Name -> (string)
                                   The name of the managed rule group. You use
                                   this, along with the vendor name, to  iden-
                                   tify the rule group.

                               Version -> (string)
                                   The  version  of  the managed rule group to
                                   use. If you specify this, the version  set-
                                   ting  is  fixed until you change it. If you
                                   don't specify this, WAF uses  the  vendor's
                                   default version, and then keeps the version
                                   at the vendor's default when the vendor up-
                                   dates the managed rule group settings.

                               ExcludedRules -> (list)
                                   Rules  in  the  referenced rule group whose
                                   actions are set to Count .

                                   NOTE:
                                      Instead  of  this  option,  use  RuleAc-
                                      tionOverrides . It accepts any valid ac-
                                      tion setting, including Count .

                                   (structure)
                                      Specifies a single rule in a rule  group
                                      whose  action  you  want  to override to
                                      Count .

                                      NOTE:
                                          Instead of this option, use  RuleAc-
                                          tionOverrides . It accepts any valid
                                          action setting, including Count .

                                      Name -> (string)
                                          The name of the  rule  whose  action
                                          you want to override to Count .

                               ( ... recursive ... )ManagedRuleGroupConfigs ->
                               (list)
                                   Additional information  that's  used  by  a
                                   managed   rule  group.  Many  managed  rule
                                   groups don't require this.

                                   Use the AWSManagedRulesATPRuleSet  configu-
                                   ration object for the account takeover pre-
                                   vention managed rule group, to provide  in-
                                   formation  such as the sign-in page of your
                                   application and the type of content to  ac-
                                   cept or reject from the client.

                                   Use   the  AWSManagedRulesBotControlRuleSet
                                   configuration object to configure the  pro-
                                   tection level that you want the Bot Control
                                   rule group to use.

                                   (structure)
                                      Additional information that's used by  a
                                      managed  rule  group.  Many managed rule
                                      groups don't require this.

                                      Use the  AWSManagedRulesATPRuleSet  con-
                                      figuration  object for the account take-
                                      over prevention managed rule  group,  to
                                      provide  information such as the sign-in
                                      page of your application and the type of
                                      content  to  accept  or  reject from the
                                      client.

                                      Use the AWSManagedRulesBotControlRuleSet
                                      configuration  object  to  configure the
                                      protection level that you want  the  Bot
                                      Control rule group to use.

                                      For  example specifications, see the ex-
                                      amples section of  CreateWebACL .

                                      LoginPath -> (string)

                                          NOTE:
                                             Instead of this setting,  provide
                                             your  configuration under AWSMan-
                                             agedRulesATPRuleSet .

                                      PayloadType -> (string)

                                          NOTE:
                                             Instead of this setting,  provide
                                             your  configuration under AWSMan-
                                             agedRulesATPRuleSet    RequestIn-
                                             spection .

                                      UsernameField -> (structure)

                                          NOTE:
                                             Instead  of this setting, provide
                                             your configuration under  AWSMan-
                                             agedRulesATPRuleSet    RequestIn-
                                             spection .

                                          Identifier -> (string)
                                             The name of the  username  field.
                                             For example /form/username .

                                      PasswordField -> (structure)

                                          NOTE:
                                             Instead  of this setting, provide
                                             your configuration under  AWSMan-
                                             agedRulesATPRuleSet    RequestIn-
                                             spection .

                                          Identifier -> (string)
                                             The name of the  password  field.
                                             For example /form/password .

                                      AWSManagedRulesBotControlRuleSet      ->
                                      (structure)
                                          Additional configuration  for  using
                                          the  Bot Control managed rule group.
                                          Use this to specify  the  inspection
                                          level  that you want to use. For in-
                                          formation about using the  Bot  Con-
                                          trol managed rule group, see WAF Bot
                                          Control rule group and WAF Bot  Con-
                                          trol in the WAF Developer Guide .

                                          InspectionLevel -> (string)
                                             The  inspection  level to use for
                                             the Bot Control rule  group.  The
                                             common  level is the least expen-
                                             sive. The targeted level includes
                                             all  common  level rules and adds
                                             rules with more advanced  inspec-
                                             tion  criteria.  For details, see
                                             WAF Bot Control rule group in the
                                             WAF Developer Guide .

                                      AWSManagedRulesATPRuleSet -> (structure)
                                          Additional  configuration  for using
                                          the  account   takeover   prevention
                                          (ATP) managed rule group, AWSManage-
                                          dRulesATPRuleSet . Use this to  pro-
                                          vide  login  request  information to
                                          the rule group. For  web  ACLs  that
                                          protect   CloudFront  distributions,
                                          use this to also provide the  infor-
                                          mation  about  how your distribution
                                          responds to login requests.

                                          This configuration replaces the  in-
                                          dividual   configuration  fields  in
                                          ManagedRuleGroupConfig and  provides
                                          additional feature configuration.

                                          For  information about using the ATP
                                          managed rule group,  see  WAF  Fraud
                                          Control  account takeover prevention
                                          (ATP) rule group and WAF Fraud  Con-
                                          trol   account  takeover  prevention
                                          (ATP) in the WAF Developer Guide .

                                          LoginPath -> (string)
                                             The path of  the  login  endpoint
                                             for  your  application. For exam-
                                             ple, for  the  URL  https://exam-
                                             ple.com/web/login   ,  you  would
                                             provide the path /web/login .

                                             The rule group inspects only HTTP
                                             POST  requests  to your specified
                                             login endpoint.

                                          RequestInspection -> (structure)
                                             The criteria for inspecting login
                                             requests,  used  by  the ATP rule
                                             group to validate credentials us-
                                             age.

                                             PayloadType -> (string)
                                                 The payload type for your lo-
                                                 gin endpoint, either JSON  or
                                                 form encoded.

                                             UsernameField -> (structure)
                                                 Details about your login page
                                                 username field.

                                                 How you specify this  depends
                                                 on the payload type.

                                                 o For  JSON payloads, specify
                                                   the  field  name  in   JSON
                                                   pointer  syntax. For infor-
                                                   mation   about   the   JSON
                                                   Pointer syntax, see the In-
                                                   ternet   Engineering   Task
                                                   Force  (IETF) documentation
                                                   JavaScript Object  Notation
                                                   (JSON) Pointer .  For exam-
                                                   ple, for the JSON payload {
                                                   "login":    {   "username":
                                                   "THE_USERNAME", "password":
                                                   "THE_PASSWORD"  }  }  , the
                                                   username  field  specifica-
                                                   tion is /login/username and
                                                   the password field specifi-
                                                   cation is /login/password .

                                                 o For  form  encoded  payload
                                                   types, use  the  HTML  form
                                                   names.  For example, for an
                                                   HTML form with  input  ele-
                                                   ments  named  username1 and
                                                   password1  ,  the  username
                                                   field    specification   is
                                                   username1 and the  password
                                                   field    specification   is
                                                   password1 .

                                                 Identifier -> (string)
                                                    The name of  the  username
                                                    field.     For     example
                                                    /form/username .

                                             PasswordField -> (structure)
                                                 Details about your login page
                                                 password field.

                                                 How  you specify this depends
                                                 on the payload type.

                                                 o For JSON payloads,  specify
                                                   the   field  name  in  JSON
                                                   pointer syntax. For  infor-
                                                   mation   about   the   JSON
                                                   Pointer syntax, see the In-
                                                   ternet   Engineering   Task
                                                   Force (IETF)  documentation
                                                   JavaScript  Object Notation
                                                   (JSON) Pointer .  For exam-
                                                   ple, for the JSON payload {
                                                   "login":   {    "username":
                                                   "THE_USERNAME", "password":
                                                   "THE_PASSWORD" }  }  ,  the
                                                   username  field  specifica-
                                                   tion is /login/username and
                                                   the password field specifi-
                                                   cation is /login/password .

                                                 o For  form  encoded  payload
                                                   types,  use  the  HTML form
                                                   names. For example, for  an
                                                   HTML  form  with input ele-
                                                   ments named  username1  and
                                                   password1  ,  the  username
                                                   field   specification    is
                                                   username1  and the password
                                                   field   specification    is
                                                   password1 .

                                                 Identifier -> (string)
                                                    The  name  of the password
                                                    field.     For     example
                                                    /form/password .

                                          ResponseInspection -> (structure)
                                             The  criteria  for inspecting re-
                                             sponses to login  requests,  used
                                             by  the  ATP  rule group to track
                                             login failure rates.

                                             The ATP rule group evaluates  the
                                             responses that your protected re-
                                             sources send back to client login
                                             attempts,  keeping  count of suc-
                                             cessful and failed attempts  from
                                             each  IP  address and client ses-
                                             sion. Using this information, the
                                             rule  group  labels and mitigates
                                             requests from client sessions and
                                             IP addresses that submit too many
                                             failed login attempts in a  short
                                             amount of time.

                                             NOTE:
                                                 Response inspection is avail-
                                                 able only in  web  ACLs  that
                                                 protect   Amazon   CloudFront
                                                 distributions.

                                             StatusCode -> (structure)
                                                 Configures inspection of  the
                                                 response status code.

                                                 SuccessCodes -> (list)
                                                    Status  codes  in  the re-
                                                    sponse  that  indicate   a
                                                    successful  login attempt.
                                                    To be counted  as  a  suc-
                                                    cessful   login,  the  re-
                                                    sponse  status  code  must
                                                    match  one  of these. Each
                                                    code must be unique  among
                                                    the  success  and  failure
                                                    status codes.

                                                    JSON  example:   "Success-
                                                    Codes": [ 200, 201 ]

                                                    (integer)

                                                 FailureCodes -> (list)
                                                    Status  codes  in  the re-
                                                    sponse  that  indicate   a
                                                    failed  login  attempt. To
                                                    be counted as a failed lo-
                                                    gin,  the  response status
                                                    code  must  match  one  of
                                                    these.  Each  code must be
                                                    unique among  the  success
                                                    and failure status codes.

                                                    JSON   example:  "Failure-
                                                    Codes": [ 400, 404 ]

                                                    (integer)

                                             Header -> (structure)
                                                 Configures inspection of  the
                                                 response header.

                                                 Name -> (string)
                                                    The  name of the header to
                                                    match  against.  The  name
                                                    must  be  an  exact match,
                                                    including case.

                                                    JSON  example:  "Name":  [
                                                    "LoginResult" ]

                                                 SuccessValues -> (list)
                                                    Values   in  the  response
                                                    header with the  specified
                                                    name  that indicate a suc-
                                                    cessful login attempt.  To
                                                    be counted as a successful
                                                    login, the value  must  be
                                                    an  exact match, including
                                                    case. Each value  must  be
                                                    unique  among  the success
                                                    and failure values.

                                                    JSON example: "SuccessVal-
                                                    ues":   [   "LoginPassed",
                                                    "Successful login" ]

                                                    (string)

                                                 FailureValues -> (list)
                                                    Values  in  the   response
                                                    header  with the specified
                                                    name   that   indicate   a
                                                    failed  login  attempt. To
                                                    be counted as a failed lo-
                                                    gin,  the value must be an
                                                    exact   match,   including
                                                    case.  Each  value must be
                                                    unique among  the  success
                                                    and failure values.

                                                    JSON example: "FailureVal-
                                                    ues":   [   "LoginFailed",
                                                    "Failed login" ]

                                                    (string)

                                             BodyContains -> (structure)
                                                 Configures  inspection of the
                                                 response body.  WAF  can  in-
                                                 spect  the first 65,536 bytes
                                                 (64 KB) of the response body.

                                                 SuccessStrings -> (list)
                                                    Strings in the body of the
                                                    response  that  indicate a
                                                    successful login  attempt.
                                                    To  be  counted  as a suc-
                                                    cessful login, the  string
                                                    can  be  anywhere  in  the
                                                    body and must be an  exact
                                                    match,   including   case.
                                                    Each string must be unique
                                                    among   the   success  and
                                                    failure strings.

                                                    JSON    example:     "Suc-
                                                    cessStrings":   [   "Login
                                                    successful",  "Welcome  to
                                                    our site!" ]

                                                    (string)

                                                 FailureStrings -> (list)
                                                    Strings in the body of the
                                                    response that  indicate  a
                                                    failed  login  attempt. To
                                                    be counted as a failed lo-
                                                    gin,  the  string  can  be
                                                    anywhere in the  body  and
                                                    must  be  an  exact match,
                                                    including    case.    Each
                                                    string   must   be  unique
                                                    among  the   success   and
                                                    failure strings.

                                                    JSON   example:  "Failure-
                                                    Strings": [ "Login failed"
                                                    ]

                                                    (string)

                                             Json -> (structure)
                                                 Configures  inspection of the
                                                 response JSON.  WAF  can  in-
                                                 spect  the first 65,536 bytes
                                                 (64 KB) of the response JSON.

                                                 Identifier -> (string)
                                                    The  identifier  for   the
                                                    value  to match against in
                                                    the JSON.  The  identifier
                                                    must  be  an  exact match,
                                                    including case.

                                                    JSON   example:   "Identi-
                                                    fier":  [ "/login/success"
                                                    ]

                                                 SuccessValues -> (list)
                                                    Values for  the  specified
                                                    identifier in the response
                                                    JSON that indicate a  suc-
                                                    cessful  login attempt. To
                                                    be counted as a successful
                                                    login,  the  value must be
                                                    an exact match,  including
                                                    case.  Each  value must be
                                                    unique among  the  success
                                                    and failure values.

                                                    JSON example: "SuccessVal-
                                                    ues":  [   "True",   "Suc-
                                                    ceeded" ]

                                                    (string)

                                                 FailureValues -> (list)
                                                    Values  for  the specified
                                                    identifier in the response
                                                    JSON   that   indicate   a
                                                    failed login  attempt.  To
                                                    be counted as a failed lo-
                                                    gin, the value must be  an
                                                    exact   match,   including
                                                    case. Each value  must  be
                                                    unique  among  the success
                                                    and failure values.

                                                    JSON example: "FailureVal-
                                                    ues":  [ "False", "Failed"
                                                    ]

                                                    (string)

                               RuleActionOverrides -> (list)
                                   Action settings to use in the place of  the
                                   rule actions that are configured inside the
                                   rule group. You specify  one  override  for
                                   each rule whose action you want to change.

                                   You  can use overrides for testing, for ex-
                                   ample you can override all of rule  actions
                                   to  Count  and  then  monitor the resulting
                                   count metrics to understand  how  the  rule
                                   group  would  handle  your web traffic. You
                                   can also permanently override some  or  all
                                   actions,  to modify how the rule group man-
                                   ages your web traffic.

                                   (structure)
                                      Action setting to use in the place of  a
                                      rule  action  that  is configured inside
                                      the rule group. You specify one override
                                      for  each  rule whose action you want to
                                      change.

                                      You can use overrides for  testing,  for
                                      example you can override all of rule ac-
                                      tions to Count and then monitor the  re-
                                      sulting  count metrics to understand how
                                      the rule group  would  handle  your  web
                                      traffic.  You can also permanently over-
                                      ride some or all actions, to modify  how
                                      the rule group manages your web traffic.

                                      Name -> (string)
                                          The name of the rule to override.

                                      ActionToUse -> (structure)
                                          The override action to use, in place
                                          of the configured action of the rule
                                          in the rule group.

                                          Block -> (structure)
                                             Instructs  WAF  to  block the web
                                             request.

                                             CustomResponse -> (structure)
                                                 Defines a custom response for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses,  see Customizing web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 ResponseCode -> (integer)
                                                    The  HTTP  status  code to
                                                    return to the client.

                                                    For a list of status codes
                                                    that  you  can use in your
                                                    custom   responses,    see
                                                    Supported status codes for
                                                    custom response in the WAF
                                                    Developer Guide .

                                                 CustomResponseBodyKey      ->
                                                 (string)
                                                    References  the   response
                                                    body  that you want WAF to
                                                    return to the web  request
                                                    client.  You  can define a
                                                    custom response for a rule
                                                    action  or  a  default web
                                                    ACL action that is set  to
                                                    block.  To  do  this,  you
                                                    first define the  response
                                                    body  key and value in the
                                                    CustomResponseBodies  set-
                                                    ting  for  the   WebACL or
                                                    RuleGroup where  you  want
                                                    to  use  it.  Then, in the
                                                    rule action or web ACL de-
                                                    fault  action  BlockAction
                                                    setting, you reference the
                                                    response  body  using this
                                                    key.

                                                 ResponseHeaders -> (list)
                                                    The HTTP headers to use in
                                                    the   response.  Duplicate
                                                    header names are  not  al-
                                                    lowed.

                                                    For  information about the
                                                    limits on count  and  size
                                                    for custom request and re-
                                                    sponse settings,  see  WAF
                                                    quotas  in  the WAF Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse handling.  This
                                                        is  used in  CustomRe-
                                                        sponse and   CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The   name  of  the
                                                           custom header.

                                                           For custom  request
                                                           header   insertion,
                                                           when  WAF   inserts
                                                           the header into the
                                                           request,  it   pre-
                                                           fixes   this   name
                                                           x-amzn-waf-  ,   to
                                                           avoid     confusion
                                                           with  the   headers
                                                           that are already in
                                                           the  request.   For
                                                           example,   for  the
                                                           header name  sample
                                                           ,  WAF  inserts the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Allow -> (structure)
                                             Instructs WAF to  allow  the  web
                                             request.

                                             CustomRequestHandling  -> (struc-
                                             ture)
                                                 Defines custom  handling  for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses,  see Customizing web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into the  request.  Dupli-
                                                    cate  header names are not
                                                    allowed.

                                                    For information about  the
                                                    limits  on  count and size
                                                    for custom request and re-
                                                    sponse  settings,  see WAF
                                                    quotas in the  WAF  Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse  handling. This
                                                        is used in   CustomRe-
                                                        sponse  and  CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The  name  of   the
                                                           custom header.

                                                           For  custom request
                                                           header   insertion,
                                                           when   WAF  inserts
                                                           the header into the
                                                           request,   it  pre-
                                                           fixes   this   name
                                                           x-amzn-waf-   ,  to
                                                           avoid     confusion
                                                           with   the  headers
                                                           that are already in
                                                           the   request.  For
                                                           example,  for   the
                                                           header  name sample
                                                           , WAF  inserts  the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Count -> (structure)
                                             Instructs  WAF  to  count the web
                                             request and then continue  evalu-
                                             ating  the  request using the re-
                                             maining rules in the web ACL.

                                             CustomRequestHandling ->  (struc-
                                             ture)
                                                 Defines  custom  handling for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses, see Customizing  web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into  the  request. Dupli-
                                                    cate header names are  not
                                                    allowed.

                                                    For  information about the
                                                    limits on count  and  size
                                                    for custom request and re-
                                                    sponse settings,  see  WAF
                                                    quotas  in  the WAF Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse handling.  This
                                                        is  used in  CustomRe-
                                                        sponse and   CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The   name  of  the
                                                           custom header.

                                                           For custom  request
                                                           header   insertion,
                                                           when  WAF   inserts
                                                           the header into the
                                                           request,  it   pre-
                                                           fixes   this   name
                                                           x-amzn-waf-  ,   to
                                                           avoid     confusion
                                                           with  the   headers
                                                           that are already in
                                                           the  request.   For
                                                           example,   for  the
                                                           header name  sample
                                                           ,  WAF  inserts the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Captcha -> (structure)
                                             Instructs WAF to  run  a  CAPTCHA
                                             check against the web request.

                                             CustomRequestHandling  -> (struc-
                                             ture)
                                                 Defines custom  handling  for
                                                 the  web  request,  used when
                                                 the CAPTCHA inspection deter-
                                                 mines  that the request's to-
                                                 ken is valid and unexpired.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses, see Customizing  web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into  the  request. Dupli-
                                                    cate header names are  not
                                                    allowed.

                                                    For  information about the
                                                    limits on count  and  size
                                                    for custom request and re-
                                                    sponse settings,  see  WAF
                                                    quotas  in  the WAF Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse handling.  This
                                                        is  used in  CustomRe-
                                                        sponse and   CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The   name  of  the
                                                           custom header.

                                                           For custom  request
                                                           header   insertion,
                                                           when  WAF   inserts
                                                           the header into the
                                                           request,  it   pre-
                                                           fixes   this   name
                                                           x-amzn-waf-  ,   to
                                                           avoid     confusion
                                                           with  the   headers
                                                           that are already in
                                                           the  request.   For
                                                           example,   for  the
                                                           header name  sample
                                                           ,  WAF  inserts the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Challenge -> (structure)
                                             Instructs WAF to run a  Challenge
                                             check against the web request.

                                             CustomRequestHandling  -> (struc-
                                             ture)
                                                 Defines custom  handling  for
                                                 the  web  request,  used when
                                                 the challenge inspection  de-
                                                 termines  that  the request's
                                                 token is valid and unexpired.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses, see Customizing  web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into  the  request. Dupli-
                                                    cate header names are  not
                                                    allowed.

                                                    For  information about the
                                                    limits on count  and  size
                                                    for custom request and re-
                                                    sponse settings,  see  WAF
                                                    quotas  in  the WAF Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse handling.  This
                                                        is  used in  CustomRe-
                                                        sponse and   CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The   name  of  the
                                                           custom header.

                                                           For custom  request
                                                           header   insertion,
                                                           when  WAF   inserts
                                                           the header into the
                                                           request,  it   pre-
                                                           fixes   this   name
                                                           x-amzn-waf-  ,   to
                                                           avoid     confusion
                                                           with  the   headers
                                                           that are already in
                                                           the  request.   For
                                                           example,   for  the
                                                           header name  sample
                                                           ,  WAF  inserts the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                            LabelMatchStatement -> (structure)
                               A rule statement to match against  labels  that
                               have  been  added  to  the web request by rules
                               that have already run in the web ACL.

                               The label match statement provides the label or
                               namespace  string  to  search  for.  The  label
                               string can represent a part or all of the fully
                               qualified label name that had been added to the
                               web request. Fully qualified labels have a pre-
                               fix,  optional  namespaces, and label name. The
                               prefix identifies the rule  group  or  web  ACL
                               context  of  the  rule that added the label. If
                               you do not provide the fully qualified name  in
                               your  label  match  string,  WAF  performs  the
                               search for labels that were added in  the  same
                               context as the label match statement.

                               Scope -> (string)
                                   Specify whether you want to match using the
                                   label name or just the namespace.

                               Key -> (string)
                                   The string to match  against.  The  setting
                                   you  provide  for this depends on the match
                                   statement's Scope setting:

                                   o If the Scope indicates LABEL , then  this
                                     specification  must  include the name and
                                     can include any number of preceding name-
                                     space  specifications  and  prefix  up to
                                     providing the fully qualified label name.

                                   o If the Scope indicates NAMESPACE  ,  then
                                     this specification can include any number
                                     of contiguous namespace strings, and  can
                                     include the entire label namespace prefix
                                     from the rule group or web ACL where  the
                                     label originates.

                                   Labels are case sensitive and components of
                                   a label must be separated by colon, for ex-
                                   ample NS1:NS2:name .

                            RegexMatchStatement -> (structure)
                               A  rule  statement  used  to search web request
                               components for a match against a single regular
                               expression.

                               RegexString -> (string)
                                   The string representing the regular expres-
                                   sion.

                               FieldToMatch -> (structure)
                                   The part of the web request that  you  want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Alternately,  you can filter and inspect
                                      all headers  with  the  Headers   Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the part of the web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A  limited amount of the request body is
                                      forwarded to WAF for inspection  by  the
                                      underlying  host  service.  For regional
                                      resources, the  limit  is  8  KB  (8,192
                                      kilobytes)  and for CloudFront distribu-
                                      tions, the limit is 16 KB (16,384  kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you can increase the limit  in  the  web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized  request  bodies, see the Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      A  limited amount of the request body is
                                      forwarded to WAF for inspection  by  the
                                      underlying  host  service.  For regional
                                      resources, the  limit  is  8  KB  (8,192
                                      kilobytes)  and for CloudFront distribu-
                                      tions, the limit is 16 KB (16,384  kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you can increase the limit  in  the  web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized  request bodies, see the Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect the request  headers.  You  must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the  set  of headers to and the parts of
                                      the headers that WAF inspects.

                                      Only the first 8 KB (8192  bytes)  of  a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must configure how to handle  any  over-
                                      size  header  content in the Headers ob-
                                      ject. WAF applies the  pattern  matching
                                      filters  to the headers that it receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The filter to use  to  identify  the
                                          subset  of  headers  to inspect in a
                                          web request.

                                          You must specify  exactly  one  set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have  a  key  that matches one of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect only  the  headers  whose
                                             keys   don't  match  any  of  the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The parts of the  headers  to  match
                                          with  the  rule inspection criteria.
                                          If you specify All  ,  WAF  inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  headers
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total headers. The underlying
                                          host service forwards a  maximum  of
                                          200  headers  and  at  most  8 KB of
                                          header contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect the request  cookies.  You  must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the  set of cookies and the parts of the
                                      cookies that WAF inspects.

                                      Only the first 8 KB (8192  bytes)  of  a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must configure how to handle  any  over-
                                      size  cookie  content in the Cookies ob-
                                      ject. WAF applies the  pattern  matching
                                      filters  to the cookies that it receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The filter to use  to  identify  the
                                          subset  of  cookies  to inspect in a
                                          web request.

                                          You must specify  exactly  one  set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have  a  key  that matches one of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect only  the  cookies  whose
                                             keys   don't  match  any  of  the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The parts of the cookies to  inspect
                                          with  the  rule inspection criteria.
                                          If you specify All  ,  WAF  inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  cookies
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total cookies. The underlying
                                          host service forwards a  maximum  of
                                          200  cookies  and  at  most  8 KB of
                                          cookie contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect a string containing the list  of
                                      the  request's  header names, ordered as
                                      they appear in the web request that  WAF
                                      receives  for  inspection. WAF generates
                                      the string and then  uses  that  as  the
                                      field  to match component in its inspec-
                                      tion. WAF separates the header names  in
                                      the  string  using  commas  and no added
                                      spaces.

                                      Matches against the header order  string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  headers
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total headers. The underlying
                                          host service forwards a  maximum  of
                                          200  headers  and  at  most  8 KB of
                                          header contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion. Text transformations are used in rule
                                   match statements, to transform  the  Field-
                                   ToMatch request component before inspecting
                                   it, and they're  used  in  rate-based  rule
                                   statements, to transform request components
                                   before using  them  as  custom  aggregation
                                   keys.  If you specify one or more transfor-
                                   mations to apply, WAF performs  all  trans-
                                   formations on the specified content, start-
                                   ing from the lowest priority  setting,  and
                                   then uses the component contents.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations.  WAF
                                          processes all transformations,  from
                                          lowest  priority  to highest, before
                                          inspecting the transformed  content.
                                          The priorities don't need to be con-
                                          secutive, but they must all be  dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                     ManagedRuleGroupStatement -> (structure)
                        A rule statement used to run the rules  that  are  de-
                        fined  in  a  managed rule group. To use this, provide
                        the vendor name and the name of the rule group in this
                        statement.  You  can  retrieve  the  required names by
                        calling  ListAvailableManagedRuleGroups .

                        You cannot nest a ManagedRuleGroupStatement , for  ex-
                        ample  for  use inside a NotStatement or OrStatement .
                        It can only be referenced  as  a  top-level  statement
                        within a rule.

                        NOTE:
                            You  are  charged additional fees when you use the
                            WAF Bot  Control  managed  rule  group  AWSManage-
                            dRulesBotControlRuleSet  or  the WAF Fraud Control
                            account takeover  prevention  (ATP)  managed  rule
                            group  AWSManagedRulesATPRuleSet . For more infor-
                            mation, see WAF Pricing .

                        VendorName -> (string)
                            The name of the managed rule group vendor. You use
                            this,  along with the rule group name, to identify
                            a rule group.

                        Name -> (string)
                            The name of the managed rule group. You use  this,
                            along  with  the vendor name, to identify the rule
                            group.

                        Version -> (string)
                            The version of the managed rule group to  use.  If
                            you specify this, the version setting is fixed un-
                            til you change it. If you don't specify this,  WAF
                            uses  the vendor's default version, and then keeps
                            the version at the vendor's default when the  ven-
                            dor updates the managed rule group settings.

                        ExcludedRules -> (list)
                            Rules  in  the referenced rule group whose actions
                            are set to Count .

                            NOTE:
                               Instead of this option, use RuleActionOverrides
                               .  It accepts any valid action setting, includ-
                               ing Count .

                            (structure)
                               Specifies a single rule in a rule  group  whose
                               action you want to override to Count .

                               NOTE:
                                   Instead of this option, use RuleActionOver-
                                   rides . It accepts any  valid  action  set-
                                   ting, including Count .

                               Name -> (string)
                                   The  name of the rule whose action you want
                                   to override to Count .

                        ScopeDownStatement -> (structure)
                            An optional  nested  statement  that  narrows  the
                            scope  of  the  web requests that are evaluated by
                            the managed rule group. Requests are  only  evalu-
                            ated   by   the  rule  group  if  they  match  the
                            scope-down statement. You  can  use  any  nestable
                            Statement in the scope-down statement, and you can
                            nest statements at any level, the same as you  can
                            for a rule statement.

                            ByteMatchStatement -> (structure)
                               A  rule  statement  that defines a string match
                               search for WAF to apply to  web  requests.  The
                               byte  match  statement  provides  the  bytes to
                               search for, the location in requests  that  you
                               want  WAF  to  search,  and other settings. The
                               bytes to search for are typically a string that
                               corresponds  with  ASCII characters. In the WAF
                               console and the developer guide, this is called
                               a string match statement.

                               SearchString -> (blob)
                                   A  string value that you want WAF to search
                                   for. WAF searches only in the part  of  web
                                   requests  that you designate for inspection
                                   in  FieldToMatch . The  maximum  length  of
                                   the value is 200 bytes.

                                   Valid  values  depend on the component that
                                   you specify for inspection in  FieldToMatch
                                   :

                                   o Method  :  The  HTTP method that you want
                                     WAF to search  for.  This  indicates  the
                                     type  of  operation  specified in the re-
                                     quest.

                                   o UriPath : The value that you want WAF  to
                                     search  for in the URI path, for example,
                                     /images/daily-ad.jpg .

                                   o HeaderOrder : The comma-separated list of
                                     header  names to match for. WAF creates a
                                     string that contains the ordered list  of
                                     header names, from the headers in the web
                                     request, and then  matches  against  that
                                     string.

                                   If SearchString includes alphabetic charac-
                                   ters A-Z and a-z, note that  the  value  is
                                   case sensitive.
                                      If you're using the WAF API

                                   Specify  a  base64-encoded  version  of the
                                   value. The maximum length of the value  be-
                                   fore you base64-encode it is 200 bytes.

                                   For  example,  suppose the value of Type is
                                   HEADER and the value of Data is  User-Agent
                                   .  If  you  want  to  search the User-Agent
                                   header  for  the   value   BadBot   ,   you
                                   base64-encode  BadBot using MIME base64-en-
                                   coding and include the resulting value, Qm-
                                   FkQm90 , in the value of SearchString .
                                      If  you're  using  the CLI or one of the
                                      Amazon Web Services SDKs

                                   The value that you want WAF to search  for.
                                   The  SDK  automatically  base64 encodes the
                                   value.

                               FieldToMatch -> (structure)
                                   The part of the web request that  you  want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Alternately,  you can filter and inspect
                                      all headers  with  the  Headers   Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the part of the web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A  limited amount of the request body is
                                      forwarded to WAF for inspection  by  the
                                      underlying  host  service.  For regional
                                      resources, the  limit  is  8  KB  (8,192
                                      kilobytes)  and for CloudFront distribu-
                                      tions, the limit is 16 KB (16,384  kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you can increase the limit  in  the  web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized  request  bodies, see the Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      A  limited amount of the request body is
                                      forwarded to WAF for inspection  by  the
                                      underlying  host  service.  For regional
                                      resources, the  limit  is  8  KB  (8,192
                                      kilobytes)  and for CloudFront distribu-
                                      tions, the limit is 16 KB (16,384  kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you can increase the limit  in  the  web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized  request bodies, see the Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect the request  headers.  You  must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the  set  of headers to and the parts of
                                      the headers that WAF inspects.

                                      Only the first 8 KB (8192  bytes)  of  a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must configure how to handle  any  over-
                                      size  header  content in the Headers ob-
                                      ject. WAF applies the  pattern  matching
                                      filters  to the headers that it receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The filter to use  to  identify  the
                                          subset  of  headers  to inspect in a
                                          web request.

                                          You must specify  exactly  one  set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have  a  key  that matches one of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect only  the  headers  whose
                                             keys   don't  match  any  of  the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The parts of the  headers  to  match
                                          with  the  rule inspection criteria.
                                          If you specify All  ,  WAF  inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  headers
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total headers. The underlying
                                          host service forwards a  maximum  of
                                          200  headers  and  at  most  8 KB of
                                          header contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect the request  cookies.  You  must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the  set of cookies and the parts of the
                                      cookies that WAF inspects.

                                      Only the first 8 KB (8192  bytes)  of  a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must configure how to handle  any  over-
                                      size  cookie  content in the Cookies ob-
                                      ject. WAF applies the  pattern  matching
                                      filters  to the cookies that it receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The filter to use  to  identify  the
                                          subset  of  cookies  to inspect in a
                                          web request.

                                          You must specify  exactly  one  set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have  a  key  that matches one of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect only  the  cookies  whose
                                             keys   don't  match  any  of  the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The parts of the cookies to  inspect
                                          with  the  rule inspection criteria.
                                          If you specify All  ,  WAF  inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  cookies
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total cookies. The underlying
                                          host service forwards a  maximum  of
                                          200  cookies  and  at  most  8 KB of
                                          cookie contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect a string containing the list  of
                                      the  request's  header names, ordered as
                                      they appear in the web request that  WAF
                                      receives  for  inspection. WAF generates
                                      the string and then  uses  that  as  the
                                      field  to match component in its inspec-
                                      tion. WAF separates the header names  in
                                      the  string  using  commas  and no added
                                      spaces.

                                      Matches against the header order  string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  headers
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total headers. The underlying
                                          host service forwards a  maximum  of
                                          200  headers  and  at  most  8 KB of
                                          header contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion. Text transformations are used in rule
                                   match statements, to transform  the  Field-
                                   ToMatch request component before inspecting
                                   it, and they're  used  in  rate-based  rule
                                   statements, to transform request components
                                   before using  them  as  custom  aggregation
                                   keys.  If you specify one or more transfor-
                                   mations to apply, WAF performs  all  trans-
                                   formations on the specified content, start-
                                   ing from the lowest priority  setting,  and
                                   then uses the component contents.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations.  WAF
                                          processes all transformations,  from
                                          lowest  priority  to highest, before
                                          inspecting the transformed  content.
                                          The priorities don't need to be con-
                                          secutive, but they must all be  dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                               PositionalConstraint -> (string)
                                   The area within the portion of the web  re-
                                   quest  that  you  want  WAF  to  search for
                                   SearchString .  Valid  values  include  the
                                   following:
                                      CONTAINS

                                   The  specified part of the web request must
                                   include the value of SearchString , but the
                                   location doesn't matter.
                                      CONTAINS_WORD

                                   The  specified part of the web request must
                                   include the value  of  SearchString  ,  and
                                   SearchString must contain only alphanumeric
                                   characters or underscore (A-Z, a-z, 0-9, or
                                   _).  In  addition,  SearchString  must be a
                                   word, which means that both of the  follow-
                                   ing are true:

                                   o SearchString  is  at the beginning of the
                                     specified part of the web request  or  is
                                     preceded by a character other than an al-
                                     phanumeric character or  underscore  (_).
                                     Examples  include  the  value of a header
                                     and ;BadBot .

                                   o SearchString is at the end of the  speci-
                                     fied  part  of the web request or is fol-
                                     lowed by a character other  than  an  al-
                                     phanumeric  character  or underscore (_),
                                     for example, BadBot; and -BadBot; .
                                      EXACTLY

                                   The value of the specified part of the  web
                                   request  must  exactly  match  the value of
                                   SearchString .
                                      STARTS_WITH

                                   The value of SearchString  must  appear  at
                                   the  beginning of the specified part of the
                                   web request.
                                      ENDS_WITH

                                   The value of SearchString  must  appear  at
                                   the  end  of  the specified part of the web
                                   request.

                            SqliMatchStatement -> (structure)
                               A rule statement that  inspects  for  malicious
                               SQL  code.  Attackers insert malicious SQL code
                               into web requests to do things like modify your
                               database or extract data from it.

                               FieldToMatch -> (structure)
                                   The  part  of the web request that you want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Alternately, you can filter and  inspect
                                      all  headers  with  the  Headers  Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of the web request that identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see  the  Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see the  Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect  the  request  headers. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the set of headers to and the  parts  of
                                      the headers that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size header content in the  Headers  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the headers that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of headers to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect  only  the  headers whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the headers to match
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect  the  request  cookies. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the set of cookies and the parts of  the
                                      cookies that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size cookie content in the  Cookies  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the cookies that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of cookies to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect  only  the  cookies whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts of the cookies to inspect
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  cookies
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total cookies. The underlying
                                          host  service  forwards a maximum of
                                          200 cookies and  at  most  8  KB  of
                                          cookie contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect  a string containing the list of
                                      the request's header names,  ordered  as
                                      they  appear in the web request that WAF
                                      receives for inspection.  WAF  generates
                                      the  string  and  then  uses that as the
                                      field to match component in its  inspec-
                                      tion.  WAF separates the header names in
                                      the string using  commas  and  no  added
                                      spaces.

                                      Matches  against the header order string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. Text transformations are used in rule
                                   match  statements,  to transform the Field-
                                   ToMatch request component before inspecting
                                   it,  and  they're  used  in rate-based rule
                                   statements, to transform request components
                                   before  using  them  as  custom aggregation
                                   keys. If you specify one or more  transfor-
                                   mations  to  apply, WAF performs all trans-
                                   formations on the specified content, start-
                                   ing  from  the lowest priority setting, and
                                   then uses the component contents.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations.  WAF
                                          processes  all transformations, from
                                          lowest priority to  highest,  before
                                          inspecting  the transformed content.
                                          The priorities don't need to be con-
                                          secutive,  but they must all be dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                               SensitivityLevel -> (string)
                                   The sensitivity that you want WAF to use to
                                   inspect for SQL injection attacks.
                                      HIGH detects  more  attacks,  but  might
                                      generate  more  false  positives,  espe-
                                      cially if your web  requests  frequently
                                      contain unusual strings. For information
                                      about identifying and  mitigating  false
                                      positives, see Testing and tuning in the
                                      WAF Developer Guide .

                                      LOW is generally a better choice for re-
                                      sources  that already have other protec-
                                      tions against SQL injection  attacks  or
                                      that have a low tolerance for false pos-
                                      itives.

                                   Default: LOW

                            XssMatchStatement -> (structure)
                               A rule statement that inspects  for  cross-site
                               scripting  (XSS)  attacks.  In XSS attacks, the
                               attacker uses vulnerabilities in a benign  web-
                               site   as   a   vehicle   to  inject  malicious
                               client-site scripts into other  legitimate  web
                               browsers.

                               FieldToMatch -> (structure)
                                   The  part  of the web request that you want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Alternately, you can filter and  inspect
                                      all  headers  with  the  Headers  Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of the web request that identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see  the  Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see the  Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect  the  request  headers. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the set of headers to and the  parts  of
                                      the headers that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size header content in the  Headers  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the headers that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of headers to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect  only  the  headers whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the headers to match
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect  the  request  cookies. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the set of cookies and the parts of  the
                                      cookies that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size cookie content in the  Cookies  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the cookies that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of cookies to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect  only  the  cookies whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts of the cookies to inspect
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  cookies
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total cookies. The underlying
                                          host  service  forwards a maximum of
                                          200 cookies and  at  most  8  KB  of
                                          cookie contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect  a string containing the list of
                                      the request's header names,  ordered  as
                                      they  appear in the web request that WAF
                                      receives for inspection.  WAF  generates
                                      the  string  and  then  uses that as the
                                      field to match component in its  inspec-
                                      tion.  WAF separates the header names in
                                      the string using  commas  and  no  added
                                      spaces.

                                      Matches  against the header order string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. Text transformations are used in rule
                                   match  statements,  to transform the Field-
                                   ToMatch request component before inspecting
                                   it,  and  they're  used  in rate-based rule
                                   statements, to transform request components
                                   before  using  them  as  custom aggregation
                                   keys. If you specify one or more  transfor-
                                   mations  to  apply, WAF performs all trans-
                                   formations on the specified content, start-
                                   ing  from  the lowest priority setting, and
                                   then uses the component contents.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations.  WAF
                                          processes  all transformations, from
                                          lowest priority to  highest,  before
                                          inspecting  the transformed content.
                                          The priorities don't need to be con-
                                          secutive,  but they must all be dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            SizeConstraintStatement -> (structure)
                               A  rule  statement  that  compares  a number of
                               bytes against the size of a request  component,
                               using  a  comparison  operator, such as greater
                               than (>) or less than (<). For example, you can
                               use  a  size  constraint  statement to look for
                               query strings that are longer than 100 bytes.

                               If you configure WAF  to  inspect  the  request
                               body,  WAF inspects only the number of bytes of
                               the body up to the limit for the  web  ACL.  By
                               default, for regional web ACLs, this limit is 8
                               KB (8,192 kilobytes)  and  for  CloudFront  web
                               ACLs,  this  limit is 16 KB (16,384 kilobytes).
                               For CloudFront web ACLs, you can  increase  the
                               limit  in  the  web ACL AssociationConfig , for
                               additional fees. If you know that  the  request
                               body  for your web requests should never exceed
                               the inspection limit, you could use a size con-
                               straint statement to block requests that have a
                               larger request body size.

                               If you choose URI for the value of Part of  the
                               request  to filter on, the slash (/) in the URI
                               counts as one character. For example,  the  URI
                               /logo.jpg is nine characters long.

                               FieldToMatch -> (structure)
                                   The  part  of the web request that you want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Alternately, you can filter and  inspect
                                      all  headers  with  the  Headers  Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of the web request that identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see  the  Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see the  Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect  the  request  headers. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the set of headers to and the  parts  of
                                      the headers that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size header content in the  Headers  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the headers that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of headers to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect  only  the  headers whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the headers to match
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect  the  request  cookies. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the set of cookies and the parts of  the
                                      cookies that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size cookie content in the  Cookies  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the cookies that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of cookies to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect  only  the  cookies whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts of the cookies to inspect
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  cookies
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total cookies. The underlying
                                          host  service  forwards a maximum of
                                          200 cookies and  at  most  8  KB  of
                                          cookie contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect  a string containing the list of
                                      the request's header names,  ordered  as
                                      they  appear in the web request that WAF
                                      receives for inspection.  WAF  generates
                                      the  string  and  then  uses that as the
                                      field to match component in its  inspec-
                                      tion.  WAF separates the header names in
                                      the string using  commas  and  no  added
                                      spaces.

                                      Matches  against the header order string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               ComparisonOperator -> (string)
                                   The  operator to use to compare the request
                                   part to the size setting.

                               Size -> (long)
                                   The size, in byte, to compare  to  the  re-
                                   quest part, after any transformations.

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. Text transformations are used in rule
                                   match  statements,  to transform the Field-
                                   ToMatch request component before inspecting
                                   it,  and  they're  used  in rate-based rule
                                   statements, to transform request components
                                   before  using  them  as  custom aggregation
                                   keys. If you specify one or more  transfor-
                                   mations  to  apply, WAF performs all trans-
                                   formations on the specified content, start-
                                   ing  from  the lowest priority setting, and
                                   then uses the component contents.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations.  WAF
                                          processes  all transformations, from
                                          lowest priority to  highest,  before
                                          inspecting  the transformed content.
                                          The priorities don't need to be con-
                                          secutive,  but they must all be dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            GeoMatchStatement -> (structure)
                               A  rule  statement  that labels web requests by
                               country and region and that matches against web
                               requests  based  on  country  code. A geo match
                               rule labels every request that it inspects  re-
                               gardless of whether it finds a match.

                               o To  manage  requests only by country, you can
                                 use this statement by itself and specify  the
                                 countries  that  you want to match against in
                                 the CountryCodes array.

                               o Otherwise, configure your geo match rule with
                                 Count action so that it only labels requests.
                                 Then, add one or more label  match  rules  to
                                 run  after  the  geo match rule and configure
                                 them to match against the  geographic  labels
                                 and handle the requests as needed.

                               WAF  labels  requests using the alpha-2 country
                               and region codes from the International Organi-
                               zation for Standardization (ISO) 3166 standard.
                               WAF determines the codes using  either  the  IP
                               address  in  the  web request origin or, if you
                               specify it, the address in the geo  match  For-
                               wardedIPConfig .

                               If  you  use  the web request origin, the label
                               formats   are   awswaf:clientip:geo:region:<ISO
                               country code>-<ISO region code> and awswaf:cli-
                               entip:geo:country:<ISO country code> .

                               If you use a forwarded IP  address,  the  label
                               formats  are awswaf:forwardedip:geo:region:<ISO
                               country code>-<ISO region code> and awswaf:for-
                               wardedip:geo:country:<ISO country code> .

                               For  additional  details,  see Geographic match
                               rule statement in the WAF Developer Guide .

                               CountryCodes -> (list)
                                   An array  of  two-character  country  codes
                                   that  you  want to match against, for exam-
                                   ple, [ "US", "CN"  ]  ,  from  the  alpha-2
                                   country  ISO codes of the ISO 3166 interna-
                                   tional standard.

                                   When you use a geo match statement just for
                                   the  region and country labels that it adds
                                   to requests, you still  have  to  supply  a
                                   country  code  for the rule to evaluate. In
                                   this case, you configure the rule  to  only
                                   count  matching requests, but it will still
                                   generate logging and count metrics for  any
                                   matches.  You  can  reduce  the logging and
                                   metrics that the rule produces by  specify-
                                   ing  a  country  that's  unlikely  to  be a
                                   source of traffic to your site.

                                   (string)

                               ForwardedIPConfig -> (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The  name  of the HTTP header to use for
                                      the IP address. For example, to use  the
                                      X-Forwarded-For  (XFF)  header, set this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The  match  status  to assign to the web
                                      request if the request  doesn't  have  a
                                      valid  IP address in the specified posi-
                                      tion.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      You  can  specify the following fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching  the  rule statement. WAF ap-
                                        plies the rule action to the request.

                                      o NO_MATCH - Treat the  web  request  as
                                        not matching the rule statement.

                            RuleGroupReferenceStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined in a  RuleGroup . To use this, create a
                               rule  group  with  your rules, then provide the
                               ARN of the rule group in this statement.

                               You cannot nest a RuleGroupReferenceStatement ,
                               for  example  for  use inside a NotStatement or
                               OrStatement . You can only  use  a  rule  group
                               reference  statement  at the top level inside a
                               web ACL.

                               ARN -> (string)
                                   The Amazon Resource Name (ARN) of  the  en-
                                   tity.

                               ExcludedRules -> (list)
                                   Rules  in  the  referenced rule group whose
                                   actions are set to Count .

                                   NOTE:
                                      Instead  of  this  option,  use  RuleAc-
                                      tionOverrides . It accepts any valid ac-
                                      tion setting, including Count .

                                   (structure)
                                      Specifies a single rule in a rule  group
                                      whose  action  you  want  to override to
                                      Count .

                                      NOTE:
                                          Instead of this option, use  RuleAc-
                                          tionOverrides . It accepts any valid
                                          action setting, including Count .

                                      Name -> (string)
                                          The name of the  rule  whose  action
                                          you want to override to Count .

                               RuleActionOverrides -> (list)
                                   Action  settings to use in the place of the
                                   rule actions that are configured inside the
                                   rule  group.  You  specify one override for
                                   each rule whose action you want to change.

                                   You can use overrides for testing, for  ex-
                                   ample  you can override all of rule actions
                                   to Count and  then  monitor  the  resulting
                                   count  metrics  to  understand how the rule
                                   group would handle your  web  traffic.  You
                                   can  also  permanently override some or all
                                   actions, to modify how the rule group  man-
                                   ages your web traffic.

                                   (structure)
                                      Action  setting to use in the place of a
                                      rule action that  is  configured  inside
                                      the rule group. You specify one override
                                      for each rule whose action you  want  to
                                      change.

                                      You  can  use overrides for testing, for
                                      example you can override all of rule ac-
                                      tions  to Count and then monitor the re-
                                      sulting count metrics to understand  how
                                      the  rule  group  would  handle your web
                                      traffic. You can also permanently  over-
                                      ride  some or all actions, to modify how
                                      the rule group manages your web traffic.

                                      Name -> (string)
                                          The name of the rule to override.

                                      ActionToUse -> (structure)
                                          The override action to use, in place
                                          of the configured action of the rule
                                          in the rule group.

                                          Block -> (structure)
                                             Instructs WAF to  block  the  web
                                             request.

                                             CustomResponse -> (structure)
                                                 Defines a custom response for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses, see Customizing  web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 ResponseCode -> (integer)
                                                    The HTTP  status  code  to
                                                    return to the client.

                                                    For a list of status codes
                                                    that you can use  in  your
                                                    custom    responses,   see
                                                    Supported status codes for
                                                    custom response in the WAF
                                                    Developer Guide .

                                                 CustomResponseBodyKey      ->
                                                 (string)
                                                    References   the  response
                                                    body that you want WAF  to
                                                    return  to the web request
                                                    client. You can  define  a
                                                    custom response for a rule
                                                    action or  a  default  web
                                                    ACL  action that is set to
                                                    block.  To  do  this,  you
                                                    first  define the response
                                                    body key and value in  the
                                                    CustomResponseBodies  set-
                                                    ting for  the   WebACL  or
                                                    RuleGroup  where  you want
                                                    to use it.  Then,  in  the
                                                    rule action or web ACL de-
                                                    fault  action  BlockAction
                                                    setting, you reference the
                                                    response body  using  this
                                                    key.

                                                 ResponseHeaders -> (list)
                                                    The HTTP headers to use in
                                                    the  response.   Duplicate
                                                    header  names  are not al-
                                                    lowed.

                                                    For information about  the
                                                    limits  on  count and size
                                                    for custom request and re-
                                                    sponse  settings,  see WAF
                                                    quotas in the  WAF  Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse  handling. This
                                                        is used in   CustomRe-
                                                        sponse  and  CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The  name  of   the
                                                           custom header.

                                                           For  custom request
                                                           header   insertion,
                                                           when   WAF  inserts
                                                           the header into the
                                                           request,   it  pre-
                                                           fixes   this   name
                                                           x-amzn-waf-   ,  to
                                                           avoid     confusion
                                                           with   the  headers
                                                           that are already in
                                                           the   request.  For
                                                           example,  for   the
                                                           header  name sample
                                                           , WAF  inserts  the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Allow -> (structure)
                                             Instructs  WAF  to  allow the web
                                             request.

                                             CustomRequestHandling ->  (struc-
                                             ture)
                                                 Defines  custom  handling for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses, see Customizing  web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into  the  request. Dupli-
                                                    cate header names are  not
                                                    allowed.

                                                    For  information about the
                                                    limits on count  and  size
                                                    for custom request and re-
                                                    sponse settings,  see  WAF
                                                    quotas  in  the WAF Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse handling.  This
                                                        is  used in  CustomRe-
                                                        sponse and   CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The   name  of  the
                                                           custom header.

                                                           For custom  request
                                                           header   insertion,
                                                           when  WAF   inserts
                                                           the header into the
                                                           request,  it   pre-
                                                           fixes   this   name
                                                           x-amzn-waf-  ,   to
                                                           avoid     confusion
                                                           with  the   headers
                                                           that are already in
                                                           the  request.   For
                                                           example,   for  the
                                                           header name  sample
                                                           ,  WAF  inserts the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Count -> (structure)
                                             Instructs WAF to  count  the  web
                                             request  and then continue evalu-
                                             ating the request using  the  re-
                                             maining rules in the web ACL.

                                             CustomRequestHandling  -> (struc-
                                             ture)
                                                 Defines custom  handling  for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses,  see Customizing web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into the  request.  Dupli-
                                                    cate  header names are not
                                                    allowed.

                                                    For information about  the
                                                    limits  on  count and size
                                                    for custom request and re-
                                                    sponse  settings,  see WAF
                                                    quotas in the  WAF  Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse  handling. This
                                                        is used in   CustomRe-
                                                        sponse  and  CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The  name  of   the
                                                           custom header.

                                                           For  custom request
                                                           header   insertion,
                                                           when   WAF  inserts
                                                           the header into the
                                                           request,   it  pre-
                                                           fixes   this   name
                                                           x-amzn-waf-   ,  to
                                                           avoid     confusion
                                                           with   the  headers
                                                           that are already in
                                                           the   request.  For
                                                           example,  for   the
                                                           header  name sample
                                                           , WAF  inserts  the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Captcha -> (structure)
                                             Instructs  WAF  to  run a CAPTCHA
                                             check against the web request.

                                             CustomRequestHandling ->  (struc-
                                             ture)
                                                 Defines  custom  handling for
                                                 the web  request,  used  when
                                                 the CAPTCHA inspection deter-
                                                 mines that the request's  to-
                                                 ken is valid and unexpired.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses,  see Customizing web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into the  request.  Dupli-
                                                    cate  header names are not
                                                    allowed.

                                                    For information about  the
                                                    limits  on  count and size
                                                    for custom request and re-
                                                    sponse  settings,  see WAF
                                                    quotas in the  WAF  Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse  handling. This
                                                        is used in   CustomRe-
                                                        sponse  and  CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The  name  of   the
                                                           custom header.

                                                           For  custom request
                                                           header   insertion,
                                                           when   WAF  inserts
                                                           the header into the
                                                           request,   it  pre-
                                                           fixes   this   name
                                                           x-amzn-waf-   ,  to
                                                           avoid     confusion
                                                           with   the  headers
                                                           that are already in
                                                           the   request.  For
                                                           example,  for   the
                                                           header  name sample
                                                           , WAF  inserts  the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Challenge -> (structure)
                                             Instructs  WAF to run a Challenge
                                             check against the web request.

                                             CustomRequestHandling ->  (struc-
                                             ture)
                                                 Defines  custom  handling for
                                                 the web  request,  used  when
                                                 the  challenge inspection de-
                                                 termines that  the  request's
                                                 token is valid and unexpired.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses,  see Customizing web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into the  request.  Dupli-
                                                    cate  header names are not
                                                    allowed.

                                                    For information about  the
                                                    limits  on  count and size
                                                    for custom request and re-
                                                    sponse  settings,  see WAF
                                                    quotas in the  WAF  Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse  handling. This
                                                        is used in   CustomRe-
                                                        sponse  and  CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The  name  of   the
                                                           custom header.

                                                           For  custom request
                                                           header   insertion,
                                                           when   WAF  inserts
                                                           the header into the
                                                           request,   it  pre-
                                                           fixes   this   name
                                                           x-amzn-waf-   ,  to
                                                           avoid     confusion
                                                           with   the  headers
                                                           that are already in
                                                           the   request.  For
                                                           example,  for   the
                                                           header  name sample
                                                           , WAF  inserts  the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                            IPSetReferenceStatement -> (structure)
                               A  rule  statement  used to detect web requests
                               coming from particular IP addresses or  address
                               ranges.  To  use  this,  create  an  IPSet that
                               specifies the addresses  you  want  to  detect,
                               then use the ARN of that set in this statement.
                               To create an IP set, see  CreateIPSet .

                               Each IP set rule  statement  references  an  IP
                               set.  You  create and maintain the set indepen-
                               dent of your rules. This allows you to use  the
                               single  set  in multiple rules. When you update
                               the referenced set, WAF  automatically  updates
                               all rules that reference it.

                               ARN -> (string)
                                   The  Amazon  Resource  Name  (ARN)  of  the
                                   IPSet that this statement references.

                               IPSetForwardedIPConfig -> (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The  name  of the HTTP header to use for
                                      the IP address. For example, to use  the
                                      X-Forwarded-For  (XFF)  header, set this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The  match  status  to assign to the web
                                      request if the request  doesn't  have  a
                                      valid  IP address in the specified posi-
                                      tion.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      You  can  specify the following fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching  the  rule statement. WAF ap-
                                        plies the rule action to the request.

                                      o NO_MATCH - Treat the  web  request  as
                                        not matching the rule statement.

                                   Position -> (string)
                                      The position in the header to search for
                                      the IP address. The header  can  contain
                                      IP  addresses of the original client and
                                      also of proxies. For example, the header
                                      value   could  be  10.1.1.1,  127.0.0.0,
                                      10.10.10.10 where the first  IP  address
                                      identifies  the  original client and the
                                      rest identify proxies that  the  request
                                      went through.

                                      The  options  for  this  setting are the
                                      following:

                                      o FIRST - Inspect the first  IP  address
                                        in  the  list  of  IP addresses in the
                                        header. This is usually  the  client's
                                        original IP.

                                      o LAST  - Inspect the last IP address in
                                        the  list  of  IP  addresses  in   the
                                        header.

                                      o ANY  - Inspect all IP addresses in the
                                        header for a match. If the header con-
                                        tains  more  than 10 IP addresses, WAF
                                        inspects the last 10.

                            RegexPatternSetReferenceStatement -> (structure)
                               A rule statement used  to  search  web  request
                               components  for  matches  with  regular expres-
                               sions. To use this, create  a   RegexPatternSet
                               that specifies the expressions that you want to
                               detect, then use the ARN of that  set  in  this
                               statement.  A  web  request matches the pattern
                               set rule statement  if  the  request  component
                               matches any of the patterns in the set. To cre-
                               ate a regex pattern set,  see   CreateRegexPat-
                               ternSet .

                               Each  regex  pattern  set rule statement refer-
                               ences a regex pattern set. You create and main-
                               tain  the  set  independent of your rules. This
                               allows you to use the single  set  in  multiple
                               rules.  When you update the referenced set, WAF
                               automatically updates all rules that  reference
                               it.

                               ARN -> (string)
                                   The Amazon Resource Name (ARN) of the  Reg-
                                   exPatternSet  that  this  statement  refer-
                                   ences.

                               FieldToMatch -> (structure)
                                   The  part  of the web request that you want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Alternately, you can filter and  inspect
                                      all  headers  with  the  Headers  Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of the web request that identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see  the  Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      A limited amount of the request body  is
                                      forwarded  to  WAF for inspection by the
                                      underlying host  service.  For  regional
                                      resources,  the  limit  is  8  KB (8,192
                                      kilobytes) and for CloudFront  distribu-
                                      tions,  the limit is 16 KB (16,384 kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you  can  increase  the limit in the web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized request bodies, see the  Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect  the  request  headers. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the set of headers to and the  parts  of
                                      the headers that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size header content in the  Headers  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the headers that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of headers to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect  only  the  headers whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the headers to match
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect  the  request  cookies. You must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the set of cookies and the parts of  the
                                      cookies that WAF inspects.

                                      Only  the  first  8 KB (8192 bytes) of a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must  configure  how to handle any over-
                                      size cookie content in the  Cookies  ob-
                                      ject.  WAF  applies the pattern matching
                                      filters to the cookies that it  receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The  filter  to  use to identify the
                                          subset of cookies to  inspect  in  a
                                          web request.

                                          You  must  specify  exactly one set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have a key that  matches  one  of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect  only  the  cookies whose
                                             keys  don't  match  any  of   the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts of the cookies to inspect
                                          with the rule  inspection  criteria.
                                          If  you  specify  All , WAF inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  cookies
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total cookies. The underlying
                                          host  service  forwards a maximum of
                                          200 cookies and  at  most  8  KB  of
                                          cookie contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect  a string containing the list of
                                      the request's header names,  ordered  as
                                      they  appear in the web request that WAF
                                      receives for inspection.  WAF  generates
                                      the  string  and  then  uses that as the
                                      field to match component in its  inspec-
                                      tion.  WAF separates the header names in
                                      the string using  commas  and  no  added
                                      spaces.

                                      Matches  against the header order string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the  request  are  more  numerous or
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire  contents  of  request  headers
                                          when  they  exceed 8 KB (8192 bytes)
                                          or 200 total headers. The underlying
                                          host  service  forwards a maximum of
                                          200 headers and  at  most  8  KB  of
                                          header contents to WAF.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. Text transformations are used in rule
                                   match  statements,  to transform the Field-
                                   ToMatch request component before inspecting
                                   it,  and  they're  used  in rate-based rule
                                   statements, to transform request components
                                   before  using  them  as  custom aggregation
                                   keys. If you specify one or more  transfor-
                                   mations  to  apply, WAF performs all trans-
                                   formations on the specified content, start-
                                   ing  from  the lowest priority setting, and
                                   then uses the component contents.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations.  WAF
                                          processes  all transformations, from
                                          lowest priority to  highest,  before
                                          inspecting  the transformed content.
                                          The priorities don't need to be con-
                                          secutive,  but they must all be dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            RateBasedStatement -> (structure)
                               A  rate-based rule counts incoming requests and
                               rate limits requests when they  are  coming  at
                               too  fast a rate. The rule categorizes requests
                               according to your  aggregation  criteria,  col-
                               lects  them  into  aggregation  instances,  and
                               counts and rate limits the  requests  for  each
                               instance.

                               You  can  specify  individual aggregation keys,
                               like IP address or HTTP method.  You  can  also
                               specify  aggregation  key combinations, like IP
                               address and HTTP method, or HTTP method,  query
                               argument, and cookie.

                               Each  unique  set of values for the aggregation
                               keys that you specify is a separate aggregation
                               instance,  with  the  value  from each key con-
                               tributing to the aggregation  instance  defini-
                               tion.

                               For  example, assume the rule evaluates web re-
                               quests with the following IP address  and  HTTP
                               method values:

                               o IP address 10.1.1.1, HTTP method POST

                               o IP address 10.1.1.1, HTTP method GET

                               o IP address 127.0.0.0, HTTP method POST

                               o IP address 10.1.1.1, HTTP method GET

                               The rule would create different aggregation in-
                               stances according to your aggregation criteria,
                               for example:

                               o If  the  aggregation  criteria is just the IP
                                 address, then each individual address  is  an
                                 aggregation instance, and WAF counts requests
                                 separately  for  each.  The  aggregation  in-
                                 stances  and  request  counts for our example
                                 would be the following:

                                 o IP address 10.1.1.1: count 3

                                 o IP address 127.0.0.0: count 1

                               o If the aggregation criteria is  HTTP  method,
                                 then each individual HTTP method is an aggre-
                                 gation instance.  The  aggregation  instances
                                 and  request  counts for our example would be
                                 the following:

                                 o HTTP method POST: count 2

                                 o HTTP method GET: count 2

                               o If the aggregation criteria is IP address and
                                 HTTP  method,  then  each IP address and each
                                 HTTP method would contribute to the  combined
                                 aggregation  instance.  The  aggregation  in-
                                 stances and request counts  for  our  example
                                 would be the following:

                                 o IP  address  10.1.1.1,  HTTP  method  POST:
                                   count 1

                                 o IP address 10.1.1.1, HTTP method GET: count
                                   2

                                 o IP  address  127.0.0.0,  HTTP  method POST:
                                   count 1

                               For  any  n-tuple  of  aggregation  keys,  each
                               unique  combination  of values for the keys de-
                               fines a separate  aggregation  instance,  which
                               WAF counts and rate-limits individually.

                               You  can  optionally nest another statement in-
                               side the rate-based statement,  to  narrow  the
                               scope  of  the  rule so that it only counts and
                               rate limits  requests  that  match  the  nested
                               statement.  You  can use this nested scope-down
                               statement in conjunction with your  aggregation
                               key  specifications  or  you can just count and
                               rate  limit  all  requests   that   match   the
                               scope-down statement, without additional aggre-
                               gation. When you choose to just manage all  re-
                               quests  that  match a scope-down statement, the
                               aggregation instance is singular for the rule.

                               You cannot nest a RateBasedStatement inside an-
                               other statement, for example inside a NotState-
                               ment or OrStatement . You can  define  a  Rate-
                               BasedStatement  inside  a  web ACL and inside a
                               rule group.

                               For additional information about  the  options,
                               see Rate limiting web requests using rate-based
                               rules in the WAF Developer Guide .

                               If you only aggregate on the individual IP  ad-
                               dress or forwarded IP address, you can retrieve
                               the list of IP addresses that WAF is  currently
                               rate  limiting  for a rule through the API call
                               GetRateBasedStatementManagedKeys . This  option
                               is not available for other aggregation configu-
                               rations.

                               WAF tracks and manages web requests  separately
                               for each instance of a rate-based rule that you
                               use. For  example,  if  you  provide  the  same
                               rate-based  rule settings in two web ACLs, each
                               of the two rule statements represents  a  sepa-
                               rate  instance  of the rate-based rule and gets
                               its own tracking and management by WAF. If  you
                               define  a  rate-based rule inside a rule group,
                               and  then  use  that  rule  group  in  multiple
                               places, each use creates a separate instance of
                               the rate-based rule that gets its own  tracking
                               and management by WAF.

                               Limit -> (long)
                                   The  limit  on requests per 5-minute period
                                   for a single aggregation instance  for  the
                                   rate-based  rule.  If the rate-based state-
                                   ment includes a ScopeDownStatement  ,  this
                                   limit  is applied only to the requests that
                                   match the statement.

                                   Examples:

                                   o If you aggregate on just the IP  address,
                                     this  is  the  limit on requests from any
                                     single IP address.

                                   o If you aggregate on the HTTP  method  and
                                     the query argument name "city", then this
                                     is the limit on requests for  any  single
                                     method, city pair.

                               AggregateKeyType -> (string)
                                   Setting that indicates how to aggregate the
                                   request counts.

                                   NOTE:
                                      Web requests that are missing any of the
                                      components  specified in the aggregation
                                      keys are  omitted  from  the  rate-based
                                      rule evaluation and handling.

                                   o CONSTANT  -  Count and limit the requests
                                     that   match   the   rate-based    rule's
                                     scope-down  statement.  With this option,
                                     the counted requests aren't  further  ag-
                                     gregated. The scope-down statement is the
                                     only specification used. When  the  count
                                     of   all   requests   that   satisfy  the
                                     scope-down statement goes over the limit,
                                     WAF  applies  the  rule action to all re-
                                     quests that satisfy the scope-down state-
                                     ment.  With this option, you must config-
                                     ure the ScopeDownStatement property.

                                   o CUSTOM_KEYS  -  Aggregate   the   request
                                     counts using one or more web request com-
                                     ponents as the aggregate keys. With  this
                                     option,  you  must  specify the aggregate
                                     keys in the CustomKeys property.  To  ag-
                                     gregate  on  only  the IP address or only
                                     the forwarded IP address, don't use  cus-
                                     tom  keys. Instead, set the aggregate key
                                     type to IP or FORWARDED_IP .

                                   o FORWARDED_IP  -  Aggregate  the   request
                                     counts on the first IP address in an HTTP
                                     header.  With this option, you must spec-
                                     ify the header to use in the ForwardedIP-
                                     Config property.  To aggregate on a  com-
                                     bination of the forwarded IP address with
                                     other aggregate keys, use CUSTOM_KEYS .

                                   o IP - Aggregate the request counts on  the
                                     IP  address  from the web request origin.
                                     To aggregate on a combination of  the  IP
                                     address  with  other  aggregate keys, use
                                     CUSTOM_KEYS .

                               (  ...  recursive  ...  )ForwardedIPConfig   ->
                               (structure)
                                   The  configuration  for  inspecting  IP ad-
                                   dresses in an HTTP header that you specify,
                                   instead  of using the IP address that's re-
                                   ported by the web request origin. Commonly,
                                   this  is  the X-Forwarded-For (XFF) header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the  request, WAF doesn't apply the rule
                                      to the web request at all.

                                   This is required if you specify a forwarded
                                   IP in the rule's aggregate key settings.

                                   HeaderName -> (string)
                                      The  name  of the HTTP header to use for
                                      the IP address. For example, to use  the
                                      X-Forwarded-For  (XFF)  header, set this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The  match  status  to assign to the web
                                      request if the request  doesn't  have  a
                                      valid  IP address in the specified posi-
                                      tion.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      You  can  specify the following fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching  the  rule statement. WAF ap-
                                        plies the rule action to the request.

                                      o NO_MATCH - Treat the  web  request  as
                                        not matching the rule statement.

                               CustomKeys -> (list)
                                   Specifies  the  aggregate  keys to use in a
                                   rate-base rule.

                                   (structure)
                                      Specifies a single custom aggregate  key
                                      for a rate-base rule.

                                      NOTE:
                                          Web requests that are missing any of
                                          the components specified in the  ag-
                                          gregation  keys are omitted from the
                                          rate-based rule evaluation and  han-
                                          dling.

                                      Header -> (structure)
                                          Use the value of a header in the re-
                                          quest as an aggregate key. Each dis-
                                          tinct  value  in the header contrib-
                                          utes to the aggregation instance. If
                                          you use a single header as your cus-
                                          tom key, then each value  fully  de-
                                          fines an aggregation instance.

                                          Name -> (string)
                                             The name of the header to use.

                                          TextTransformations -> (list)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection. Text transformations are
                                             used in rule match statements, to
                                             transform  the  FieldToMatch  re-
                                             quest component before inspecting
                                             it,    and    they're   used   in
                                             rate-based  rule  statements,  to
                                             transform  request components be-
                                             fore using them as custom  aggre-
                                             gation  keys.  If you specify one
                                             or more transformations to apply,
                                             WAF  performs all transformations
                                             on the specified content,  start-
                                             ing from the lowest priority set-
                                             ting, and then uses the component
                                             contents.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing  order  for   multiple
                                                    transformations.  WAF pro-
                                                    cesses   all   transforma-
                                                    tions,  from lowest prior-
                                                    ity to highest, before in-
                                                    specting  the  transformed
                                                    content.  The   priorities
                                                    don't  need to be consecu-
                                                    tive, but they must all be
                                                    different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      Cookie -> (structure)
                                          Use the value of a cookie in the re-
                                          quest as an aggregate key. Each dis-
                                          tinct value in the  cookie  contrib-
                                          utes to the aggregation instance. If
                                          you use a single cookie as your cus-
                                          tom  key,  then each value fully de-
                                          fines an aggregation instance.

                                          Name -> (string)
                                             The name of the cookie to use.

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. Text transformations are
                                             used in rule match statements, to
                                             transform  the  FieldToMatch  re-
                                             quest component before inspecting
                                             it,   and   they're    used    in
                                             rate-based  rule  statements,  to
                                             transform request components  be-
                                             fore  using them as custom aggre-
                                             gation keys. If you  specify  one
                                             or more transformations to apply,
                                             WAF performs all  transformations
                                             on  the specified content, start-
                                             ing from the lowest priority set-
                                             ting, and then uses the component
                                             contents.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations. WAF  pro-
                                                    cesses   all   transforma-
                                                    tions, from lowest  prior-
                                                    ity to highest, before in-
                                                    specting  the  transformed
                                                    content.   The  priorities
                                                    don't need to be  consecu-
                                                    tive, but they must all be
                                                    different.

                                                 Type -> (string)
                                                    You can specify  the  fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a    Base64   -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode  a  Base64 -en-
                                                        coded string, but  use
                                                        a  forgiving implemen-
                                                        tation  that   ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE    -     Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness of  attackers
                                                        who  inject an operat-
                                                        ing    system     com-
                                                        mand-line  command and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following characters:  /
                                                      (

                                                    o Replace   the  following
                                                      characters with a space:
                                                      , ;

                                                    o Replace  multiple spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters  (A-Z) to lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace  these charac-
                                                        ters  with   a   space
                                                        character     (decimal
                                                        32):

                                                    o \f ,  formfeed,  decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE  -   Decode
                                                        characters  that  were
                                                        encoded using CSS  2.x
                                                        escape    rules   syn-
                                                        data.html#characters .
                                                        This  function uses up
                                                        to two  bytes  in  the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII  characters that
                                                        were encoded using CSS
                                                        encoding  that wouldnt
                                                        typically be  encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of  a  backslash   and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript  for java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI  C   escape   se-
                                                        quences:  \a , \b , \f
                                                        , \n , \r , \t , \v  ,
                                                        \\  ,  \?  , \' , \" ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO  (octal). Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE  - Decode a
                                                        string of  hexadecimal
                                                        characters  into a bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters with  unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs  these opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;    with     a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with  a "less than" sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal  format, (amper-
                                                      sand)#xhhhh; , with  the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal    format,   (amper-
                                                      sand)#nnnn; ,  with  the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript escape  se-
                                                        quences.  If  a  \   u
                                                        HHHH code  is  in  the
                                                        full-width  ASCII code
                                                        range of  FF01-FF5E  ,
                                                        then  the  higher byte
                                                        is used to detect  and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte  is  used and the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE  -   Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash from the data  in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you  don't  want   any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are not at the  begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This  is  the  same as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash  characters   to
                                                        forward slashes.

                                                        REMOVE_NULLS  - Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place each  occurrence
                                                        of  a  C-style comment
                                                        (/* ... */  )  with  a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments  are also re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a standalone  termina-
                                                        tion  of a comment (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS  -   Re-
                                                        place  NULL  bytes  in
                                                        the input  with  space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE  - Decode a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI -  Like
                                                        URL_DECODE  , but with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in    the   full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and  adjust  the lower
                                                        byte. Otherwise,  only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter  sequences to Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives  and false-nega-
                                                        tives for  non-English
                                                        languages.

                                      QueryArgument -> (structure)
                                          Use  the specified query argument as
                                          an  aggregate  key.  Each   distinct
                                          value  for  the named query argument
                                          contributes to the  aggregation  in-
                                          stance.  If  you  use a single query
                                          argument as your  custom  key,  then
                                          each value fully defines an aggrega-
                                          tion instance.

                                          Name -> (string)
                                             The name of the query argument to
                                             use.

                                          TextTransformations -> (list)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection. Text transformations are
                                             used in rule match statements, to
                                             transform  the  FieldToMatch  re-
                                             quest component before inspecting
                                             it,    and    they're   used   in
                                             rate-based  rule  statements,  to
                                             transform  request components be-
                                             fore using them as custom  aggre-
                                             gation  keys.  If you specify one
                                             or more transformations to apply,
                                             WAF  performs all transformations
                                             on the specified content,  start-
                                             ing from the lowest priority set-
                                             ting, and then uses the component
                                             contents.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing  order  for   multiple
                                                    transformations.  WAF pro-
                                                    cesses   all   transforma-
                                                    tions,  from lowest prior-
                                                    ity to highest, before in-
                                                    specting  the  transformed
                                                    content.  The   priorities
                                                    don't  need to be consecu-
                                                    tive, but they must all be
                                                    different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      QueryString -> (structure)
                                          Use the request's query string as an
                                          aggregate  key. Each distinct string
                                          contributes to the  aggregation  in-
                                          stance.  If  you  use just the query
                                          string as your custom key, then each
                                          string  fully defines an aggregation
                                          instance.

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. Text transformations are
                                             used in rule match statements, to
                                             transform  the  FieldToMatch  re-
                                             quest component before inspecting
                                             it,   and   they're    used    in
                                             rate-based  rule  statements,  to
                                             transform request components  be-
                                             fore  using them as custom aggre-
                                             gation keys. If you  specify  one
                                             or more transformations to apply,
                                             WAF performs all  transformations
                                             on  the specified content, start-
                                             ing from the lowest priority set-
                                             ting, and then uses the component
                                             contents.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations. WAF  pro-
                                                    cesses   all   transforma-
                                                    tions, from lowest  prior-
                                                    ity to highest, before in-
                                                    specting  the  transformed
                                                    content.   The  priorities
                                                    don't need to be  consecu-
                                                    tive, but they must all be
                                                    different.

                                                 Type -> (string)
                                                    You can specify  the  fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a    Base64   -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode  a  Base64 -en-
                                                        coded string, but  use
                                                        a  forgiving implemen-
                                                        tation  that   ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE    -     Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness of  attackers
                                                        who  inject an operat-
                                                        ing    system     com-
                                                        mand-line  command and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following characters:  /
                                                      (

                                                    o Replace   the  following
                                                      characters with a space:
                                                      , ;

                                                    o Replace  multiple spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters  (A-Z) to lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace  these charac-
                                                        ters  with   a   space
                                                        character     (decimal
                                                        32):

                                                    o \f ,  formfeed,  decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE  -   Decode
                                                        characters  that  were
                                                        encoded using CSS  2.x
                                                        escape    rules   syn-
                                                        data.html#characters .
                                                        This  function uses up
                                                        to two  bytes  in  the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII  characters that
                                                        were encoded using CSS
                                                        encoding  that wouldnt
                                                        typically be  encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of  a  backslash   and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript  for java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI  C   escape   se-
                                                        quences:  \a , \b , \f
                                                        , \n , \r , \t , \v  ,
                                                        \\  ,  \?  , \' , \" ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO  (octal). Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE  - Decode a
                                                        string of  hexadecimal
                                                        characters  into a bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters with  unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs  these opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;    with     a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with  a "less than" sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal  format, (amper-
                                                      sand)#xhhhh; , with  the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal    format,   (amper-
                                                      sand)#nnnn; ,  with  the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript escape  se-
                                                        quences.  If  a  \   u
                                                        HHHH code  is  in  the
                                                        full-width  ASCII code
                                                        range of  FF01-FF5E  ,
                                                        then  the  higher byte
                                                        is used to detect  and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte  is  used and the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE  -   Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash from the data  in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you  don't  want   any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are not at the  begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This  is  the  same as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash  characters   to
                                                        forward slashes.

                                                        REMOVE_NULLS  - Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place each  occurrence
                                                        of  a  C-style comment
                                                        (/* ... */  )  with  a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments  are also re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a standalone  termina-
                                                        tion  of a comment (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS  -   Re-
                                                        place  NULL  bytes  in
                                                        the input  with  space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE  - Decode a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI -  Like
                                                        URL_DECODE  , but with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in    the   full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and  adjust  the lower
                                                        byte. Otherwise,  only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter  sequences to Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives  and false-nega-
                                                        tives for  non-English
                                                        languages.

                                      HTTPMethod -> (structure)
                                          Use  the request's HTTP method as an
                                          aggregate key.  Each  distinct  HTTP
                                          method  contributes  to the aggrega-
                                          tion instance. If you use  just  the
                                          HTTP method as your custom key, then
                                          each method fully defines an  aggre-
                                          gation instance.

                                      ForwardedIP -> (structure)
                                          Use  the first IP address in an HTTP
                                          header as  an  aggregate  key.  Each
                                          distinct  forwarded  IP address con-
                                          tributes  to  the  aggregation   in-
                                          stance.

                                          When  you specify an IP or forwarded
                                          IP in the custom key  settings,  you
                                          must also specify at least one other
                                          key to use.  You  can  aggregate  on
                                          only  the  forwarded  IP  address by
                                          specifying  FORWARDED_IP   in   your
                                          rate-based statement's AggregateKey-
                                          Type .

                                          With this option, you  must  specify
                                          the  header to use in the rate-based
                                          rule's ForwardedIPConfig property.

                                      IP -> (structure)
                                          Use the request's originating IP ad-
                                          dress as an aggregate key. Each dis-
                                          tinct IP address contributes to  the
                                          aggregation instance.

                                          When  you specify an IP or forwarded
                                          IP in the custom key  settings,  you
                                          must also specify at least one other
                                          key to use.  You  can  aggregate  on
                                          only the IP address by specifying IP
                                          in your rate-based  statement's  Ag-
                                          gregateKeyType .

                                      LabelNamespace -> (structure)
                                          Use the specified label namespace as
                                          an  aggregate  key.  Each   distinct
                                          fully  qualified label name that has
                                          the specified label  namespace  con-
                                          tributes   to  the  aggregation  in-
                                          stance. If you use  just  one  label
                                          namespace  as  your custom key, then
                                          each label name fully defines an ag-
                                          gregation instance.

                                          This uses only labels that have been
                                          added to the request by  rules  that
                                          are evaluated before this rate-based
                                          rule in the web ACL.

                                          For information  about  label  name-
                                          spaces  and  names, see Label syntax
                                          and naming requirements in  the  WAF
                                          Developer Guide .

                                          Namespace -> (string)
                                             The namespace to use for aggrega-
                                             tion.

                            AndStatement -> (structure)
                               A logical rule statement used to combine  other
                               rule  statements  with  AND  logic. You provide
                               more than one  Statement within  the  AndState-
                               ment .

                               Statements -> (list)
                                   The  statements  to combine with AND logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   ( ... recursive ... )

                            OrStatement -> (structure)
                               A  logical rule statement used to combine other
                               rule statements with OR logic. You provide more
                               than one  Statement within the OrStatement .

                               Statements -> (list)
                                   The  statements  to  combine with OR logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   ( ... recursive ... )

                            NotStatement -> (structure)
                               A logical rule statement used to negate the re-
                               sults of another rule  statement.  You  provide
                               one  Statement within the NotStatement .

                               ( ... recursive ... )

                            ManagedRuleGroupStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined in a managed rule group. To  use  this,
                               provide  the  vendor  name  and the name of the
                               rule group in this statement. You can  retrieve
                               the  required names by calling  ListAvailableM-
                               anagedRuleGroups .

                               You cannot nest a  ManagedRuleGroupStatement  ,
                               for  example  for  use inside a NotStatement or
                               OrStatement . It can only be  referenced  as  a
                               top-level statement within a rule.

                               NOTE:
                                   You  are  charged  additional fees when you
                                   use the WAF Bot Control managed rule  group
                                   AWSManagedRulesBotControlRuleSet or the WAF
                                   Fraud Control account  takeover  prevention
                                   (ATP) managed rule group AWSManagedRulesAT-
                                   PRuleSet . For more  information,  see  WAF
                                   Pricing .

                               VendorName -> (string)
                                   The  name of the managed rule group vendor.
                                   You use this, along  with  the  rule  group
                                   name, to identify a rule group.

                               Name -> (string)
                                   The name of the managed rule group. You use
                                   this, along with the vendor name, to  iden-
                                   tify the rule group.

                               Version -> (string)
                                   The  version  of  the managed rule group to
                                   use. If you specify this, the version  set-
                                   ting  is  fixed until you change it. If you
                                   don't specify this, WAF uses  the  vendor's
                                   default version, and then keeps the version
                                   at the vendor's default when the vendor up-
                                   dates the managed rule group settings.

                               ExcludedRules -> (list)
                                   Rules  in  the  referenced rule group whose
                                   actions are set to Count .

                                   NOTE:
                                      Instead  of  this  option,  use  RuleAc-
                                      tionOverrides . It accepts any valid ac-
                                      tion setting, including Count .

                                   (structure)
                                      Specifies a single rule in a rule  group
                                      whose  action  you  want  to override to
                                      Count .

                                      NOTE:
                                          Instead of this option, use  RuleAc-
                                          tionOverrides . It accepts any valid
                                          action setting, including Count .

                                      Name -> (string)
                                          The name of the  rule  whose  action
                                          you want to override to Count .

                               ( ... recursive ... )ManagedRuleGroupConfigs ->
                               (list)
                                   Additional information  that's  used  by  a
                                   managed   rule  group.  Many  managed  rule
                                   groups don't require this.

                                   Use the AWSManagedRulesATPRuleSet  configu-
                                   ration object for the account takeover pre-
                                   vention managed rule group, to provide  in-
                                   formation  such as the sign-in page of your
                                   application and the type of content to  ac-
                                   cept or reject from the client.

                                   Use   the  AWSManagedRulesBotControlRuleSet
                                   configuration object to configure the  pro-
                                   tection level that you want the Bot Control
                                   rule group to use.

                                   (structure)
                                      Additional information that's used by  a
                                      managed  rule  group.  Many managed rule
                                      groups don't require this.

                                      Use the  AWSManagedRulesATPRuleSet  con-
                                      figuration  object for the account take-
                                      over prevention managed rule  group,  to
                                      provide  information such as the sign-in
                                      page of your application and the type of
                                      content  to  accept  or  reject from the
                                      client.

                                      Use the AWSManagedRulesBotControlRuleSet
                                      configuration  object  to  configure the
                                      protection level that you want  the  Bot
                                      Control rule group to use.

                                      For  example specifications, see the ex-
                                      amples section of  CreateWebACL .

                                      LoginPath -> (string)

                                          NOTE:
                                             Instead of this setting,  provide
                                             your  configuration under AWSMan-
                                             agedRulesATPRuleSet .

                                      PayloadType -> (string)

                                          NOTE:
                                             Instead of this setting,  provide
                                             your  configuration under AWSMan-
                                             agedRulesATPRuleSet    RequestIn-
                                             spection .

                                      UsernameField -> (structure)

                                          NOTE:
                                             Instead  of this setting, provide
                                             your configuration under  AWSMan-
                                             agedRulesATPRuleSet    RequestIn-
                                             spection .

                                          Identifier -> (string)
                                             The name of the  username  field.
                                             For example /form/username .

                                      PasswordField -> (structure)

                                          NOTE:
                                             Instead  of this setting, provide
                                             your configuration under  AWSMan-
                                             agedRulesATPRuleSet    RequestIn-
                                             spection .

                                          Identifier -> (string)
                                             The name of the  password  field.
                                             For example /form/password .

                                      AWSManagedRulesBotControlRuleSet      ->
                                      (structure)
                                          Additional configuration  for  using
                                          the  Bot Control managed rule group.
                                          Use this to specify  the  inspection
                                          level  that you want to use. For in-
                                          formation about using the  Bot  Con-
                                          trol managed rule group, see WAF Bot
                                          Control rule group and WAF Bot  Con-
                                          trol in the WAF Developer Guide .

                                          InspectionLevel -> (string)
                                             The  inspection  level to use for
                                             the Bot Control rule  group.  The
                                             common  level is the least expen-
                                             sive. The targeted level includes
                                             all  common  level rules and adds
                                             rules with more advanced  inspec-
                                             tion  criteria.  For details, see
                                             WAF Bot Control rule group in the
                                             WAF Developer Guide .

                                      AWSManagedRulesATPRuleSet -> (structure)
                                          Additional  configuration  for using
                                          the  account   takeover   prevention
                                          (ATP) managed rule group, AWSManage-
                                          dRulesATPRuleSet . Use this to  pro-
                                          vide  login  request  information to
                                          the rule group. For  web  ACLs  that
                                          protect   CloudFront  distributions,
                                          use this to also provide the  infor-
                                          mation  about  how your distribution
                                          responds to login requests.

                                          This configuration replaces the  in-
                                          dividual   configuration  fields  in
                                          ManagedRuleGroupConfig and  provides
                                          additional feature configuration.

                                          For  information about using the ATP
                                          managed rule group,  see  WAF  Fraud
                                          Control  account takeover prevention
                                          (ATP) rule group and WAF Fraud  Con-
                                          trol   account  takeover  prevention
                                          (ATP) in the WAF Developer Guide .

                                          LoginPath -> (string)
                                             The path of  the  login  endpoint
                                             for  your  application. For exam-
                                             ple, for  the  URL  https://exam-
                                             ple.com/web/login   ,  you  would
                                             provide the path /web/login .

                                             The rule group inspects only HTTP
                                             POST  requests  to your specified
                                             login endpoint.

                                          RequestInspection -> (structure)
                                             The criteria for inspecting login
                                             requests,  used  by  the ATP rule
                                             group to validate credentials us-
                                             age.

                                             PayloadType -> (string)
                                                 The payload type for your lo-
                                                 gin endpoint, either JSON  or
                                                 form encoded.

                                             UsernameField -> (structure)
                                                 Details about your login page
                                                 username field.

                                                 How you specify this  depends
                                                 on the payload type.

                                                 o For  JSON payloads, specify
                                                   the  field  name  in   JSON
                                                   pointer  syntax. For infor-
                                                   mation   about   the   JSON
                                                   Pointer syntax, see the In-
                                                   ternet   Engineering   Task
                                                   Force  (IETF) documentation
                                                   JavaScript Object  Notation
                                                   (JSON) Pointer .  For exam-
                                                   ple, for the JSON payload {
                                                   "login":    {   "username":
                                                   "THE_USERNAME", "password":
                                                   "THE_PASSWORD"  }  }  , the
                                                   username  field  specifica-
                                                   tion is /login/username and
                                                   the password field specifi-
                                                   cation is /login/password .

                                                 o For  form  encoded  payload
                                                   types, use  the  HTML  form
                                                   names.  For example, for an
                                                   HTML form with  input  ele-
                                                   ments  named  username1 and
                                                   password1  ,  the  username
                                                   field    specification   is
                                                   username1 and the  password
                                                   field    specification   is
                                                   password1 .

                                                 Identifier -> (string)
                                                    The name of  the  username
                                                    field.     For     example
                                                    /form/username .

                                             PasswordField -> (structure)
                                                 Details about your login page
                                                 password field.

                                                 How  you specify this depends
                                                 on the payload type.

                                                 o For JSON payloads,  specify
                                                   the   field  name  in  JSON
                                                   pointer syntax. For  infor-
                                                   mation   about   the   JSON
                                                   Pointer syntax, see the In-
                                                   ternet   Engineering   Task
                                                   Force (IETF)  documentation
                                                   JavaScript  Object Notation
                                                   (JSON) Pointer .  For exam-
                                                   ple, for the JSON payload {
                                                   "login":   {    "username":
                                                   "THE_USERNAME", "password":
                                                   "THE_PASSWORD" }  }  ,  the
                                                   username  field  specifica-
                                                   tion is /login/username and
                                                   the password field specifi-
                                                   cation is /login/password .

                                                 o For  form  encoded  payload
                                                   types,  use  the  HTML form
                                                   names. For example, for  an
                                                   HTML  form  with input ele-
                                                   ments named  username1  and
                                                   password1  ,  the  username
                                                   field   specification    is
                                                   username1  and the password
                                                   field   specification    is
                                                   password1 .

                                                 Identifier -> (string)
                                                    The  name  of the password
                                                    field.     For     example
                                                    /form/password .

                                          ResponseInspection -> (structure)
                                             The  criteria  for inspecting re-
                                             sponses to login  requests,  used
                                             by  the  ATP  rule group to track
                                             login failure rates.

                                             The ATP rule group evaluates  the
                                             responses that your protected re-
                                             sources send back to client login
                                             attempts,  keeping  count of suc-
                                             cessful and failed attempts  from
                                             each  IP  address and client ses-
                                             sion. Using this information, the
                                             rule  group  labels and mitigates
                                             requests from client sessions and
                                             IP addresses that submit too many
                                             failed login attempts in a  short
                                             amount of time.

                                             NOTE:
                                                 Response inspection is avail-
                                                 able only in  web  ACLs  that
                                                 protect   Amazon   CloudFront
                                                 distributions.

                                             StatusCode -> (structure)
                                                 Configures inspection of  the
                                                 response status code.

                                                 SuccessCodes -> (list)
                                                    Status  codes  in  the re-
                                                    sponse  that  indicate   a
                                                    successful  login attempt.
                                                    To be counted  as  a  suc-
                                                    cessful   login,  the  re-
                                                    sponse  status  code  must
                                                    match  one  of these. Each
                                                    code must be unique  among
                                                    the  success  and  failure
                                                    status codes.

                                                    JSON  example:   "Success-
                                                    Codes": [ 200, 201 ]

                                                    (integer)

                                                 FailureCodes -> (list)
                                                    Status  codes  in  the re-
                                                    sponse  that  indicate   a
                                                    failed  login  attempt. To
                                                    be counted as a failed lo-
                                                    gin,  the  response status
                                                    code  must  match  one  of
                                                    these.  Each  code must be
                                                    unique among  the  success
                                                    and failure status codes.

                                                    JSON   example:  "Failure-
                                                    Codes": [ 400, 404 ]

                                                    (integer)

                                             Header -> (structure)
                                                 Configures inspection of  the
                                                 response header.

                                                 Name -> (string)
                                                    The  name of the header to
                                                    match  against.  The  name
                                                    must  be  an  exact match,
                                                    including case.

                                                    JSON  example:  "Name":  [
                                                    "LoginResult" ]

                                                 SuccessValues -> (list)
                                                    Values   in  the  response
                                                    header with the  specified
                                                    name  that indicate a suc-
                                                    cessful login attempt.  To
                                                    be counted as a successful
                                                    login, the value  must  be
                                                    an  exact match, including
                                                    case. Each value  must  be
                                                    unique  among  the success
                                                    and failure values.

                                                    JSON example: "SuccessVal-
                                                    ues":   [   "LoginPassed",
                                                    "Successful login" ]

                                                    (string)

                                                 FailureValues -> (list)
                                                    Values  in  the   response
                                                    header  with the specified
                                                    name   that   indicate   a
                                                    failed  login  attempt. To
                                                    be counted as a failed lo-
                                                    gin,  the value must be an
                                                    exact   match,   including
                                                    case.  Each  value must be
                                                    unique among  the  success
                                                    and failure values.

                                                    JSON example: "FailureVal-
                                                    ues":   [   "LoginFailed",
                                                    "Failed login" ]

                                                    (string)

                                             BodyContains -> (structure)
                                                 Configures  inspection of the
                                                 response body.  WAF  can  in-
                                                 spect  the first 65,536 bytes
                                                 (64 KB) of the response body.

                                                 SuccessStrings -> (list)
                                                    Strings in the body of the
                                                    response  that  indicate a
                                                    successful login  attempt.
                                                    To  be  counted  as a suc-
                                                    cessful login, the  string
                                                    can  be  anywhere  in  the
                                                    body and must be an  exact
                                                    match,   including   case.
                                                    Each string must be unique
                                                    among   the   success  and
                                                    failure strings.

                                                    JSON    example:     "Suc-
                                                    cessStrings":   [   "Login
                                                    successful",  "Welcome  to
                                                    our site!" ]

                                                    (string)

                                                 FailureStrings -> (list)
                                                    Strings in the body of the
                                                    response that  indicate  a
                                                    failed  login  attempt. To
                                                    be counted as a failed lo-
                                                    gin,  the  string  can  be
                                                    anywhere in the  body  and
                                                    must  be  an  exact match,
                                                    including    case.    Each
                                                    string   must   be  unique
                                                    among  the   success   and
                                                    failure strings.

                                                    JSON   example:  "Failure-
                                                    Strings": [ "Login failed"
                                                    ]

                                                    (string)

                                             Json -> (structure)
                                                 Configures  inspection of the
                                                 response JSON.  WAF  can  in-
                                                 spect  the first 65,536 bytes
                                                 (64 KB) of the response JSON.

                                                 Identifier -> (string)
                                                    The  identifier  for   the
                                                    value  to match against in
                                                    the JSON.  The  identifier
                                                    must  be  an  exact match,
                                                    including case.

                                                    JSON   example:   "Identi-
                                                    fier":  [ "/login/success"
                                                    ]

                                                 SuccessValues -> (list)
                                                    Values for  the  specified
                                                    identifier in the response
                                                    JSON that indicate a  suc-
                                                    cessful  login attempt. To
                                                    be counted as a successful
                                                    login,  the  value must be
                                                    an exact match,  including
                                                    case.  Each  value must be
                                                    unique among  the  success
                                                    and failure values.

                                                    JSON example: "SuccessVal-
                                                    ues":  [   "True",   "Suc-
                                                    ceeded" ]

                                                    (string)

                                                 FailureValues -> (list)
                                                    Values  for  the specified
                                                    identifier in the response
                                                    JSON   that   indicate   a
                                                    failed login  attempt.  To
                                                    be counted as a failed lo-
                                                    gin, the value must be  an
                                                    exact   match,   including
                                                    case. Each value  must  be
                                                    unique  among  the success
                                                    and failure values.

                                                    JSON example: "FailureVal-
                                                    ues":  [ "False", "Failed"
                                                    ]

                                                    (string)

                               RuleActionOverrides -> (list)
                                   Action settings to use in the place of  the
                                   rule actions that are configured inside the
                                   rule group. You specify  one  override  for
                                   each rule whose action you want to change.

                                   You  can use overrides for testing, for ex-
                                   ample you can override all of rule  actions
                                   to  Count  and  then  monitor the resulting
                                   count metrics to understand  how  the  rule
                                   group  would  handle  your web traffic. You
                                   can also permanently override some  or  all
                                   actions,  to modify how the rule group man-
                                   ages your web traffic.

                                   (structure)
                                      Action setting to use in the place of  a
                                      rule  action  that  is configured inside
                                      the rule group. You specify one override
                                      for  each  rule whose action you want to
                                      change.

                                      You can use overrides for  testing,  for
                                      example you can override all of rule ac-
                                      tions to Count and then monitor the  re-
                                      sulting  count metrics to understand how
                                      the rule group  would  handle  your  web
                                      traffic.  You can also permanently over-
                                      ride some or all actions, to modify  how
                                      the rule group manages your web traffic.

                                      Name -> (string)
                                          The name of the rule to override.

                                      ActionToUse -> (structure)
                                          The override action to use, in place
                                          of the configured action of the rule
                                          in the rule group.

                                          Block -> (structure)
                                             Instructs  WAF  to  block the web
                                             request.

                                             CustomResponse -> (structure)
                                                 Defines a custom response for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses,  see Customizing web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 ResponseCode -> (integer)
                                                    The  HTTP  status  code to
                                                    return to the client.

                                                    For a list of status codes
                                                    that  you  can use in your
                                                    custom   responses,    see
                                                    Supported status codes for
                                                    custom response in the WAF
                                                    Developer Guide .

                                                 CustomResponseBodyKey      ->
                                                 (string)
                                                    References  the   response
                                                    body  that you want WAF to
                                                    return to the web  request
                                                    client.  You  can define a
                                                    custom response for a rule
                                                    action  or  a  default web
                                                    ACL action that is set  to
                                                    block.  To  do  this,  you
                                                    first define the  response
                                                    body  key and value in the
                                                    CustomResponseBodies  set-
                                                    ting  for  the   WebACL or
                                                    RuleGroup where  you  want
                                                    to  use  it.  Then, in the
                                                    rule action or web ACL de-
                                                    fault  action  BlockAction
                                                    setting, you reference the
                                                    response  body  using this
                                                    key.

                                                 ResponseHeaders -> (list)
                                                    The HTTP headers to use in
                                                    the   response.  Duplicate
                                                    header names are  not  al-
                                                    lowed.

                                                    For  information about the
                                                    limits on count  and  size
                                                    for custom request and re-
                                                    sponse settings,  see  WAF
                                                    quotas  in  the WAF Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse handling.  This
                                                        is  used in  CustomRe-
                                                        sponse and   CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The   name  of  the
                                                           custom header.

                                                           For custom  request
                                                           header   insertion,
                                                           when  WAF   inserts
                                                           the header into the
                                                           request,  it   pre-
                                                           fixes   this   name
                                                           x-amzn-waf-  ,   to
                                                           avoid     confusion
                                                           with  the   headers
                                                           that are already in
                                                           the  request.   For
                                                           example,   for  the
                                                           header name  sample
                                                           ,  WAF  inserts the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Allow -> (structure)
                                             Instructs WAF to  allow  the  web
                                             request.

                                             CustomRequestHandling  -> (struc-
                                             ture)
                                                 Defines custom  handling  for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses,  see Customizing web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into the  request.  Dupli-
                                                    cate  header names are not
                                                    allowed.

                                                    For information about  the
                                                    limits  on  count and size
                                                    for custom request and re-
                                                    sponse  settings,  see WAF
                                                    quotas in the  WAF  Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse  handling. This
                                                        is used in   CustomRe-
                                                        sponse  and  CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The  name  of   the
                                                           custom header.

                                                           For  custom request
                                                           header   insertion,
                                                           when   WAF  inserts
                                                           the header into the
                                                           request,   it  pre-
                                                           fixes   this   name
                                                           x-amzn-waf-   ,  to
                                                           avoid     confusion
                                                           with   the  headers
                                                           that are already in
                                                           the   request.  For
                                                           example,  for   the
                                                           header  name sample
                                                           , WAF  inserts  the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Count -> (structure)
                                             Instructs  WAF  to  count the web
                                             request and then continue  evalu-
                                             ating  the  request using the re-
                                             maining rules in the web ACL.

                                             CustomRequestHandling ->  (struc-
                                             ture)
                                                 Defines  custom  handling for
                                                 the web request.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses, see Customizing  web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into  the  request. Dupli-
                                                    cate header names are  not
                                                    allowed.

                                                    For  information about the
                                                    limits on count  and  size
                                                    for custom request and re-
                                                    sponse settings,  see  WAF
                                                    quotas  in  the WAF Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse handling.  This
                                                        is  used in  CustomRe-
                                                        sponse and   CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The   name  of  the
                                                           custom header.

                                                           For custom  request
                                                           header   insertion,
                                                           when  WAF   inserts
                                                           the header into the
                                                           request,  it   pre-
                                                           fixes   this   name
                                                           x-amzn-waf-  ,   to
                                                           avoid     confusion
                                                           with  the   headers
                                                           that are already in
                                                           the  request.   For
                                                           example,   for  the
                                                           header name  sample
                                                           ,  WAF  inserts the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Captcha -> (structure)
                                             Instructs WAF to  run  a  CAPTCHA
                                             check against the web request.

                                             CustomRequestHandling  -> (struc-
                                             ture)
                                                 Defines custom  handling  for
                                                 the  web  request,  used when
                                                 the CAPTCHA inspection deter-
                                                 mines  that the request's to-
                                                 ken is valid and unexpired.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses, see Customizing  web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into  the  request. Dupli-
                                                    cate header names are  not
                                                    allowed.

                                                    For  information about the
                                                    limits on count  and  size
                                                    for custom request and re-
                                                    sponse settings,  see  WAF
                                                    quotas  in  the WAF Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse handling.  This
                                                        is  used in  CustomRe-
                                                        sponse and   CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The   name  of  the
                                                           custom header.

                                                           For custom  request
                                                           header   insertion,
                                                           when  WAF   inserts
                                                           the header into the
                                                           request,  it   pre-
                                                           fixes   this   name
                                                           x-amzn-waf-  ,   to
                                                           avoid     confusion
                                                           with  the   headers
                                                           that are already in
                                                           the  request.   For
                                                           example,   for  the
                                                           header name  sample
                                                           ,  WAF  inserts the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                                          Challenge -> (structure)
                                             Instructs WAF to run a  Challenge
                                             check against the web request.

                                             CustomRequestHandling  -> (struc-
                                             ture)
                                                 Defines custom  handling  for
                                                 the  web  request,  used when
                                                 the challenge inspection  de-
                                                 termines  that  the request's
                                                 token is valid and unexpired.

                                                 For  information  about  cus-
                                                 tomizing web requests and re-
                                                 sponses, see Customizing  web
                                                 requests and responses in WAF
                                                 in the WAF Developer Guide .

                                                 InsertHeaders -> (list)
                                                    The HTTP headers to insert
                                                    into  the  request. Dupli-
                                                    cate header names are  not
                                                    allowed.

                                                    For  information about the
                                                    limits on count  and  size
                                                    for custom request and re-
                                                    sponse settings,  see  WAF
                                                    quotas  in  the WAF Devel-
                                                    oper Guide .

                                                    (structure)
                                                        A  custom  header  for
                                                        custom request and re-
                                                        sponse handling.  This
                                                        is  used in  CustomRe-
                                                        sponse and   CustomRe-
                                                        questHandling .

                                                        Name -> (string)
                                                           The   name  of  the
                                                           custom header.

                                                           For custom  request
                                                           header   insertion,
                                                           when  WAF   inserts
                                                           the header into the
                                                           request,  it   pre-
                                                           fixes   this   name
                                                           x-amzn-waf-  ,   to
                                                           avoid     confusion
                                                           with  the   headers
                                                           that are already in
                                                           the  request.   For
                                                           example,   for  the
                                                           header name  sample
                                                           ,  WAF  inserts the
                                                           header
                                                           x-amzn-waf-sample .

                                                        Value -> (string)
                                                           The  value  of  the
                                                           custom header.

                            LabelMatchStatement -> (structure)
                               A rule statement to match against  labels  that
                               have  been  added  to  the web request by rules
                               that have already run in the web ACL.

                               The label match statement provides the label or
                               namespace  string  to  search  for.  The  label
                               string can represent a part or all of the fully
                               qualified label name that had been added to the
                               web request. Fully qualified labels have a pre-
                               fix,  optional  namespaces, and label name. The
                               prefix identifies the rule  group  or  web  ACL
                               context  of  the  rule that added the label. If
                               you do not provide the fully qualified name  in
                               your  label  match  string,  WAF  performs  the
                               search for labels that were added in  the  same
                               context as the label match statement.

                               Scope -> (string)
                                   Specify whether you want to match using the
                                   label name or just the namespace.

                               Key -> (string)
                                   The string to match  against.  The  setting
                                   you  provide  for this depends on the match
                                   statement's Scope setting:

                                   o If the Scope indicates LABEL , then  this
                                     specification  must  include the name and
                                     can include any number of preceding name-
                                     space  specifications  and  prefix  up to
                                     providing the fully qualified label name.

                                   o If the Scope indicates NAMESPACE  ,  then
                                     this specification can include any number
                                     of contiguous namespace strings, and  can
                                     include the entire label namespace prefix
                                     from the rule group or web ACL where  the
                                     label originates.

                                   Labels are case sensitive and components of
                                   a label must be separated by colon, for ex-
                                   ample NS1:NS2:name .

                            RegexMatchStatement -> (structure)
                               A  rule  statement  used  to search web request
                               components for a match against a single regular
                               expression.

                               RegexString -> (string)
                                   The string representing the regular expres-
                                   sion.

                               FieldToMatch -> (structure)
                                   The part of the web request that  you  want
                                   WAF to inspect.

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Alternately,  you can filter and inspect
                                      all headers  with  the  Headers   Field-
                                      ToMatch setting.

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the part of the web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      A  limited amount of the request body is
                                      forwarded to WAF for inspection  by  the
                                      underlying  host  service.  For regional
                                      resources, the  limit  is  8  KB  (8,192
                                      kilobytes)  and for CloudFront distribu-
                                      tions, the limit is 16 KB (16,384  kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you can increase the limit  in  the  web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized  request  bodies, see the Body
                                      object configuration.

                                      OversizeHandling -> (string)
                                          What WAF should do if  the  body  is
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  the  web request
                                          body if the body exceeds  the  limit
                                          for  the  resource type. If the body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The  default  limit  is  8 KB (8,192
                                          kilobytes)  for  regional  resources
                                          and  16  KB  (16,384  kilobytes) for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease the limit in the web ACL  As-
                                          sociationConfig   ,  for  additional
                                          processing fees.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            body contents normally,  according
                                            to the rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          You  can  combine   the   MATCH   or
                                          NO_MATCH  settings for oversize han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request  whose  body  is  over   the
                                          limit.

                                          Default: CONTINUE

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      A  limited amount of the request body is
                                      forwarded to WAF for inspection  by  the
                                      underlying  host  service.  For regional
                                      resources, the  limit  is  8  KB  (8,192
                                      kilobytes)  and for CloudFront distribu-
                                      tions, the limit is 16 KB (16,384  kilo-
                                      bytes).  For  CloudFront  distributions,
                                      you can increase the limit  in  the  web
                                      ACL's AssociationConfig , for additional
                                      processing fees.

                                      For  information  about  how  to  handle
                                      oversized  request bodies, see the Json-
                                      Body object configuration.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                                      OversizeHandling -> (string)
                                          What  WAF  should  do if the body is
                                          larger than  WAF  can  inspect.  WAF
                                          does  not support inspecting the en-
                                          tire contents  of  the  web  request
                                          body  if  the body exceeds the limit
                                          for the resource type. If  the  body
                                          is larger than the limit, the under-
                                          lying host service only forwards the
                                          contents that are below the limit to
                                          WAF for inspection.

                                          The default limit  is  8  KB  (8,192
                                          kilobytes)  for  regional  resources
                                          and 16  KB  (16,384  kilobytes)  for
                                          CloudFront distributions. For Cloud-
                                          Front  distributions,  you  can  in-
                                          crease  the limit in the web ACL As-
                                          sociationConfig  ,  for   additional
                                          processing fees.

                                          The  options  for  oversize handling
                                          are the following:

                                          o CONTINUE - Inspect  the  available
                                            body  contents normally, according
                                            to the rule inspection criteria.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          You   can   combine   the  MATCH  or
                                          NO_MATCH settings for oversize  han-
                                          dling with your rule and web ACL ac-
                                          tion settings, so that you block any
                                          request   whose  body  is  over  the
                                          limit.

                                          Default: CONTINUE

                                   Headers -> (structure)
                                      Inspect the request  headers.  You  must
                                      configure  scope  and  pattern  matching
                                      filters in the Headers object, to define
                                      the  set  of headers to and the parts of
                                      the headers that WAF inspects.

                                      Only the first 8 KB (8192  bytes)  of  a
                                      request's headers and only the first 200
                                      headers are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must configure how to handle  any  over-
                                      size  header  content in the Headers ob-
                                      ject. WAF applies the  pattern  matching
                                      filters  to the headers that it receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The filter to use  to  identify  the
                                          subset  of  headers  to inspect in a
                                          web request.

                                          You must specify  exactly  one  set-
                                          ting: either All , IncludedHeaders ,
                                          or ExcludedHeaders .

                                          Example JSON: "MatchPattern": { "Ex-
                                          cludedHeaders":    {"KeyToExclude1",
                                          "KeyToExclude2"} }

                                          All -> (structure)
                                             Inspect all headers.

                                          IncludedHeaders -> (list)
                                             Inspect  only  the  headers  that
                                             have  a  key  that matches one of
                                             the strings specified here.

                                             (string)

                                          ExcludedHeaders -> (list)
                                             Inspect only  the  headers  whose
                                             keys   don't  match  any  of  the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The parts of the  headers  to  match
                                          with  the  rule inspection criteria.
                                          If you specify All  ,  WAF  inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  headers
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total headers. The underlying
                                          host service forwards a  maximum  of
                                          200  headers  and  at  most  8 KB of
                                          header contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                   Cookies -> (structure)
                                      Inspect the request  cookies.  You  must
                                      configure  scope  and  pattern  matching
                                      filters in the Cookies object, to define
                                      the  set of cookies and the parts of the
                                      cookies that WAF inspects.

                                      Only the first 8 KB (8192  bytes)  of  a
                                      request's cookies and only the first 200
                                      cookies are forwarded to WAF for inspec-
                                      tion by the underlying host service. You
                                      must configure how to handle  any  over-
                                      size  cookie  content in the Cookies ob-
                                      ject. WAF applies the  pattern  matching
                                      filters  to the cookies that it receives
                                      from the underlying host service.

                                      MatchPattern -> (structure)
                                          The filter to use  to  identify  the
                                          subset  of  cookies  to inspect in a
                                          web request.

                                          You must specify  exactly  one  set-
                                          ting: either All , IncludedCookies ,
                                          or ExcludedCookies .

                                          Example JSON: "MatchPattern": { "In-
                                          cludedCookies":    {"KeyToInclude1",
                                          "KeyToInclude2", "KeyToInclude3"} }

                                          All -> (structure)
                                             Inspect all cookies.

                                          IncludedCookies -> (list)
                                             Inspect  only  the  cookies  that
                                             have  a  key  that matches one of
                                             the strings specified here.

                                             (string)

                                          ExcludedCookies -> (list)
                                             Inspect only  the  cookies  whose
                                             keys   don't  match  any  of  the
                                             strings specified here.

                                             (string)

                                      MatchScope -> (string)
                                          The parts of the cookies to  inspect
                                          with  the  rule inspection criteria.
                                          If you specify All  ,  WAF  inspects
                                          both keys and values.

                                      OversizeHandling -> (string)
                                          What WAF should do if the cookies of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  cookies
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total cookies. The underlying
                                          host service forwards a  maximum  of
                                          200  cookies  and  at  most  8 KB of
                                          cookie contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            cookies normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                   HeaderOrder -> (structure)
                                      Inspect a string containing the list  of
                                      the  request's  header names, ordered as
                                      they appear in the web request that  WAF
                                      receives  for  inspection. WAF generates
                                      the string and then  uses  that  as  the
                                      field  to match component in its inspec-
                                      tion. WAF separates the header names  in
                                      the  string  using  commas  and no added
                                      spaces.

                                      Matches against the header order  string
                                      are case insensitive.

                                      OversizeHandling -> (string)
                                          What WAF should do if the headers of
                                          the request  are  more  numerous  or
                                          larger  than  WAF  can  inspect. WAF
                                          does not support inspecting the  en-
                                          tire  contents  of  request  headers
                                          when they exceed 8 KB  (8192  bytes)
                                          or 200 total headers. The underlying
                                          host service forwards a  maximum  of
                                          200  headers  and  at  most  8 KB of
                                          header contents to WAF.

                                          The options  for  oversize  handling
                                          are the following:

                                          o CONTINUE  -  Inspect the available
                                            headers normally, according to the
                                            rule inspection criteria.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion. Text transformations are used in rule
                                   match statements, to transform  the  Field-
                                   ToMatch request component before inspecting
                                   it, and they're  used  in  rate-based  rule
                                   statements, to transform request components
                                   before using  them  as  custom  aggregation
                                   keys.  If you specify one or more transfor-
                                   mations to apply, WAF performs  all  trans-
                                   formations on the specified content, start-
                                   ing from the lowest priority  setting,  and
                                   then uses the component contents.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations.  WAF
                                          processes all transformations,  from
                                          lowest  priority  to highest, before
                                          inspecting the transformed  content.
                                          The priorities don't need to be con-
                                          secutive, but they must all be  dif-
                                          ferent.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                        ManagedRuleGroupConfigs -> (list)
                            Additional information that's used  by  a  managed
                            rule group. Many managed rule groups don't require
                            this.

                            Use  the  AWSManagedRulesATPRuleSet  configuration
                            object for the account takeover prevention managed
                            rule group, to provide  information  such  as  the
                            sign-in  page  of your application and the type of
                            content to accept or reject from the client.

                            Use the AWSManagedRulesBotControlRuleSet  configu-
                            ration  object  to  configure the protection level
                            that you want the Bot Control rule group to use.

                            (structure)
                               Additional information that's used by a managed
                               rule  group. Many managed rule groups don't re-
                               quire this.

                               Use the AWSManagedRulesATPRuleSet configuration
                               object for the account takeover prevention man-
                               aged rule group, to provide information such as
                               the  sign-in  page  of your application and the
                               type of content to accept or  reject  from  the
                               client.

                               Use  the  AWSManagedRulesBotControlRuleSet con-
                               figuration object to configure  the  protection
                               level  that you want the Bot Control rule group
                               to use.

                               For example specifications,  see  the  examples
                               section of  CreateWebACL .

                               LoginPath -> (string)

                                   NOTE:
                                      Instead  of  this  setting, provide your
                                      configuration  under  AWSManagedRulesAT-
                                      PRuleSet .

                               PayloadType -> (string)

                                   NOTE:
                                      Instead  of  this  setting, provide your
                                      configuration  under  AWSManagedRulesAT-
                                      PRuleSet  RequestInspection .

                               UsernameField -> (structure)

                                   NOTE:
                                      Instead  of  this  setting, provide your
                                      configuration  under  AWSManagedRulesAT-
                                      PRuleSet  RequestInspection .

                                   Identifier -> (string)
                                      The  name of the username field. For ex-
                                      ample /form/username .

                               PasswordField -> (structure)

                                   NOTE:
                                      Instead of this  setting,  provide  your
                                      configuration  under  AWSManagedRulesAT-
                                      PRuleSet  RequestInspection .

                                   Identifier -> (string)
                                      The name of the password field. For  ex-
                                      ample /form/password .

                               AWSManagedRulesBotControlRuleSet -> (structure)
                                   Additional  configuration for using the Bot
                                   Control managed rule  group.  Use  this  to
                                   specify  the inspection level that you want
                                   to use. For information about using the Bot
                                   Control  managed  rule  group,  see WAF Bot
                                   Control rule group and WAF Bot  Control  in
                                   the WAF Developer Guide .

                                   InspectionLevel -> (string)
                                      The  inspection level to use for the Bot
                                      Control rule group. The common level  is
                                      the  least expensive. The targeted level
                                      includes all common level rules and adds
                                      rules with more advanced inspection cri-
                                      teria. For details, see WAF Bot  Control
                                      rule group in the WAF Developer Guide .

                               AWSManagedRulesATPRuleSet -> (structure)
                                   Additional  configuration for using the ac-
                                   count  takeover  prevention  (ATP)  managed
                                   rule group, AWSManagedRulesATPRuleSet . Use
                                   this to provide login  request  information
                                   to  the  rule group. For web ACLs that pro-
                                   tect CloudFront distributions, use this  to
                                   also provide the information about how your
                                   distribution responds to login requests.

                                   This configuration replaces the  individual
                                   configuration  fields  in ManagedRuleGroup-
                                   Config and provides additional feature con-
                                   figuration.

                                   For information about using the ATP managed
                                   rule group, see WAF Fraud  Control  account
                                   takeover  prevention  (ATP)  rule group and
                                   WAF Fraud Control account takeover  preven-
                                   tion (ATP) in the WAF Developer Guide .

                                   LoginPath -> (string)
                                      The  path of the login endpoint for your
                                      application. For example,  for  the  URL
                                      https://example.com/web/login    ,   you
                                      would provide the path /web/login .

                                      The rule group inspects only  HTTP  POST
                                      requests  to  your  specified login end-
                                      point.

                                   RequestInspection -> (structure)
                                      The criteria for  inspecting  login  re-
                                      quests,  used  by  the ATP rule group to
                                      validate credentials usage.

                                      PayloadType -> (string)
                                          The payload type for your login end-
                                          point, either JSON or form encoded.

                                      UsernameField -> (structure)
                                          Details  about your login page user-
                                          name field.

                                          How you specify this depends on  the
                                          payload type.

                                          o For  JSON  payloads,  specify  the
                                            field name in JSON pointer syntax.
                                            For  information  about  the  JSON
                                            Pointer syntax, see  the  Internet
                                            Engineering Task Force (IETF) doc-
                                            umentation JavaScript Object Nota-
                                            tion  (JSON)  Pointer .  For exam-
                                            ple, for the JSON payload  {  "lo-
                                            gin":   {  "username":  "THE_USER-
                                            NAME", "password":  "THE_PASSWORD"
                                            }  } , the username field specifi-
                                            cation is /login/username and  the
                                            password  field  specification  is
                                            /login/password .

                                          o For form  encoded  payload  types,
                                            use the HTML form names. For exam-
                                            ple, for an HTML form  with  input
                                            elements named username1 and pass-
                                            word1 , the username field  speci-
                                            fication   is  username1  and  the
                                            password  field  specification  is
                                            password1 .

                                          Identifier -> (string)
                                             The  name  of the username field.
                                             For example /form/username .

                                      PasswordField -> (structure)
                                          Details about your login page  pass-
                                          word field.

                                          How  you specify this depends on the
                                          payload type.

                                          o For  JSON  payloads,  specify  the
                                            field name in JSON pointer syntax.
                                            For  information  about  the  JSON
                                            Pointer  syntax,  see the Internet
                                            Engineering Task Force (IETF) doc-
                                            umentation JavaScript Object Nota-
                                            tion (JSON) Pointer .   For  exam-
                                            ple,  for  the JSON payload { "lo-
                                            gin":  {  "username":   "THE_USER-
                                            NAME",  "password": "THE_PASSWORD"
                                            } } , the username field  specifi-
                                            cation  is /login/username and the
                                            password  field  specification  is
                                            /login/password .

                                          o For  form  encoded  payload types,
                                            use the HTML form names. For exam-
                                            ple,  for  an HTML form with input
                                            elements named username1 and pass-
                                            word1  , the username field speci-
                                            fication  is  username1  and   the
                                            password  field  specification  is
                                            password1 .

                                          Identifier -> (string)
                                             The name of the  password  field.
                                             For example /form/password .

                                   ResponseInspection -> (structure)
                                      The criteria for inspecting responses to
                                      login requests, used  by  the  ATP  rule
                                      group to track login failure rates.

                                      The  ATP  rule  group  evaluates the re-
                                      sponses that  your  protected  resources
                                      send  back  to  client  login  attempts,
                                      keeping count of successful  and  failed
                                      attempts from each IP address and client
                                      session.  Using  this  information,  the
                                      rule group labels and mitigates requests
                                      from client sessions  and  IP  addresses
                                      that  submit  too  many failed login at-
                                      tempts in a short amount of time.

                                      NOTE:
                                          Response  inspection  is   available
                                          only in web ACLs that protect Amazon
                                          CloudFront distributions.

                                      StatusCode -> (structure)
                                          Configures  inspection  of  the  re-
                                          sponse status code.

                                          SuccessCodes -> (list)
                                             Status codes in the response that
                                             indicate a successful  login  at-
                                             tempt.  To  be  counted as a suc-
                                             cessful login, the response  sta-
                                             tus code must match one of these.
                                             Each code must  be  unique  among
                                             the  success  and  failure status
                                             codes.

                                             JSON example:  "SuccessCodes":  [
                                             200, 201 ]

                                             (integer)

                                          FailureCodes -> (list)
                                             Status codes in the response that
                                             indicate a failed login  attempt.
                                             To  be counted as a failed login,
                                             the  response  status  code  must
                                             match  one  of  these.  Each code
                                             must be unique among the  success
                                             and failure status codes.

                                             JSON  example:  "FailureCodes": [
                                             400, 404 ]

                                             (integer)

                                      Header -> (structure)
                                          Configures  inspection  of  the  re-
                                          sponse header.

                                          Name -> (string)
                                             The  name  of the header to match
                                             against. The name must be an  ex-
                                             act match, including case.

                                             JSON example: "Name": [ "LoginRe-
                                             sult" ]

                                          SuccessValues -> (list)
                                             Values  in  the  response  header
                                             with  the specified name that in-
                                             dicate  a  successful  login  at-
                                             tempt.  To  be  counted as a suc-
                                             cessful login, the value must  be
                                             an  exact  match, including case.
                                             Each value must be  unique  among
                                             the success and failure values.

                                             JSON  example: "SuccessValues": [
                                             "LoginPassed", "Successful login"
                                             ]

                                             (string)

                                          FailureValues -> (list)
                                             Values  in  the  response  header
                                             with the specified name that  in-
                                             dicate a failed login attempt. To
                                             be counted as a failed login, the
                                             value must be an exact match, in-
                                             cluding case. Each value must  be
                                             unique   among  the  success  and
                                             failure values.

                                             JSON example: "FailureValues":  [
                                             "LoginFailed", "Failed login" ]

                                             (string)

                                      BodyContains -> (structure)
                                          Configures  inspection  of  the  re-
                                          sponse body.  WAF  can  inspect  the
                                          first  65,536  bytes  (64 KB) of the
                                          response body.

                                          SuccessStrings -> (list)
                                             Strings in the body  of  the  re-
                                             sponse that indicate a successful
                                             login attempt. To be counted as a
                                             successful  login, the string can
                                             be anywhere in the body and  must
                                             be   an  exact  match,  including
                                             case. Each string must be  unique
                                             among  the  success  and  failure
                                             strings.

                                             JSON example: "SuccessStrings": [
                                             "Login  successful",  "Welcome to
                                             our site!" ]

                                             (string)

                                          FailureStrings -> (list)
                                             Strings in the body  of  the  re-
                                             sponse that indicate a failed lo-
                                             gin attempt. To be counted  as  a
                                             failed  login,  the string can be
                                             anywhere in the body and must  be
                                             an  exact  match, including case.
                                             Each string must be unique  among
                                             the success and failure strings.

                                             JSON example: "FailureStrings": [
                                             "Login failed" ]

                                             (string)

                                      Json -> (structure)
                                          Configures  inspection  of  the  re-
                                          sponse  JSON.  WAF  can  inspect the
                                          first 65,536 bytes (64  KB)  of  the
                                          response JSON.

                                          Identifier -> (string)
                                             The  identifier  for the value to
                                             match against in  the  JSON.  The
                                             identifier   must   be  an  exact
                                             match, including case.

                                             JSON  example:  "Identifier":   [
                                             "/login/success" ]

                                          SuccessValues -> (list)
                                             Values  for the specified identi-
                                             fier in the  response  JSON  that
                                             indicate  a  successful login at-
                                             tempt. To be counted  as  a  suc-
                                             cessful  login, the value must be
                                             an exact match,  including  case.
                                             Each  value  must be unique among
                                             the success and failure values.

                                             JSON example: "SuccessValues":  [
                                             "True", "Succeeded" ]

                                             (string)

                                          FailureValues -> (list)
                                             Values  for the specified identi-
                                             fier in the  response  JSON  that
                                             indicate  a failed login attempt.
                                             To be counted as a failed  login,
                                             the value must be an exact match,
                                             including case. Each  value  must
                                             be  unique  among the success and
                                             failure values.

                                             JSON example: "FailureValues":  [
                                             "False", "Failed" ]

                                             (string)

                        RuleActionOverrides -> (list)
                            Action  settings  to  use in the place of the rule
                            actions that are configured inside the rule group.
                            You  specify  one override for each rule whose ac-
                            tion you want to change.

                            You can use overrides for testing, for example you
                            can override all of rule actions to Count and then
                            monitor the resulting count metrics to  understand
                            how  the rule group would handle your web traffic.
                            You can also permanently override some or all  ac-
                            tions,  to  modify how the rule group manages your
                            web traffic.

                            (structure)
                               Action setting to use in the place  of  a  rule
                               action  that  is  configured  inside  the  rule
                               group. You specify one override for  each  rule
                               whose action you want to change.

                               You  can use overrides for testing, for example
                               you can override all of rule actions  to  Count
                               and then monitor the resulting count metrics to
                               understand how the rule group would handle your
                               web  traffic. You can also permanently override
                               some or all actions, to  modify  how  the  rule
                               group manages your web traffic.

                               Name -> (string)
                                   The name of the rule to override.

                               ActionToUse -> (structure)
                                   The override action to use, in place of the
                                   configured action of the rule in  the  rule
                                   group.

                                   Block -> (structure)
                                      Instructs WAF to block the web request.

                                      CustomResponse -> (structure)
                                          Defines  a  custom  response for the
                                          web request.

                                          For  information  about  customizing
                                          web   requests  and  responses,  see
                                          Customizing  web  requests  and  re-
                                          sponses  in WAF in the WAF Developer
                                          Guide .

                                          ResponseCode -> (integer)
                                             The HTTP status code to return to
                                             the client.

                                             For  a  list of status codes that
                                             you can use in  your  custom  re-
                                             sponses,   see  Supported  status
                                             codes for custom response in  the
                                             WAF Developer Guide .

                                          CustomResponseBodyKey -> (string)
                                             References the response body that
                                             you want WAF to return to the web
                                             request  client. You can define a
                                             custom response for a rule action
                                             or  a default web ACL action that
                                             is set to block. To do this,  you
                                             first  define  the  response body
                                             key and value  in  the  CustomRe-
                                             sponseBodies setting for the  We-
                                             bACL or  RuleGroup where you want
                                             to  use it. Then, in the rule ac-
                                             tion or web  ACL  default  action
                                             BlockAction  setting,  you refer-
                                             ence the response body using this
                                             key.

                                          ResponseHeaders -> (list)
                                             The  HTTP  headers  to use in the
                                             response. Duplicate header  names
                                             are not allowed.

                                             For  information about the limits
                                             on count and size for custom  re-
                                             quest  and response settings, see
                                             WAF quotas in the  WAF  Developer
                                             Guide .

                                             (structure)
                                                 A  custom  header  for custom
                                                 request  and  response   han-
                                                 dling.  This is used in  Cus-
                                                 tomResponse  and    CustomRe-
                                                 questHandling .

                                                 Name -> (string)
                                                    The  name  of  the  custom
                                                    header.

                                                    For custom request  header
                                                    insertion,  when  WAF  in-
                                                    serts the header into  the
                                                    request,  it prefixes this
                                                    name  x-amzn-waf-   ,   to
                                                    avoid  confusion  with the
                                                    headers that  are  already
                                                    in  the request. For exam-
                                                    ple, for the  header  name
                                                    sample  ,  WAF inserts the
                                                    header x-amzn-waf-sample .

                                                 Value -> (string)
                                                    The value  of  the  custom
                                                    header.

                                   Allow -> (structure)
                                      Instructs WAF to allow the web request.

                                      CustomRequestHandling -> (structure)
                                          Defines  custom handling for the web
                                          request.

                                          For  information  about  customizing
                                          web   requests  and  responses,  see
                                          Customizing  web  requests  and  re-
                                          sponses  in WAF in the WAF Developer
                                          Guide .

                                          InsertHeaders -> (list)
                                             The HTTP headers to  insert  into
                                             the   request.  Duplicate  header
                                             names are not allowed.

                                             For information about the  limits
                                             on  count and size for custom re-
                                             quest and response settings,  see
                                             WAF  quotas  in the WAF Developer
                                             Guide .

                                             (structure)
                                                 A custom  header  for  custom
                                                 request   and  response  han-
                                                 dling. This is used in   Cus-
                                                 tomResponse   and   CustomRe-
                                                 questHandling .

                                                 Name -> (string)
                                                    The  name  of  the  custom
                                                    header.

                                                    For  custom request header
                                                    insertion,  when  WAF  in-
                                                    serts  the header into the
                                                    request, it prefixes  this
                                                    name   x-amzn-waf-   ,  to
                                                    avoid confusion  with  the
                                                    headers  that  are already
                                                    in the request. For  exam-
                                                    ple,  for  the header name
                                                    sample , WAF  inserts  the
                                                    header x-amzn-waf-sample .

                                                 Value -> (string)
                                                    The  value  of  the custom
                                                    header.

                                   Count -> (structure)
                                      Instructs WAF to count the  web  request
                                      and then continue evaluating the request
                                      using the remaining  rules  in  the  web
                                      ACL.

                                      CustomRequestHandling -> (structure)
                                          Defines  custom handling for the web
                                          request.

                                          For  information  about  customizing
                                          web   requests  and  responses,  see
                                          Customizing  web  requests  and  re-
                                          sponses  in WAF in the WAF Developer
                                          Guide .

                                          InsertHeaders -> (list)
                                             The HTTP headers to  insert  into
                                             the   request.  Duplicate  header
                                             names are not allowed.

                                             For information about the  limits
                                             on  count and size for custom re-
                                             quest and response settings,  see
                                             WAF  quotas  in the WAF Developer
                                             Guide .

                                             (structure)
                                                 A custom  header  for  custom
                                                 request   and  response  han-
                                                 dling. This is used in   Cus-
                                                 tomResponse   and   CustomRe-
                                                 questHandling .

                                                 Name -> (string)
                                                    The  name  of  the  custom
                                                    header.

                                                    For  custom request header
                                                    insertion,  when  WAF  in-
                                                    serts  the header into the
                                                    request, it prefixes  this
                                                    name   x-amzn-waf-   ,  to
                                                    avoid confusion  with  the
                                                    headers  that  are already
                                                    in the request. For  exam-
                                                    ple,  for  the header name
                                                    sample , WAF  inserts  the
                                                    header x-amzn-waf-sample .

                                                 Value -> (string)
                                                    The  value  of  the custom
                                                    header.

                                   Captcha -> (structure)
                                      Instructs WAF to  run  a  CAPTCHA  check
                                      against the web request.

                                      CustomRequestHandling -> (structure)
                                          Defines  custom handling for the web
                                          request, used when the  CAPTCHA  in-
                                          spection  determines  that  the  re-
                                          quest's token  is  valid  and  unex-
                                          pired.

                                          For  information  about  customizing
                                          web  requests  and  responses,   see
                                          Customizing  web  requests  and  re-
                                          sponses in WAF in the WAF  Developer
                                          Guide .

                                          InsertHeaders -> (list)
                                             The  HTTP  headers to insert into
                                             the  request.  Duplicate   header
                                             names are not allowed.

                                             For  information about the limits
                                             on count and size for custom  re-
                                             quest  and response settings, see
                                             WAF quotas in the  WAF  Developer
                                             Guide .

                                             (structure)
                                                 A  custom  header  for custom
                                                 request  and  response   han-
                                                 dling.  This is used in  Cus-
                                                 tomResponse  and    CustomRe-
                                                 questHandling .

                                                 Name -> (string)
                                                    The  name  of  the  custom
                                                    header.

                                                    For custom request  header
                                                    insertion,  when  WAF  in-
                                                    serts the header into  the
                                                    request,  it prefixes this
                                                    name  x-amzn-waf-   ,   to
                                                    avoid  confusion  with the
                                                    headers that  are  already
                                                    in  the request. For exam-
                                                    ple, for the  header  name
                                                    sample  ,  WAF inserts the
                                                    header x-amzn-waf-sample .

                                                 Value -> (string)
                                                    The value  of  the  custom
                                                    header.

                                   Challenge -> (structure)
                                      Instructs  WAF  to run a Challenge check
                                      against the web request.

                                      CustomRequestHandling -> (structure)
                                          Defines custom handling for the  web
                                          request, used when the challenge in-
                                          spection  determines  that  the  re-
                                          quest's  token  is  valid  and unex-
                                          pired.

                                          For  information  about  customizing
                                          web   requests  and  responses,  see
                                          Customizing  web  requests  and  re-
                                          sponses  in WAF in the WAF Developer
                                          Guide .

                                          InsertHeaders -> (list)
                                             The HTTP headers to  insert  into
                                             the   request.  Duplicate  header
                                             names are not allowed.

                                             For information about the  limits
                                             on  count and size for custom re-
                                             quest and response settings,  see
                                             WAF  quotas  in the WAF Developer
                                             Guide .

                                             (structure)
                                                 A custom  header  for  custom
                                                 request   and  response  han-
                                                 dling. This is used in   Cus-
                                                 tomResponse   and   CustomRe-
                                                 questHandling .

                                                 Name -> (string)
                                                    The  name  of  the  custom
                                                    header.

                                                    For  custom request header
                                                    insertion,  when  WAF  in-
                                                    serts  the header into the
                                                    request, it prefixes  this
                                                    name   x-amzn-waf-   ,  to
                                                    avoid confusion  with  the
                                                    headers  that  are already
                                                    in the request. For  exam-
                                                    ple,  for  the header name
                                                    sample , WAF  inserts  the
                                                    header x-amzn-waf-sample .

                                                 Value -> (string)
                                                    The  value  of  the custom
                                                    header.

                     LabelMatchStatement -> (structure)
                        A rule statement to match  against  labels  that  have
                        been  added  to the web request by rules that have al-
                        ready run in the web ACL.

                        The label match statement provides the label or  name-
                        space  string to search for. The label string can rep-
                        resent a part or all of the fully qualified label name
                        that  had  been added to the web request. Fully quali-
                        fied labels have a prefix,  optional  namespaces,  and
                        label  name.  The  prefix identifies the rule group or
                        web ACL context of the rule that added the  label.  If
                        you  do  not  provide the fully qualified name in your
                        label match string, WAF performs the search for labels
                        that were added in the same context as the label match
                        statement.

                        Scope -> (string)
                            Specify whether you want to match using the  label
                            name or just the namespace.

                        Key -> (string)
                            The  string to match against. The setting you pro-
                            vide for this depends  on  the  match  statement's
                            Scope setting:

                            o If  the Scope indicates LABEL , then this speci-
                              fication must include the name and  can  include
                              any number of preceding namespace specifications
                              and prefix up to providing the  fully  qualified
                              label name.

                            o If  the  Scope  indicates  NAMESPACE , then this
                              specification can include any number of contigu-
                              ous  namespace  strings, and can include the en-
                              tire label namespace prefix from the rule  group
                              or web ACL where the label originates.

                            Labels  are case sensitive and components of a la-
                            bel  must  be  separated  by  colon,  for  example
                            NS1:NS2:name .

                     RegexMatchStatement -> (structure)
                        A rule statement used to search web request components
                        for a match against a single regular expression.

                        RegexString -> (string)
                            The string representing the regular expression.

                        FieldToMatch -> (structure)
                            The part of the web request that you want  WAF  to
                            inspect.

                            SingleHeader -> (structure)
                               Inspect  a  single  header. Provide the name of
                               the header to inspect, for example,  User-Agent
                               or Referer . This setting isn't case sensitive.

                               Example   JSON:   "SingleHeader":   {   "Name":
                               "haystack" }

                               Alternately, you can  filter  and  inspect  all
                               headers with the Headers  FieldToMatch setting.

                               Name -> (string)
                                   The name of the query header to inspect.

                            SingleQueryArgument -> (structure)
                               Inspect  a  single  query argument. Provide the
                               name of the query argument to inspect, such  as
                               UserName or SalesRegion . The name can be up to
                               30 characters long and isn't case sensitive.

                               Example JSON: "SingleQueryArgument": {  "Name":
                               "myArgument" }

                               Name -> (string)
                                   The name of the query argument to inspect.

                            AllQueryArguments -> (structure)
                               Inspect all query arguments.

                            UriPath -> (structure)
                               Inspect  the request URI path. This is the part
                               of the web request that identifies a  resource,
                               for example, /images/daily-ad.jpg .

                            QueryString -> (structure)
                               Inspect the query string. This is the part of a
                               URL that appears after a ? character, if any.

                            Body -> (structure)
                               Inspect the request body as plain text. The re-
                               quest  body  immediately  follows  the  request
                               headers. This is the part  of  a  request  that
                               contains  any  additional data that you want to
                               send to your web server  as  the  HTTP  request
                               body, such as data from a form.

                               A  limited  amount  of the request body is for-
                               warded to WAF for inspection by the  underlying
                               host service. For regional resources, the limit
                               is 8 KB (8,192 kilobytes)  and  for  CloudFront
                               distributions, the limit is 16 KB (16,384 kilo-
                               bytes). For CloudFront distributions,  you  can
                               increase  the  limit  in the web ACL's Associa-
                               tionConfig , for additional processing fees.

                               For information about how to  handle  oversized
                               request  bodies, see the Body object configura-
                               tion.

                               OversizeHandling -> (string)
                                   What WAF should do if the  body  is  larger
                                   than  WAF can inspect. WAF does not support
                                   inspecting the entire contents of  the  web
                                   request  body if the body exceeds the limit
                                   for the  resource  type.  If  the  body  is
                                   larger  than the limit, the underlying host
                                   service only forwards the contents that are
                                   below the limit to WAF for inspection.

                                   The default limit is 8 KB (8,192 kilobytes)
                                   for regional resources and  16  KB  (16,384
                                   kilobytes)  for  CloudFront  distributions.
                                   For CloudFront distributions, you  can  in-
                                   crease  the  limit  in the web ACL Associa-
                                   tionConfig  ,  for  additional   processing
                                   fees.

                                   The  options  for oversize handling are the
                                   following:

                                   o CONTINUE -  Inspect  the  available  body
                                     contents  normally, according to the rule
                                     inspection criteria.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                                   You  can combine the MATCH or NO_MATCH set-
                                   tings for oversize handling with your  rule
                                   and  web  ACL  action settings, so that you
                                   block any request whose body  is  over  the
                                   limit.

                                   Default: CONTINUE

                            Method -> (structure)
                               Inspect  the  HTTP method. The method indicates
                               the type of operation that the request is  ask-
                               ing the origin to perform.

                            JsonBody -> (structure)
                               Inspect  the  request body as JSON. The request
                               body immediately follows the  request  headers.
                               This is the part of a request that contains any
                               additional data that you want to send  to  your
                               web  server  as  the HTTP request body, such as
                               data from a form.

                               A limited amount of the request  body  is  for-
                               warded  to WAF for inspection by the underlying
                               host service. For regional resources, the limit
                               is  8  KB  (8,192 kilobytes) and for CloudFront
                               distributions, the limit is 16 KB (16,384 kilo-
                               bytes).  For  CloudFront distributions, you can
                               increase the limit in the  web  ACL's  Associa-
                               tionConfig , for additional processing fees.

                               For  information  about how to handle oversized
                               request bodies, see the JsonBody object config-
                               uration.

                               MatchPattern -> (structure)
                                   The  patterns to look for in the JSON body.
                                   WAF inspects the results of  these  pattern
                                   matches  against the rule inspection crite-
                                   ria.

                                   All -> (structure)
                                      Match all  of  the  elements.  See  also
                                      MatchScope in  JsonBody .

                                      You  must specify either this setting or
                                      the IncludedPaths setting, but not both.

                                   IncludedPaths -> (list)
                                      Match only the specified include  paths.
                                      See also MatchScope in  JsonBody .

                                      Provide  the  include  paths  using JSON
                                      Pointer syntax. For example,  "Included-
                                      Paths": ["/dogs/0/name", "/dogs/1/name"]
                                      . For information about this syntax, see
                                      the   Internet  Engineering  Task  Force
                                      (IETF) documentation  JavaScript  Object
                                      Notation (JSON) Pointer .

                                      You  must specify either this setting or
                                      the All setting, but not both.

                                      NOTE:
                                          Don't use this option to include all
                                          paths. Instead, use the All setting.

                                      (string)

                               MatchScope -> (string)
                                   The  parts of the JSON to match against us-
                                   ing the MatchPattern . If you specify All ,
                                   WAF matches against keys and values.

                               InvalidFallbackBehavior -> (string)
                                   What  WAF  should  do  if  it fails to com-
                                   pletely parse the JSON  body.  The  options
                                   are the following:

                                   o EVALUATE_AS_STRING  - Inspect the body as
                                     plain text. WAF applies the  text  trans-
                                     formations  and  inspection criteria that
                                     you defined for the  JSON  inspection  to
                                     the body text string.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                                   If you  don't  provide  this  setting,  WAF
                                   parses and evaluates the content only up to
                                   the first parsing failure that  it  encoun-
                                   ters.

                                   WAF  does its best to parse the entire JSON
                                   body, but might be forced to stop for  rea-
                                   sons  such as invalid characters, duplicate
                                   keys, truncation,  and  any  content  whose
                                   root node isn't an object or an array.

                                   WAF  parses the JSON in the following exam-
                                   ples as two valid key, value pairs:

                                   o Missing                            comma:
                                     {"key1":"value1""key2":"value2"}

                                   o Missing                            colon:
                                     {"key1":"value1","key2""value2"}

                                   o Extra                             colons:
                                     {"key1"::"value1","key2""value2"}

                               OversizeHandling -> (string)
                                   What  WAF  should  do if the body is larger
                                   than WAF can inspect. WAF does not  support
                                   inspecting  the  entire contents of the web
                                   request body if the body exceeds the  limit
                                   for  the  resource  type.  If  the  body is
                                   larger than the limit, the underlying  host
                                   service only forwards the contents that are
                                   below the limit to WAF for inspection.

                                   The default limit is 8 KB (8,192 kilobytes)
                                   for  regional  resources  and 16 KB (16,384
                                   kilobytes)  for  CloudFront  distributions.
                                   For  CloudFront  distributions, you can in-
                                   crease the limit in the  web  ACL  Associa-
                                   tionConfig   ,  for  additional  processing
                                   fees.

                                   The options for oversize handling  are  the
                                   following:

                                   o CONTINUE  -  Inspect  the  available body
                                     contents normally, according to the  rule
                                     inspection criteria.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                                   You can combine the MATCH or NO_MATCH  set-
                                   tings  for oversize handling with your rule
                                   and web ACL action settings,  so  that  you
                                   block  any  request  whose body is over the
                                   limit.

                                   Default: CONTINUE

                            Headers -> (structure)
                               Inspect the request headers. You must configure
                               scope and pattern matching filters in the Head-
                               ers object, to define the set of headers to and
                               the parts of the headers that WAF inspects.

                               Only the first 8 KB (8192 bytes) of a request's
                               headers and only the first 200 headers are for-
                               warded  to WAF for inspection by the underlying
                               host service. You must configure how to  handle
                               any  oversize header content in the Headers ob-
                               ject. WAF applies the pattern matching  filters
                               to the headers that it receives from the under-
                               lying host service.

                               MatchPattern -> (structure)
                                   The filter to use to identify the subset of
                                   headers to inspect in a web request.

                                   You  must  specify exactly one setting: ei-
                                   ther All , IncludedHeaders ,  or  Excluded-
                                   Headers .

                                   Example  JSON: "MatchPattern": { "Excluded-
                                   Headers":    {"KeyToExclude1",    "KeyToEx-
                                   clude2"} }

                                   All -> (structure)
                                      Inspect all headers.

                                   IncludedHeaders -> (list)
                                      Inspect only the headers that have a key
                                      that matches one of the  strings  speci-
                                      fied here.

                                      (string)

                                   ExcludedHeaders -> (list)
                                      Inspect  only  the  headers  whose  keys
                                      don't match any of the strings specified
                                      here.

                                      (string)

                               MatchScope -> (string)
                                   The  parts of the headers to match with the
                                   rule inspection criteria.  If  you  specify
                                   All , WAF inspects both keys and values.

                               OversizeHandling -> (string)
                                   What  WAF  should  do if the headers of the
                                   request are more numerous  or  larger  than
                                   WAF  can  inspect. WAF does not support in-
                                   specting the  entire  contents  of  request
                                   headers  when they exceed 8 KB (8192 bytes)
                                   or 200 total headers. The  underlying  host
                                   service  forwards  a maximum of 200 headers
                                   and at most 8 KB of header contents to WAF.

                                   The options for oversize handling  are  the
                                   following:

                                   o CONTINUE  - Inspect the available headers
                                     normally, according to the  rule  inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                            Cookies -> (structure)
                               Inspect the request cookies. You must configure
                               scope and pattern matching filters in the Cook-
                               ies object, to define the set  of  cookies  and
                               the parts of the cookies that WAF inspects.

                               Only the first 8 KB (8192 bytes) of a request's
                               cookies and only the first 200 cookies are for-
                               warded  to WAF for inspection by the underlying
                               host service. You must configure how to  handle
                               any  oversize cookie content in the Cookies ob-
                               ject. WAF applies the pattern matching  filters
                               to the cookies that it receives from the under-
                               lying host service.

                               MatchPattern -> (structure)
                                   The filter to use to identify the subset of
                                   cookies to inspect in a web request.

                                   You  must  specify exactly one setting: ei-
                                   ther All , IncludedCookies ,  or  Excluded-
                                   Cookies .

                                   Example  JSON: "MatchPattern": { "Included-
                                   Cookies":    {"KeyToInclude1",    "KeyToIn-
                                   clude2", "KeyToInclude3"} }

                                   All -> (structure)
                                      Inspect all cookies.

                                   IncludedCookies -> (list)
                                      Inspect only the cookies that have a key
                                      that matches one of the  strings  speci-
                                      fied here.

                                      (string)

                                   ExcludedCookies -> (list)
                                      Inspect  only  the  cookies  whose  keys
                                      don't match any of the strings specified
                                      here.

                                      (string)

                               MatchScope -> (string)
                                   The  parts  of  the cookies to inspect with
                                   the rule inspection criteria. If you  spec-
                                   ify  All  , WAF inspects both keys and val-
                                   ues.

                               OversizeHandling -> (string)
                                   What WAF should do if the  cookies  of  the
                                   request  are  more  numerous or larger than
                                   WAF can inspect. WAF does not  support  in-
                                   specting  the  entire  contents  of request
                                   cookies when they exceed 8 KB (8192  bytes)
                                   or  200  total cookies. The underlying host
                                   service forwards a maximum of  200  cookies
                                   and at most 8 KB of cookie contents to WAF.

                                   The  options  for oversize handling are the
                                   following:

                                   o CONTINUE - Inspect the available  cookies
                                     normally,  according  to the rule inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                            HeaderOrder -> (structure)
                               Inspect a string containing the list of the re-
                               quest's header names, ordered as they appear in
                               the  web  request that WAF receives for inspec-
                               tion. WAF generates the string  and  then  uses
                               that as the field to match component in its in-
                               spection. WAF separates the header names in the
                               string using commas and no added spaces.

                               Matches  against  the  header  order string are
                               case insensitive.

                               OversizeHandling -> (string)
                                   What WAF should do if the  headers  of  the
                                   request  are  more  numerous or larger than
                                   WAF can inspect. WAF does not  support  in-
                                   specting  the  entire  contents  of request
                                   headers when they exceed 8 KB (8192  bytes)
                                   or  200  total headers. The underlying host
                                   service forwards a maximum of  200  headers
                                   and at most 8 KB of header contents to WAF.

                                   The  options  for oversize handling are the
                                   following:

                                   o CONTINUE - Inspect the available  headers
                                     normally,  according  to the rule inspec-
                                     tion criteria.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                        TextTransformations -> (list)
                            Text transformations eliminate some of the unusual
                            formatting that attackers use in web  requests  in
                            an  effort  to  bypass detection. Text transforma-
                            tions are used in rule match statements, to trans-
                            form the FieldToMatch request component before in-
                            specting it, and they're used in  rate-based  rule
                            statements, to transform request components before
                            using them as  custom  aggregation  keys.  If  you
                            specify  one or more transformations to apply, WAF
                            performs all transformations on the specified con-
                            tent,  starting  from the lowest priority setting,
                            and then uses the component contents.

                            (structure)
                               Text transformations eliminate some of the  un-
                               usual  formatting that attackers use in web re-
                               quests in an effort to bypass detection.

                               Priority -> (integer)
                                   Sets the relative processing order for mul-
                                   tiple  transformations.  WAF  processes all
                                   transformations, from  lowest  priority  to
                                   highest,  before inspecting the transformed
                                   content. The priorities don't  need  to  be
                                   consecutive,  but  they must all be differ-
                                   ent.

                               Type -> (string)
                                   You can specify the  following  transforma-
                                   tion types:
                                      BASE64_DECODE - Decode a Base64 -encoded
                                      string.

                                      BASE64_DECODE_EXT - Decode a Base64 -en-
                                      coded string, but use a forgiving imple-
                                      mentation that ignores  characters  that
                                      aren't valid.

                                      CMD_LINE - Command-line transformations.
                                      These are helpful in reducing effective-
                                      ness  of attackers who inject an operat-
                                      ing system command-line command and  use
                                      unusual  formatting  to disguise some or
                                      all of the command.

                                   o Delete the following characters: \ " ' ^

                                   o Delete spaces before the following  char-
                                     acters: / (

                                   o Replace  the  following characters with a
                                     space: , ;

                                   o Replace multiple spaces with one space

                                   o Convert uppercase letters (A-Z) to lower-
                                     case (a-z)
                                      COMPRESS_WHITE_SPACE   -  Replace  these
                                      characters with a space character (deci-
                                      mal 32):

                                   o \f , formfeed, decimal 12

                                   o \t , tab, decimal 9

                                   o \n , newline, decimal 10

                                   o \r , carriage return, decimal 13

                                   o \v , vertical tab, decimal 11

                                   o Non-breaking space, decimal 160
                                      COMPRESS_WHITE_SPACE  also replaces mul-
                                      tiple spaces with one space.

                                      CSS_DECODE - Decode characters that were
                                      encoded  using CSS 2.x escape rules syn-
                                      data.html#characters  .  This   function
                                      uses  up  to  two  bytes in the decoding
                                      process, so it can help to uncover ASCII
                                      characters  that  were encoded using CSS
                                      encoding that wouldnt typically  be  en-
                                      coded.  It's  also  useful in countering
                                      evasion, which is  a  combination  of  a
                                      backslash  and  non-hexadecimal  charac-
                                      ters. For example, ja\vascript for java-
                                      script.

                                      ESCAPE_SEQ_DECODE - Decode the following
                                      ANSI C escape sequences: \a , \b , \f  ,
                                      \n  , \r , \t , \v , \\ , \? , \' , \" ,
                                      \xHH (hexadecimal), \0OOO  (octal).  En-
                                      codings  that aren't valid remain in the
                                      output.

                                      HEX_DECODE - Decode a string of hexadec-
                                      imal characters into a binary.

                                      HTML_ENTITY_DECODE  -  Replace  HTML-en-
                                      coded characters with unencoded  charac-
                                      ters.  HTML_ENTITY_DECODE performs these
                                      operations:

                                   o Replaces (ampersand)quot; with "

                                   o Replaces    (ampersand)nbsp;    with    a
                                     non-breaking space, decimal 160

                                   o Replaces   (ampersand)lt;  with  a  "less
                                     than" symbol

                                   o Replaces (ampersand)gt; with >

                                   o Replaces characters that are  represented
                                     in hexadecimal format, (ampersand)#xhhhh;
                                     , with the corresponding characters

                                   o Replaces characters that are  represented
                                     in  decimal  format,  (ampersand)#nnnn; ,
                                     with the corresponding characters
                                      JS_DECODE - Decode JavaScript escape se-
                                      quences.  If a \  u  HHHH code is in the
                                      full-width ASCII code range of FF01-FF5E
                                      , then the higher byte is used to detect
                                      and adjust the lower byte. If not,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed, causing a possible  loss
                                      of information.

                                      LOWERCASE  -  Convert  uppercase letters
                                      (A-Z) to lowercase (a-z).

                                      MD5 - Calculate an  MD5  hash  from  the
                                      data  in the input. The computed hash is
                                      in a raw binary form.

                                      NONE - Specify NONE if  you  don't  want
                                      any text transformations.

                                      NORMALIZE_PATH    -    Remove   multiple
                                      slashes, directory self-references,  and
                                      directory  back-references  that are not
                                      at the beginning of the  input  from  an
                                      input string.

                                      NORMALIZE_PATH_WIN - This is the same as
                                      NORMALIZE_PATH  ,  but  first   converts
                                      backslash characters to forward slashes.

                                      REMOVE_NULLS  -  Remove  all  NULL bytes
                                      from the input.

                                      REPLACE_COMMENTS - Replace  each  occur-
                                      rence  of a C-style comment (/* ... */ )
                                      with a single space.  Multiple  consecu-
                                      tive occurrences are not compressed. Un-
                                      terminated comments  are  also  replaced
                                      with  a  space  (ASCII 0x20). However, a
                                      standalone termination of a comment  (*/
                                      ) is not acted upon.

                                      REPLACE_NULLS  -  Replace  NULL bytes in
                                      the input with space  characters  (ASCII
                                      0x20 ).

                                      SQL_HEX_DECODE  -  Decode  SQL hex data.
                                      Example (0x414243 ) will be  decoded  to
                                      (ABC ).

                                      URL_DECODE - Decode a URL-encoded value.

                                      URL_DECODE_UNI  -  Like URL_DECODE , but
                                      with support for  Microsoft-specific  %u
                                      encoding.   If   the   code  is  in  the
                                      full-width ASCII code range of FF01-FF5E
                                      ,  the higher byte is used to detect and
                                      adjust the lower byte.  Otherwise,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed.

                                      UTF8_TO_UNICODE  -  Convert  all   UTF-8
                                      character  sequences  to  Unicode.  This
                                      helps input normalization, and  minimiz-
                                      ing  false-positives and false-negatives
                                      for non-English languages.

                 Action -> (structure)
                     The action that WAF should take on a web request when  it
                     matches the rule statement. Settings at the web ACL level
                     can override the rule action setting.

                     This is used only for rules whose statements do not  ref-
                     erence  a  rule  group.  Rule statements that reference a
                     rule group include RuleGroupReferenceStatement  and  Man-
                     agedRuleGroupStatement .

                     You  must  specify either this Action setting or the rule
                     OverrideAction setting, but not both:

                     o If the rule statement does not reference a rule  group,
                       use  this rule action setting and not the rule override
                       action setting.

                     o If the rule statement references a rule group, use  the
                       override action setting and not this action setting.

                     Block -> (structure)
                        Instructs WAF to block the web request.

                        CustomResponse -> (structure)
                            Defines a custom response for the web request.

                            For information about customizing web requests and
                            responses, see Customizing web  requests  and  re-
                            sponses in WAF in the WAF Developer Guide .

                            ResponseCode -> (integer)
                               The HTTP status code to return to the client.

                               For  a list of status codes that you can use in
                               your custom  responses,  see  Supported  status
                               codes  for custom response in the WAF Developer
                               Guide .

                            CustomResponseBodyKey -> (string)
                               References the response body that you want  WAF
                               to  return  to  the web request client. You can
                               define a custom response for a rule action or a
                               default web ACL action that is set to block. To
                               do this, you first define the response body key
                               and  value  in the CustomResponseBodies setting
                               for the  WebACL or  RuleGroup where you want to
                               use it. Then, in the rule action or web ACL de-
                               fault action BlockAction setting, you reference
                               the response body using this key.

                            ResponseHeaders -> (list)
                               The HTTP headers to use in the response. Dupli-
                               cate header names are not allowed.

                               For information about the limits on  count  and
                               size  for custom request and response settings,
                               see WAF quotas in the WAF Developer Guide .

                               (structure)
                                   A custom header for custom request and  re-
                                   sponse handling. This is used in  CustomRe-
                                   sponse and  CustomRequestHandling .

                                   Name -> (string)
                                      The name of the custom header.

                                      For  custom  request  header  insertion,
                                      when WAF inserts the header into the re-
                                      quest, it prefixes this name x-amzn-waf-
                                      ,  to  avoid  confusion with the headers
                                      that are already in the request. For ex-
                                      ample,  for the header name sample , WAF
                                      inserts the header x-amzn-waf-sample .

                                   Value -> (string)
                                      The value of the custom header.

                     Allow -> (structure)
                        Instructs WAF to allow the web request.

                        CustomRequestHandling -> (structure)
                            Defines custom handling for the web request.

                            For information about customizing web requests and
                            responses,  see  Customizing  web requests and re-
                            sponses in WAF in the WAF Developer Guide .

                            InsertHeaders -> (list)
                               The HTTP headers to insert  into  the  request.
                               Duplicate header names are not allowed.

                               For  information  about the limits on count and
                               size for custom request and response  settings,
                               see WAF quotas in the WAF Developer Guide .

                               (structure)
                                   A  custom header for custom request and re-
                                   sponse handling. This is used in  CustomRe-
                                   sponse and  CustomRequestHandling .

                                   Name -> (string)
                                      The name of the custom header.

                                      For  custom  request  header  insertion,
                                      when WAF inserts the header into the re-
                                      quest, it prefixes this name x-amzn-waf-
                                      , to avoid confusion  with  the  headers
                                      that are already in the request. For ex-
                                      ample, for the header name sample ,  WAF
                                      inserts the header x-amzn-waf-sample .

                                   Value -> (string)
                                      The value of the custom header.

                     Count -> (structure)
                        Instructs  WAF  to count the web request and then con-
                        tinue evaluating the request using the remaining rules
                        in the web ACL.

                        CustomRequestHandling -> (structure)
                            Defines custom handling for the web request.

                            For information about customizing web requests and
                            responses, see Customizing web  requests  and  re-
                            sponses in WAF in the WAF Developer Guide .

                            InsertHeaders -> (list)
                               The  HTTP  headers  to insert into the request.
                               Duplicate header names are not allowed.

                               For information about the limits on  count  and
                               size  for custom request and response settings,
                               see WAF quotas in the WAF Developer Guide .

                               (structure)
                                   A custom header for custom request and  re-
                                   sponse handling. This is used in  CustomRe-
                                   sponse and  CustomRequestHandling .

                                   Name -> (string)
                                      The name of the custom header.

                                      For  custom  request  header  insertion,
                                      when WAF inserts the header into the re-
                                      quest, it prefixes this name x-amzn-waf-
                                      ,  to  avoid  confusion with the headers
                                      that are already in the request. For ex-
                                      ample,  for the header name sample , WAF
                                      inserts the header x-amzn-waf-sample .

                                   Value -> (string)
                                      The value of the custom header.

                     Captcha -> (structure)
                        Instructs WAF to run a CAPTCHA check against  the  web
                        request.

                        CustomRequestHandling -> (structure)
                            Defines  custom handling for the web request, used
                            when the CAPTCHA inspection  determines  that  the
                            request's token is valid and unexpired.

                            For information about customizing web requests and
                            responses, see Customizing web  requests  and  re-
                            sponses in WAF in the WAF Developer Guide .

                            InsertHeaders -> (list)
                               The  HTTP  headers  to insert into the request.
                               Duplicate header names are not allowed.

                               For information about the limits on  count  and
                               size  for custom request and response settings,
                               see WAF quotas in the WAF Developer Guide .

                               (structure)
                                   A custom header for custom request and  re-
                                   sponse handling. This is used in  CustomRe-
                                   sponse and  CustomRequestHandling .

                                   Name -> (string)
                                      The name of the custom header.

                                      For  custom  request  header  insertion,
                                      when WAF inserts the header into the re-
                                      quest, it prefixes this name x-amzn-waf-
                                      ,  to  avoid  confusion with the headers
                                      that are already in the request. For ex-
                                      ample,  for the header name sample , WAF
                                      inserts the header x-amzn-waf-sample .

                                   Value -> (string)
                                      The value of the custom header.

                     Challenge -> (structure)
                        Instructs WAF to run a Challenge check against the web
                        request.

                        CustomRequestHandling -> (structure)
                            Defines  custom handling for the web request, used
                            when the challenge inspection determines that  the
                            request's token is valid and unexpired.

                            For information about customizing web requests and
                            responses, see Customizing web  requests  and  re-
                            sponses in WAF in the WAF Developer Guide .

                            InsertHeaders -> (list)
                               The  HTTP  headers  to insert into the request.
                               Duplicate header names are not allowed.

                               For information about the limits on  count  and
                               size  for custom request and response settings,
                               see WAF quotas in the WAF Developer Guide .

                               (structure)
                                   A custom header for custom request and  re-
                                   sponse handling. This is used in  CustomRe-
                                   sponse and  CustomRequestHandling .

                                   Name -> (string)
                                      The name of the custom header.

                                      For  custom  request  header  insertion,
                                      when WAF inserts the header into the re-
                                      quest, it prefixes this name x-amzn-waf-
                                      ,  to  avoid  confusion with the headers
                                      that are already in the request. For ex-
                                      ample,  for the header name sample , WAF
                                      inserts the header x-amzn-waf-sample .

                                   Value -> (string)
                                      The value of the custom header.

                 OverrideAction -> (structure)
                     The action to use in the place of the action that results
                     from  the  rule group evaluation. Set the override action
                     to none to leave the result of the rule group alone.  Set
                     it to count to override the result to count only.

                     You  can only use this for rule statements that reference
                     a rule group, like RuleGroupReferenceStatement  and  Man-
                     agedRuleGroupStatement .

                     NOTE:
                        This option is usually set to none. It does not affect
                        how the rules in the rule group are evaluated. If  you
                        want  the  rules  in  the  rule  group  to  only count
                        matches, do not use this and instead use the rule  ac-
                        tion  override option, with Count action, in your rule
                        group reference statement settings.

                     Count -> (structure)
                        Override the rule group  evaluation  result  to  count
                        only.

                        NOTE:
                            This  option  is  usually set to none. It does not
                            affect how the rules in the rule group are  evalu-
                            ated.  If  you want the rules in the rule group to
                            only count matches, do not use  this  and  instead
                            use  the  rule  action override option, with Count
                            action, in your  rule  group  reference  statement
                            settings.

                        CustomRequestHandling -> (structure)
                            Defines custom handling for the web request.

                            For information about customizing web requests and
                            responses, see Customizing web  requests  and  re-
                            sponses in WAF in the WAF Developer Guide .

                            InsertHeaders -> (list)
                               The  HTTP  headers  to insert into the request.
                               Duplicate header names are not allowed.

                               For information about the limits on  count  and
                               size  for custom request and response settings,
                               see WAF quotas in the WAF Developer Guide .

                               (structure)
                                   A custom header for custom request and  re-
                                   sponse handling. This is used in  CustomRe-
                                   sponse and  CustomRequestHandling .

                                   Name -> (string)
                                      The name of the custom header.

                                      For  custom  request  header  insertion,
                                      when WAF inserts the header into the re-
                                      quest, it prefixes this name x-amzn-waf-
                                      ,  to  avoid  confusion with the headers
                                      that are already in the request. For ex-
                                      ample,  for the header name sample , WAF
                                      inserts the header x-amzn-waf-sample .

                                   Value -> (string)
                                      The value of the custom header.

                     None -> (structure)
                        Don't override the rule group evaluation result.  This
                        is the most common setting.

                 RuleLabels -> (list)
                     Labels to apply to web requests that match the rule match
                     statement. WAF applies fully qualified labels to matching
                     web  requests.  A fully qualified label is the concatena-
                     tion of a label namespace and a rule  label.  The  rule's
                     rule group or web ACL defines the label namespace.

                     Rules  that  run after this rule in the web ACL can match
                     against these labels using a LabelMatchStatement .

                     For each label, provide a case-sensitive string  contain-
                     ing  optional  namespaces  and a label name, according to
                     the following guidelines:

                     o Separate each component of the label with a colon.

                     o Each namespace or name can have up to 128 characters.

                     o You can specify up to 5 namespaces in a label.

                     o Don't use the following reserved words  in  your  label
                       specification: aws , waf , managed , rulegroup , webacl
                       , regexpatternset , or ipset .

                     For example, myLabelName  or  nameSpace1:nameSpace2:myLa-
                     belName .

                     (structure)
                        A  single  label container. This is used as an element
                        of a label array in multiple contexts, for example, in
                        RuleLabels inside a  Rule and in Labels inside a  Sam-
                        pledHTTPRequest .

                        Name -> (string)
                            The label string.

                 VisibilityConfig -> (structure)
                     Defines and enables Amazon CloudWatch metrics and web re-
                     quest sample collection.

                     SampledRequestsEnabled -> (boolean)
                        Indicates  whether  WAF should store a sampling of the
                        web requests that match the rules. You  can  view  the
                        sampled requests through the WAF console.

                     CloudWatchMetricsEnabled -> (boolean)
                        Indicates  whether  the associated resource sends met-
                        rics to Amazon CloudWatch. For the list  of  available
                        metrics, see WAF Metrics in the WAF Developer Guide .

                        For  web  ACLs,  the metrics are for web requests that
                        have the web ACL default action applied.  WAF  applies
                        the  default  action to web requests that pass the in-
                        spection of all rules in the web ACL without being ei-
                        ther allowed or blocked. For more information, see The
                        web ACL default action in the WAF Developer Guide .

                     MetricName -> (string)
                        A name of the Amazon CloudWatch metric dimension.  The
                        name can contain only the characters: A-Z, a-z, 0-9, -
                        (hyphen), and _ (underscore). The name can be from one
                        to 128 characters long. It can't contain whitespace or
                        metric names that are reserved for  WAF,  for  example
                        All and Default_Action .

                 CaptchaConfig -> (structure)
                     Specifies  how  WAF should handle CAPTCHA evaluations. If
                     you don't specify this, WAF uses the  CAPTCHA  configura-
                     tion that's defined for the web ACL.

                     ImmunityTimeProperty -> (structure)
                        Determines  how  long a CAPTCHA timestamp in the token
                        remains valid after the client successfully  solves  a
                        CAPTCHA puzzle.

                        ImmunityTime -> (long)
                            The  amount of time, in seconds, that a CAPTCHA or
                            challenge timestamp is considered  valid  by  WAF.
                            The default setting is 300.

                            For  the  Challenge action, the minimum setting is
                            300.

                 ChallengeConfig -> (structure)
                     Specifies how WAF should handle Challenge evaluations. If
                     you don't specify this, WAF uses the challenge configura-
                     tion that's defined for the web ACL.

                     ImmunityTimeProperty -> (structure)
                        Determines how long a challenge timestamp in the token
                        remains  valid  after the client successfully responds
                        to a challenge.

                        ImmunityTime -> (long)
                            The amount of time, in seconds, that a CAPTCHA  or
                            challenge  timestamp  is  considered valid by WAF.
                            The default setting is 300.

                            For the Challenge action, the minimum  setting  is
                            300.

          VisibilityConfig -> (structure)
              Defines  and  enables  Amazon CloudWatch metrics and web request
              sample collection.

              SampledRequestsEnabled -> (boolean)
                 Indicates whether WAF should store a sampling of the web  re-
                 quests  that  match  the  rules. You can view the sampled re-
                 quests through the WAF console.

              CloudWatchMetricsEnabled -> (boolean)
                 Indicates whether the associated resource  sends  metrics  to
                 Amazon CloudWatch. For the list of available metrics, see WAF
                 Metrics in the WAF Developer Guide .

                 For web ACLs, the metrics are for web requests that have  the
                 web  ACL  default action applied. WAF applies the default ac-
                 tion to web requests that pass the inspection of all rules in
                 the web ACL without being either allowed or blocked. For more
                 information, see The web ACL default action in the WAF Devel-
                 oper Guide .

              MetricName -> (string)
                 A  name  of  the Amazon CloudWatch metric dimension. The name
                 can contain only the characters: A-Z, a-z, 0-9,  -  (hyphen),
                 and  _  (underscore). The name can be from one to 128 charac-
                 ters long. It can't contain whitespace or metric  names  that
                 are reserved for WAF, for example All and Default_Action .

          LabelNamespace -> (string)
              The label namespace prefix for this rule group. All labels added
              by rules in this rule group have this prefix.

              o The syntax for the label namespace prefix for your rule groups
                is  the following:   awswaf:<account ID>:rulegroup:<rule group
                name>:

              o When a rule with a label matches a web request, WAF  adds  the
                fully  qualified label to the request. A fully qualified label
                is made up of the label namespace from the rule group  or  web
                ACL  where  the  rule  is defined and the label from the rule,
                separated by a colon:   <label namespace>:<label from rule>

          CustomResponseBodies -> (map)
              A map of custom response keys and content bodies. When you  cre-
              ate  a  rule with a block action, you can send a custom response
              to the web request. You define these for  the  rule  group,  and
              then use them in the rules that you define in the rule group.

              For  information  about  customizing web requests and responses,
              see Customizing web requests and responses in WAF in the WAF De-
              veloper Guide .

              For  information  about  the limits on count and size for custom
              request and response settings, see WAF quotas in the WAF  Devel-
              oper Guide .

              key -> (string)

              value -> (structure)
                 The  response  body  to use in a custom response to a web re-
                 quest. This is referenced by key from   CustomResponse   Cus-
                 tomResponseBodyKey .

                 ContentType -> (string)
                     The  type of content in the payload that you are defining
                     in the Content string.

                 Content -> (string)
                     The payload of the custom response.

                     You can use JSON escape strings in JSON  content.  To  do
                     this,  you  must  specify JSON content in the ContentType
                     setting.

                     For information about the limits on count  and  size  for
                     custom  request  and response settings, see WAF quotas in
                     the WAF Developer Guide .

          AvailableLabels -> (list)
              The labels that one or more rules in  this  rule  group  add  to
              matching  web  requests. These labels are defined in the RuleLa-
              bels for a  Rule .

              (structure)
                 List of labels used by one or more of the rules of  a   Rule-
                 Group  .  This  summary object is used for the following rule
                 group lists:

                 o AvailableLabels - Labels that rules  add  to  matching  re-
                   quests.  These  labels  are defined in the RuleLabels for a
                   Rule .

                 o ConsumedLabels - Labels that rules match against. These la-
                   bels are defined in a LabelMatchStatement specification, in
                   the  Statement definition of a rule.

                 Name -> (string)
                     An individual label specification.

          ConsumedLabels -> (list)
              The labels that one or more  rules  in  this  rule  group  match
              against in label match statements. These labels are defined in a
              LabelMatchStatement specification, in the  Statement  definition
              of a rule.

              (structure)
                 List  of  labels used by one or more of the rules of a  Rule-
                 Group . This summary object is used for  the  following  rule
                 group lists:

                 o AvailableLabels  -  Labels  that  rules add to matching re-
                   quests. These labels are defined in the  RuleLabels  for  a
                   Rule .

                 o ConsumedLabels - Labels that rules match against. These la-
                   bels are defined in a LabelMatchStatement specification, in
                   the  Statement definition of a rule.

                 Name -> (string)
                     An individual label specification.

       LockToken -> (string)
          A token used for optimistic locking. WAF returns a token to your get
          and list requests, to mark the state of the entity at  the  time  of
          the  request.  To make changes to the entity associated with the to-
          ken, you provide the token to operations like update  and  delete  .
          WAF  uses  the token to ensure that no changes have been made to the
          entity since you last retrieved it. If a change has been  made,  the
          update  fails  with  a WAFOptimisticLockException . If this happens,
          perform another get , and use the new token returned by that  opera-
          tion.



                                                              GET-RULE-GROUP()
